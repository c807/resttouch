(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{"9qht":function(t,a,e){"use strict";e.d(a,"a",(function(){return f}));var n=e("8Y7J"),i=e("SVse"),r=e("Fwaw"),o=e("xgIS"),s=e("cp0P"),c=e("IzEk");const l=23;class u{constructor(t,a){this.renderer=a,this.miniFabVisible=!1,this._parent=t.get(d)}ngAfterContentInit(){this._buttons.changes.subscribe(()=>{this.initButtonStates(),this._parent.setActionsVisibility()}),this.initButtonStates()}initButtonStates(){this._buttons.forEach((t,a)=>{this.renderer.addClass(t._getHostElement(),"eco-fab-action-item"),this.changeElementStyle(t._getHostElement(),"z-index",""+(l-a))})}show(){this._buttons&&(this.resetAnimationState(),this.miniFabVisible=!0,this.showMiniFabAnimation=setTimeout(()=>{this._buttons.forEach((t,a)=>{let e,n=0;"scale"===this._parent.animationMode?(n=3+65*a,e="scale(1)"):e=this.getTranslateFunction("0");const i=t._getHostElement();this.changeElementStyle(i,"transition-delay",n+"ms"),this.changeElementStyle(i,"opacity","1"),this.changeElementStyle(i,"transform",e)})},50))}resetAnimationState(){clearTimeout(this.showMiniFabAnimation),this.hideMiniFab&&(this.hideMiniFab.unsubscribe(),this.hideMiniFab=null)}hide(){if(!this._buttons)return;this.resetAnimationState();const t=this._buttons.map((t,a)=>{let e,n="1",i=0;"scale"===this._parent.animationMode?(i=3-65*a,e="scale(0)",n="0"):e=this.getTranslateFunction(55*(a+1)-5*a+"px");const r=t._getHostElement();return this.changeElementStyle(r,"transition-delay",i+"ms"),this.changeElementStyle(r,"opacity",n),this.changeElementStyle(r,"transform",e),Object(o.a)(r,"transitionend").pipe(Object(c.a)(1))});this.hideMiniFab=Object(s.a)(t).subscribe(()=>this.miniFabVisible=!1)}getTranslateFunction(t){const a=this._parent.direction;return("up"===a||"down"===a?"translateY":"translateX")+"("+("down"===a||"right"===a?"-":"")+t+")"}changeElementStyle(t,a,e){this.renderer.setStyle(t,a,e)}}u.decorators=[{type:n.Component,args:[{selector:"eco-fab-speed-dial-actions",template:'\n        <ng-content select="[mat-mini-fab]" *ngIf="miniFabVisible"></ng-content>'}]}],u.ctorParameters=()=>[{type:n.Injector},{type:n.Renderer2}],u.propDecorators={_buttons:[{type:n.ContentChildren,args:[r.a]}]};class d{constructor(t,a,e){this.elementRef=t,this.renderer=a,this.document=e,this.isInitialized=!1,this._direction="up",this._open=!1,this._animationMode="fling",this._fixed=!1,this._documentClickUnlistener=null,this.openChange=new n.EventEmitter}get fixed(){return this._fixed}set fixed(t){this._fixed=t,this._processOutsideClickState()}get open(){return this._open}set open(t){const a=this._open;this._open=t,a!==this._open&&(this.openChange.emit(this._open),this.isInitialized&&this.setActionsVisibility())}get direction(){return this._direction}set direction(t){const a=this._direction;this._direction=t,a!==this.direction&&(this._setElementClass(a,!1),this._setElementClass(this.direction,!0),this.isInitialized&&this.setActionsVisibility())}get animationMode(){return this._animationMode}set animationMode(t){const a=this._animationMode;this._animationMode=t,a!==this._animationMode&&(this._setElementClass(a,!1),this._setElementClass(this.animationMode,!0),this.isInitialized&&Promise.resolve(null).then(()=>this.open=!1))}ngAfterContentInit(){this.isInitialized=!0,this.setActionsVisibility(),this._setElementClass(this.direction,!0),this._setElementClass(this.animationMode,!0)}ngOnDestroy(){this._unsetDocumentClickListener()}toggle(){this.open=!this.open}_onClick(){!this.fixed&&this.open&&(this.open=!1)}setActionsVisibility(){this._childActions&&(this.open?this._childActions.show():this._childActions.hide(),this._processOutsideClickState())}_setElementClass(t,a){const e=`eco-${t}`;a?this.renderer.addClass(this.elementRef.nativeElement,e):this.renderer.removeClass(this.elementRef.nativeElement,e)}_processOutsideClickState(){!this.fixed&&this.open?this._setDocumentClickListener():this._unsetDocumentClickListener()}_setDocumentClickListener(){this._documentClickUnlistener||(this._documentClickUnlistener=this.renderer.listen(this.document,"click",()=>{this.open=!1}))}_unsetDocumentClickListener(){this._documentClickUnlistener&&(this._documentClickUnlistener(),this._documentClickUnlistener=null)}}d.decorators=[{type:n.Component,args:[{selector:"eco-fab-speed-dial",template:'\n        <div class="eco-fab-speed-dial-container">\n            <ng-content select="eco-fab-speed-dial-trigger"></ng-content>\n            <ng-content select="eco-fab-speed-dial-actions"></ng-content>\n        </div>\n    ',encapsulation:n.ViewEncapsulation.None,styles:["eco-fab-speed-dial{display:inline-block}eco-fab-speed-dial.eco-opened .eco-fab-speed-dial-container eco-fab-speed-dial-trigger.eco-spin .spin180{transform:rotate(180deg)}eco-fab-speed-dial.eco-opened .eco-fab-speed-dial-container eco-fab-speed-dial-trigger.eco-spin .spin360{transform:rotate(360deg)}eco-fab-speed-dial .eco-fab-speed-dial-container{position:relative;display:flex;align-items:center;z-index:20}eco-fab-speed-dial .eco-fab-speed-dial-container eco-fab-speed-dial-trigger{pointer-events:auto;z-index:24}eco-fab-speed-dial .eco-fab-speed-dial-container eco-fab-speed-dial-trigger.eco-spin .spin180,eco-fab-speed-dial .eco-fab-speed-dial-container eco-fab-speed-dial-trigger.eco-spin .spin360{transition:.6s cubic-bezier(.4,0,.2,1)}eco-fab-speed-dial .eco-fab-speed-dial-container eco-fab-speed-dial-actions{display:flex;position:absolute;height:0;width:0}eco-fab-speed-dial.eco-fling .eco-fab-speed-dial-container eco-fab-speed-dial-actions .eco-fab-action-item{display:block;opacity:1;transition:.3s cubic-bezier(.55,0,.55,.2)}eco-fab-speed-dial.eco-scale .eco-fab-speed-dial-container eco-fab-speed-dial-actions .eco-fab-action-item{transform:scale(0);transition:.3s cubic-bezier(.55,0,.55,.2);transition-duration:.14286s}eco-fab-speed-dial.eco-down eco-fab-speed-dial-actions{bottom:2px;left:7px}eco-fab-speed-dial.eco-down .eco-fab-speed-dial-container{flex-direction:column}eco-fab-speed-dial.eco-down .eco-fab-speed-dial-container eco-fab-speed-dial-trigger{order:1}eco-fab-speed-dial.eco-down .eco-fab-speed-dial-container eco-fab-speed-dial-actions{flex-direction:column;order:2}eco-fab-speed-dial.eco-down .eco-fab-speed-dial-container eco-fab-speed-dial-actions .eco-fab-action-item{margin-top:10px}eco-fab-speed-dial.eco-up eco-fab-speed-dial-actions{top:2px;left:7px}eco-fab-speed-dial.eco-up .eco-fab-speed-dial-container{flex-direction:column}eco-fab-speed-dial.eco-up .eco-fab-speed-dial-container eco-fab-speed-dial-trigger{order:2}eco-fab-speed-dial.eco-up .eco-fab-speed-dial-container eco-fab-speed-dial-actions{flex-direction:column-reverse;order:1}eco-fab-speed-dial.eco-up .eco-fab-speed-dial-container eco-fab-speed-dial-actions .eco-fab-action-item{margin-bottom:10px}eco-fab-speed-dial.eco-left eco-fab-speed-dial-actions{top:7px;left:2px}eco-fab-speed-dial.eco-left .eco-fab-speed-dial-container{flex-direction:row}eco-fab-speed-dial.eco-left .eco-fab-speed-dial-container eco-fab-speed-dial-trigger{order:2}eco-fab-speed-dial.eco-left .eco-fab-speed-dial-container eco-fab-speed-dial-actions{flex-direction:row-reverse;order:1}eco-fab-speed-dial.eco-left .eco-fab-speed-dial-container eco-fab-speed-dial-actions .eco-fab-action-item{margin-right:10px}eco-fab-speed-dial.eco-right eco-fab-speed-dial-actions{top:7px;right:2px}eco-fab-speed-dial.eco-right .eco-fab-speed-dial-container{flex-direction:row}eco-fab-speed-dial.eco-right .eco-fab-speed-dial-container eco-fab-speed-dial-trigger{order:1}eco-fab-speed-dial.eco-right .eco-fab-speed-dial-container eco-fab-speed-dial-actions{flex-direction:row;order:2}eco-fab-speed-dial.eco-right .eco-fab-speed-dial-container eco-fab-speed-dial-actions .eco-fab-action-item{margin-left:10px}"]}]}],d.ctorParameters=()=>[{type:n.ElementRef},{type:n.Renderer2},{type:Document,decorators:[{type:n.Inject,args:[i.DOCUMENT]}]}],d.propDecorators={fixed:[{type:n.Input}],open:[{type:n.HostBinding,args:["class.eco-opened"]},{type:n.Input}],direction:[{type:n.Input}],animationMode:[{type:n.Input}],openChange:[{type:n.Output}],_childActions:[{type:n.ContentChild,args:[u,{static:!1}]}],_onClick:[{type:n.HostListener,args:["click"]}]};class m{constructor(t){this.spin=!1,this._parent=t.get(d)}get sp(){return this.spin}_onClick(t){this._parent.fixed||(this._parent.toggle(),t.stopPropagation())}}m.decorators=[{type:n.Component,args:[{selector:"eco-fab-speed-dial-trigger",template:'\n        <ng-content select="[mat-fab]"></ng-content>'}]}],m.ctorParameters=()=>[{type:n.Injector}],m.propDecorators={sp:[{type:n.HostBinding,args:["class.eco-spin"]}],spin:[{type:n.Input}],_onClick:[{type:n.HostListener,args:["click",["$event"]]}]};class f{}f.decorators=[{type:n.NgModule,args:[{imports:[i.CommonModule],declarations:[u,d,m],exports:[u,d,m]}]}]},Dm0Z:function(t,a,e){"use strict";e.r(a),a.default='<mat-card class="mat-elevation-z4 fullWidth">\n    <mat-card-title>\n        <h4>\n            Forma de pago {{!!formaPago.forma_pago ? formaPago.descripcion : \'\'}}\n        </h4>\n    </mat-card-title>\n    <mat-card-content>\n        <form #frmFormaPago="ngForm" (ngSubmit)="frmFormaPago.form.valid && onSubmit()" novalidate>\n            <div class="form-group">\n                <mat-form-field class="fullWidth" *ngIf="esMovil">\n                    <input matInput type="text" placeholder="Descripci\xf3n" name="descripcion" [(ngModel)]="formaPago.descripcion" required>\n                </mat-form-field>\n                <mat-form-field class="fullWidth" *ngIf="!esMovil">\n                    <input matInput ng-virtual-keyboard ng-virtual-keyboard-layout="alphanumeric" ng-virtual-keyboard-placeholder="Descripcion" type="text" placeholder="Descripci\xf3n" name="descripcion" [(ngModel)]="formaPago.descripcion" required>\n                </mat-form-field>\n            </div>\n            <div class="form-group">\n                <mat-checkbox name="activo" class="fullWidth" [(ngModel)]="+formaPago.activo">Activo</mat-checkbox>\n            </div>\n            <div align="end">\n                <button mat-raised-button type="submit" color="accent" class="btnAccion" [disabled]="!frmFormaPago.form.valid">\n                    Guardar\n                </button>\n                <button mat-raised-button type="button" color="accent" (click)="resetFormaPago()" *ngIf="formaPago.forma_pago">\n                    Nueva\n                </button>\n            </div>\n        </form>\n    </mat-card-content>\n</mat-card>'},ElJa:function(t,a,e){"use strict";e.r(a),a.default='<mat-card class="mat-elevation-z4 fullWidth">\n    <mat-card-title>\n        <h4 *ngIf="!!factura.fel_uuid_anulacion" style="background-color: lightcoral;">*** ANULADA ***</h4>\n        <h4>\n            Factura {{!!factura.factura ? (!!factura.serie_factura ? (factura.serie_factura + \' \' + factura.numero_factura) : \'Pendiente de firmar.\') : \'\'}}\n            <button mat-icon-button type="button" color="accent" (click)="showForm = true;" *ngIf="!showForm">\n                <mat-icon class="iconFontSize">expand_more</mat-icon>\n            </button>\n            <button mat-icon-button type="button" color="accent" (click)="showForm = false;" *ngIf="showForm">\n                <mat-icon class="iconFontSize">expand_less</mat-icon>\n            </button>\n        </h4>\n    </mat-card-title>\n    <mat-card-content>\n        <form #frmFactura="ngForm" *ngIf="showForm" (ngSubmit)="frmFactura.form.valid && onSubmit()" novalidate>\n            <div class="form-group">\n                <mat-form-field class="fullWidth">\n                    <mat-label>Serie</mat-label>\n                    <mat-select name="factura_serie" [(ngModel)]="factura.factura_serie" required>\n                        <mat-option *ngFor="let fs of facturaSeries" [value]="fs.factura_serie">\n                            {{fs.serie}} ({{fs.tipo}})\n                        </mat-option>\n                    </mat-select>\n                </mat-form-field>\n            </div>\n            <div class="form-group">\n                <mat-form-field class="fullWidth">\n                    <mat-label>Cliente</mat-label>\n                    <mat-select name="cliente" [(ngModel)]="factura.cliente" required>\n                        <mat-option *ngFor="let cli of clientes" [value]="cli.cliente">\n                            {{cli.nombre}} ({{cli.nit}})\n                        </mat-option>\n                    </mat-select>\n                </mat-form-field>\n            </div>\n            <div class="form-group">\n                <mat-form-field class="fullWidth">\n                    <input matInput type="date" placeholder="Fecha" name="fecha_factura" [(ngModel)]="factura.fecha_factura" required>\n                </mat-form-field>\n            </div>\n            <div class="form-group">\n                <mat-form-field class="fullWidth">\n                    <mat-label>Moneda</mat-label>\n                    <mat-select name="moneda" [(ngModel)]="factura.moneda" required>\n                        <mat-option *ngFor="let mon of monedas" [value]="mon.moneda">\n                            {{mon.nombre}} ({{mon.simbolo}})\n                        </mat-option>\n                    </mat-select>\n                </mat-form-field>\n            </div>\n            <div class="form-group">\n                <mat-checkbox name="exenta" class="fullWidth" [(ngModel)]="+factura.exenta">Exenta</mat-checkbox>\n            </div>\n            <div class="form-group">\n                <mat-form-field class="fullWidth" *ngIf="esMovil">\n                    <input matInput type="text" placeholder="Notas" name="notas" [(ngModel)]="factura.notas">\n                </mat-form-field>\n                <mat-form-field class="fullWidth" *ngIf="!esMovil">\n                    <input matInput ng-virtual-keyboard ng-virtual-keyboard-layout="alphanumeric" ng-virtual-keyboard-placeholder="Notas" type="text" placeholder="Notas" name="notas" [(ngModel)]="factura.notas">\n                </mat-form-field>\n            </div>\n            <div align="end">\n                <button mat-raised-button type="submit" color="accent" class="btnAccion" [disabled]="!frmFactura.form.valid || !!factura.fel_uuid || !!factura.fel_uuid_anulacion">\n                    Guardar\n                </button>\n                <button mat-raised-button type="button" color="accent" class="btnAccion" [disabled]="!frmFactura.form.valid || !!factura.fel_uuid || !!factura.fel_uuid_anulacion || detallesFactura.length === 0 || refacturacion" (click)="firmarFactura()">\n                    Firmar\n                </button>\n                <button mat-raised-button type="button" color="accent" class="btnAccion" [disabled]="!frmFactura.form.valid || factura.fel_uuid == undefined || factura.fel_uuid == null || !!factura.fel_uuid_anulacion || detallesFactura.length === 0 || refacturacion" (click)="imprimirFactura()">\n                    Imprimir\n                </button>\n                <button mat-raised-button type="button" color="accent" class="btnAccion" [disabled]="!frmFactura.form.valid || factura.fel_uuid == undefined || factura.fel_uuid == null || detallesFactura.length === 0 || refacturacion" (click)="representacionGrafica()">\n                    PDF\n                </button>\n                <button mat-raised-button type="button" color="accent" class="btnAccion" [disabled]="!frmFactura.form.valid || factura.fel_uuid == undefined || factura.fel_uuid == null || !!factura.fel_uuid_anulacion || detallesFactura.length === 0" (click)="anularFactura()">\n                    Anular\n                </button>\n                <button mat-raised-button type="button" color="accent" class="btnAccion" *ngIf="!!factura.fel_uuid_anulacion" (click)="refacturar()">\n                    Refacturar\n                </button>\n                <button mat-raised-button type="button" color="accent" (click)="resetFactura()" *ngIf="factura.factura">\n                    Nueva\n                </button>\n\n            </div>\n        </form>\n    </mat-card-content>\n</mat-card>\n<hr *ngIf="factura.factura" />\n<mat-card class="mat-elevation-z4 fullWidth" *ngIf="factura.factura">\n    <mat-card-title>\n        <h4>\n            Detalle de factura No. {{(!!factura.serie_factura ? (factura.serie_factura + \' \' + factura.numero_factura) : \'Pendiente de firmar.\')}}\n            <button mat-icon-button type="button" color="accent" (click)="showFormDetalle = true;" *ngIf="!showFormDetalle">\n                <mat-icon class="iconFontSize">expand_more</mat-icon>\n            </button>\n            <button mat-icon-button type="button" color="accent" (click)="showFormDetalle = false;" *ngIf="showFormDetalle">\n                <mat-icon class="iconFontSize">expand_less</mat-icon>\n            </button>\n        </h4>\n    </mat-card-title>\n    <mat-card-content>\n        <form #frmDetalleFactura="ngForm" *ngIf="showFormDetalle" (ngSubmit)="frmDetalleFactura.form.valid && onSubmitDetail()" novalidate>\n            <div class="form-group">\n                <mat-form-field class="fullWidth">\n                    <mat-label>Art\xedculo</mat-label>\n                    <mat-select name="articulo" [(ngModel)]="detalleFactura.articulo" (selectionChange)="setPrecioUnitario($event)" required>\n                        <mat-option *ngFor="let a of articulos" [value]="a.articulo">\n                            {{a.descripcion}}\n                        </mat-option>\n                    </mat-select>\n                </mat-form-field>\n            </div>\n            <div class="form-group">\n                <mat-form-field class="fullWidth" *ngIf="esMovil">\n                    <input matInput placeholder="Cantidad" name="cantidad" [(ngModel)]="detalleFactura.cantidad"\n                        (change)="detalleFactura.total = +detalleFactura.precio_unitario * +detalleFactura.cantidad"\n                        required>\n                </mat-form-field>\n                <mat-form-field class="fullWidth" *ngIf="!esMovil">\n                    <input matInput ng-virtual-keyboard ng-virtual-keyboard-layout="numeric" ng-virtual-keyboard-placeholder="Cantidad" placeholder="Cantidad" name="cantidad" [(ngModel)]="detalleFactura.cantidad"\n                        (change)="detalleFactura.total = +detalleFactura.precio_unitario * +detalleFactura.cantidad"\n                        required>\n                </mat-form-field>\n            </div>\n            <div class="form-group">\n                <mat-form-field class="fullWidth" *ngIf="esMovil">\n                    <input matInput placeholder="Precio unitario" name="precio_unitario"\n                        [(ngModel)]="detalleFactura.precio_unitario"\n                        (change)="detalleFactura.total = +detalleFactura.precio_unitario * +detalleFactura.cantidad"\n                        required>\n                </mat-form-field>\n                <mat-form-field class="fullWidth" *ngIf="!esMovil">\n                    <input matInput ng-virtual-keyboard ng-virtual-keyboard-layout="numeric" ng-virtual-keyboard-placeholder="Precio unitario" placeholder="Precio unitario" name="precio_unitario"\n                        [(ngModel)]="detalleFactura.precio_unitario"\n                        (change)="detalleFactura.total = +detalleFactura.precio_unitario * +detalleFactura.cantidad"\n                        required>\n                </mat-form-field>\n            </div>\n            <div align="end">\n                <button mat-raised-button type="submit" color="accent" class="btnAccion" [disabled]="!frmDetalleFactura.form.valid || !!factura.fel_uuid || !!factura.fel_uuid_anulacion">\n                    Guardar\n                </button>\n                <button mat-raised-button type="button" color="accent" (click)="resetDetalleFactura()" *ngIf="detalleFactura.detalle_factura">\n                    Nuevo\n                </button>\n            </div>\n        </form>\n        <hr *ngIf="detallesFactura.length > 0"/>\n        <table mat-table [dataSource]="dataSource" class="mat-elevation-z4 full-width" *ngIf="detallesFactura.length > 0">\n            <ng-container matColumnDef="articulo">\n                <th mat-header-cell *matHeaderCellDef>Art\xedculo</th>\n                <td mat-cell *matCellDef="let element" class="text-wrap">{{element.articulo.descripcion}}</td>\n            </ng-container>\n            <ng-container matColumnDef="cantidad">\n                <th mat-header-cell *matHeaderCellDef class="text-right">Cantidad</th>\n                <td mat-cell *matCellDef="let element" class="text-right">{{element.cantidad | number:\'1.2-2\'}}</td>\n            </ng-container>\n            <ng-container matColumnDef="precio_unitario">\n                <th mat-header-cell *matHeaderCellDef class="text-right">Precio Unitario</th>\n                <td mat-cell *matCellDef="let element" class="text-right">{{element.precio_unitario | number:\'1.2-2\'}}</td>\n            </ng-container>\n            <ng-container matColumnDef="total">\n                <th mat-header-cell *matHeaderCellDef class="text-right">Total</th>\n                <td mat-cell *matCellDef="let element" class="text-right">{{element.total | number:\'1.2-2\'}}</td>\n            </ng-container>\n            <ng-container matColumnDef="editItem">\n                <th mat-header-cell *matHeaderCellDef>&nbsp;</th>\n                <td mat-cell *matCellDef="let element" class="text-wrap">\n                    <button mat-raised-button type="button" color="accent" (click)="getDetalleFactura(element.factura, element.detalle_factura)" [disabled]="!!factura.fel_uuid || !!factura.fel_uuid_anulacion || refacturacion">\n                        Editar\n                    </button>\n                </td>\n            </ng-container>\n            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>\n            <tr mat-row *matRowDef="let row; columns: displayedColumns;">\n            </tr>\n        </table>\n    </mat-card-content>\n</mat-card>'},Ff2I:function(t,a,e){"use strict";e.r(a),a.default='<div class="row">\n    <div class="col m5 s12">\n        <app-lista-factura-manual #lstFacturaManual (getFacturaEv)="setFactura($event)"></app-lista-factura-manual>\n    </div>\n    <div class="col m7 s12">\n        <app-form-factura-manual #frmFacturaManual [factura]="factura" (facturaSavedEv)="refreshFacturaList()">\n        </app-form-factura-manual>\n    </div>\n</div>'},KFbY:function(t,a,e){"use strict";e.d(a,"a",(function(){return m}));var n=e("mrSG"),i=e("8Y7J"),r=e("IheW"),o=e("sKxO"),s=e("R5jZ"),c=e("FY0D"),l=e("un/a"),u=e("JIr8"),d=e("Qyje");let m=class{constructor(t,a){this.http=t,this.ls=a,this.moduleUrl="factura",this.usrToken=null,this.srvcErrHndl=new s.a,this.usrToken=this.ls.get(o.a.usrTokenVar)?this.ls.get(o.a.usrTokenVar).token:null}facturar(t){const a={headers:new r.c({Authorization:this.usrToken})};return this.http.post(`${o.a.urlAppRestaurante}/${this.moduleUrl}/guardar`,t,a).pipe(Object(l.a)(o.a.reintentos),Object(u.a)(this.srvcErrHndl.errorHandler))}get(t={}){const a={headers:new r.c({Authorization:this.usrToken})};return this.http.get(`${o.a.urlFacturacion}/${this.moduleUrl}/buscar_factura?${d.stringify(t)}`,a).pipe(Object(l.a)(o.a.reintentos),Object(u.a)(this.srvcErrHndl.errorHandler))}imprimir(t){const a={headers:new r.c({Authorization:this.usrToken})};return this.http.get(`${o.a.urlFacturacion}/${this.moduleUrl}/imprimir/${t}`,a).pipe(Object(l.a)(o.a.reintentos),Object(u.a)(this.srvcErrHndl.errorHandler))}save(t){const a={headers:new r.c({Authorization:this.usrToken})};return this.http.post(`${o.a.urlFacturacion}/${this.moduleUrl}/guardar${t.factura?"/"+t.factura:""}`,t,a).pipe(Object(l.a)(o.a.reintentos),Object(u.a)(this.srvcErrHndl.errorHandler))}refacturar(t){const a={headers:new r.c({Authorization:this.usrToken})};return this.http.post(`${o.a.urlFacturacion}/${this.moduleUrl}/refacturar${t.factura?"/"+t.factura:""}`,t,a).pipe(Object(l.a)(o.a.reintentos),Object(u.a)(this.srvcErrHndl.errorHandler))}firmar(t){const a={headers:new r.c({Authorization:this.usrToken})};return this.http.post(`${o.a.urlFacturacion}/${this.moduleUrl}/facturar/${t}`,{},a).pipe(Object(l.a)(o.a.reintentos),Object(u.a)(this.srvcErrHndl.errorHandler))}anular(t){const a={headers:new r.c({Authorization:this.usrToken})};return this.http.post(`${o.a.urlFacturacion}/${this.moduleUrl}/anular/${t}`,{},a).pipe(Object(l.a)(o.a.reintentos),Object(u.a)(this.srvcErrHndl.errorHandler))}getDetalle(t,a={}){const e={headers:new r.c({Authorization:this.usrToken})};return this.http.get(`${o.a.urlFacturacion}/${this.moduleUrl}/buscar_detalle/${t}?${d.stringify(a)}`,e).pipe(Object(l.a)(o.a.reintentos),Object(u.a)(this.srvcErrHndl.errorHandler))}saveDetalle(t){const a={headers:new r.c({Authorization:this.usrToken})};return this.http.post(`${o.a.urlFacturacion}/${this.moduleUrl}/guardar_detalle/${t.factura}${t.detalle_factura?"/"+t.detalle_factura:""}`,t,a).pipe(Object(l.a)(o.a.reintentos),Object(u.a)(this.srvcErrHndl.errorHandler))}};m.ctorParameters=()=>[{type:r.a},{type:c.a}],m=n.b([Object(i.Injectable)({providedIn:"root"})],m)},KZK3:function(t,a,e){"use strict";e.d(a,"a",(function(){return m}));var n=e("mrSG"),i=e("8Y7J"),r=e("IheW"),o=e("sKxO"),s=e("R5jZ"),c=e("FY0D"),l=e("un/a"),u=e("JIr8"),d=e("Qyje");let m=class{constructor(t,a){this.http=t,this.ls=a,this.moduleUrl="catalogo",this.manteUrl="fpago",this.usrToken=null,this.srvcErrHndl=new s.a,this.usrToken=this.ls.get(o.a.usrTokenVar)?this.ls.get(o.a.usrTokenVar).token:null}get(t={}){const a={headers:new r.c({Authorization:this.usrToken})};return this.http.get(`${o.a.url}/${this.moduleUrl}/get_forma_pago?${d.stringify(t)}`,a).pipe(Object(l.a)(o.a.reintentos),Object(u.a)(this.srvcErrHndl.errorHandler))}buscar(t={}){const a={headers:new r.c({Authorization:this.usrToken})};return this.http.get(`${o.a.urlMantenimientos}/${this.manteUrl}/buscar?${d.stringify(t)}`,a).pipe(Object(l.a)(o.a.reintentos),Object(u.a)(this.srvcErrHndl.errorHandler))}save(t){const a={headers:new r.c({Authorization:this.usrToken})};return this.http.post(`${o.a.urlMantenimientos}/${this.manteUrl}/guardar${t.forma_pago?"/"+t.forma_pago:""}`,t,a).pipe(Object(l.a)(o.a.reintentos),Object(u.a)(this.srvcErrHndl.errorHandler))}};m.ctorParameters=()=>[{type:r.a},{type:c.a}],m=n.b([Object(i.Injectable)({providedIn:"root"})],m)},Ma74:function(t,a,e){"use strict";e.r(a),a.default=".full-width {\n    width: 100%;\n}\n\n.iconFontSize {\n    font-size: 24pt;\n}"},QbRZ:function(t,a,e){"use strict";e.r(a),a.default='<h1 mat-dialog-title>\n  Cobrar cuenta de {{data.cuenta}}\n  <small *ngIf="clienteSelected && !!clienteSelected.cliente">\n     - Factura a nombre de {{clienteSelected.nombre}}\n  </small>\n</h1>\n<div mat-dialog-content style="height: 650px;">\n  <div class="row">\n    <div class="col m5 s12 mat-elevation-z4 colHeight" style="overflow-y: auto;">\n      <app-lista-cliente #lstClientes (getClienteEv)="setClienteFacturar($event)" [showAddButton]="true"></app-lista-cliente>\n    </div>\n    <div class="col m3 s12 mat-elevation-z4 colHeight" style="overflow-y: auto;">\n      <table class="table table-sm table-borderless table-striped">\n        <tbody>\n          <tr *ngFor="let p of inputData.productosACobrar; let i = index;">\n            <td>{{p.cantidad}}&nbsp;{{p.nombre || p.articulo.descripcion}}</td>\n            <td class="text-right">{{(p.cantidad * p.precio) | number: \'1.2-2\'}}</td>\n          </tr>\n        </tbody>\n      </table>\n    </div>\n    <div class="col m4 s12 mat-elevation-z4 colHeight" style="overflow-y: auto;">\n      <form #frmFormasPago="ngForm" novalidate>\n        <mat-form-field class="fullWidth">\n          <mat-label>Forma de pago</mat-label>\n          <mat-select name="forma_pago" [(ngModel)]="formaPago.forma_pago" cdkFocusInitial (selectionChange)="onSelectionChangeFP($event)" required>\n            <mat-option *ngFor="let fp of lstFormasPago" [value]="fp.forma_pago">\n              {{fp.descripcion}}\n            </mat-option>\n          </mat-select>\n        </mat-form-field>\n        \x3c!--Inicia input de monto por forma de pago--\x3e\n        <mat-form-field class="fullWidth" *ngIf="esMovil">\n          <input matInput placeholder="monto" name="monto" [(ngModel)]="formaPago.monto" required>\n        </mat-form-field>\n        <mat-form-field class="fullWidth" *ngIf="!esMovil">\n          <input matInput ng-virtual-keyboard ng-virtual-keyboard-layout="numeric" ng-virtual-keyboard-placeholder="Monto" placeholder="monto" name="monto" [(ngModel)]="formaPago.monto" required>\n        </mat-form-field>\n        \x3c!--Fin de input de monto por forma de pago--\x3e\n        \x3c!--Inicia input de propina por forma de pago--\x3e\n        <mat-form-field class="fullWidth" *ngIf="esMovil">\n          <input matInput placeholder="Propina" name="propina" [(ngModel)]="formaPago.propina">\n        </mat-form-field>\n        <mat-form-field class="fullWidth" *ngIf="!esMovil">\n          <input matInput ng-virtual-keyboard ng-virtual-keyboard-layout="numeric" ng-virtual-keyboard-placeholder="Propina" placeholder="Propina" name="propina" [(ngModel)]="formaPago.propina">\n        </mat-form-field>\n        \x3c!--Fin de input de propina por forma de pago--\x3e\n        \x3c!-- Inicia input de documento --\x3e\n        <mat-form-field class="fullWidth" *ngIf="esMovil && pideDocumento">\n          <input matInput placeholder="Documento" name="documento" [(ngModel)]="formaPago.documento" [required]="pideDocumento">\n        </mat-form-field>\n        <mat-form-field class="fullWidth" *ngIf="!esMovil && pideDocumento">\n          <input matInput ng-virtual-keyboard ng-virtual-keyboard-placeholder="Documento" placeholder="Documento" name="documento" [(ngModel)]="formaPago.documento" [required]="pideDocumento">\n        </mat-form-field>\n        \x3c!-- Fin de input de documento --\x3e\n        <div align="end">\n          <button mat-raised-button type="button" color="accent" (click)="addFormaPago()" [disabled]="!frmFormasPago.form.valid || inputData.saldo <= 0">\n            Agregar\n          </button>\n        </div>\n      </form>\n      <hr />\n      <table class="table table-sm">\n        <thead>\n          <tr>\n            <th class="text-left">FP</th>\n            <th class="text-right">Mon</th>\n            <th class="text-right">Prop</th>\n          </tr>\n        </thead>\n        <tbody>\n          <tr *ngFor="let fpCta of formasPagoDeCuenta; let i = index">\n            <td>{{fpCta.forma_pago.descripcion}}</td>\n            <td class="text-right">{{fpCta.monto | number:\'1.2-2\'}}</td>\n            <td class="text-right">{{fpCta.propina | number:\'1.2-2\'}}</td>\n            <td class="text-center">\n              <button mat-icon-button type="button" color="warn" (click)="delFormaPago(i)">\n                <mat-icon>delete_forever</mat-icon>\n              </button>\n            </td>\n          </tr>\n        </tbody>\n      </table>\n    </div>\n  </div>\n  <div class="row">\n    <div class="col m12 s12 overflow-auto d-flex justify-content-end">\n      <table class="table table-sm table-borderless">\n        <tbody>\n          <tr>\n            <td class="text-right font-weight-bold">TOTAL DE CUENTA:</td>\n            <td class="text-right font-weight-bold totalCuenta" style="max-width: 15%;">{{inputData.totalDeCuenta | number:\'1.2-2\'}}</td>\n          </tr>\n          <tr>\n            <td class="text-right font-weight-bold">PENDIENTE:</td>\n            <td class="text-right font-weight-bold" style="max-width: 15%;">\n              <span\n                [ngClass]="{\'saldo-pendiente\': +inputData.saldo > 0, \'saldo-exacto\': +inputData.saldo == 0, \'saldo-extra\': +inputData.saldo < 0 }">{{inputData.saldo | number:\'1.2-2\'}}</span>\n            </td>\n          </tr>\n        </tbody>\n      </table>\n    </div>\n  </div>  \n</div>\n<div mat-dialog-actions align="end">\n  <app-cargando *ngIf="facturando" [configuracion]="cargandoConf"></app-cargando>\n  <button mat-raised-button color="accent" (click)="cancelar()" [disabled]="facturando">Cancelar</button>\n  <button mat-raised-button color="accent" (click)="cobrar()" [disabled]="formasPagoDeCuenta.length == 0 || +inputData.saldo > 0 || !factReq.cliente || facturando">Facturar</button>  \n</div>'},"V+uF":function(t,a,e){"use strict";e.r(a),a.default=".fullWidth {\n    width: 100% !important;\n}\n\ntable {\n    width: 100% !important;\n}"},VHZL:function(t,a,e){"use strict";e.r(a),a.default=".fullWidth {\n    width: 100% !important;\n}\n\ntable {\n    width: 100% !important;\n}"},VLua:function(t,a,e){"use strict";e.r(a),a.default='<mat-card class="mat-elevation-z4 fullWidth">\n    <mat-card-content>\n        <mat-form-field class="fullWidth">\n            <input matInput (keyup)="applyFilter()" placeholder="Buscar..." [(ngModel)]="txtFiltro" [ngModelOptions]="{standalone: true}">\n        </mat-form-field>\n        <mat-nav-list>\n            <mat-list-item *ngFor="let element of lstFormasPagoPaged" (click)="getFormaPago(element)">\n                <mat-icon mat-list-icon>account_balance_wallet</mat-icon>\n                <h5 mat-line>{{element.descripcion}}</h5>\n            </mat-list-item>            \n        </mat-nav-list>\n        <mat-paginator [length]="length" [pageSize]="pageSize" [pageSizeOptions]="pageSizeOptions" (page)="pageChange($event)" showFirstLastButtons>\n        </mat-paginator>\n    </mat-card-content>\n</mat-card>\n'},XaST:function(t,a,e){"use strict";e.r(a),a.default=""},aIz7:function(t,a,e){"use strict";e.r(a),a.default=".full-width {\n    width: 100%;\n}\n\n.iconFontSize {\n    font-size: 24pt;\n}"},fn6i:function(t,a,e){"use strict";var n=e("mrSG"),i=e("8Y7J"),r=e("s6ns"),o=e("dFDH"),s=e("sKxO"),c=e("FY0D"),l=e("wd/R"),u=e("IJgu"),d=e("mTQG"),m=e("RH9n"),f=e("KZK3"),p=e("IheW"),h=e("R5jZ"),g=e("un/a"),b=e("JIr8");let F=class{constructor(t,a){this.http=t,this.ls=a,this.moduleUrl="cuenta",this.usrToken=null,this.srvcErrHndl=new h.a,this.usrToken=this.ls.get(s.a.usrTokenVar)?this.ls.get(s.a.usrTokenVar).token:null}save(t){const a={headers:new p.c({Authorization:this.usrToken})};return this.http.post(`${s.a.urlAppRestaurante}/${this.moduleUrl}/cobrar/${t.cuenta}`,t,a).pipe(Object(g.a)(s.a.reintentos),Object(b.a)(this.srvcErrHndl.errorHandler))}};F.ctorParameters=()=>[{type:p.a},{type:c.a}],F=n.b([Object(i.Injectable)({providedIn:"root"})],F);var v=e("KFbY");e.d(a,"a",(function(){return _}));let _=class{constructor(t,a,e,n,i,r,o,c,m){this.dialog=t,this.dialogRef=a,this.data=e,this.snackBar=n,this.formaPagoSrvc=i,this.cobroSrvc=r,this.facturaSrvc=o,this.ls=c,this.socket=m,this.inputData={},this.lstFormasPago=[],this.formaPago={},this.formasPagoDeCuenta=[],this.esMovil=!1,this.facturando=!1,this.cargandoConf={w:75,h:75},this.pideDocumento=!1,this.resetFactReq=()=>{this.factReq={cuentas:[],factura_serie:1,cliente:null,fecha_factura:l().format(s.a.dbDateFormat),moneda:1}},this.processData=()=>{this.data?this.inputData=this.data:this.data=this.inputData,this.inputData.totalDeCuenta=0,this.inputData.productosACobrar.forEach(t=>{this.inputData.totalDeCuenta+=t.precio*t.cantidad}),this.calculaPropina(),this.actualizaSaldo(),this.formaPago.monto=parseFloat(this.inputData.saldo).toFixed(2)},this.calculaPropina=()=>{this.inputData.montoPropina=parseFloat((this.inputData.porcentajePropina*this.inputData.totalDeCuenta/100).toFixed(2)),this.actualizaSaldo()},this.loadFormasPago=()=>{this.formaPagoSrvc.get({activo:1}).subscribe(t=>{t&&t.length>0&&(this.lstFormasPago=t)})},this.addFormaPago=()=>{const t=this.lstFormasPago.filter(t=>+t.forma_pago==+this.formaPago.forma_pago)[0];if(1==+t.pedirautorizacion){this.dialog.open(d.a,{width:"40%",disableClose:!0,data:new d.b(1)}).afterClosed().subscribe(a=>{a?this.agregaFormaPago(t):this.snackBar.open("La contrase\xf1a no es correcta","Formas de pago",{duration:5e3})})}else this.agregaFormaPago(t)},this.agregaFormaPago=t=>{this.formasPagoDeCuenta.push({forma_pago:t,monto:parseFloat(this.formaPago.monto).toFixed(2),propina:this.formaPago.propina||0,documento:this.formaPago.documento||null}),this.actualizaSaldo(),this.pideDocumento=!1},this.delFormaPago=t=>{this.formasPagoDeCuenta.splice(t,1),this.actualizaSaldo()},this.actualizaSaldo=()=>{let t=0;this.formasPagoDeCuenta.forEach(a=>t+=+a.monto),this.inputData.saldo=(+this.inputData.totalDeCuenta-t).toFixed(2),this.formaPago={monto:this.inputData.saldo}},this.cancelar=()=>this.dialogRef.close(),this.setClienteFacturar=t=>{this.clienteSelected=t,this.factReq.cliente=+t.cliente},this.cobrar=()=>{this.facturando=!0;const t={cuenta:this.inputData.idcuenta,forma_pago:[],total:this.inputData.totalDeCuenta+this.inputData.montoPropina,propina_monto:this.inputData.montoPropina,propina_porcentaje:this.inputData.porcentajePropina};for(const a of this.formasPagoDeCuenta)t.forma_pago.push({forma_pago:+a.forma_pago.forma_pago,monto:a.monto,propina:a.propina||0,documento:a.documento});this.factReq.cuentas.push({cuenta:+this.inputData.idcuenta}),this.cobroSrvc.save(t).subscribe(t=>{t.exito&&!t.facturada?(this.snackBar.open("Cobro",`${t.mensaje}`,{duration:3e3}),this.facturaSrvc.facturar(this.factReq).subscribe(a=>{if(a.exito){this.dialog.open(u.a,{maxWidth:"400px",data:new u.b("Imprimir factura","\xbfDesea imprimir la factura?","S\xed","No")}).afterClosed().subscribe(e=>{e&&this.printFactura(a.factura),this.resetFactReq(),this.snackBar.open("Factura",`${a.mensaje}`,{duration:3e3}),this.facturando=!1,this.dialogRef.close(t.cuenta),this.socket.emit("refrescar:mesa",{mesaenuso:this.data.mesaenuso})})}else this.facturando=!1,this.snackBar.open("Factura",`ERROR: ${t.mensaje}`,{duration:7e3}),this.dialogRef.close(t.cuenta)})):(this.facturando=!1,this.snackBar.open("Cobro",`ERROR: ${t.mensaje}`,{duration:7e3}),this.dialogRef.close("closePanel"))})},this.procesaDetalleFactura=t=>{const a=[];return t.forEach(t=>a.push({Cantidad:+t.cantidad,Descripcion:t.articulo.descripcion,Total:+t.total})),a},this.getTotalDetalle=t=>{let a=0;return t.forEach(t=>a+=+t.total),a},this.printFactura=t=>{this.facturaSrvc.imprimir(+t.factura).subscribe(t=>{if(t.factura){const a={NombreEmpresa:t.factura.empresa.nombre,NitEmpresa:t.factura.empresa.nit,SedeEmpresa:t.factura.sedeFactura.nombre,DireccionEmpresa:t.factura.empresa.direccion,Fecha:l(t.factura.fecha_factura).format(s.a.dateFormat),Nit:t.factura.receptor.nit,Nombre:t.factura.receptor.nombre,Direccion:t.factura.receptor.direccion,Serie:t.factura.serie_factura,Numero:t.factura.numero_factura,Total:this.getTotalDetalle(t.factura.detalle),NoAutorizacion:t.factura.fel_uuid,NombreCertificador:t.factura.certificador_fel.nombre,NitCertificador:t.factura.certificador_fel.nit,FechaDeAutorizacion:t.factura.fecha_autorizacion,NoOrdenEnLinea:"",FormaDePago:"",DetalleFactura:this.procesaDetalleFactura(t.factura.detalle),Impresora:this.data.impresora};this.data.impresora?0==+this.data.impresora.bluetooth?this.socket.emit("print:factura",`${JSON.stringify(a)}`):this.printToBT(JSON.stringify(a)):this.socket.emit("print:factura",`${JSON.stringify(a)}`),this.snackBar.open(`Imprimiendo factura ${t.factura.serie_factura}-${t.factura.numero_factura}`,"Impresi\xf3n",{duration:3e3})}else this.snackBar.open(`ERROR: ${t.mensaje}`,"Impresi\xf3n",{duration:7e3})})},this.printToBT=(t="")=>{const a=`com.restouch.impresion://impresion/${t}`,e=window.open(a,"PrntBT","height=200,width=200,menubar=no,location=no,resizable=no,scrollbars=no,status=no");setTimeout(()=>e.close(),1e3)},this.onSelectionChangeFP=t=>{const a=this.lstFormasPago.findIndex(a=>+a.forma_pago==+t.value);a>-1&&(this.pideDocumento=1==+this.lstFormasPago[a].pedirdocumento)}}ngOnInit(){this.esMovil=this.ls.get(s.a.usrTokenVar).enmovil||!1,this.processData(),this.loadFormasPago(),this.resetFactReq(),this.ls.get(s.a.usrTokenVar).sede_uuid&&this.socket.emit("joinRestaurant",this.ls.get(s.a.usrTokenVar).sede_uuid)}calculaPorcentajePropina(){this.inputData.porcentajePropina=parseFloat((100*this.inputData.montoPropina/this.inputData.totalDeCuenta).toFixed(2)),this.actualizaSaldo()}};_.ctorParameters=()=>[{type:r.b},{type:r.d},{type:void 0,decorators:[{type:i.Inject,args:[r.a]}]},{type:o.a},{type:f.a},{type:F},{type:v.a},{type:c.a},{type:m.a}],n.b([Object(i.Input)()],_.prototype,"inputData",void 0),_=n.b([Object(i.Component)({selector:"app-cobrar-pedido",template:n.c(e("QbRZ")).default,styles:[n.c(e("id0f")).default]}),n.d(2,Object(i.Inject)(r.a))],_)},fraS:function(t,a,e){"use strict";e.r(a),a.default='<div class="row">\n    <div class="col m5 s12">\n        <app-lista-forma-pago #lstFormaPago (getFormaPagoEv)="setFormaPago($event)"></app-lista-forma-pago>\n    </div>\n    <div class="col m7 s12">\n        <app-form-forma-pago #frmIngreso [formaPago]="formaPago" (formaPagoSavedEv)="refreshFormaPagoList()">\n        </app-form-forma-pago>\n    </div>\n</div>'},id0f:function(t,a,e){"use strict";e.r(a),a.default=".spacer {\n    flex: 1 1 auto;\n}\n\n.totalCuenta {\n    border-top: solid 1px black;\n    border-bottom: double 5px black;\n}\n\n.colHeight {\n    height: 400px;\n}\n\n.saldo-pendiente {\n    color: #DA332D;\n    border-bottom: double 5px #DA332D;\n}\n\n.saldo-extra {\n    color: skyblue;\n    border-bottom: double 5px skyblue;\n}\n\n.saldo-exacto {\n    color: green;\n    border-bottom: double 5px green;\n}\n\n.propina {\n    font-style: italic;\n}"},naO8:function(t,a,e){"use strict";e.r(a),a.default='<mat-card class="mat-elevation-z4 fullWidth">\n    <mat-card-content>\n        <mat-form-field class="fullWidth" *ngIf="esMovil">\n            <input matInput (keyup)="applyFilter()" (change)="applyFilter($event.target.value)" placeholder="Buscar..." [(ngModel)]="txtFiltro" [ngModelOptions]="{standalone: true}">\n        </mat-form-field>\n        <mat-form-field class="fullWidth" *ngIf="!esMovil">\n            <input matInput ng-virtual-keyboard ng-virtual-keyboard-layout="alphanumeric" ng-virtual-keyboard-placeholder="Buscar..." (keyup)="applyFilter()" placeholder="Buscar..." [(ngModel)]="txtFiltro" [ngModelOptions]="{standalone: true}">\n        </mat-form-field>\n        <mat-nav-list>\n            <mat-list-item *ngFor="let element of lstFacturasPaged" (click)="getFactura(element)">\n                <mat-icon mat-list-icon>receipt</mat-icon>\n                <h5 mat-line>{{element.serie_factura}}&nbsp;{{element.numero_factura}}</h5>\n                <span mat-line>Fecha: {{element.fecha_factura | date:\'dd/MM/yyyy\'}}</span>\n                <span mat-line>Cliente: {{element.cliente.nombre}}</span>\n                <span mat-line>NIT: {{element.cliente.nit}}</span>\n            </mat-list-item>\n        </mat-nav-list>\n        <mat-paginator [length]="length" [pageSize]="pageSize" [pageSizeOptions]="pageSizeOptions" (page)="pageChange($event)" showFirstLastButtons>\n        </mat-paginator>        \n        \x3c!--\n        <table mat-table [dataSource]="dataSource">\n            <ng-container matColumnDef="factura">                \n                <td mat-cell *matCellDef="let element" (click)="getFactura(element)">\n                    <mat-list>\n                        <mat-list-item>\n                            <mat-icon mat-list-icon>receipt</mat-icon>\n                            <h5 mat-line>{{element.serie_factura}}&nbsp;{{element.numero_factura}}</h5>\n                            <span mat-line>Fecha: {{element.fecha_factura | date:\'dd/MM/yyyy\'}}</span>\n                            <span mat-line>Cliente: {{element.cliente.nombre}}</span>\n                            <span mat-line>NIT: {{element.cliente.nit}}</span>\n                            <button mat-icon-button type="button" color="accent">\n                                <mat-icon>arrow_right_alt</mat-icon>\n                            </button>\n                        </mat-list-item>\n                    </mat-list>\n                </td>\n            </ng-container>            \n            <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>\n        </table>\n        <mat-paginator [pageSizeOptions]="[5, 10, 20]" showFirstLastButtons></mat-paginator>\n        --\x3e\n    </mat-card-content>\n</mat-card>\n'},qodq:function(t,a,e){"use strict";e.r(a);var n=e("mrSG"),i=e("8Y7J"),r=e("SVse"),o=e("IheW"),s=e("s7LF"),c=e("PCNd"),l=e("jkDv"),u=e("Q+lL"),d=e("Gi4r"),m=e("HsOI"),f=e("ZwOa"),p=e("igqZ"),h=e("02hT"),g=e("rWV4"),b=e("8rEH"),F=e("JjoW"),v=e("r0V8"),_=e("Fwaw"),y=e("dFDH"),D=e("BzsH"),k=e("gavF"),x=e("FVPZ"),P=e("OIZN"),C=e("s6ns"),S=e("BV1i"),I=e("Y8tL"),w=e("9qht"),O=e("drcI"),E=e("iInd"),j=e("0T/Q");let M=class{constructor(){this.setFormaPago=t=>this.formaPago=t,this.refreshFormaPagoList=()=>this.lstFormaPagoComponent.loadFormasPago(),this.formaPago={forma_pago:null,descripcion:null,activo:1}}ngOnInit(){}};n.b([Object(i.ViewChild)("lstFormaPago",{static:!1})],M.prototype,"lstFormaPagoComponent",void 0),M=n.b([Object(i.Component)({selector:"app-forma-pago",template:n.c(e("fraS")).default,styles:[n.c(e("XaST")).default]})],M);var z=e("sKxO"),T=e("wd/R");let $=class{constructor(){this.setFactura=t=>{this.factura={factura:t.factura,factura_serie:t.factura_serie.factura_serie,cliente:t.cliente.cliente,fecha_factura:t.fecha_factura,moneda:t.moneda.moneda,exenta:t.exenta,notas:t.notas,usuario:t.usuario.usuario,numero_factura:t.numero_factura,serie_factura:t.serie_factura,fel_uuid:t.fel_uuid,fel_uuid_anulacion:t.fel_uuid_anulacion,certificador_fel:t.certificador_fel},this.frmFactura.loadDetalleFactura(+this.factura.factura),this.frmFactura.resetDetalleFactura()},this.refreshFacturaList=()=>this.lstFacturaComponent.loadFacturas(),this.factura={factura:null,factura_serie:null,cliente:null,fecha_factura:T().format(z.a.dbDateFormat),moneda:null,exenta:0,notas:null}}ngOnInit(){}};n.b([Object(i.ViewChild)("lstFacturaManual",{static:!1})],$.prototype,"lstFacturaComponent",void 0),n.b([Object(i.ViewChild)("frmFacturaManual",{static:!1})],$.prototype,"frmFactura",void 0),$=n.b([Object(i.Component)({selector:"app-factura-manual",template:n.c(e("Ff2I")).default,styles:[n.c(e("rgcp")).default]})],$);const A=[{path:"fpago",component:M,canActivate:[j.a]},{path:"factman",component:$,canActivate:[j.a]},{path:"**",redirectTo:"/admin/dashboard",pathMatch:"full"}];let H=class{};H=n.b([Object(i.NgModule)({imports:[E.b.forChild(A)],exports:[E.b]})],H);var R=e("fn6i"),N=e("KZK3");let V=class{constructor(t){this.formaPagoSrvc=t,this.getFormaPagoEv=new i.EventEmitter,this.length=0,this.pageSize=5,this.pageSizeOptions=[5,10,15],this.pageIndex=0,this.txtFiltro="",this.loadFormasPago=()=>{this.formaPagoSrvc.buscar().subscribe(t=>{t&&t.length>0&&(this.lstFormasPago=t,this.applyFilter())})},this.getFormaPago=t=>{this.getFormaPagoEv.emit(t)},this.pageChange=t=>{this.pageSize=t.pageSize,this.pageIndex=t.pageIndex,this.applyFilter()}}ngOnInit(){this.loadFormasPago()}applyFilter(){if(this.txtFiltro.length>0){const t=Object(z.b)(this.lstFormasPago,this.txtFiltro);this.length=t.length,this.lstFormasPagoPaged=Object(z.c)(t,this.pageSize,this.pageIndex+1)}else this.length=this.lstFormasPago.length,this.lstFormasPagoPaged=Object(z.c)(this.lstFormasPago,this.pageSize,this.pageIndex+1)}};V.ctorParameters=()=>[{type:N.a}],n.b([Object(i.Output)()],V.prototype,"getFormaPagoEv",void 0),V=n.b([Object(i.Component)({selector:"app-lista-forma-pago",template:n.c(e("VLua")).default,styles:[n.c(e("VHZL")).default]})],V);var W=e("FY0D");let B=class{constructor(t,a,e){this._snackBar=t,this.formaPagoSrvc=a,this.ls=e,this.formaPagoSavedEv=new i.EventEmitter,this.esMovil=!1,this.resetFormaPago=()=>this.formaPago={forma_pago:null,descripcion:null,activo:1},this.onSubmit=()=>{this.formaPagoSrvc.save(this.formaPago).subscribe(t=>{t.exito&&(this.formaPagoSavedEv.emit(),this.resetFormaPago(),this._snackBar.open("Forma de pago agregada...","Forma de pago",{duration:3e3}))})}}ngOnInit(){this.esMovil=this.ls.get(z.a.usrTokenVar).enmovil||!1}};B.ctorParameters=()=>[{type:y.a},{type:N.a},{type:W.a}],n.b([Object(i.Input)()],B.prototype,"formaPago",void 0),n.b([Object(i.Output)()],B.prototype,"formaPagoSavedEv",void 0),B=n.b([Object(i.Component)({selector:"app-form-forma-pago",template:n.c(e("Dm0Z")).default,styles:[n.c(e("Ma74")).default]})],B);var U=e("KFbY");let q=class{constructor(t,a){this.facturaSrvc=t,this.ls=a,this.esMovil=!1,this.getFacturaEv=new i.EventEmitter,this.length=0,this.pageSize=5,this.pageSizeOptions=[5,10,15],this.pageIndex=0,this.txtFiltro="",this.loadFacturas=()=>{this.facturaSrvc.get().subscribe(t=>{t&&t.length>0&&(this.lstFacturas=t,this.applyFilter())})},this.getFactura=t=>{this.getFacturaEv.emit(t)},this.pageChange=t=>{this.pageSize=t.pageSize,this.pageIndex=t.pageIndex,this.applyFilter()}}ngOnInit(){this.esMovil=this.ls.get(z.a.usrTokenVar).enmovil||!1,this.loadFacturas()}applyFilter(){if(this.txtFiltro.length>0){const t=Object(z.b)(this.lstFacturas,this.txtFiltro);this.length=t.length,this.lstFacturasPaged=Object(z.c)(t,this.pageSize,this.pageIndex+1)}else this.length=this.lstFacturas.length,this.lstFacturasPaged=Object(z.c)(this.lstFacturas,this.pageSize,this.pageIndex+1)}};q.ctorParameters=()=>[{type:U.a},{type:W.a}],n.b([Object(i.Output)()],q.prototype,"getFacturaEv",void 0),q=n.b([Object(i.Component)({selector:"app-lista-factura-manual",template:n.c(e("naO8")).default,styles:[n.c(e("V+uF")).default]})],q);var L=e("IJgu"),J=e("RH9n"),Z=e("R5jZ"),Y=e("un/a"),K=e("JIr8"),G=e("Qyje");let Q=class{constructor(t,a){this.http=t,this.ls=a,this.usrToken=null,this.srvcErrHndl=new Z.a,this.usrToken=this.ls.get(z.a.usrTokenVar)?this.ls.get(z.a.usrTokenVar).token:null}get(t={}){const a={headers:new o.c({Authorization:this.usrToken})};return this.http.get(`${z.a.urlCatalogos}/get_factura_serie?${G.stringify(t)}`,a).pipe(Object(Y.a)(z.a.reintentos),Object(K.a)(this.srvcErrHndl.errorHandler))}};Q.ctorParameters=()=>[{type:o.a},{type:W.a}],Q=n.b([Object(i.Injectable)({providedIn:"root"})],Q);var X=e("M8s9");let tt=class{constructor(t,a){this.http=t,this.ls=a,this.usrToken=null,this.srvcErrHndl=new Z.a,this.usrToken=this.ls.get(z.a.usrTokenVar)?this.ls.get(z.a.usrTokenVar).token:null}get(t={}){const a={headers:new o.c({Authorization:this.usrToken})};return this.http.get(`${z.a.urlCatalogos}/get_moneda?${G.stringify(t)}`,a).pipe(Object(Y.a)(z.a.reintentos),Object(K.a)(this.srvcErrHndl.errorHandler))}};tt.ctorParameters=()=>[{type:o.a},{type:W.a}],tt=n.b([Object(i.Injectable)({providedIn:"root"})],tt);var at=e("NGYs");let et=class{constructor(t,a,e,n,r,o,s,c,l){this._snackBar=t,this.dialog=a,this.facturaSrvc=e,this.facturaSerieSrvc=n,this.clienteSrvc=r,this.monedaSrvc=o,this.articuloSrvc=s,this.socket=c,this.ls=l,this.facturaSavedEv=new i.EventEmitter,this.showForm=!0,this.showFormDetalle=!0,this.facturaSeries=[],this.clientes=[],this.monedas=[],this.detallesFactura=[],this.articulos=[],this.displayedColumns=["articulo","cantidad","precio_unitario","total","editItem"],this.esMovil=!1,this.refacturacion=!1,this.loadFacturaSeries=()=>{this.facturaSerieSrvc.get().subscribe(t=>{t&&(this.facturaSeries=t)})},this.loadClientes=()=>{this.clienteSrvc.get().subscribe(t=>{t&&(this.clientes=t)})},this.loadMonedas=()=>{this.monedaSrvc.get().subscribe(t=>{t&&(this.monedas=t)})},this.refacturar=()=>{this.factura={factura:this.factura.factura,factura_serie:null,cliente:null,fecha_factura:T().format(z.a.dbDateFormat),moneda:null,exenta:0,notas:null,fel_uuid:null,fel_uuid_anulacion:null},this.refacturacion=!0},this.resetFactura=()=>{this.factura={factura:null,factura_serie:null,cliente:null,fecha_factura:T().format(z.a.dbDateFormat),moneda:null,exenta:0,notas:null,fel_uuid:null,fel_uuid_anulacion:null},this.resetDetalleFactura(),this.detallesFactura=[]},this.onSubmit=()=>{this.refacturacion?this.facturaSrvc.refacturar(this.factura).subscribe(t=>{t.exito&&(this.facturaSavedEv.emit(),this.resetFactura(),this.refacturacion=!1,this.factura={factura:t.factura.factura,factura_serie:t.factura.factura_serie,cliente:t.factura.cliente,fecha_factura:t.factura.fecha_factura,moneda:t.factura.moneda,exenta:+t.factura.exenta,notas:t.factura.notas,fel_uuid:t.factura.fel_uuid},this._snackBar.open("Factura manual agregada...","Factura",{duration:3e3}))}):this.facturaSrvc.save(this.factura).subscribe(t=>{t.exito&&(this.facturaSavedEv.emit(),this.resetFactura(),this.factura={factura:t.factura.factura,factura_serie:t.factura.factura_serie,cliente:t.factura.cliente,fecha_factura:t.factura.fecha_factura,moneda:t.factura.moneda,exenta:+t.factura.exenta,notas:t.factura.notas,fel_uuid:t.factura.fel_uuid},this._snackBar.open("Factura manual agregada...","Factura",{duration:3e3}))})},this.firmarFactura=()=>{this.dialog.open(L.a,{maxWidth:"400px",data:new L.b("Firmar factura","Luego de firmar la factura no podr\xe1 hacer ninguna modificaci\xf3n. \xbfDesea continuar?","S\xed","No")}).afterClosed().subscribe(t=>{t&&this.facturaSrvc.firmar(+this.factura.factura).subscribe(t=>{t.exito?(this.factura.numero_factura=t.factura.numero_factura,this.factura.serie_factura=t.factura.serie_factura,this.factura.certificador_fel=t.factura.certificador_fel,this.factura.fel_uuid=t.factura.fel_uuid,this.facturaSavedEv.emit(),this._snackBar.open("Factura firmada con \xe9xito...","Firmar",{duration:3e3})):this._snackBar.open(`ERROR: ${t.mensaje}`,"Firmar",{duration:3e3})})})},this.procesaDetalleFactura=t=>{const a=[];return t.forEach(t=>a.push({Cantidad:+t.cantidad,Descripcion:t.articulo.descripcion,Total:+t.total})),a},this.getTotalDetalle=t=>{let a=0;return t.forEach(t=>a+=+t.total),a},this.imprimirFactura=()=>{this.facturaSrvc.imprimir(+this.factura.factura).subscribe(t=>{t.factura?(this.socket.emit("print:factura",`${JSON.stringify({NombreEmpresa:t.factura.empresa.nombre,NitEmpresa:t.factura.empresa.nit,SedeEmpresa:t.factura.sedeFactura.nombre,DireccionEmpresa:t.factura.empresa.direccion,Fecha:T(t.factura.fecha_factura).format(z.a.dateFormat),Nit:t.factura.receptor.nit,Nombre:t.factura.receptor.nombre,Direccion:t.factura.receptor.direccion,Serie:t.factura.serie_factura,Numero:t.factura.numero_factura,Total:this.getTotalDetalle(t.factura.detalle),NoAutorizacion:t.factura.fel_uuid,NombreCertificador:t.factura.certificador_fel.nombre,NitCertificador:t.factura.certificador_fel.nit,FechaDeAutorizacion:t.factura.fecha_autorizacion,NoOrdenEnLinea:"",FormaDePago:"",DetalleFactura:this.procesaDetalleFactura(t.factura.detalle)})}`),this._snackBar.open(`Imprimiendo factura ${this.factura.serie_factura}-${this.factura.numero_factura}`,"Impresi\xf3n",{duration:3e3})):this._snackBar.open(`ERROR: ${t.mensaje}`,"Impresi\xf3n",{duration:3e3})})},this.anularFactura=()=>{this.dialog.open(L.a,{maxWidth:"400px",data:new L.b("Anular factura","Luego de anular la factura no podr\xe1 hacer ninguna modificaci\xf3n. \xbfDesea continuar?","S\xed","No")}).afterClosed().subscribe(t=>{t&&this.facturaSrvc.anular(+this.factura.factura).subscribe(t=>{t.exito?(this.factura.fel_uuid_anulacion=t.factura.fel_uuid_anulacion,this.facturaSavedEv.emit(),this._snackBar.open("Factura anulada con \xe9xito...","Firmar",{duration:3e3})):this._snackBar.open(`ERROR: ${t.mensaje}`,"Firmar",{duration:1e4})})})},this.loadArticulos=()=>{this.articuloSrvc.getArticulos().subscribe(t=>{t&&(this.articulos=t)})},this.setPrecioUnitario=t=>{const a=this.articulos.findIndex(a=>+a.articulo==+t.value);a>-1&&(this.detalleFactura.precio_unitario=+this.articulos[a].precio,this.detalleFactura.total=+this.detalleFactura.precio_unitario*+this.detalleFactura.cantidad)},this.resetDetalleFactura=()=>this.detalleFactura={detalle_factura:null,factura:this.factura.factura||0,articulo:null,cantidad:1,precio_unitario:null,total:null},this.loadDetalleFactura=(t=+this.factura.factura)=>{this.facturaSrvc.getDetalle(t,{factura:t}).subscribe(t=>{t&&(this.detallesFactura=t,this.updateTableDataSource())})},this.getDetalleFactura=(t=+this.factura.factura,a)=>{this.facturaSrvc.getDetalle(t,{detalle_factura:a}).subscribe(t=>{t&&(this.detalleFactura={detalle_factura:t[0].detalle_factura,factura:t[0].factura,articulo:t[0].articulo.articulo,cantidad:+t[0].cantidad,precio_unitario:+t[0].precio_unitario,total:+t[0].total},this.showFormDetalle=!0)})},this.onSubmitDetail=()=>{this.detalleFactura.factura=this.factura.factura,this.detalleFactura.total=+this.detalleFactura.precio_unitario*+this.detalleFactura.cantidad,this.facturaSrvc.saveDetalle(this.detalleFactura).subscribe(t=>{t&&(this.loadDetalleFactura(),this.resetDetalleFactura())})},this.updateTableDataSource=()=>this.dataSource=new b.a(this.detallesFactura),this.representacionGrafica=()=>{window.open(`${z.a.infilePdfUrl}${this.factura.fel_uuid}`,"winFactPdf","height=700,width=800,menubar=no,location=no,resizable=no,scrollbars=no,status=no")}}ngOnInit(){this.esMovil=this.ls.get(z.a.usrTokenVar).enmovil||!1,this.refacturacion=!1,this.resetFactura(),this.loadFacturaSeries(),this.loadClientes(),this.loadMonedas(),this.loadArticulos(),this.ls.get(z.a.usrTokenVar).sede_uuid&&this.socket.emit("joinRestaurant",this.ls.get(z.a.usrTokenVar).sede_uuid)}};et.ctorParameters=()=>[{type:y.a},{type:C.b},{type:U.a},{type:Q},{type:X.a},{type:tt},{type:at.a},{type:J.a},{type:W.a}],n.b([Object(i.Input)()],et.prototype,"factura",void 0),n.b([Object(i.Output)()],et.prototype,"facturaSavedEv",void 0),et=n.b([Object(i.Component)({selector:"app-form-factura-manual",template:n.c(e("ElJa")).default,styles:[n.c(e("aIz7")).default]})],et),e.d(a,"PosModule",(function(){return nt}));let nt=class{};nt=n.b([Object(i.NgModule)({declarations:[R.a,M,V,B,$,q,et],entryComponents:[R.a],imports:[r.CommonModule,H,o.b,s.FormsModule,c.a,l.AdminModule,u.a,d.a,m.c,f.b,p.a,h.a,g.a,b.b,F.a,v.a,_.b,y.b,D.a,k.a,x.a,P.b,C.c,I.a,S.a,w.a,O.NgVirtualKeyboardModule],exports:[R.a]})],nt)},rgcp:function(t,a,e){"use strict";e.r(a),a.default=""}}]);