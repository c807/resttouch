!function(){function t(e,a){return(t=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(e,a)}function e(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var o,i=n(t);if(e){var c=n(this).constructor;o=Reflect.construct(i,arguments,c)}else o=i.apply(this,arguments);return a(this,o)}}function a(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function n(t){return(n=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function o(t,e){var a;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(a=function(t,e){if(!t)return;if("string"==typeof t)return i(t,e);var a=Object.prototype.toString.call(t).slice(8,-1);"Object"===a&&t.constructor&&(a=t.constructor.name);if("Map"===a||"Set"===a)return Array.from(t);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return i(t,e)}(t))||e&&t&&"number"==typeof t.length){a&&(t=a);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,r=!0,s=!1;return{s:function(){a=t[Symbol.iterator]()},n:function(){var t=a.next();return r=t.done,t},e:function(t){s=!0,c=t},f:function(){try{r||null==a.return||a.return()}finally{if(s)throw c}}}}function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,n=new Array(e);a<e;a++)n[a]=t[a];return n}function c(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(t,e,a){return e&&r(t.prototype,e),a&&r(t,a),t}(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{k2MF:function(a,n,i){"use strict";i.r(n),i.d(n,"RestauranteModule",function(){return is});var r,l,u,d=i("ofXK"),b=i("tk/3"),m=i("3Pt+"),f=i("PCNd"),p=i("vtFA"),g=i("qodq"),h=i("Kr0P"),v=i("YUcS"),S=i("MutI"),C=i("NFeN"),T=i("kmnG"),k=i("qFsG"),y=i("Wp6s"),M=i("f0Cb"),F=i("wZkO"),x=i("+0xr"),O=i("d3UM"),D=i("bSwM"),E=i("bTqV"),P=i("dNgK"),_=i("/t3+"),I=i("STbY"),w=i("zkoq"),A=i("M9IT"),N=i("0IaG"),R=i("XhcP"),U=i("iadO"),j=i("FKr1"),B=i("5+WD"),H=i("TU8p"),L=i("A5z7"),q=i("2ChS"),$=i("uM5D"),z=i("JbvS"),G=i("XNiG"),W=i("Cfvw"),V=i("xgIS"),K=i("5+tZ"),J=i("lJxs"),Q=i("pLZG"),X=i("Kj3r"),Y=i("/uUt"),Z=i("1G5W"),tt=i("fXoL"),et=((l=function(){function t(e){c(this,t),this.elementRef=e,this.debounce=0,this.skipStart=0,this.onDelete=new tt.o,this.onDetected=new tt.o,this.destroy$=new G.a}return s(t,[{key:"ngAfterViewInit",value:function(){var t=this,e={};Object(W.a)(["keydown","keyup"]).pipe(Object(K.a)(function(e){return Object(V.a)(t.elementRef.nativeElement,e)}),Object(J.a)(function(t){switch(t.type){case"keydown":e[t.which]=t.timeStamp;break;case"keyup":Object.assign(t,{duration:(t.timeStamp-e[t.which])/1e3})}return t}),Object(Q.a)(function(e){return 8!==e.keyCode&&"Backspace"!==e.code&&8!==e.which||t.onDelete.emit({event:e,value:e.target.value,type:"delete"}),e.target.value.length>t.skipStart}),Object(X.a)(this.debounce),Object(Y.a)()).pipe(Object(Z.a)(this.destroy$)).subscribe(function(e){e.duration>.02?t.onDetected.emit({event:e,value:e.target.value,time:e.duration,type:"keyboard"}):e.duration<=.02&&t.onDetected.emit({event:e,value:e.target.value,time:e.duration,type:"scanner"})})}},{key:"ngOnDestroy",value:function(){this.destroy$.next(!0),this.destroy$.complete()}}]),t}()).\u0275fac=function(t){return new(t||l)(tt.Nb(tt.l))},l.\u0275dir=tt.Ib({type:l,selectors:[["","ngxBarCodePut",""]],inputs:{debounce:"debounce",skipStart:"skipStart"},outputs:{onDelete:"onDelete",onDetected:"onDetected"}}),l),at=((r=function t(){c(this,t)}).\u0275mod=tt.Lb({type:r}),r.\u0275inj=tt.Kb({factory:function(t){return new(t||r)}}),r),nt=i("tyNb"),ot=i("0T/Q"),it=i("sKxO"),ct=i("R5jZ"),rt=i("un/a"),st=i("JIr8"),lt=i("Qyje"),ut=((u=function(){function t(e){c(this,t),this.http=e,this.moduleUrl="area",this.srvcErrHndl=new ct.a}return s(t,[{key:"get",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.http.get("".concat(it.b.urlMantenimientos,"/").concat(this.moduleUrl,"/get_areas?").concat(lt.stringify(t))).pipe(Object(rt.a)(it.b.reintentos),Object(st.a)(this.srvcErrHndl.errorHandler))}},{key:"save",value:function(t){return this.http.post("".concat(it.b.urlMantenimientos,"/").concat(this.moduleUrl,"/guardar").concat(t.area?"/"+t.area:""),t).pipe(Object(rt.a)(it.b.reintentos),Object(st.a)(this.srvcErrHndl.errorHandler))}}]),t}()).\u0275fac=function(t){return new(t||u)(tt.Xb(b.b))},u.\u0275prov=tt.Jb({token:u,factory:u.\u0275fac,providedIn:"root"}),u),dt=i("FY0D");function bt(t,e){if(1&t){var a=tt.Ub();tt.Tb(0,"mat-list-item",5),tt.bc("click",function(){tt.xc(a);var t=e.$implicit;return tt.fc().getEntidad(t.area)}),tt.Tb(1,"mat-icon",6),tt.Fc(2,"settings"),tt.Sb(),tt.Tb(3,"h5",7),tt.Fc(4),tt.Sb(),tt.Sb()}if(2&t){var n=e.$implicit;tt.Cb(4),tt.Gc(n.nombre)}}var mt,ft,pt=function(){return{standalone:!0}},gt=((ft=function(){function t(e,a){var n=this;c(this,t),this.areaSrvc=e,this.ls=a,this.getEntidadEv=new tt.o,this.length=0,this.pageSize=5,this.pageSizeOptions=[5,10,15],this.pageIndex=0,this.txtFiltro="",this.loadEntidades=function(){n.areaSrvc.get({sede:n.ls.get(it.b.usrTokenVar).sede||0,debaja:1}).subscribe(function(t){t&&t.length>0&&(n.lstEntidades=t,n.applyFilter())})},this.getEntidad=function(t){n.areaSrvc.get({area:t,debaja:1}).subscribe(function(t){t&&t.length>0&&n.getEntidadEv.emit(t[0])})},this.pageChange=function(t){n.pageSize=t.pageSize,n.pageIndex=t.pageIndex,n.applyFilter()}}return s(t,[{key:"ngOnInit",value:function(){this.loadEntidades()}},{key:"applyFilter",value:function(){if(this.txtFiltro.length>0){var t=Object(it.c)(this.lstEntidades,this.txtFiltro);this.length=t.length,this.lstEntidadesPaged=Object(it.f)(t,this.pageSize,this.pageIndex+1)}else this.length=this.lstEntidades.length,this.lstEntidadesPaged=Object(it.f)(this.lstEntidades,this.pageSize,this.pageIndex+1)}}]),t}()).\u0275fac=function(t){return new(t||ft)(tt.Nb(ut),tt.Nb(dt.a))},ft.\u0275cmp=tt.Hb({type:ft,selectors:[["app-lista-area"]],outputs:{getEntidadEv:"getEntidadEv"},decls:7,vars:7,consts:[[1,"mat-elevation-z4","fullWidth"],[1,"fullWidth"],["matInput","","placeholder","Buscar...",3,"ngModel","ngModelOptions","keyup","ngModelChange"],["matRipple","",3,"click",4,"ngFor","ngForOf"],["showFirstLastButtons","",3,"length","pageSize","pageSizeOptions","page"],["matRipple","",3,"click"],["mat-list-icon",""],["mat-line",""]],template:function(t,e){1&t&&(tt.Tb(0,"mat-card",0),tt.Tb(1,"mat-card-content"),tt.Tb(2,"mat-form-field",1),tt.Tb(3,"input",2),tt.bc("keyup",function(){return e.applyFilter()})("ngModelChange",function(t){return e.txtFiltro=t}),tt.Sb(),tt.Sb(),tt.Tb(4,"mat-nav-list"),tt.Dc(5,bt,5,1,"mat-list-item",3),tt.Sb(),tt.Tb(6,"mat-paginator",4),tt.bc("page",function(t){return e.pageChange(t)}),tt.Sb(),tt.Sb(),tt.Sb()),2&t&&(tt.Cb(3),tt.lc("ngModel",e.txtFiltro)("ngModelOptions",tt.nc(6,pt)),tt.Cb(2),tt.lc("ngForOf",e.lstEntidadesPaged),tt.Cb(1),tt.lc("length",e.length)("pageSize",e.pageSize)("pageSizeOptions",e.pageSizeOptions))},directives:[y.a,y.c,T.b,k.b,m.c,m.k,m.n,S.e,d.l,A.a,S.c,C.a,S.b,j.j],styles:[".fullWidth[_ngcontent-%COMP%], table[_ngcontent-%COMP%]{width:100%!important}"]}),ft),ht=((mt=function(){function t(e){c(this,t),this.http=e,this.moduleUrl="mesa",this.srvcErrHndl=new ct.a}return s(t,[{key:"get",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.http.get("".concat(it.b.urlMantenimientos,"/").concat(this.moduleUrl,"/buscar?").concat(lt.stringify(t))).pipe(Object(rt.a)(it.b.reintentos),Object(st.a)(this.srvcErrHndl.errorHandler))}},{key:"save",value:function(t){return this.http.post("".concat(it.b.urlMantenimientos,"/mesa/guardar").concat(t.mesa?"/"+t.mesa:""),t).pipe(Object(rt.a)(it.b.reintentos),Object(st.a)(this.srvcErrHndl.errorHandler))}},{key:"getDisponibles",value:function(){return this.http.get("".concat(it.b.urlMantenimientos,"/area/get_mesas_disponibles?")).pipe(Object(rt.a)(it.b.reintentos),Object(st.a)(this.srvcErrHndl.errorHandler))}}]),t}()).\u0275fac=function(t){return new(t||mt)(tt.Xb(b.b))},mt.\u0275prov=tt.Jb({token:mt,factory:mt.\u0275fac,providedIn:"root"}),mt),vt=i("qMXL");function St(t,e){if(1&t&&(tt.Tb(0,"mat-option",12),tt.Fc(1),tt.Sb()),2&t){var a=e.$implicit;tt.lc("value",a.impresora),tt.Cb(1),tt.Hc(" ",a.nombre," ")}}function Ct(t,e){if(1&t){var a=tt.Ub();tt.Tb(0,"mat-form-field",4),tt.Tb(1,"mat-label"),tt.Fc(2,"Impresora"),tt.Sb(),tt.Tb(3,"mat-select",10),tt.bc("ngModelChange",function(t){return tt.xc(a),tt.fc().mesa.impresora=t}),tt.Dc(4,St,2,2,"mat-option",11),tt.Sb(),tt.Sb()}if(2&t){var n=tt.fc();tt.Cb(3),tt.lc("ngModel",n.mesa.impresora),tt.Cb(1),tt.lc("ngForOf",n.impresoras)}}var Tt,kt,yt=((Tt=function(){function t(e,a,n,o,i){var r=this;c(this,t),this.mesaSrvc=e,this.impresoraSrvc=a,this.snackBar=n,this.dialogRef=o,this.data=i,this.impresoras=[],this.mesa={},this.loadImpresoras=function(){return r.impresoraSrvc.get().subscribe(function(t){return r.impresoras=t})},this.cancelar=function(){return r.dialogRef.close(!1)},this.guardarConfiguracion=function(){r.mesaSrvc.save(r.mesa).subscribe(function(t){t.exito?r.snackBar.open(t.mesa?"Mesa #".concat(t.mesa.numero," actualizada..."):"Mesa #".concat(r.mesa.numero," actualizada..."),"Configuraci\xf3n de mesa",{duration:3e3}):r.snackBar.open("ERROR:".concat(t.mensaje,"."),"Configuraci\xf3n de mesa",{duration:7e3}),r.dialogRef.close(!0)})}}return s(t,[{key:"ngOnInit",value:function(){this.mesa=this.data.mesa,this.loadImpresoras()}}]),t}()).\u0275fac=function(t){return new(t||Tt)(tt.Nb(ht),tt.Nb(vt.a),tt.Nb(P.b),tt.Nb(N.f),tt.Nb(N.a))},Tt.\u0275cmp=tt.Hb({type:Tt,selectors:[["app-configura-mesa"]],decls:13,vars:4,consts:[["mat-dialog-title",""],["mat-dialog-content",""],["novalidate",""],["frmConfigMesa","ngForm"],[1,"fullWidth"],["type","text","matInput","","placeholder","Etiqueta","name","etiqueta","maxlength","3",3,"ngModel","ngModelChange"],["class","fullWidth",4,"ngIf"],["mat-dialog-actions","","align","end"],["mat-raised-button","","color","warn",3,"click"],["mat-raised-button","","color","accent",3,"disabled","click"],["name","impresora",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(t,e){if(1&t&&(tt.Tb(0,"h1",0),tt.Fc(1),tt.Sb(),tt.Tb(2,"div",1),tt.Tb(3,"form",2,3),tt.Tb(5,"mat-form-field",4),tt.Tb(6,"input",5),tt.bc("ngModelChange",function(t){return e.mesa.etiqueta=t}),tt.Sb(),tt.Sb(),tt.Dc(7,Ct,5,2,"mat-form-field",6),tt.Sb(),tt.Sb(),tt.Tb(8,"div",7),tt.Tb(9,"button",8),tt.bc("click",function(){return e.cancelar()}),tt.Fc(10," Cancelar "),tt.Sb(),tt.Tb(11,"button",9),tt.bc("click",function(){return e.guardarConfiguracion()}),tt.Fc(12," Guardar "),tt.Sb(),tt.Sb()),2&t){var a=tt.tc(4);tt.Cb(1),tt.Hc("Configuraci\xf3n de mesa ",e.mesa.numero,""),tt.Cb(5),tt.lc("ngModel",e.mesa.etiqueta),tt.Cb(1),tt.lc("ngIf",1==+e.mesa.esmostrador),tt.Cb(4),tt.lc("disabled",!a.form.valid)}},directives:[N.g,N.d,m.r,m.l,m.m,T.b,k.b,m.c,m.f,m.k,m.n,d.m,N.c,E.a,T.f,O.a,d.l,j.m],styles:[""]}),Tt),Mt=i("IJgu"),Ft=i("znSr"),xt=["divMesa"],Ot=function(t,e,a,n,o){return{disponible:t,ocupada:e,debaja:a,"call-center-ocupado":n,"call-center-disponible":o}},Dt=((kt=function(){function t(e,a){var n=this;c(this,t),this.snackBar=e,this.mesaSrvc=a,this.configuracion={mesa:0,area:0,numero:0,posx:0,posy:0,tamanio:48,estatus:1,ancho:null,alto:null,esmostrador:0,vertical:0,etiqueta:null,escallcenter:0},this.dontAllowDrag=!0,this.isDisabled=!1,this.onClickMesa=new tt.o,this.moviendoMesa=new tt.o,this.urlImage="/assets/img/mesas/",this.ngAfterViewInit=function(){return n.objMesa=n.divMesa.nativeElement},this.clickMesa=function(){return n.onClickMesa.emit({mesaSelected:n.configuracion})},this.getAncho=function(){return n.configuracion.ancho&&+n.configuracion.ancho>0?n.configuracion.ancho:n.configuracion.tamanio},this.getAlto=function(){return n.configuracion.alto&&+n.configuracion.alto>0?n.configuracion.alto:n.configuracion.tamanio},this.dragEnded=function(t){n.dontAllowDrag=!0;var e=t.source.element.nativeElement,a=e.offsetParent.scrollHeight,o=t.distance,i={mesa:n.configuracion.mesa,area:n.configuracion.area,numero:n.configuracion.numero,posx:Math.abs(100*(e.offsetLeft+o.x)/e.offsetParent.scrollWidth),posy:Math.abs(100*(e.offsetTop+o.y)/a),tamanio:n.configuracion.tamanio,estatus:n.configuracion.estatus};n.mesaSrvc.save(i).subscribe(function(t){t.exito?t.mesa?(n.configuracion.mesa=t.mesa.mesa,n.snackBar.open("Mesa #".concat(t.mesa.numero," actualizada..."),"Dise\xf1o de \xe1rea",{duration:3e3})):n.snackBar.open("Mesa #".concat(n.configuracion.numero," actualizada..."),"Dise\xf1o de \xe1rea",{duration:3e3}):n.snackBar.open("ERROR:".concat(t.mensaje,"."),"Dise\xf1o de \xe1rea",{duration:3e3}),n.dontAllowDrag=!1,n.moviendoMesa.emit(!1)})},this.dragStarted=function(t){n.moviendoMesa.emit(!0)}}return s(t,[{key:"ngOnInit",value:function(){this.urlImage+=0==+this.configuracion.esmostrador?"table_03.svg":0==+this.configuracion.escallcenter?0==+this.configuracion.vertical?"mostrador_horizontal.svg":"mostrador_vertical.svg":"callcenter.svg"}}]),t}()).\u0275fac=function(t){return new(t||kt)(tt.Nb(P.b),tt.Nb(ht))},kt.\u0275cmp=tt.Hb({type:kt,selectors:[["app-mesa"]],viewQuery:function(t,e){var a;1&t&&tt.Kc(xt,1),2&t&&tt.sc(a=tt.cc())&&(e.divMesa=a.first)},inputs:{configuracion:"configuracion",dontAllowDrag:"dontAllowDrag",isDisabled:"isDisabled"},outputs:{onClickMesa:"onClickMesa",moviendoMesa:"moviendoMesa"},decls:4,vars:20,consts:[["cdkDrag","","cdkDragBoundary",".areaPosicionamiento",1,"divMesa","mat-elevation-z6",3,"cdkDragDisabled","ngClass","cdkDragEnded","cdkDragStarted","click"],["divMesa",""]],template:function(t,e){1&t&&(tt.Tb(0,"div",0,1),tt.bc("cdkDragEnded",function(t){return e.dragEnded(t)})("cdkDragStarted",function(t){return e.dragStarted(t)})("click",function(){return e.clickMesa()}),tt.Tb(2,"span"),tt.Fc(3),tt.Sb(),tt.Sb()),2&t&&(tt.Ac("width",e.getAncho(),"px")("height",e.getAlto(),"px")("left",e.configuracion.posx,"%")("top",e.configuracion.posy,"%")("background-image","url("+e.urlImage+")"),tt.lc("cdkDragDisabled",e.dontAllowDrag)("ngClass",tt.rc(14,Ot,1==+e.configuracion.estatus&&0==+e.configuracion.debaja,2==+e.configuracion.estatus&&0==+e.configuracion.debaja,1==+e.configuracion.debaja,2==+e.configuracion.estatus&&1==+e.configuracion.escallcenter,1==+e.configuracion.estatus&&1==+e.configuracion.escallcenter)),tt.Db("disabled",!!e.isDisabled||null),tt.Cb(3),tt.Gc(e.configuracion.etiqueta||e.configuracion.numero))},directives:[B.a,d.k,Ft.a],styles:[".divMesa[_ngcontent-%COMP%]{background-repeat:no-repeat;background-position:50%;position:absolute;text-align:right;padding-top:0;background-size:90% 90%}span[_ngcontent-%COMP%]{font-size:12pt;font-weight:700;text-shadow:-1px 0 #fff,0 1px #fff,1px 0 #fff,0 -1px #fff}.disponible[_ngcontent-%COMP%]{background-color:#90ee90}.ocupada[_ngcontent-%COMP%]{background-color:#da332d}.debaja[_ngcontent-%COMP%]{background-color:#000}.call-center-ocupado[_ngcontent-%COMP%]{background-color:#da332d;background-image:url(/assets/img/mesas/callcenter_alt.svg)}.call-center-disponible[_ngcontent-%COMP%]{background-color:#90ee90;background-image:url(/assets/img/mesas/callcenter.svg)}"]}),kt);function Et(t,e){if(1&t){var a=tt.Ub();tt.Tb(0,"app-mesa",11),tt.bc("onClickMesa",function(t){tt.xc(a);var e=tt.fc();return!e.cargando&&e.onClickMesa(t)})("moviendoMesa",function(t){return tt.xc(a),tt.fc().cargando=t})("contextmenu",function(t){tt.xc(a);var n=e.$implicit,o=tt.fc();return!o.cargando&&o.onContextMenu(t,n)}),tt.Sb()}if(2&t){var n=e.$implicit,o=tt.fc();tt.lc("configuracion",n)("dontAllowDrag",o.cargando)}}function Pt(t,e){if(1&t){var a=tt.Ub();tt.Tb(0,"button",16),tt.bc("click",function(){tt.xc(a);var t=tt.fc().item;return tt.fc().configurarMesa(t)}),tt.Tb(1,"mat-icon",3),tt.Fc(2,"settings"),tt.Sb(),tt.Fc(3,"Configuracion "),tt.Sb()}}function _t(t,e){if(1&t){var a=tt.Ub();tt.Tb(0,"button",17),tt.bc("click",function(){tt.xc(a);var t=tt.fc().item;return tt.fc().toggleDeBaja(t)}),tt.Tb(1,"mat-icon",3),tt.Fc(2,"thumb_down"),tt.Sb(),tt.Fc(3,"Dar de baja "),tt.Sb()}if(2&t){var n=tt.fc().item;tt.lc("disabled",2==+n.estatus)}}function It(t,e){if(1&t){var a=tt.Ub();tt.Tb(0,"button",18),tt.bc("click",function(){tt.xc(a);var t=tt.fc().item;return tt.fc().toggleDeBaja(t,0)}),tt.Tb(1,"mat-icon",3),tt.Fc(2,"thumb_up"),tt.Sb(),tt.Fc(3,"Habilitar "),tt.Sb()}if(2&t){var n=tt.fc().item;tt.lc("disabled",2==+n.estatus)}}function wt(t,e){if(1&t&&(tt.Tb(0,"span",12),tt.Fc(1),tt.Sb(),tt.Ob(2,"mat-divider"),tt.Dc(3,Pt,4,0,"button",13),tt.Dc(4,_t,4,1,"button",14),tt.Dc(5,It,4,1,"button",15)),2&t){var a=e.item;tt.Cb(1),tt.Ic("Mesa #",a.numero," (",a.mesa,")"),tt.Cb(2),tt.lc("ngIf",0==+a.debaja),tt.Cb(1),tt.lc("ngIf",0==+a.debaja),tt.Cb(1),tt.lc("ngIf",1==+a.debaja)}}var At,Nt=((At=function(){function t(e,a,n,o,i){var r=this;c(this,t),this.snackBar=e,this.mesaSrvc=a,this.dialogRef=n,this.dialog=o,this.data=i,this.mesas=[],this.contextMenuPosition={x:"0px",y:"0px"},this.cargando=!1,this.getNextTableNumber=function(){return r.mesas.length>0?r.mesas.reduce(function(t,e){return+e.numero>t?+e.numero:t},r.mesas[0].numero?+r.mesas[0].numero:0)+1:1},this.addTable=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:72,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:72,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;r.cargando=!0,r.mesas.push({mesa:null,area:r.data.area,numero:r.getNextTableNumber(),posx:1,posy:1,tamanio:72,estatus:1,ancho:t,alto:e,esmostrador:a,vertical:n,escallcenter:o}),r.saveNewMesa(r.mesas[r.mesas.length-1],r.mesas.length-1)},this.addMostrador=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return r.addTable(t?72:144,t?144:72,1,t?1:0)},this.addCallCenter=function(){return r.addTable(72,72,1,0,1)},this.saveNewMesa=function(t,e){r.mesaSrvc.save(t).subscribe(function(t){t.exito?t.mesa&&(r.mesas[e]=t.mesa):r.snackBar.open("ERROR: ".concat(t.mensaje),"Mesa",{duration:7e3}),r.cargando=!1})},this.onClickMesa=function(t){},this.terminar=function(){return r.dialogRef.close(r.mesas)},this.configurarMesa=function(t){r.dialog.open(yt,{width:"50%",data:{mesa:t}}).afterClosed().subscribe(function(t){})},this.toggleDeBaja=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;r.dialog.open(Mt.a,{maxWidth:"400px",data:new Mt.b(0==+t.esmostrador?"Mesa":"Mostrador","\xbfSeguro que desea ".concat(1===e?"dar de baja":"habilitar"," ").concat(0==+t.esmostrador?"la mesa":"el mostrador"," #").concat(t.numero,"?"),"S\xed","No")}).afterClosed().subscribe(function(a){a&&(t.debaja=e,r.mesaSrvc.save(t).subscribe(function(t){if(t.exito){if(t.mesa){var e=r.mesas.findIndex(function(e){return+e.mesa==+t.mesa.mesa});e>-1&&(r.mesas[e]=t.mesa),r.snackBar.open(t.mensaje,"Mesa",{duration:3e3})}}else r.snackBar.open("ERROR: ".concat(t.mensaje),"Mesa",{duration:7e3})}))})}}return s(t,[{key:"ngOnInit",value:function(){this.mesas=this.data.mesas}},{key:"onContextMenu",value:function(t,e){t.preventDefault(),this.contextMenuPosition.x=t.clientX+"px",this.contextMenuPosition.y=t.clientY+"px",this.contextMenu.menuData={item:e},this.contextMenu.menu.focusFirstItem("mouse"),this.contextMenu.openMenu()}}]),t}()).\u0275fac=function(t){return new(t||At)(tt.Nb(P.b),tt.Nb(ht),tt.Nb(N.f),tt.Nb(N.b),tt.Nb(N.a))},At.\u0275cmp=tt.Hb({type:At,selectors:[["app-area-designer"]],viewQuery:function(t,e){var a;1&t&&tt.Kc(I.e,1),2&t&&tt.sc(a=tt.cc())&&(e.contextMenu=a.first)},decls:27,vars:11,consts:[[1,"diseniador"],["align","center",2,"height","55px"],["mat-raised-button","","type","button","color","accent",1,"btnAccion",3,"disabled","click"],[1,"btnIconSize"],["mat-raised-button","","type","button","color","accent",3,"disabled","click"],[2,"height","5px","width","100%"],["id","divAreaPosicionamiento",1,"areaPosicionamiento"],[3,"configuracion","dontAllowDrag","onClickMesa","moviendoMesa","contextmenu",4,"ngFor","ngForOf"],[2,"visibility","hidden","position","fixed",3,"matMenuTriggerFor"],["contextMenu","matMenu"],["matMenuContent",""],[3,"configuracion","dontAllowDrag","onClickMesa","moviendoMesa","contextmenu"],["mat-menu-item","","disableRipple","true",1,"mesaTitle"],["mat-menu-item","",3,"click",4,"ngIf"],["mat-menu-item","","class","customize",3,"disabled","click",4,"ngIf"],["mat-menu-item","","class","customizeUp",3,"disabled","click",4,"ngIf"],["mat-menu-item","",3,"click"],["mat-menu-item","",1,"customize",3,"disabled","click"],["mat-menu-item","",1,"customizeUp",3,"disabled","click"]],template:function(t,e){if(1&t&&(tt.Tb(0,"div",0),tt.Tb(1,"div",1),tt.Tb(2,"button",2),tt.bc("click",function(){return e.addTable()}),tt.Tb(3,"mat-icon",3),tt.Fc(4,"add"),tt.Sb(),tt.Fc(5,"\xa0Mesa "),tt.Sb(),tt.Tb(6,"button",2),tt.bc("click",function(){return e.addMostrador()}),tt.Tb(7,"mat-icon",3),tt.Fc(8,"add"),tt.Sb(),tt.Fc(9,"\xa0Mostrador "),tt.Sb(),tt.Tb(10,"button",2),tt.bc("click",function(){return e.addMostrador(!0)}),tt.Tb(11,"mat-icon",3),tt.Fc(12,"add"),tt.Sb(),tt.Fc(13,"\xa0Mostrador vertical "),tt.Sb(),tt.Tb(14,"button",2),tt.bc("click",function(){return e.addCallCenter()}),tt.Tb(15,"mat-icon",3),tt.Fc(16,"add"),tt.Sb(),tt.Fc(17,"\xa0Call center "),tt.Sb(),tt.Tb(18,"button",4),tt.bc("click",function(){return e.terminar()}),tt.Fc(19," Terminar "),tt.Sb(),tt.Sb(),tt.Ob(20,"div",5),tt.Tb(21,"div",6),tt.Dc(22,Et,1,2,"app-mesa",7),tt.Sb(),tt.Ob(23,"div",8),tt.Tb(24,"mat-menu",null,9),tt.Dc(26,wt,6,5,"ng-template",10),tt.Sb(),tt.Sb()),2&t){var a=tt.tc(25);tt.Cb(2),tt.lc("disabled",e.cargando),tt.Cb(4),tt.lc("disabled",e.cargando),tt.Cb(4),tt.lc("disabled",e.cargando),tt.Cb(4),tt.lc("disabled",e.cargando),tt.Cb(4),tt.lc("disabled",e.cargando),tt.Cb(4),tt.lc("ngForOf",e.mesas),tt.Cb(1),tt.Ac("left",e.contextMenuPosition.x)("top",e.contextMenuPosition.y),tt.lc("matMenuTriggerFor",a)}},directives:[E.a,C.a,d.l,I.e,I.a,I.b,Dt,I.c,M.a,d.m],styles:[".diseniador[_ngcontent-%COMP%]{width:750px;height:650px}.areaPosicionamiento[_ngcontent-%COMP%], .diseniador[_ngcontent-%COMP%]{overflow:hidden!important;padding:0!important}.areaPosicionamiento[_ngcontent-%COMP%]{width:100%;height:600px;background-color:hsla(0,0%,78%,.28627450980392155);position:relative}.btnIconSize[_ngcontent-%COMP%]{font-size:17pt!important}  .customize{background:#ffffe0}  .customizeUp{background:#90ee90}.mesaTitle[_ngcontent-%COMP%]{font-weight:700}"]}),At);function Rt(t,e){if(1&t){var a=tt.Ub();tt.Tb(0,"mat-form-field",4),tt.Tb(1,"input",13),tt.bc("ngModelChange",function(t){return tt.xc(a),tt.fc().entidad.nombre=t}),tt.Sb(),tt.Sb()}if(2&t){var n=tt.fc();tt.Cb(1),tt.lc("ngModel",n.entidad.nombre)}}function Ut(t,e){if(1&t&&(tt.Tb(0,"mat-option",14),tt.Fc(1),tt.Sb()),2&t){var a=e.$implicit;tt.lc("value",a.area),tt.Cb(1),tt.Hc(" ",a.nombre," ")}}function jt(t,e){if(1&t&&(tt.Tb(0,"mat-option",14),tt.Fc(1),tt.Sb()),2&t){var a=e.$implicit;tt.lc("value",a.impresora),tt.Cb(1),tt.Hc(" ",a.nombre," ")}}function Bt(t,e){if(1&t&&(tt.Tb(0,"mat-option",14),tt.Fc(1),tt.Sb()),2&t){var a=e.$implicit;tt.lc("value",a.impresora),tt.Cb(1),tt.Hc(" ",a.nombre," ")}}function Ht(t,e){if(1&t){var a=tt.Ub();tt.Tb(0,"button",15),tt.bc("click",function(){return tt.xc(a),tt.fc().openDesigner()}),tt.Fc(1," Dise\xf1ar "),tt.Sb()}}function Lt(t,e){if(1&t){var a=tt.Ub();tt.Tb(0,"button",16),tt.bc("click",function(){return tt.xc(a),tt.fc().resetEntidad()}),tt.Fc(1," Nuevo "),tt.Sb()}}var qt,$t,zt=((qt=function(){function t(e,a,n,o,i){var r=this;c(this,t),this.snackBar=e,this.dialog=a,this.entidadSrvc=n,this.impresoraSrvc=o,this.ls=i,this.entidadSavedEv=new tt.o,this.sedeUsr=0,this.lstAreas=[],this.esMovil=!1,this.impresoras=[],this.loadAreas=function(){return r.entidadSrvc.get({sede:r.sedeUsr,debaja:1}).subscribe(function(t){return r.lstAreas=t})},this.loadImpresoras=function(){return r.impresoraSrvc.get().subscribe(function(t){return r.impresoras=t})},this.resetEntidad=function(){return r.entidad={area:null,sede:r.sedeUsr,nombre:null,mesas:[],impresora_factura:null,impresora:null}},this.onSubmit=function(){r.entidadSrvc.save(r.entidad).subscribe(function(t){t.exito?(r.snackBar.open("".concat(t.mensaje),"\xc1rea",{duration:3e3}),r.resetEntidad(),r.loadAreas(),r.entidadSavedEv.emit()):r.snackBar.open("ERROR: ".concat(t.mensaje),"\xc1rea",{duration:3e3})})},this.openDesigner=function(){r.dialog.open(Nt,{width:"800px",disableClose:!0,data:{area:+r.entidad.area,mesas:r.entidad.mesas||[]}}).afterClosed().subscribe(function(t){t&&(r.entidadSavedEv.emit(),r.entidadSrvc.get({area:+r.entidad.area,debaja:1}).subscribe(function(t){t&&t.length>0&&(r.entidad=t[0])}))})}}return s(t,[{key:"ngOnInit",value:function(){this.sedeUsr=this.ls.get(it.b.usrTokenVar).sede||0,this.esMovil=this.ls.get(it.b.usrTokenVar).enmovil||!1,this.resetEntidad(),this.loadAreas(),this.loadImpresoras()}}]),t}()).\u0275fac=function(t){return new(t||qt)(tt.Nb(P.b),tt.Nb(N.b),tt.Nb(ut),tt.Nb(vt.a),tt.Nb(dt.a))},qt.\u0275cmp=tt.Hb({type:qt,selectors:[["app-form-area"]],inputs:{entidad:"entidad"},outputs:{entidadSavedEv:"entidadSavedEv"},decls:30,vars:11,consts:[[1,"mat-elevation-z4","fullWidth"],["novalidate","",3,"ngSubmit"],["frmEntidad","ngForm"],["class","fullWidth",4,"ngIf"],[1,"fullWidth"],["name","area_padre",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["name","impresora","required","",3,"ngModel","ngModelChange"],["name","impresora_factura",3,"ngModel","ngModelChange"],["align","end"],["mat-raised-button","","type","submit","color","accent",1,"btnAccion",3,"disabled"],["mat-raised-button","","type","button","color","accent","class","btnAccion",3,"click",4,"ngIf"],["mat-raised-button","","type","button","color","accent",3,"click",4,"ngIf"],["type","text","matInput","","placeholder","Nombre","name","nombre","minlength","1","maxlength","100","required","",3,"ngModel","ngModelChange"],[3,"value"],["mat-raised-button","","type","button","color","accent",1,"btnAccion",3,"click"],["mat-raised-button","","type","button","color","accent",3,"click"]],template:function(t,e){if(1&t){var a=tt.Ub();tt.Tb(0,"mat-card",0),tt.Tb(1,"mat-card-title"),tt.Tb(2,"h4"),tt.Fc(3,"\xc1rea"),tt.Sb(),tt.Sb(),tt.Tb(4,"mat-card-content"),tt.Tb(5,"form",1,2),tt.bc("ngSubmit",function(){return tt.xc(a),tt.tc(6).form.valid&&e.onSubmit()}),tt.Dc(7,Rt,2,1,"mat-form-field",3),tt.Tb(8,"mat-form-field",4),tt.Tb(9,"mat-label"),tt.Fc(10,"\xc1rea padre"),tt.Sb(),tt.Tb(11,"mat-select",5),tt.bc("ngModelChange",function(t){return e.entidad.area_padre=t}),tt.Dc(12,Ut,2,2,"mat-option",6),tt.Sb(),tt.Sb(),tt.Tb(13,"mat-form-field",4),tt.Tb(14,"mat-label"),tt.Fc(15,"Impresora"),tt.Sb(),tt.Tb(16,"mat-select",7),tt.bc("ngModelChange",function(t){return e.entidad.impresora=t}),tt.Dc(17,jt,2,2,"mat-option",6),tt.Sb(),tt.Sb(),tt.Tb(18,"mat-form-field",4),tt.Tb(19,"mat-label"),tt.Fc(20,"Impresora de factura"),tt.Sb(),tt.Tb(21,"mat-select",8),tt.bc("ngModelChange",function(t){return e.entidad.impresora_factura=t}),tt.Dc(22,Bt,2,2,"mat-option",6),tt.Sb(),tt.Sb(),tt.Tb(23,"h5"),tt.Fc(24),tt.Sb(),tt.Tb(25,"div",9),tt.Tb(26,"button",10),tt.Fc(27," Guardar "),tt.Sb(),tt.Dc(28,Ht,2,0,"button",11),tt.Dc(29,Lt,2,0,"button",12),tt.Sb(),tt.Sb(),tt.Sb(),tt.Sb()}if(2&t){var n=tt.tc(6);tt.Cb(7),tt.lc("ngIf",e.esMovil),tt.Cb(4),tt.lc("ngModel",e.entidad.area_padre),tt.Cb(1),tt.lc("ngForOf",e.lstAreas),tt.Cb(4),tt.lc("ngModel",e.entidad.impresora),tt.Cb(1),tt.lc("ngForOf",e.impresoras),tt.Cb(4),tt.lc("ngModel",e.entidad.impresora_factura),tt.Cb(1),tt.lc("ngForOf",e.impresoras),tt.Cb(2),tt.Hc("Mesas en el \xe1rea: ",e.entidad.mesas.length,""),tt.Cb(2),tt.lc("disabled",!n.form.valid),tt.Cb(2),tt.lc("ngIf",e.entidad.area),tt.Cb(1),tt.lc("ngIf",e.entidad.area)}},directives:[y.a,y.h,y.c,m.r,m.l,m.m,d.m,T.b,T.f,O.a,m.k,m.n,d.l,m.p,E.a,k.b,m.c,m.g,m.f,j.m],styles:[".full-width[_ngcontent-%COMP%]{width:100%}"]}),qt),Gt=["listaAreas"],Wt=(($t=function(){function t(){var e=this;c(this,t),this.setArea=function(t){return e.area=t},this.refreshAreaList=function(){e.lstAreasComponent.loadEntidades()},this.area={area:null,sede:null,nombre:null,impresora:null,impresora_factura:null}}return s(t,[{key:"ngOnInit",value:function(){}}]),t}()).\u0275fac=function(t){return new(t||$t)},$t.\u0275cmp=tt.Hb({type:$t,selectors:[["app-area"]],viewQuery:function(t,e){var a;1&t&&tt.Kc(Gt,1),2&t&&tt.sc(a=tt.cc())&&(e.lstAreasComponent=a.first)},decls:6,vars:1,consts:[[1,"row"],[1,"col","m5","s12"],[3,"getEntidadEv"],["listaAreas",""],[1,"col","m7","s12"],[3,"entidad","entidadSavedEv"]],template:function(t,e){1&t&&(tt.Tb(0,"div",0),tt.Tb(1,"div",1),tt.Tb(2,"app-lista-area",2,3),tt.bc("getEntidadEv",function(t){return e.setArea(t)}),tt.Sb(),tt.Sb(),tt.Tb(4,"div",4),tt.Tb(5,"app-form-area",5),tt.bc("entidadSavedEv",function(){return e.refreshAreaList()}),tt.Sb(),tt.Sb(),tt.Sb()),2&t&&(tt.Cb(5),tt.lc("entidad",e.area))},directives:[gt,zt],styles:[""]}),$t),Vt=i("u01r"),Kt=i("M8s9"),Jt=function(){return{standalone:!0}};function Qt(t,e){if(1&t){var a=tt.Ub();tt.Tb(0,"input",9),tt.bc("input",function(t){return tt.xc(a),tt.fc().validateKey(t)})("ngModelChange",function(t){return tt.xc(a),tt.fc().telefonoPedido=t}),tt.Sb()}if(2&t){var n=tt.fc();tt.lc("matKeyboard",n.keyboardLayout)("ngModel",n.telefonoPedido)("ngModelOptions",tt.nc(3,Jt))}}function Xt(t,e){if(1&t){var a=tt.Ub();tt.Tb(0,"input",10),tt.bc("keypress",function(t){return tt.xc(a),tt.fc().validateKey(t)})("ngModelChange",function(t){return tt.xc(a),tt.fc().telefonoPedido=t}),tt.Sb()}if(2&t){var n=tt.fc();tt.lc("ngModel",n.telefonoPedido)("ngModelOptions",tt.nc(2,Jt))}}function Yt(t,e){if(1&t){var a=tt.Ub();tt.Tb(0,"tr"),tt.Tb(1,"td"),tt.Fc(2),tt.Sb(),tt.Tb(3,"td",12),tt.Tb(4,"button",13),tt.bc("click",function(){tt.xc(a);var t=e.$implicit;return tt.fc(2).seleccionarCliente(t)}),tt.Fc(5," Seleccionar "),tt.Sb(),tt.Sb(),tt.Sb()}if(2&t){var n=e.$implicit;tt.Cb(2),tt.Gc(n.nombre)}}function Zt(t,e){if(1&t&&(tt.Tb(0,"table"),tt.Tb(1,"thead"),tt.Tb(2,"tr"),tt.Tb(3,"td"),tt.Fc(4,"\xbfQui\xe9n est\xe1 llamando?"),tt.Sb(),tt.Ob(5,"td"),tt.Sb(),tt.Sb(),tt.Tb(6,"tbody"),tt.Dc(7,Yt,6,1,"tr",11),tt.Sb(),tt.Sb()),2&t){var a=tt.fc();tt.Cb(7),tt.lc("ngForOf",a.clientes)}}var te,ee=((te=function(){function t(e,a,n,o,i,r){var s=this;c(this,t),this.dialogRef=e,this.snackBar=a,this.data=n,this.clienteSrvc=o,this.dialog=i,this.ls=r,this.telefonoPedido=null,this.clientes=[],this.keyboardLayout=it.b.IDIOMA_TECLADO,this.esMovil=!1,this.validateKey=function(t){var e=String.fromCharCode(t.keyCode);return!!/[0-9]/.test(e)||(t.preventDefault(),!1)},this.cancelar=function(){return s.dialogRef.close()},this.buscar=function(){s.telefonoPedido=s.telefonoPedido.trim().toUpperCase().replace(/[^0-9]/gi,""),s.telefonoPedido&&s.telefonoPedido.length>=8?s.clienteSrvc.get({telefono:s.telefonoPedido}).subscribe(function(t){t&&t.length>0?s.clientes=t:s.dialog.open(Vt.a,{width:"50%",disableClose:!0,data:{cliente:{cliente:null,nombre:null,nit:null,telefono:s.telefonoPedido}}}).afterClosed().subscribe(function(t){(null==t?void 0:t.cliente)&&s.dialogRef.close(t)})}):s.snackBar.open("Favor ingresar un n\xfamero de tel\xe9fono v\xe1lido.","Pedido",{duration:5e3})},this.seleccionarCliente=function(t){s.dialogRef.close(t)}}return s(t,[{key:"ngOnInit",value:function(){this.esMovil=this.ls.get(it.b.usrTokenVar).enmovil||!1}}]),t}()).\u0275fac=function(t){return new(t||te)(tt.Nb(N.f),tt.Nb(P.b),tt.Nb(N.a),tt.Nb(Kt.a),tt.Nb(N.b),tt.Nb(dt.a))},te.\u0275cmp=tt.Hb({type:te,selectors:[["app-pide-telefono-dialog"]],decls:12,vars:4,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[1,"fullWidth"],["matInput","","type","text","placeholder","Tel\xe9fono","minlength","8","maxlength","25","required","",3,"matKeyboard","ngModel","ngModelOptions","input","ngModelChange",4,"ngIf"],["matInput","","type","text","placeholder","Tel\xe9fono","minlength","8","maxlength","25","required","",3,"ngModel","ngModelOptions","keypress","ngModelChange",4,"ngIf"],[4,"ngIf"],["mat-dialog-actions","","align","end"],["mat-raised-button","","color","warn",3,"click"],["mat-raised-button","","type","button","color","accent",3,"disabled","click"],["matInput","","type","text","placeholder","Tel\xe9fono","minlength","8","maxlength","25","required","",3,"matKeyboard","ngModel","ngModelOptions","input","ngModelChange"],["matInput","","type","text","placeholder","Tel\xe9fono","minlength","8","maxlength","25","required","",3,"ngModel","ngModelOptions","keypress","ngModelChange"],[4,"ngFor","ngForOf"],["align","center",2,"width","15%"],["mat-raised-button","","type","button","color","accent",3,"click"]],template:function(t,e){1&t&&(tt.Tb(0,"h1",0),tt.Fc(1,"Tel\xe9fono"),tt.Sb(),tt.Tb(2,"div",1),tt.Tb(3,"mat-form-field",2),tt.Dc(4,Qt,1,4,"input",3),tt.Dc(5,Xt,1,3,"input",4),tt.Sb(),tt.Dc(6,Zt,8,1,"table",5),tt.Sb(),tt.Tb(7,"div",6),tt.Tb(8,"button",7),tt.bc("click",function(){return e.cancelar()}),tt.Fc(9," Cancelar "),tt.Sb(),tt.Tb(10,"button",8),tt.bc("click",function(){return e.buscar()}),tt.Fc(11," Buscar "),tt.Sb(),tt.Sb()),2&t&&(tt.Cb(4),tt.lc("ngIf",!e.esMovil),tt.Cb(1),tt.lc("ngIf",e.esMovil),tt.Cb(1),tt.lc("ngIf",e.clientes.length>0),tt.Cb(4),tt.lc("disabled",!(e.telefonoPedido&&e.telefonoPedido.length>=8)))},directives:[N.g,N.d,T.b,d.m,N.c,E.a,k.b,$.a,m.c,m.g,m.f,m.p,m.k,m.n,d.l],styles:[""]}),te);function ae(t,e){1&t&&(tt.Tb(0,"th",12),tt.Fc(1,"No."),tt.Sb())}function ne(t,e){if(1&t&&(tt.Tb(0,"td",13),tt.Tb(1,"span"),tt.Fc(2),tt.Sb(),tt.Sb()),2&t){var a=e.$implicit;tt.Cb(2),tt.Gc(a.numero)}}function oe(t,e){1&t&&(tt.Tb(0,"th",12),tt.Fc(1,"Nombre"),tt.Sb())}function ie(t,e){if(1&t){var a=tt.Ub();tt.Tb(0,"input",19),tt.bc("ngModelChange",function(t){return tt.xc(a),tt.fc().$implicit.nombre=t}),tt.Sb()}if(2&t){var n=tt.fc().$implicit;tt.lc("ngModel",n.nombre)}}function ce(t,e){if(1&t){var a=tt.Ub();tt.Tb(0,"input",20),tt.bc("ngModelChange",function(t){return tt.xc(a),tt.fc().$implicit.nombre=t}),tt.Sb()}if(2&t){var n=tt.fc().$implicit,o=tt.fc();tt.lc("matKeyboard",o.keyboardLayout)("ngModel",n.nombre)}}function re(t,e){if(1&t){var a=tt.Ub();tt.Tb(0,"td",13),tt.Tb(1,"mat-form-field",14),tt.Dc(2,ie,1,1,"input",15),tt.Dc(3,ce,1,2,"input",16),tt.Tb(4,"button",17),tt.bc("click",function(){tt.xc(a);var t=e.$implicit;return tt.fc().eliminarFila(t)}),tt.Tb(5,"mat-icon",18),tt.Fc(6,"close"),tt.Sb(),tt.Sb(),tt.Sb(),tt.Sb()}if(2&t){var n=tt.fc();tt.Cb(2),tt.lc("ngIf",n.esMovil),tt.Cb(1),tt.lc("ngIf",!n.esMovil)}}function se(t,e){1&t&&tt.Ob(0,"tr",21)}function le(t,e){1&t&&tt.Ob(0,"tr",22)}var ue,de=((ue=function(){function t(e,a,n,o){var i=this;c(this,t),this.dialogRef=e,this.data=a,this.snackBar=n,this.ls=o,this.displayedColumns=["numero","nombre"],this.esMovil=!1,this.terminar=function(){var t=i.todosConNombre(i.data.cuentas);t<0?i.dialogRef.close(i.data.cuentas):i.snackBar.open("Favor ingresar nombre a la cuenta #".concat(i.data.cuentas[t].cuenta,"..."),"Cuentas",{duration:5e3})},this.setTableDataSource=function(){return i.dataSource=new x.l(i.data.cuentas)},this.eliminarFila=function(t){var e=i.data.cuentas.findIndex(function(e){return+e.numero==+t.numero});e>0?(i.data.cuentas.splice(e,1),i.data.cuentas.map(function(t,e){return t.numero=e+1}),i.dataSource.data=i.data.cuentas):console.log("No se encuentra esta cuenta...")}}return s(t,[{key:"ngOnInit",value:function(){this.esMovil=this.ls.get(it.b.usrTokenVar).enmovil||!1,this.keyboardLayout=it.b.IDIOMA_TECLADO,this.setTableDataSource();for(var t=0;t<+this.data.comensales-1;t++)this.agregarFila()}},{key:"todosConNombre",value:function(t){for(var e=0;e<t.length;e++)if(!t[e].nombre)return e;return-1}},{key:"agregarFila",value:function(){this.data.cuentas.push({cuenta:0,numero:this.data.cuentas.length+1,nombre:null,productos:[]}),this.dataSource.data=this.data.cuentas}}]),t}()).\u0275fac=function(t){return new(t||ue)(tt.Nb(N.f),tt.Nb(N.a),tt.Nb(P.b),tt.Nb(dt.a))},ue.\u0275cmp=tt.Hb({type:ue,selectors:[["app-pide-datos-cuentas"]],decls:18,vars:5,consts:[["mat-dialog-title",""],["mat-dialog-content",""],["mat-table","",1,"fullWidth",3,"dataSource"],["tblCuentas",""],["matColumnDef","numero"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","nombre"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-dialog-actions","","align","end"],["mat-raised-button","","color","accent",3,"disabled","click"],["mat-header-cell",""],["mat-cell",""],[1,"fullWidth"],["type","text","matInput","","name","nombre","required","",3,"ngModel","ngModelChange",4,"ngIf"],["type","text","matInput","","name","nombre","required","",3,"matKeyboard","ngModel","ngModelChange",4,"ngIf"],["type","button","mat-button","","matSuffix","","mat-icon-button","",3,"click"],[1,"iconFontSize"],["type","text","matInput","","name","nombre","required","",3,"ngModel","ngModelChange"],["type","text","matInput","","name","nombre","required","",3,"matKeyboard","ngModel","ngModelChange"],["mat-header-row",""],["mat-row",""]],template:function(t,e){1&t&&(tt.Tb(0,"h1",0),tt.Fc(1,"Ingreso de datos de cuentas"),tt.Sb(),tt.Tb(2,"div",1),tt.Tb(3,"table",2,3),tt.Rb(5,4),tt.Dc(6,ae,2,0,"th",5),tt.Dc(7,ne,3,1,"td",6),tt.Qb(),tt.Rb(8,7),tt.Dc(9,oe,2,0,"th",5),tt.Dc(10,re,7,2,"td",6),tt.Qb(),tt.Dc(11,se,1,0,"tr",8),tt.Dc(12,le,1,0,"tr",9),tt.Sb(),tt.Sb(),tt.Tb(13,"div",10),tt.Tb(14,"button",11),tt.bc("click",function(){return e.agregarFila()}),tt.Fc(15," Agregar "),tt.Sb(),tt.Tb(16,"button",11),tt.bc("click",function(){return e.terminar()}),tt.Fc(17," Terminar "),tt.Sb(),tt.Sb()),2&t&&(tt.Cb(3),tt.lc("dataSource",e.dataSource),tt.Cb(8),tt.lc("matHeaderRowDef",e.displayedColumns),tt.Cb(1),tt.lc("matRowDefColumns",e.displayedColumns),tt.Cb(2),tt.lc("disabled",e.data.cuentas.length===+e.data.comensales),tt.Cb(2),tt.lc("disabled",e.data.cuentas.length!==+e.data.comensales))},directives:[N.g,N.d,x.k,x.c,x.e,x.b,x.g,x.j,N.c,E.a,x.d,x.a,T.b,d.m,T.g,C.a,k.b,m.c,m.p,m.k,m.n,$.a,x.f,x.i],styles:[".fullWidth[_ngcontent-%COMP%]{width:100%}.iconFontSize[_ngcontent-%COMP%]{font-size:34pt!important}"]}),ue),be=i("K9lQ");function me(t,e){if(1&t&&(tt.Tb(0,"mat-option",13),tt.Fc(1),tt.Sb()),2&t){var a=e.$implicit;tt.lc("value",a.usuario.usuario),tt.Cb(1),tt.Ic(" ",a.usuario.nombres," ",a.usuario.apellidos," ")}}function fe(t,e){if(1&t){var a=tt.Ub();tt.Tb(0,"input",14),tt.bc("ngModelChange",function(t){return tt.xc(a),tt.fc().data.comensales=t}),tt.Sb()}if(2&t){var n=tt.fc();tt.lc("matKeyboard",n.keyboardLayout)("ngModel",n.data.comensales)}}function pe(t,e){if(1&t){var a=tt.Ub();tt.Tb(0,"input",15),tt.bc("ngModelChange",function(t){return tt.xc(a),tt.fc().data.comensales=t}),tt.Sb()}if(2&t){var n=tt.fc();tt.lc("ngModel",n.data.comensales)}}var ge,he,ve=((he=function(){function t(e,a,n,o,i){var r=this;c(this,t),this.dialogRef=e,this.data=a,this.dialogDatosCuentas=n,this.usuarioSrvc=o,this.ls=i,this.lstMeseros=[],this.esMovil=!1,this.loadMeseros=function(){r.usuarioSrvc.getMeserosTurno().subscribe(function(t){t&&(r.lstMeseros=t)})},this.toNumber=function(t){return+t}}return s(t,[{key:"ngOnInit",value:function(){this.esMovil=this.ls.get(it.b.usrTokenVar).enmovil||!1,this.keyboardLayout=it.b.IDIOMA_TECLADO,this.loadMeseros()}},{key:"pedirDatosDeCuentas",value:function(t){var e=this;this.dialogDatosCuentas.open(de,{width:"50%",disableClose:!0,data:{cuentas:t.cuentas,comensales:this.data.comensales}}).afterClosed().subscribe(function(a){t.cuentas=a,e.dialogRef.close(t)})}},{key:"terminar",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;t?t.dividirCuentasPorSillas?this.pedirDatosDeCuentas(t):this.dialogRef.close(t):this.dialogRef.close()}}]),t}()).\u0275fac=function(t){return new(t||he)(tt.Nb(N.f),tt.Nb(N.a),tt.Nb(N.b),tt.Nb(be.a),tt.Nb(dt.a))},he.\u0275cmp=tt.Hb({type:he,selectors:[["app-abrir-mesa"]],decls:22,vars:8,consts:[["mat-dialog-title",""],["novalidate","",3,"ngSubmit"],["frmAbrirMesa","ngForm"],[1,"separatorMargin"],["name","mesero",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["type","text","matInput","","placeholder","# Comensales","name","comensales","required","",3,"matKeyboard","ngModel","ngModelChange",4,"ngIf"],["type","text","matInput","","placeholder","# Comensales","name","comensales","required","",3,"ngModel","ngModelChange",4,"ngIf"],["name","esEvento",1,"separatorMargin",3,"ngModel","ngModelChange"],["name","dividirCuentasPorSillas",1,"separatorMargin",3,"ngModel","disabled","ngModelChange"],["align","end"],["mat-raised-button","","color","secondary",1,"btnAccion",3,"click"],["mat-raised-button","","color","accent",3,"disabled","click"],[3,"value"],["type","text","matInput","","placeholder","# Comensales","name","comensales","required","",3,"matKeyboard","ngModel","ngModelChange"],["type","text","matInput","","placeholder","# Comensales","name","comensales","required","",3,"ngModel","ngModelChange"]],template:function(t,e){if(1&t){var a=tt.Ub();tt.Tb(0,"h1",0),tt.Fc(1,"Abrir mesa"),tt.Sb(),tt.Tb(2,"mat-dialog-content"),tt.Tb(3,"form",1,2),tt.bc("ngSubmit",function(){return tt.xc(a),tt.tc(4).form.valid}),tt.Tb(5,"mat-form-field",3),tt.Tb(6,"mat-label"),tt.Fc(7,"Mesero"),tt.Sb(),tt.Tb(8,"mat-select",4),tt.bc("ngModelChange",function(t){return e.data.mesero=t}),tt.Dc(9,me,2,3,"mat-option",5),tt.Sb(),tt.Sb(),tt.Tb(10,"mat-form-field",3),tt.Dc(11,fe,1,2,"input",6),tt.Dc(12,pe,1,1,"input",7),tt.Sb(),tt.Tb(13,"mat-checkbox",8),tt.bc("ngModelChange",function(t){return+(e.data.esEvento=t)}),tt.Fc(14,"\xbfEs evento?"),tt.Sb(),tt.Tb(15,"mat-checkbox",9),tt.bc("ngModelChange",function(t){return+(e.data.dividirCuentasPorSillas=t)}),tt.Fc(16,"\xbfDividir cuentas?"),tt.Sb(),tt.Sb(),tt.Sb(),tt.Tb(17,"mat-dialog-actions",10),tt.Tb(18,"button",11),tt.bc("click",function(){return e.terminar()}),tt.Fc(19," Cancelar "),tt.Sb(),tt.Tb(20,"button",12),tt.bc("click",function(){return e.terminar(e.data)}),tt.Fc(21," Abrir mesa "),tt.Sb(),tt.Sb()}if(2&t){var n=tt.tc(4);tt.Cb(8),tt.lc("ngModel",e.data.mesero),tt.Cb(1),tt.lc("ngForOf",e.lstMeseros),tt.Cb(2),tt.lc("ngIf",!e.esMovil),tt.Cb(1),tt.lc("ngIf",e.esMovil),tt.Cb(1),tt.lc("ngModel",+e.data.esEvento),tt.Cb(2),tt.lc("ngModel",+e.data.dividirCuentasPorSillas)("disabled",+e.data.comensales<=1),tt.Cb(5),tt.lc("disabled",!n.form.valid)}},directives:[N.g,N.d,m.r,m.l,m.m,T.b,T.f,O.a,m.k,m.n,d.l,d.m,D.a,N.c,E.a,j.m,k.b,$.a,m.c,m.p],styles:[".contenido[_ngcontent-%COMP%]{height:50%!important}.separatorMargin[_ngcontent-%COMP%]{margin-right:8px}"]}),he),Se=((ge=function(){function t(e){c(this,t),this.http=e,this.moduleUrl="comanda",this.srvcErrHndl=new ct.a}return s(t,[{key:"get",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.http.get("".concat(it.b.urlAppRestaurante,"/").concat(this.moduleUrl,"/buscar?").concat(lt.stringify(t))).pipe(Object(rt.a)(it.b.reintentos),Object(st.a)(this.srvcErrHndl.errorHandler))}},{key:"getComandaDeMesa",value:function(t){return this.http.get("".concat(it.b.urlAppRestaurante,"/").concat(this.moduleUrl,"/get_comanda/").concat(t)).pipe(Object(rt.a)(it.b.reintentos),Object(st.a)(this.srvcErrHndl.errorHandler))}},{key:"save",value:function(t){return this.http.post("".concat(it.b.urlAppRestaurante,"/").concat(this.moduleUrl,"/guardar").concat(t.comanda?"/"+t.comanda:""),t).pipe(Object(rt.a)(it.b.reintentos),Object(st.a)(this.srvcErrHndl.errorHandler))}},{key:"enviarPedido",value:function(t,e){return this.http.post("".concat(it.b.urlAppRestaurante,"/callcenter/guardar_pedido/").concat(t),e).pipe(Object(rt.a)(it.b.reintentos),Object(st.a)(this.srvcErrHndl.errorHandler))}},{key:"saveDetalleCombo",value:function(t,e,a){return this.http.post("".concat(it.b.urlAppRestaurante,"/").concat(this.moduleUrl,"/guardar_detalle_combo/").concat(t,"/").concat(e),a).pipe(Object(rt.a)(it.b.reintentos),Object(st.a)(this.srvcErrHndl.errorHandler))}},{key:"saveNotasGenerales",value:function(t){return this.http.post("".concat(it.b.urlAppRestaurante,"/").concat(this.moduleUrl,"/guardar_notas_generales/").concat(t.comanda),t).pipe(Object(rt.a)(it.b.reintentos),Object(st.a)(this.srvcErrHndl.errorHandler))}},{key:"saveNotasProducto",value:function(t){return this.http.post("".concat(it.b.urlAppRestaurante,"/").concat(this.moduleUrl,"/guardar_notas_producto/").concat(t.detalle_comanda),t).pipe(Object(rt.a)(it.b.reintentos),Object(st.a)(this.srvcErrHndl.errorHandler))}},{key:"saveDetalle",value:function(t,e,a){return this.http.post("".concat(it.b.urlAppRestaurante,"/").concat(this.moduleUrl,"/guardar_detalle/").concat(t,"/").concat(e),a).pipe(Object(rt.a)(it.b.reintentos),Object(st.a)(this.srvcErrHndl.errorHandler))}},{key:"setProductoImpreso",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.http.get("".concat(it.b.urlAppRestaurante,"/").concat(this.moduleUrl,"/imprimir/").concat(t)).pipe(Object(rt.a)(it.b.reintentos),Object(st.a)(this.srvcErrHndl.errorHandler))}},{key:"cerrarMesa",value:function(t){return this.http.post("".concat(it.b.urlAppRestaurante,"/").concat(this.moduleUrl,"/cerrar_mesa/").concat(t),null).pipe(Object(rt.a)(it.b.reintentos),Object(st.a)(this.srvcErrHndl.errorHandler))}},{key:"getComandasOnLIne",value:function(){return this.http.get("".concat(it.b.urlAppRestaurante,"/").concat(this.moduleUrl,"/get_comanda")).pipe(Object(rt.a)(it.b.reintentos),Object(st.a)(this.srvcErrHndl.errorHandler))}},{key:"validaPwdGerenteTurno",value:function(t){return this.http.post("".concat(it.b.urlAppRestaurante,"/").concat(this.moduleUrl,"/validapwdgerenteturno"),{pwd:t}).pipe(Object(rt.a)(it.b.reintentos),Object(st.a)(this.srvcErrHndl.errorHandler))}},{key:"cerrarEstacion",value:function(t){return this.http.get("".concat(it.b.urlAppRestaurante,"/").concat(this.moduleUrl,"/cerrar_estacion/").concat(t)).pipe(Object(rt.a)(it.b.reintentos),Object(st.a)(this.srvcErrHndl.errorHandler))}},{key:"getCuenta",value:function(t){return this.http.get("".concat(it.b.urlAppRestaurante,"/cuenta/get_cuenta/").concat(t)).pipe(Object(rt.a)(it.b.reintentos),Object(st.a)(this.srvcErrHndl.errorHandler))}},{key:"unificarCuentas",value:function(t,e){return this.http.get("".concat(it.b.urlAppRestaurante,"/").concat(this.moduleUrl,"/unir_cuentas/").concat(t,"/").concat(e)).pipe(Object(rt.a)(it.b.reintentos),Object(st.a)(this.srvcErrHndl.errorHandler))}},{key:"trasladarMesa",value:function(t,e,a){return this.http.get("".concat(it.b.urlAppRestaurante,"/").concat(this.moduleUrl,"/trasladar_mesa/").concat(t,"/").concat(e,"/").concat(a)).pipe(Object(rt.a)(it.b.reintentos),Object(st.a)(this.srvcErrHndl.errorHandler))}},{key:"getComandasCocina",value:function(){return this.http.get("".concat(it.b.urlAppRestaurante,"/").concat(this.moduleUrl,"/get_comanda_cocina")).pipe(Object(rt.a)(it.b.reintentos),Object(st.a)(this.srvcErrHndl.errorHandler))}},{key:"setComandaCocinada",value:function(t,e){return this.http.post("".concat(it.b.urlAppRestaurante,"/").concat(this.moduleUrl,"/set_cocinado/").concat(t),e).pipe(Object(rt.a)(it.b.reintentos),Object(st.a)(this.srvcErrHndl.errorHandler))}},{key:"distribuirCuentas",value:function(t){return this.http.post("".concat(it.b.urlAppRestaurante,"/").concat(this.moduleUrl,"/distribuir_cuentas"),t).pipe(Object(rt.a)(it.b.reintentos),Object(st.a)(this.srvcErrHndl.errorHandler))}},{key:"cancelarPedido",value:function(t,e){return this.http.post("".concat(it.b.urlAppRestaurante,"/").concat(this.moduleUrl,"/anular_pedido/").concat(t),e).pipe(Object(rt.a)(it.b.reintentos),Object(st.a)(this.srvcErrHndl.errorHandler))}},{key:"getComandasOnLine_Test",value:function(){return[{comanda:37,total:8,usuario:6,sede:1,estatus:1,turno:2,mesa:{mesa:1,area:{area:1,sede:1,area_padre:null,nombre:"Bar"},numero:1,posx:23.8667,posy:18.8333,tamanio:72,estatus:2},cuentas:[{cuenta:31,comanda:37,nombre:"\xdanica",numero:1,propina_monto:.8,propina_porcentaje:10,cerrada:1,productos:[{detalle_cuenta:75,cuenta_cuenta:31,detalle_comanda:79,comanda:37,articulo:{articulo:1,categoria_grupo:21,presentacion:null,descripcion:"Original",precio:8,bien_servicio:"B",existencias:969,impresora:{impresora:1,sede:1,nombre:"EPSON L120 Series",direccion_ip:null,ubicacion:null,bluetooth:0}},cantidad:1,precio:8,impreso:1,total:8,notas:"",numero_cuenta:1}]}]},{comanda:45,total:76,usuario:2,sede:1,estatus:1,turno:2,mesa:{mesa:3,area:{area:1,sede:1,area_padre:null,nombre:"Bar"},numero:3,posx:11.0667,posy:41.5,tamanio:72,estatus:2},cuentas:[{cuenta:39,comanda:45,nombre:"uno",numero:1,propina_monto:.8,propina_porcentaje:10,cerrada:1,productos:[{detalle_cuenta:84,cuenta_cuenta:39,detalle_comanda:88,comanda:45,articulo:{articulo:1,categoria_grupo:21,presentacion:null,descripcion:"Original",precio:8,bien_servicio:"B",existencias:969,impresora:{impresora:1,sede:1,nombre:"EPSON L120 Series",direccion_ip:null,ubicacion:null,bluetooth:0}},cantidad:1,precio:8,impreso:1,total:8,notas:"",numero_cuenta:1},{detalle_cuenta:85,cuenta_cuenta:40,detalle_comanda:89,comanda:45,articulo:{articulo:2,categoria_grupo:21,presentacion:null,descripcion:"Zero",precio:8,bien_servicio:"B",existencias:984,impresora:{impresora:1,sede:1,nombre:"EPSON L120 Series",direccion_ip:null,ubicacion:null,bluetooth:0}},cantidad:1,precio:8,impreso:1,total:8,notas:"",numero_cuenta:1},{detalle_cuenta:86,cuenta_cuenta:40,detalle_comanda:90,comanda:45,articulo:{articulo:6,categoria_grupo:23,presentacion:null,descripcion:"Fettuccine",precio:60,bien_servicio:"B",existencias:995,impresora:{impresora:2,sede:1,nombre:"EPSON L120 Series",direccion_ip:null,ubicacion:null,bluetooth:0}},cantidad:1,precio:60,impreso:1,total:60,notas:"",numero_cuenta:1}]}]}]}}]),t}()).\u0275fac=function(t){return new(t||ge)(tt.Xb(b.b))},ge.\u0275prov=tt.Jb({token:ge,factory:ge.\u0275fac,providedIn:"root"}),ge);function Ce(t,e){if(1&t&&(tt.Tb(0,"mat-option",10),tt.Fc(1),tt.Sb()),2&t){var a=e.$implicit;tt.lc("value",a)("disabled",1==+a.cerrada),tt.Cb(1),tt.Hc(" ",a.nombre," ")}}function Te(t,e){if(1&t&&(tt.Tb(0,"mat-option",10),tt.Fc(1),tt.Sb()),2&t){var a=e.$implicit;tt.lc("value",a)("disabled",1==+a.cerrada),tt.Cb(1),tt.Hc(" ",a.nombre," ")}}var ke,ye=((ke=function(){function t(e,a,n,o){c(this,t),this.dialogRef=e,this.comandaSrvc=a,this.snackBar=n,this.data=o}return s(t,[{key:"ngOnInit",value:function(){}},{key:"cancelar",value:function(){this.dialogRef.close(!1)}},{key:"unirCuentas",value:function(t,e){var a=this;this.comandaSrvc.unificarCuentas(t.cuenta,e.cuenta).subscribe(function(t){t.exito?(a.snackBar.open(t.mensaje,"Cuentas",{duration:3e3}),a.dialogRef.close(!0)):a.snackBar.open("ERROR:".concat(t.mensaje),"Cuentas",{duration:7e3})})}},{key:"unirTodas",value:function(){}}]),t}()).\u0275fac=function(t){return new(t||ke)(tt.Nb(N.f),tt.Nb(Se),tt.Nb(P.b),tt.Nb(N.a))},ke.\u0275cmp=tt.Hb({type:ke,selectors:[["app-unir-cuenta"]],decls:20,vars:5,consts:[["mat-dialog-title",""],["mat-dialog-content",""],["novalidate",""],["frmUnirCuenta","ngForm"],["name","cuentaDe","required","",3,"ngModel","ngModelChange"],[3,"value","disabled",4,"ngFor","ngForOf"],["name","cuentaA","required","",3,"ngModel","ngModelChange"],["mat-dialog-actions","","align","end"],["mat-raised-button","","color","warn",3,"click"],["mat-raised-button","","type","button","color","accent",3,"disabled","click"],[3,"value","disabled"]],template:function(t,e){if(1&t&&(tt.Tb(0,"h1",0),tt.Fc(1,"Unir cuentas"),tt.Sb(),tt.Tb(2,"div",1),tt.Tb(3,"form",2,3),tt.Tb(5,"mat-form-field"),tt.Tb(6,"mat-label"),tt.Fc(7,"Unir cuenta de"),tt.Sb(),tt.Tb(8,"mat-select",4),tt.bc("ngModelChange",function(t){return e.cuentaDe=t}),tt.Dc(9,Ce,2,3,"mat-option",5),tt.Sb(),tt.Sb(),tt.Tb(10,"mat-form-field"),tt.Tb(11,"mat-label"),tt.Fc(12,"con la cuenta de"),tt.Sb(),tt.Tb(13,"mat-select",6),tt.bc("ngModelChange",function(t){return e.cuentaA=t}),tt.Dc(14,Te,2,3,"mat-option",5),tt.Sb(),tt.Sb(),tt.Sb(),tt.Sb(),tt.Tb(15,"div",7),tt.Tb(16,"button",8),tt.bc("click",function(){return e.cancelar()}),tt.Fc(17," Cancelar "),tt.Sb(),tt.Tb(18,"button",9),tt.bc("click",function(){return e.unirCuentas(e.cuentaDe,e.cuentaA)}),tt.Fc(19," Unir cuentas "),tt.Sb(),tt.Sb()),2&t){var a=tt.tc(4);tt.Cb(8),tt.lc("ngModel",e.cuentaDe),tt.Cb(1),tt.lc("ngForOf",e.data.mesaEnUso.cuentas),tt.Cb(4),tt.lc("ngModel",e.cuentaA),tt.Cb(1),tt.lc("ngForOf",e.data.mesaEnUso.cuentas),tt.Cb(4),tt.lc("disabled",!a.form.valid||!e.cuentaDe||!e.cuentaA||+e.cuentaDe.numero==+e.cuentaA.numero)}},directives:[N.g,N.d,m.r,m.l,m.m,T.b,T.f,O.a,m.p,m.k,m.n,d.l,N.c,E.a,j.m],styles:[""]}),ke);function Me(t,e){if(1&t&&(tt.Tb(0,"mat-option",10),tt.Fc(1),tt.Sb()),2&t){var a=e.$implicit;tt.lc("value",a),tt.Cb(1),tt.Ic(" ",a.area.nombre," - ",a.etiqueta||a.numero," ")}}var Fe,xe,Oe,De=((Fe=function(){function t(e,a,n,o,i){var r=this;c(this,t),this.dialogRef=e,this.snackBar=a,this.mesaSrvc=n,this.comandaSrvc=o,this.data=i,this.mesasDisponibles=[],this.loadMesasDisponibles=function(){return r.mesaSrvc.getDisponibles().subscribe(function(t){return r.mesasDisponibles=t})},this.cancelar=function(){return r.dialogRef.close(!1)},this.trasladar=function(){r.comandaSrvc.trasladarMesa(+r.data.mesaEnUso.comanda,+r.data.mesaEnUso.mesa.mesa,+r.destino.mesa).subscribe(function(t){t.exito?(r.snackBar.open(t.mensaje,"Traslado de mesa",{duration:3e3}),r.dialogRef.close(!0)):r.snackBar.open("ERROR:".concat(t.mensaje),"Traslado de mesa",{duration:7e3})})}}return s(t,[{key:"ngOnInit",value:function(){this.loadMesasDisponibles()}}]),t}()).\u0275fac=function(t){return new(t||Fe)(tt.Nb(N.f),tt.Nb(P.b),tt.Nb(ht),tt.Nb(Se),tt.Nb(N.a))},Fe.\u0275cmp=tt.Hb({type:Fe,selectors:[["app-traslado-mesa"]],decls:15,vars:3,consts:[["mat-dialog-title",""],["mat-dialog-content",""],["novalidate",""],["frmTrasladarMesa","ngForm"],[1,"fullWidth"],["name","destino","required","",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["mat-dialog-actions","","align","end"],["mat-raised-button","","color","warn",3,"click"],["mat-raised-button","","type","button","color","accent",3,"disabled","click"],[3,"value"]],template:function(t,e){if(1&t&&(tt.Tb(0,"h1",0),tt.Fc(1,"Trasladar a otra mesa"),tt.Sb(),tt.Tb(2,"div",1),tt.Tb(3,"form",2,3),tt.Tb(5,"mat-form-field",4),tt.Tb(6,"mat-label"),tt.Fc(7,"Trasladar a mesa:"),tt.Sb(),tt.Tb(8,"mat-select",5),tt.bc("ngModelChange",function(t){return e.destino=t}),tt.Dc(9,Me,2,3,"mat-option",6),tt.Sb(),tt.Sb(),tt.Sb(),tt.Sb(),tt.Tb(10,"div",7),tt.Tb(11,"button",8),tt.bc("click",function(){return e.cancelar()}),tt.Fc(12," Cancelar "),tt.Sb(),tt.Tb(13,"button",9),tt.bc("click",function(){return e.trasladar()}),tt.Fc(14," Trasladar "),tt.Sb(),tt.Sb()),2&t){var a=tt.tc(4);tt.Cb(8),tt.lc("ngModel",e.destino),tt.Cb(1),tt.lc("ngForOf",e.mesasDisponibles),tt.Cb(4),tt.lc("disabled",!a.form.valid)}},directives:[N.g,N.d,m.r,m.l,m.m,T.b,T.f,O.a,m.p,m.k,m.n,d.l,N.c,E.a,j.m],styles:[""]}),Fe),Ee=i("wd/R"),Pe=function t(e,a,n){c(this,t),this.tipo=e,this.subtitulo=a,this.etiquetaAceptar=n},_e=((xe=function(){function t(e,a,n){var o=this;c(this,t),this.comandaSrvc=e,this.dialogRef=a,this.data=n,this.pwd=void 0,this.cancelar=function(){return o.dialogRef.close()},this.terminar=function(){switch(+o.data.tipo){case 1:o.validarPwdGerenteTurno()}},this.validarPwdGerenteTurno=function(){o.comandaSrvc.validaPwdGerenteTurno(o.pwd).subscribe(function(t){o.dialogRef.close(!!t.exito&&t.esgerente)})}}return s(t,[{key:"ngOnInit",value:function(){}}]),t}()).\u0275fac=function(t){return new(t||xe)(tt.Nb(Se),tt.Nb(N.f),tt.Nb(N.a))},xe.\u0275cmp=tt.Hb({type:xe,selectors:[["app-check-password"]],decls:14,vars:4,consts:[["mat-dialog-title",""],["novalidate","",3,"ngSubmit"],["frmValidaPwd","ngForm"],[1,"fullWidth"],["type","password","matInput","","placeholder","Contrase\xf1a","name","pwd","required","",3,"ngModel","ngModelChange"],["align","end"],["mat-raised-button","","color","secondary",1,"btnAccion",3,"click"],["mat-raised-button","","color","accent",3,"disabled","click"]],template:function(t,e){if(1&t){var a=tt.Ub();tt.Tb(0,"h1",0),tt.Fc(1," Validar contrase\xf1a"),tt.Ob(2,"br"),tt.Fc(3),tt.Sb(),tt.Tb(4,"mat-dialog-content"),tt.Tb(5,"form",1,2),tt.bc("ngSubmit",function(){return tt.xc(a),tt.tc(6).form.valid}),tt.Tb(7,"mat-form-field",3),tt.Tb(8,"input",4),tt.bc("ngModelChange",function(t){return e.pwd=t}),tt.Sb(),tt.Sb(),tt.Sb(),tt.Sb(),tt.Tb(9,"mat-dialog-actions",5),tt.Tb(10,"button",6),tt.bc("click",function(){return e.cancelar()}),tt.Fc(11," Cancelar "),tt.Sb(),tt.Tb(12,"button",7),tt.bc("click",function(){return e.terminar()}),tt.Fc(13),tt.Sb(),tt.Sb()}if(2&t){var n=tt.tc(6);tt.Cb(3),tt.Hc(" ",e.data.subtitulo||"Gerente de turno","\n"),tt.Cb(5),tt.lc("ngModel",e.pwd),tt.Cb(4),tt.lc("disabled",!n.form.valid),tt.Cb(1),tt.Hc(" ",e.data.etiquetaAceptar||"Validar"," ")}},directives:[N.g,N.d,m.r,m.l,m.m,T.b,k.b,m.c,m.p,m.k,m.n,N.c,E.a],styles:[""]}),xe),Ie=i("52Kp"),we=i("quSY"),Ae=i("KZK3"),Ne=((Oe=function(){function t(e){c(this,t),this.http=e,this.moduleUrl="cuenta",this.srvcErrHndl=new ct.a}return s(t,[{key:"save",value:function(t){return this.http.post("".concat(it.b.urlAppRestaurante,"/").concat(this.moduleUrl,"/cobrar/").concat(t.cuenta),t).pipe(Object(rt.a)(it.b.reintentos),Object(st.a)(this.srvcErrHndl.errorHandler))}}]),t}()).\u0275fac=function(t){return new(t||Oe)(tt.Xb(b.b))},Oe.\u0275prov=tt.Jb({token:Oe,factory:Oe.\u0275fac,providedIn:"root"}),Oe),Re=i("KFbY"),Ue=i("7JkF"),je=i("IHy4"),Be=i("qXgu"),He=i("FjVI"),Le=i("TOq3");function qe(t,e){if(1&t&&(tt.Tb(0,"small"),tt.Fc(1),tt.Sb()),2&t){var a=tt.fc();tt.Cb(1),tt.Hc(" - Factura a nombre de ",a.clienteSelected.nombre," ")}}function $e(t,e){if(1&t&&(tt.Tb(0,"tr"),tt.Tb(1,"td"),tt.Fc(2),tt.Sb(),tt.Tb(3,"td",25),tt.Fc(4),tt.gc(5,"number"),tt.Sb(),tt.Sb()),2&t){var a=e.$implicit;tt.Cb(2),tt.Ic("",a.cantidad,"\xa0",a.nombre||a.articulo.descripcion,""),tt.Cb(2),tt.Gc(tt.ic(5,3,a.cantidad*a.precio+a.monto_extra,"1.2-2"))}}function ze(t,e){if(1&t&&(tt.Tb(0,"mat-option",38),tt.Fc(1),tt.Sb()),2&t){var a=e.$implicit;tt.lc("value",a.forma_pago),tt.Cb(1),tt.Hc(" ",a.descripcion," ")}}function Ge(t,e){if(1&t){var a=tt.Ub();tt.Tb(0,"input",39),tt.bc("ngModelChange",function(t){return tt.xc(a),tt.fc().formaPago.monto=t}),tt.Sb()}if(2&t){var n=tt.fc();tt.lc("matKeyboard",n.keyboardLayout)("ngModel",n.formaPago.monto)}}function We(t,e){if(1&t){var a=tt.Ub();tt.Tb(0,"input",40),tt.bc("ngModelChange",function(t){return tt.xc(a),tt.fc().formaPago.monto=t}),tt.Sb()}if(2&t){var n=tt.fc();tt.lc("ngModel",n.formaPago.monto)}}function Ve(t,e){if(1&t){var a=tt.Ub();tt.Tb(0,"input",41),tt.bc("ngModelChange",function(t){return tt.xc(a),tt.fc().formaPago.propina=t}),tt.Sb()}if(2&t){var n=tt.fc();tt.lc("matKeyboard",n.keyboardLayout)("ngModel",n.formaPago.propina)}}function Ke(t,e){if(1&t){var a=tt.Ub();tt.Tb(0,"input",42),tt.bc("ngModelChange",function(t){return tt.xc(a),tt.fc().formaPago.propina=t}),tt.Sb()}if(2&t){var n=tt.fc();tt.lc("ngModel",n.formaPago.propina)}}function Je(t,e){if(1&t){var a=tt.Ub();tt.Tb(0,"input",45),tt.bc("ngModelChange",function(t){return tt.xc(a),tt.fc(2).formaPago.documento=t}),tt.Sb()}if(2&t){var n=tt.fc(2);tt.lc("matKeyboard",n.keyboardLayout)("ngModel",n.formaPago.documento)("required",n.pideDocumento)}}function Qe(t,e){if(1&t){var a=tt.Ub();tt.Tb(0,"input",46),tt.bc("ngModelChange",function(t){return tt.xc(a),tt.fc(2).formaPago.documento=t}),tt.Sb()}if(2&t){var n=tt.fc(2);tt.lc("ngModel",n.formaPago.documento)("required",n.pideDocumento)}}function Xe(t,e){if(1&t&&(tt.Tb(0,"mat-form-field",13),tt.Dc(1,Je,1,3,"input",43),tt.Dc(2,Qe,1,2,"input",44),tt.Sb()),2&t){var a=tt.fc();tt.Cb(1),tt.lc("ngIf",!a.esMovil),tt.Cb(1),tt.lc("ngIf",a.esMovil)}}function Ye(t,e){if(1&t){var a=tt.Ub();tt.Tb(0,"tr"),tt.Tb(1,"td"),tt.Fc(2),tt.Sb(),tt.Tb(3,"td",25),tt.Fc(4),tt.gc(5,"number"),tt.Sb(),tt.Tb(6,"td",25),tt.Fc(7),tt.gc(8,"number"),tt.Sb(),tt.Tb(9,"td",47),tt.Tb(10,"button",48),tt.bc("click",function(){tt.xc(a);var t=e.index;return tt.fc().delFormaPago(t)}),tt.Tb(11,"mat-icon"),tt.Fc(12,"delete_forever"),tt.Sb(),tt.Sb(),tt.Sb(),tt.Sb()}if(2&t){var n=e.$implicit;tt.Cb(2),tt.Gc(n.forma_pago.descripcion),tt.Cb(2),tt.Gc(tt.ic(5,3,n.monto,"1.2-2")),tt.Cb(3),tt.Gc(tt.ic(8,6,n.propina,"1.2-2"))}}function Ze(t,e){if(1&t&&(tt.Tb(0,"mat-option",38),tt.Fc(1),tt.Sb()),2&t){var a=e.$implicit;tt.lc("value",a.sede),tt.Cb(1),tt.Hc(" ",a.nombre," ")}}function ta(t,e){if(1&t){var a=tt.Ub();tt.Tb(0,"table",29),tt.Tb(1,"caption"),tt.Tb(2,"strong"),tt.Fc(3,"Datos de env\xedo"),tt.Sb(),tt.Sb(),tt.Tb(4,"tbody"),tt.Tb(5,"tr"),tt.Tb(6,"td"),tt.Tb(7,"mat-form-field",13),tt.Tb(8,"mat-label"),tt.Fc(9,"Atiende:"),tt.Sb(),tt.Tb(10,"mat-select",49),tt.bc("ngModelChange",function(t){return tt.xc(a),tt.fc().datosPedido.sede=t}),tt.Dc(11,Ze,2,2,"mat-option",15),tt.Sb(),tt.Sb(),tt.Sb(),tt.Tb(12,"td"),tt.Tb(13,"mat-form-field",13),tt.Tb(14,"input",50),tt.bc("ngModelChange",function(t){return tt.xc(a),tt.fc().datosPedido.direccion_entrega=t}),tt.Sb(),tt.Sb(),tt.Sb(),tt.Sb(),tt.Tb(15,"tr"),tt.Tb(16,"td"),tt.Tb(17,"mat-form-field",13),tt.Tb(18,"input",51),tt.bc("ngModelChange",function(t){return tt.xc(a),tt.fc().datosPedido.nombre=t}),tt.Sb(),tt.Sb(),tt.Sb(),tt.Tb(19,"td"),tt.Tb(20,"mat-form-field",13),tt.Tb(21,"input",52),tt.bc("ngModelChange",function(t){return tt.xc(a),tt.fc().datosPedido.telefono=t}),tt.Sb(),tt.Sb(),tt.Sb(),tt.Sb(),tt.Sb(),tt.Sb()}if(2&t){var n=tt.fc();tt.Cb(10),tt.lc("ngModel",n.datosPedido.sede),tt.Cb(1),tt.lc("ngForOf",n.sedes),tt.Cb(3),tt.lc("ngModel",n.datosPedido.direccion_entrega),tt.Cb(4),tt.lc("ngModel",n.datosPedido.nombre),tt.Cb(3),tt.lc("ngModel",n.datosPedido.telefono)}}function ea(t,e){if(1&t&&tt.Ob(0,"app-cargando",53),2&t){var a=tt.fc();tt.lc("configuracion",a.cargandoConf)}}function aa(t,e){if(1&t){var a=tt.Ub();tt.Tb(0,"button",36),tt.bc("click",function(){return tt.xc(a),tt.fc().cobrar()}),tt.Fc(1,"Facturar"),tt.Sb()}if(2&t){var n=tt.fc();tt.lc("disabled",0==n.formasPagoDeCuenta.length||+n.inputData.saldo>0||!n.factReq.cliente||n.facturando)}}function na(t,e){if(1&t){var a=tt.Ub();tt.Tb(0,"button",36),tt.bc("click",function(){return tt.xc(a),tt.fc().cobrar()}),tt.Fc(1," Enviar "),tt.Sb()}if(2&t){var n=tt.fc();tt.lc("disabled",0==n.formasPagoDeCuenta.length||+n.inputData.saldo>0||!n.factReq.cliente||n.facturando||!n.datosPedido.sede)}}var oa,ia=function(t,e,a){return{"saldo-pendiente":t,"saldo-exacto":e,"saldo-extra":a}},ca=((oa=function(){function t(e,a,n,i,r,s,l,u,d,b,m,f){var p=this;c(this,t),this.dialog=e,this.dialogRef=a,this.data=n,this.snackBar=i,this.formaPagoSrvc=r,this.cobroSrvc=s,this.facturaSrvc=l,this.ls=u,this.socket=d,this.sedeSrvc=b,this.comandaSrvc=m,this.configSrvc=f,this.inputData={},this.lstFormasPago=[],this.formaPago={},this.formasPagoDeCuenta=[],this.esMovil=!1,this.facturando=!1,this.cargandoConf={w:75,h:75},this.pideDocumento=!1,this.sedes=[],this.datosPedido={sede:null,direccion_entrega:null,telefono:null,nombre:null,cliente:null},this.endSubs=new we.a,this.resetFactReq=function(){p.factReq={cuentas:[],factura_serie:1,cliente:null,fecha_factura:Ee().format(it.b.dbDateFormat),moneda:1}},this.processData=function(){p.data?p.inputData=p.data:p.data=p.inputData,p.inputData.totalDeCuenta=0,p.inputData.productosACobrar.forEach(function(t){p.inputData.totalDeCuenta+=t.precio*t.cantidad+t.monto_extra}),p.calculaPropina(),p.actualizaSaldo(),p.formaPago.monto=parseFloat(p.inputData.saldo).toFixed(2),p.inputData.clientePedido&&p.setClienteFacturar(p.inputData.clientePedido)},this.loadSedes=function(){p.endSubs.add(p.sedeSrvc.get().subscribe(function(t){t&&(p.sedes=t)}))},this.calculaPropina=function(){p.inputData.montoPropina=parseFloat((p.inputData.porcentajePropina*p.inputData.totalDeCuenta/100).toFixed(2)),p.actualizaSaldo()},this.loadFormasPago=function(){p.endSubs.add(p.formaPagoSrvc.get({activo:1}).subscribe(function(t){t&&t.length>0&&(p.lstFormasPago=t)}))},this.addFormaPago=function(){var t=p.lstFormasPago.filter(function(t){return+t.forma_pago==+p.formaPago.forma_pago})[0];if(1==+t.pedirautorizacion){var e=p.dialog.open(_e,{width:"40%",disableClose:!0,data:new Pe(1)});p.endSubs.add(e.afterClosed().subscribe(function(e){e?p.agregaFormaPago(t):p.snackBar.open("La contrase\xf1a no es correcta","Formas de pago",{duration:5e3})}))}else p.agregaFormaPago(t)},this.agregaFormaPago=function(t){p.formasPagoDeCuenta.push({forma_pago:t,monto:parseFloat(p.formaPago.monto).toFixed(2),propina:p.formaPago.propina||0,documento:p.formaPago.documento||null,comision_monto:+p.formaPago.monto*+t.comision_porcentaje/100}),p.actualizaSaldo(),p.pideDocumento=!1},this.delFormaPago=function(t){p.formasPagoDeCuenta.splice(t,1),p.actualizaSaldo()},this.actualizaSaldo=function(){var t=0;p.formasPagoDeCuenta.forEach(function(e){return t+=+e.monto}),p.inputData.saldo=(+p.inputData.totalDeCuenta-t).toFixed(2),p.formaPago={monto:p.inputData.saldo}},this.cancelar=function(){return p.dialogRef.close()},this.setClienteFacturar=function(t){p.clienteSelected=t,p.factReq.cliente=+t.cliente,1==+p.data.mesaenuso.mesa.escallcenter&&(p.datosPedido.nombre=t.nombre,p.datosPedido.direccion_entrega=t.direccion,p.datosPedido.telefono=t.telefono)},this.cobrar=function(){p.facturando=!0;var t,e={cuenta:p.inputData.idcuenta,forma_pago:[],total:p.inputData.totalDeCuenta+p.inputData.montoPropina,propina_monto:p.inputData.montoPropina,propina_porcentaje:p.inputData.porcentajePropina,comision_monto:0},a=0,n=o(p.formasPagoDeCuenta);try{for(n.s();!(t=n.n()).done;){var i=t.value;a+=i.comision_monto||0,e.forma_pago.push({forma_pago:+i.forma_pago.forma_pago,monto:+i.monto+ +i.comision_monto,propina:i.propina||0,documento:i.documento,comision_monto:i.comision_monto})}}catch(c){n.e(c)}finally{n.f()}e.comision_monto=a,e.total+=a,1!=+p.data.mesaenuso.mesa.escallcenter?(p.factReq.cuentas.push({cuenta:+p.inputData.idcuenta}),p.endSubs.add(p.cobroSrvc.save(e).subscribe(function(t){if(t.exito&&!t.facturada)if(p.snackBar.open("Cobro","".concat(t.mensaje),{duration:3e3}),t.facturar)p.endSubs.add(p.facturaSrvc.facturar(p.factReq).subscribe(function(e){if(e.exito){var a=p.dialog.open(Mt.a,{maxWidth:"400px",data:new Mt.b("Imprimir factura","\xbfDesea imprimir la factura?","S\xed","No")});p.endSubs.add(a.afterClosed().subscribe(function(a){a&&p.printFactura(e.factura),p.resetFactReq(),p.snackBar.open("Factura","".concat(e.mensaje),{duration:3e3}),p.facturando=!1,p.dialogRef.close(t.cuenta),p.socket.emit("refrescar:mesa",{mesaenuso:p.data.mesaenuso})}))}else p.facturando=!1,p.snackBar.open("Factura","ERROR: ".concat(t.mensaje),{duration:7e3}),p.socket.emit("refrescar:mesa",{mesaenuso:p.data.mesaenuso}),p.dialogRef.close(t.cuenta)}));else{var e=p.dialog.open(Mt.a,{maxWidth:"400px",data:new Mt.b("Imprimir recibo","\xbfDesea imprimir un recibo?","S\xed","No")});p.endSubs.add(e.afterClosed().subscribe(function(e){e&&p.printRecibo(t.entidad),p.socket.emit("refrescar:mesa",{mesaenuso:p.data.mesaenuso}),p.dialogRef.close(t.cuenta)}))}else p.facturando=!1,p.snackBar.open("Cobro","ERROR: ".concat(t.mensaje),{duration:7e3}),p.socket.emit("refrescar:mesa",{mesaenuso:p.data.mesaenuso}),p.dialogRef.close("closePanel")}))):p.enviarPedido(e)},this.enviarPedido=function(t){p.datosPedido.cliente={nombre:p.clienteSelected.nombre,apellidos:"",correo:p.clienteSelected.correo,telefono:p.datosPedido.telefono,nit:p.clienteSelected.nit,direccion:p.datosPedido.direccion_entrega};var e={cobro:t,pedido:p.datosPedido,factura:{cuentas:[{cuenta:t.cuenta}],factura_serie:1,cliente:p.clienteSelected.cliente,fecha_factura:Ee().format(it.b.dbDateFormat),moneda:1}};p.endSubs.add(p.comandaSrvc.enviarPedido(+p.data.mesaenuso.comanda,e).subscribe(function(t){t.exito?(p.snackBar.open("Pedido","#".concat(t.pedido,". ").concat(t.mensaje),{duration:3e3}),p.dialogRef.close("closePanel")):p.snackBar.open("Pedido","ERROR: ".concat(t.mensaje),{duration:7e3}),p.facturando=!1,p.socket.emit("refrescar:mesa",{mesaenuso:p.data.mesaenuso})}))},this.procesaDetalleFactura=function(t){var e=[];return t.forEach(function(t){return e.push({Cantidad:parseInt(t.cantidad),Descripcion:t.articulo.descripcion,Total:+t.total,PrecioUnitario:t.precio_unitario?+t.precio_unitario:+t.precio})}),e},this.getTotalDetalle=function(t){var e=0;return t.forEach(function(t){return e+=+t.total}),e},this.getTotalImpuestosAdicionales=function(t){var e=0;return t.forEach(function(t){return e+=+t.total}),e},this.printFactura=function(t){p.endSubs.add(p.facturaSrvc.imprimir(+t.factura).subscribe(function(t){if(t.factura){var e={NombreEmpresa:t.factura.empresa.nombre,NitEmpresa:t.factura.empresa.nit,SedeEmpresa:t.factura.sedeFactura.nombre,DireccionEmpresa:t.factura.empresa.direccion,Fecha:Ee(t.factura.fecha_factura).format(it.b.dateFormat),Nit:t.factura.receptor.nit,Nombre:t.factura.receptor.nombre,Direccion:t.factura.receptor.direccion,Serie:t.factura.serie_factura,Numero:t.factura.numero_factura,Total:p.getTotalDetalle(t.factura.detalle)+p.getTotalImpuestosAdicionales(t.factura.impuestos_adicionales||[]),NoAutorizacion:t.factura.fel_uuid,NombreCertificador:t.factura.certificador_fel.nombre,NitCertificador:t.factura.certificador_fel.nit,FechaDeAutorizacion:t.factura.fecha_autorizacion,NoOrdenEnLinea:"",FormaDePago:"",DetalleFactura:p.procesaDetalleFactura(t.factura.detalle),Impresora:p.data.impresora,ImpuestosAdicionales:t.factura.impuestos_adicionales||[]};p.data.impresora?0==+p.data.impresora.bluetooth?p.socket.emit("print:factura","".concat(JSON.stringify(e))):(e.Fecha=Ee(t.factura.fecha_factura).format(it.b.dateFormatBT),p.printToBT(JSON.stringify(e))):p.socket.emit("print:factura","".concat(JSON.stringify(e))),p.snackBar.open("Imprimiendo factura ".concat(t.factura.serie_factura,"-").concat(t.factura.numero_factura),"Impresi\xf3n",{duration:3e3})}else p.snackBar.open("ERROR: ".concat(t.mensaje),"Impresi\xf3n",{duration:7e3})}))},this.printRecibo=function(t){var e={NombreEmpresa:t.empresa.nombre,NitEmpresa:t.empresa.nit,SedeEmpresa:t.sede.nombre,DireccionEmpresa:t.sede.direccion,Fecha:Ee().format(it.b.dateFormat),Nombre:p.clienteSelected.nombre||t.nombre,Numero:"".concat(t.comanda,"-").concat(t.numero),Total:p.getTotalDetalle(t.detalle)+ +t.propina,Propina:+t.propina,DetalleRecibo:p.procesaDetalleFactura(t.detalle),Impresora:p.data.impresora};p.data.impresora?0==+p.data.impresora.bluetooth?p.socket.emit("print:recibo","".concat(JSON.stringify(e))):(e.Fecha=Ee().format(it.b.dateFormatBT),p.printToBT(JSON.stringify(e))):p.socket.emit("print:recibo","".concat(JSON.stringify(e))),p.snackBar.open("Imprimiendo recibo ".concat(t.comanda,"-").concat(t.numero),"Impresi\xf3n",{duration:3e3})},this.printToBT=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=p.configSrvc.getConfig(it.b.CONSTANTES.RT_ENVIA_COMO_BASE64)?Ie.a.encode(t,!0):t,a=it.b.DEEP_LINK_ANDROID.replace("__INFOBASE64__",e);try{window.location.href=a}catch(n){p.snackBar.open("No se pudo conectar con la aplicaci\xf3n de impresi\xf3n","Comanda",{duration:3e3})}},this.onSelectionChangeFP=function(t){var e=p.lstFormasPago.findIndex(function(e){return+e.forma_pago==+t.value});e>-1&&(p.pideDocumento=1==+p.lstFormasPago[e].pedirdocumento)}}return s(t,[{key:"ngOnInit",value:function(){var t=this;this.esMovil=this.ls.get(it.b.usrTokenVar).enmovil||!1,this.keyboardLayout=it.b.IDIOMA_TECLADO,this.resetFactReq(),this.processData(),this.loadFormasPago(),this.ls.get(it.b.usrTokenVar).sede_uuid&&(this.socket.emit("joinRestaurant",this.ls.get(it.b.usrTokenVar).sede_uuid),this.socket.on("reconnect",function(){return t.socket.emit("joinRestaurant",t.ls.get(it.b.usrTokenVar).sede_uuid)})),this.loadSedes()}},{key:"ngOnDestroy",value:function(){this.endSubs.unsubscribe()}},{key:"calculaPorcentajePropina",value:function(){this.inputData.porcentajePropina=parseFloat((100*this.inputData.montoPropina/this.inputData.totalDeCuenta).toFixed(2)),this.actualizaSaldo()}}]),t}()).\u0275fac=function(t){return new(t||oa)(tt.Nb(N.b),tt.Nb(N.f),tt.Nb(N.a),tt.Nb(P.b),tt.Nb(Ae.a),tt.Nb(Ne),tt.Nb(Re.a),tt.Nb(dt.a),tt.Nb(Ue.a),tt.Nb(je.a),tt.Nb(Se),tt.Nb(Be.a))},oa.\u0275cmp=tt.Hb({type:oa,selectors:[["app-cobrar-pedido"]],inputs:{inputData:"inputData"},decls:67,vars:31,consts:[["mat-dialog-title",""],[4,"ngIf"],["mat-dialog-content","",2,"height","650px"],[1,"row"],[1,"col","m5","s12","mat-elevation-z4","colHeight",2,"overflow-y","auto"],[3,"showAddButton","getClienteEv"],["lstClientes",""],[1,"col","m3","s12","mat-elevation-z4","colHeight",2,"overflow-y","auto"],[1,"table","table-sm","table-borderless","table-striped"],[4,"ngFor","ngForOf"],[1,"col","m4","s12","mat-elevation-z4","colHeight",2,"overflow-y","auto"],["novalidate",""],["frmFormasPago","ngForm"],[1,"fullWidth"],["name","forma_pago","cdkFocusInitial","","required","",3,"ngModel","ngModelChange","selectionChange"],[3,"value",4,"ngFor","ngForOf"],["matInput","","placeholder","monto","name","monto","required","",3,"matKeyboard","ngModel","ngModelChange",4,"ngIf"],["matInput","","placeholder","monto","name","monto","required","",3,"ngModel","ngModelChange",4,"ngIf"],["matInput","","placeholder","Propina","name","propina",3,"matKeyboard","ngModel","ngModelChange",4,"ngIf"],["matInput","","placeholder","Propina","name","propina",3,"ngModel","ngModelChange",4,"ngIf"],["class","fullWidth",4,"ngIf"],["align","end"],["mat-raised-button","","type","button","color","accent",3,"disabled","click"],[1,"table","table-sm"],[1,"text-left"],[1,"text-right"],[1,"col","m8","s8"],["class","table table-sm table-borderless",4,"ngIf"],[1,"col","m4","s4"],[1,"table","table-sm","table-borderless"],[1,"text-right","font-weight-bold"],[1,"text-right","font-weight-bold","totalCuenta",2,"max-width","15%"],[1,"text-right","font-weight-bold",2,"max-width","15%"],[3,"ngClass"],["mat-dialog-actions","","align","end"],[3,"configuracion",4,"ngIf"],["mat-raised-button","","color","accent",3,"disabled","click"],["mat-raised-button","","color","accent",3,"disabled","click",4,"ngIf"],[3,"value"],["matInput","","placeholder","monto","name","monto","required","",3,"matKeyboard","ngModel","ngModelChange"],["matInput","","placeholder","monto","name","monto","required","",3,"ngModel","ngModelChange"],["matInput","","placeholder","Propina","name","propina",3,"matKeyboard","ngModel","ngModelChange"],["matInput","","placeholder","Propina","name","propina",3,"ngModel","ngModelChange"],["matInput","","placeholder","Documento","name","documento",3,"matKeyboard","ngModel","required","ngModelChange",4,"ngIf"],["matInput","","placeholder","Documento","name","documento",3,"ngModel","required","ngModelChange",4,"ngIf"],["matInput","","placeholder","Documento","name","documento",3,"matKeyboard","ngModel","required","ngModelChange"],["matInput","","placeholder","Documento","name","documento",3,"ngModel","required","ngModelChange"],[1,"text-center"],["mat-icon-button","","type","button","color","warn",3,"click"],["name","sede","required","",3,"ngModel","ngModelChange"],["matInput","","type","text","placeholder","Direcci\xf3n de entrega","name","direccion_entrega","maxlength","1000","required","",3,"ngModel","ngModelChange"],["matInput","","type","text","placeholder","Nombre","name","nombre","maxlength","1000",3,"ngModel","ngModelChange"],["matInput","","type","text","placeholder","Tel\xe9fono","name","telefono","maxlength","1000",3,"ngModel","ngModelChange"],[3,"configuracion"]],template:function(t,e){if(1&t&&(tt.Tb(0,"h1",0),tt.Fc(1),tt.Dc(2,qe,2,1,"small",1),tt.Sb(),tt.Tb(3,"div",2),tt.Tb(4,"div",3),tt.Tb(5,"div",4),tt.Tb(6,"app-lista-cliente",5,6),tt.bc("getClienteEv",function(t){return e.setClienteFacturar(t)}),tt.Sb(),tt.Sb(),tt.Tb(8,"div",7),tt.Tb(9,"table",8),tt.Tb(10,"tbody"),tt.Dc(11,$e,6,6,"tr",9),tt.Sb(),tt.Sb(),tt.Sb(),tt.Tb(12,"div",10),tt.Tb(13,"form",11,12),tt.Tb(15,"mat-form-field",13),tt.Tb(16,"mat-label"),tt.Fc(17,"Forma de pago"),tt.Sb(),tt.Tb(18,"mat-select",14),tt.bc("ngModelChange",function(t){return e.formaPago.forma_pago=t})("selectionChange",function(t){return e.onSelectionChangeFP(t)}),tt.Dc(19,ze,2,2,"mat-option",15),tt.Sb(),tt.Sb(),tt.Tb(20,"mat-form-field",13),tt.Dc(21,Ge,1,2,"input",16),tt.Dc(22,We,1,1,"input",17),tt.Sb(),tt.Tb(23,"mat-form-field",13),tt.Dc(24,Ve,1,2,"input",18),tt.Dc(25,Ke,1,1,"input",19),tt.Sb(),tt.Dc(26,Xe,3,2,"mat-form-field",20),tt.Tb(27,"div",21),tt.Tb(28,"button",22),tt.bc("click",function(){return e.addFormaPago()}),tt.Fc(29," Agregar "),tt.Sb(),tt.Sb(),tt.Sb(),tt.Ob(30,"hr"),tt.Tb(31,"table",23),tt.Tb(32,"thead"),tt.Tb(33,"tr"),tt.Tb(34,"th",24),tt.Fc(35,"FP"),tt.Sb(),tt.Tb(36,"th",25),tt.Fc(37,"Mon"),tt.Sb(),tt.Tb(38,"th",25),tt.Fc(39,"Prop"),tt.Sb(),tt.Sb(),tt.Sb(),tt.Tb(40,"tbody"),tt.Dc(41,Ye,13,9,"tr",9),tt.Sb(),tt.Sb(),tt.Sb(),tt.Sb(),tt.Tb(42,"div",3),tt.Tb(43,"div",26),tt.Dc(44,ta,22,5,"table",27),tt.Sb(),tt.Tb(45,"div",28),tt.Tb(46,"table",29),tt.Tb(47,"tbody"),tt.Tb(48,"tr"),tt.Tb(49,"td",30),tt.Fc(50,"TOTAL DE CUENTA:"),tt.Sb(),tt.Tb(51,"td",31),tt.Fc(52),tt.gc(53,"number"),tt.Sb(),tt.Sb(),tt.Tb(54,"tr"),tt.Tb(55,"td",30),tt.Fc(56,"PENDIENTE:"),tt.Sb(),tt.Tb(57,"td",32),tt.Tb(58,"span",33),tt.Fc(59),tt.gc(60,"number"),tt.Sb(),tt.Sb(),tt.Sb(),tt.Sb(),tt.Sb(),tt.Sb(),tt.Sb(),tt.Sb(),tt.Tb(61,"div",34),tt.Dc(62,ea,1,1,"app-cargando",35),tt.Tb(63,"button",36),tt.bc("click",function(){return e.cancelar()}),tt.Fc(64,"Cancelar"),tt.Sb(),tt.Dc(65,aa,2,1,"button",37),tt.Dc(66,na,2,1,"button",37),tt.Sb()),2&t){var a=tt.tc(14);tt.Cb(1),tt.Hc(" Cobrar cuenta de ",e.data.cuenta," "),tt.Cb(1),tt.lc("ngIf",e.clienteSelected&&!!e.clienteSelected.cliente),tt.Cb(4),tt.lc("showAddButton",!0),tt.Cb(5),tt.lc("ngForOf",e.inputData.productosACobrar),tt.Cb(7),tt.lc("ngModel",e.formaPago.forma_pago),tt.Cb(1),tt.lc("ngForOf",e.lstFormasPago),tt.Cb(2),tt.lc("ngIf",!e.esMovil),tt.Cb(1),tt.lc("ngIf",e.esMovil),tt.Cb(2),tt.lc("ngIf",!e.esMovil),tt.Cb(1),tt.lc("ngIf",e.esMovil),tt.Cb(1),tt.lc("ngIf",e.pideDocumento),tt.Cb(2),tt.lc("disabled",!a.form.valid||e.inputData.saldo<=0),tt.Cb(13),tt.lc("ngForOf",e.formasPagoDeCuenta),tt.Cb(3),tt.lc("ngIf",1==+e.data.mesaenuso.mesa.escallcenter),tt.Cb(8),tt.Gc(tt.ic(53,21,e.inputData.totalDeCuenta,"1.2-2")),tt.Cb(6),tt.lc("ngClass",tt.qc(27,ia,+e.inputData.saldo>0,0==+e.inputData.saldo,+e.inputData.saldo<0)),tt.Cb(1),tt.Gc(tt.ic(60,24,e.inputData.saldo,"1.2-2")),tt.Cb(3),tt.lc("ngIf",e.facturando),tt.Cb(1),tt.lc("disabled",e.facturando),tt.Cb(2),tt.lc("ngIf",0==+e.data.mesaenuso.mesa.escallcenter),tt.Cb(1),tt.lc("ngIf",1==+e.data.mesaenuso.mesa.escallcenter)}},directives:[N.g,d.m,N.d,He.a,d.l,m.r,m.l,m.m,T.b,T.f,O.a,m.p,m.k,m.n,E.a,d.k,N.c,j.m,k.b,$.a,m.c,C.a,m.f,Le.a],pipes:[d.f],styles:[".spacer[_ngcontent-%COMP%]{flex:1 1 auto}.totalCuenta[_ngcontent-%COMP%]{border-top:1px solid #000;border-bottom:5px double #000}.colHeight[_ngcontent-%COMP%]{height:400px}.saldo-pendiente[_ngcontent-%COMP%]{color:#da332d;border-bottom:5px double #da332d}.saldo-extra[_ngcontent-%COMP%]{color:#87ceeb;border-bottom:5px double #87ceeb}.saldo-exacto[_ngcontent-%COMP%]{color:green;border-bottom:5px double green}.propina[_ngcontent-%COMP%]{font-style:italic}"]}),oa),ra=i("XiUz");function sa(t,e){if(1&t){var a=tt.Ub();tt.Tb(0,"div",6),tt.Tb(1,"mat-card",7),tt.Ob(2,"mat-card-header"),tt.Tb(3,"mat-card-content"),tt.Rb(4),tt.Tb(5,"div",0),tt.Tb(6,"div",8),tt.Tb(7,"button",9),tt.bc("click",function(){tt.xc(a);var t=e.$implicit;return tt.fc().onConfirm(t.numero)}),tt.Fc(8),tt.Sb(),tt.Sb(),tt.Sb(),tt.Qb(),tt.Sb(),tt.Sb(),tt.Sb()}if(2&t){var n=e.$implicit;tt.Cb(8),tt.Gc(n.numero)}}var la,ua=function t(e,a,n,o){c(this,t),this.titlew=e,this.cantidadPedido=a,this.lblBtnConfirm=n,this.lblBtnDeny=o},da=((la=function(){function t(e,a){c(this,t),this.dialogRef=e,this.data=a,this.pedidos=[],this.datos={respuesta:!1,pedido:""},this.title=a.titlew,this.lblBtnConfirm=a.lblBtnConfirm,this.lblBtnDeny=a.lblBtnDeny,this.cantidadPedido=a.cantidadPedido,console.log(+this.cantidadPedido);for(var n=0;n<+this.cantidadPedido;n++)console.log("asdf"),this.pedidos.push({numero:n+1});console.log(this.pedidos)}return s(t,[{key:"ngOnInit",value:function(){}},{key:"onConfirm",value:function(t){this.datos.respuesta=!0,this.datos.pedido=t,this.dialogRef.close(this.datos)}},{key:"onDismiss",value:function(){this.datos.respuesta=!1,this.dialogRef.close(this.datos)}}]),t}()).\u0275fac=function(t){return new(t||la)(tt.Nb(N.f),tt.Nb(N.a))},la.\u0275cmp=tt.Hb({type:la,selectors:[["app-dialog-pedido"]],decls:9,vars:2,consts:[[1,"row"],["mat-dialog-title",""],["fxFlex","100%","fxFlex.xs","100%",1,"bordeRght"],["fxLayout","row wrap","fxLayoutGap","10px grid","fxFlexFill","","fxLayoutAlign","start start",1,"divContenedor"],["fxFlex","100%","fxLayoutAlign","center start"],["fxFlex","20%","fxFlex.xs","100%","fxFlex.sm","100%","fxFlex.md","50%",4,"ngFor","ngForOf"],["fxFlex","20%","fxFlex.xs","100%","fxFlex.sm","100%","fxFlex.md","50%"],[1,"mat-elevation-z4"],[1,"col"],["mat-raised-button","","color","accent","type","button",3,"click"]],template:function(t,e){1&t&&(tt.Tb(0,"div",0),tt.Tb(1,"h1",1),tt.Fc(2),tt.Sb(),tt.Sb(),tt.Tb(3,"mat-dialog-content"),tt.Tb(4,"div",2),tt.Tb(5,"div",3),tt.Ob(6,"div",4),tt.Dc(7,sa,9,1,"div",5),tt.Sb(),tt.Sb(),tt.Ob(8,"mat-dialog-content"),tt.Sb()),2&t&&(tt.Cb(2),tt.Hc(" ",e.title," "),tt.Cb(5),tt.lc("ngForOf",e.pedidos))},directives:[N.g,N.d,ra.a,ra.c,ra.d,ra.e,ra.b,d.l,y.a,y.d,y.c,E.a],styles:[""]}),la),ba=i("NGYs");function ma(t,e){if(1&t&&(tt.Tb(0,"div"),tt.Tb(1,"h5"),tt.Fc(2),tt.Sb(),tt.Sb()),2&t){var a=tt.fc().$implicit;tt.Cb(2),tt.Hc(" ",a.descripcion," ")}}function fa(t,e){if(1&t&&(tt.Tb(0,"mat-option",12),tt.Fc(1),tt.Sb()),2&t){var a=e.$implicit;tt.lc("value",a),tt.Cb(1),tt.Hc(" ",a.descripcion," ")}}var pa=function(){return{standalone:!0}};function ga(t,e){if(1&t&&(tt.Rb(0),tt.Tb(1,"mat-select",10),tt.bc("ngModelChange",function(t){return e.$implicit.seleccion=t}),tt.Dc(2,fa,2,2,"mat-option",11),tt.Sb(),tt.Ob(3,"mat-divider"),tt.Ob(4,"br"),tt.Qb()),2&t){var a=e.$implicit,n=tt.fc(2).$implicit;tt.Cb(1),tt.lc("ngModel",a.seleccion)("ngModelOptions",tt.nc(3,pa)),tt.Cb(1),tt.lc("ngForOf",n.receta)}}function ha(t,e){if(1&t&&(tt.Tb(0,"div",0),tt.Tb(1,"div",1),tt.Dc(2,ga,5,4,"ng-container",5),tt.Sb(),tt.Sb()),2&t){var a=tt.fc().$implicit;tt.Cb(2),tt.lc("ngForOf",a.input)}}function va(t,e){if(1&t&&(tt.Tb(0,"div"),tt.Dc(1,ma,3,1,"div",8),tt.Dc(2,ha,3,1,"div",9),tt.Sb()),2&t){var a=e.$implicit;tt.Cb(1),tt.lc("ngIf",a.receta.length>0),tt.Cb(1),tt.lc("ngIf",a.receta.length>0)}}var Sa,Ca=function t(e,a,n){c(this,t),this.producto=e,this.lblBtnConfirm=a,this.lblBtnDeny=n},Ta=((Sa=function(){function t(e,a,n,i,r){var s=this;c(this,t),this.dialogRef=e,this.data=a,this.articuloSvr=n,this.snackBar=i,this.ls=r,this.esMovil=!1,this.getArticulos=function(){s.articuloSvr.getArticuloCombo({articulo:s.producto.id}).subscribe(function(t){s.combo=t;for(var e=0;e<s.combo.receta.length;e++){var a=s.combo.receta[e];if(s.combo.receta[e].seleccionado=!1,1==+a.multiple){for(var n=[],o=0;o<+s.combo.receta[e].cantidad_maxima;o++)n.push({id:o,seleccion:{}});s.combo.receta[e].input=n}else s.seleccion.receta.push(s.combo.receta[e])}})},this.setCantidad=function(){for(var t=0;t<s.combo.receta.length;t++)if(1==+s.combo.receta[t].multiple){for(var e=[],a=0;a<+s.combo.receta[t].cantidad_maxima*s.seleccion.cantidad;a++)e.push({id:a,seleccion:{}});s.combo.receta[t].input=e}},this.todosSeleccionados=function(t){var e,a=!0,n=o(t);try{t:for(n.s();!(e=n.n()).done;){var i,c=o(e.value.input);try{for(c.s();!(i=c.n()).done;)if(void 0===i.value.seleccion.articulo){a=!1;break t}}catch(r){c.e(r)}finally{c.f()}}}catch(r){n.e(r)}finally{n.f()}return a},this.datos={respuesta:!1,seleccion:[]},this.lblBtnConfirm=a.lblBtnConfirm,this.lblBtnDeny=a.lblBtnDeny,this.producto=a.producto,this.seleccion={cantidad:1,articulo:this.producto.id,descripcion:this.producto.nombre,receta:[]}}return s(t,[{key:"ngOnInit",value:function(){this.esMovil=this.ls.get(it.b.usrTokenVar).enmovil||!1,this.keyboardLayout=it.b.IDIOMA_TECLADO,this.combo=[],this.getArticulos()}},{key:"onConfirm",value:function(){var t=this,e=this.combo.receta.filter(function(t){return 1==+t.multiple});if(this.todosSeleccionados(e)){var a,n=o(e);try{var i=function(){var e=a.value;t.seleccion.receta.push({articulo:e.articulo,descripcion:e.descripcion,receta:[]});var n,i=t.seleccion.receta.findIndex(function(t){return+t.articulo==+e.articulo}),c=o(e.input);try{for(c.s();!(n=c.n()).done;){var r=n.value;t.seleccion.receta[i].receta.push(r.seleccion)}}catch(s){c.e(s)}finally{c.f()}};for(n.s();!(a=n.n()).done;)i()}catch(c){n.e(c)}finally{n.f()}this.datos.respuesta=!0,this.datos.seleccion=this.seleccion,this.dialogRef.close(this.datos)}else this.snackBar.open("Por favor seleccione todas las opciones para completar.","Combos",{duration:7e3})}},{key:"onDismiss",value:function(){this.datos.respuesta=!1,this.dialogRef.close(this.datos)}}]),t}()).\u0275fac=function(t){return new(t||Sa)(tt.Nb(N.f),tt.Nb(N.a),tt.Nb(ba.a),tt.Nb(P.b),tt.Nb(dt.a))},Sa.\u0275cmp=tt.Hb({type:Sa,selectors:[["app-dialog-combo"]],decls:16,vars:4,consts:[[1,"row"],[1,"col","m12","s12"],[1,"fullWidth"],["type","number","matInput","","placeholder","Cantidad","min","1","step","1",3,"ngModel","ngModelOptions","change","ngModelChange"],[1,"col-sm-12"],[4,"ngFor","ngForOf"],["align","right",1,"row","text-right"],["mat-raised-button","","color","accent",1,"btnAccion",3,"click"],[4,"ngIf"],["class","row",4,"ngIf"],[3,"ngModel","ngModelOptions","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(t,e){1&t&&(tt.Tb(0,"mat-dialog-content"),tt.Tb(1,"div",0),tt.Tb(2,"div",1),tt.Tb(3,"h5"),tt.Fc(4,"Cantidad"),tt.Sb(),tt.Tb(5,"mat-form-field",2),tt.Tb(6,"input",3),tt.bc("change",function(){return e.setCantidad()})("ngModelChange",function(t){return e.seleccion.cantidad=t}),tt.Sb(),tt.Sb(),tt.Sb(),tt.Sb(),tt.Tb(7,"div",0),tt.Tb(8,"div",4),tt.Dc(9,va,3,2,"div",5),tt.Sb(),tt.Sb(),tt.Tb(10,"div",6),tt.Tb(11,"div",1),tt.Tb(12,"button",7),tt.bc("click",function(){return e.onDismiss()}),tt.Fc(13," Cancelar "),tt.Sb(),tt.Tb(14,"button",7),tt.bc("click",function(){return e.onConfirm()}),tt.Fc(15," Aceptar "),tt.Sb(),tt.Sb(),tt.Sb(),tt.Sb()),2&t&&(tt.Cb(6),tt.lc("ngModel",e.seleccion.cantidad)("ngModelOptions",tt.nc(3,pa)),tt.Cb(3),tt.lc("ngForOf",e.combo.receta))},directives:[N.d,T.b,m.o,k.b,m.c,m.k,m.n,d.l,E.a,d.m,O.a,M.a,j.m],styles:[""]}),Sa);function ka(t,e){if(1&t){var a=tt.Ub();tt.Tb(0,"textarea",9),tt.bc("ngModelChange",function(t){return tt.xc(a),tt.fc().data.notasGenerales=t}),tt.Sb()}if(2&t){var n=tt.fc();tt.lc("matKeyboard",n.keyboardLayout)("ngModel",n.data.notasGenerales)}}function ya(t,e){if(1&t){var a=tt.Ub();tt.Tb(0,"textarea",10),tt.bc("ngModelChange",function(t){return tt.xc(a),tt.fc().data.notasGenerales=t}),tt.Sb()}if(2&t){var n=tt.fc();tt.lc("ngModel",n.data.notasGenerales)}}var Ma,Fa,xa=((Fa=function(){function t(e,a,n){var o=this;c(this,t),this.dialogRef=e,this.data=a,this.ls=n,this.keyboardLayout=it.b.IDIOMA_TECLADO,this.esMovil=!1,this.terminar=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return o.dialogRef.close(t)}}return s(t,[{key:"ngOnInit",value:function(){this.esMovil=this.ls.get(it.b.usrTokenVar).enmovil||!1}}]),t}()).\u0275fac=function(t){return new(t||Fa)(tt.Nb(N.f),tt.Nb(N.a),tt.Nb(dt.a))},Fa.\u0275cmp=tt.Hb({type:Fa,selectors:[["app-notas-generales-comanda"]],decls:13,vars:2,consts:[["mat-dialog-title",""],["novalidate",""],["frmNotasGenCom","ngForm"],[1,"fullWidth"],["matInput","","placeholder","Notas generales","name","notasGenerales","maxlength","1000",3,"matKeyboard","ngModel","ngModelChange",4,"ngIf"],["matInput","","placeholder","Notas generales","name","notasGenerales","maxlength","1000",3,"ngModel","ngModelChange",4,"ngIf"],["align","end"],["mat-raised-button","","color","secondary",1,"btnAccion",3,"click"],["mat-raised-button","","color","accent",3,"click"],["matInput","","placeholder","Notas generales","name","notasGenerales","maxlength","1000",3,"matKeyboard","ngModel","ngModelChange"],["matInput","","placeholder","Notas generales","name","notasGenerales","maxlength","1000",3,"ngModel","ngModelChange"]],template:function(t,e){1&t&&(tt.Tb(0,"h1",0),tt.Fc(1,"Notas generales de comanda"),tt.Sb(),tt.Tb(2,"mat-dialog-content"),tt.Tb(3,"form",1,2),tt.Tb(5,"mat-form-field",3),tt.Dc(6,ka,1,2,"textarea",4),tt.Dc(7,ya,1,1,"textarea",5),tt.Sb(),tt.Sb(),tt.Sb(),tt.Tb(8,"mat-dialog-actions",6),tt.Tb(9,"button",7),tt.bc("click",function(){return e.terminar()}),tt.Fc(10," Cancelar "),tt.Sb(),tt.Tb(11,"button",8),tt.bc("click",function(){return e.terminar(e.data.notasGenerales)}),tt.Fc(12," Guardar "),tt.Sb(),tt.Sb()),2&t&&(tt.Cb(6),tt.lc("ngIf",!e.esMovil),tt.Cb(1),tt.lc("ngIf",e.esMovil))},directives:[N.g,N.d,m.r,m.l,m.m,T.b,d.m,N.c,E.a,k.b,$.a,m.c,m.f,m.k,m.n],styles:[""]}),Fa),Oa=((Ma=function(){function t(e,a,n,o){var i=this;c(this,t),this.dialogRef=e,this.snackBar=a,this.comandaSrvc=n,this.data=o,this.cancelar=function(){return i.dialogRef.close(!1)},this.guardar=function(){i.nuevaCuenta.nombre&&(i.comanda.cuentas.findIndex(function(t){return t.nombre.toUpperCase().trim()===i.nuevaCuenta.nombre.toUpperCase().trim()})<0?(i.comanda.cuentas.push(i.nuevaCuenta),i.comandaSrvc.save(i.comanda).subscribe(function(t){t.exito?(i.snackBar.open("Cuenta agregada con \xe9xito","Cuentas",{duration:3e3}),i.dialogRef.close(!0)):i.snackBar.open("ERROR: ".concat(t.mensaje),"Cuentas",{duration:7e3})})):i.snackBar.open("Ya existe una cuenta con ese nombre. Por favor ingrese otro nombre.","Cuentas",{duration:7e3}))}}return s(t,[{key:"ngOnInit",value:function(){if(+this.data.mesaEnUso.comanda>0){var t=this.data.mesaEnUso;this.comanda={area:+t.mesa.area.area,mesa:+t.mesa.mesa,mesero:+t.mesero.usuario,comensales:t.cuentas.length+1,dividirCuentasPorSillas:1,comanda:+t.comanda,cuentas:t.cuentas,replaceUnica:!1},this.nuevaCuenta={cuenta:0,numero:this.comanda.cuentas.length+1,nombre:void 0,productos:[]}}}}]),t}()).\u0275fac=function(t){return new(t||Ma)(tt.Nb(N.f),tt.Nb(P.b),tt.Nb(Se),tt.Nb(N.a))},Ma.\u0275cmp=tt.Hb({type:Ma,selectors:[["app-nueva-cuenta"]],decls:12,vars:3,consts:[["mat-dialog-title",""],["mat-dialog-content",""],["novalidate",""],["frmNuevaCuenta","ngForm"],[1,"fullWidth"],["type","text","matInput","","placeholder","Nombre","name","nombre","required","",3,"ngModel","ngModelChange"],["mat-dialog-actions","","align","end"],["mat-raised-button","","color","warn",3,"click"],["mat-raised-button","","type","button","color","accent",3,"disabled","click"]],template:function(t,e){if(1&t&&(tt.Tb(0,"h1",0),tt.Fc(1),tt.Sb(),tt.Tb(2,"div",1),tt.Tb(3,"form",2,3),tt.Tb(5,"mat-form-field",4),tt.Tb(6,"input",5),tt.bc("ngModelChange",function(t){return e.nuevaCuenta.nombre=t}),tt.Sb(),tt.Sb(),tt.Sb(),tt.Sb(),tt.Tb(7,"div",6),tt.Tb(8,"button",7),tt.bc("click",function(){return e.cancelar()}),tt.Fc(9," Cancelar "),tt.Sb(),tt.Tb(10,"button",8),tt.bc("click",function(){return e.guardar()}),tt.Fc(11," Guardar "),tt.Sb(),tt.Sb()),2&t){var a=tt.tc(4);tt.Cb(1),tt.Hc("Nueva cuenta - Comanda #",e.data.mesaEnUso.comanda,""),tt.Cb(5),tt.lc("ngModel",e.nuevaCuenta.nombre),tt.Cb(4),tt.lc("disabled",!a.form.valid)}},directives:[N.g,N.d,m.r,m.l,m.m,T.b,k.b,m.c,m.p,m.k,m.n,N.c,E.a],styles:[""]}),Ma);function Da(t,e){if(1&t&&(tt.Tb(0,"mat-option",12),tt.Fc(1),tt.Sb()),2&t){var a=e.$implicit,n=tt.fc().$implicit;tt.lc("value",+a.cuenta)("disabled",1==+a.cerrada||+n.idcuenta==+a.cuenta),tt.Cb(1),tt.Hc(" ",a.nombre," ")}}function Ea(t,e){if(1&t&&(tt.Tb(0,"tr"),tt.Tb(1,"td"),tt.Fc(2),tt.Sb(),tt.Tb(3,"td",7),tt.Tb(4,"mat-form-field",8),tt.Tb(5,"input",9),tt.bc("ngModelChange",function(t){return e.$implicit.cantidad=t}),tt.Sb(),tt.Sb(),tt.Sb(),tt.Tb(6,"td"),tt.Tb(7,"mat-select",10),tt.bc("ngModelChange",function(t){return e.$implicit.idcuenta=t}),tt.Dc(8,Da,2,3,"mat-option",11),tt.Sb(),tt.Sb(),tt.Sb()),2&t){var a=e.$implicit,n=e.index,o=tt.fc();tt.Cb(2),tt.Gc(a.nombre),tt.Cb(3),tt.lc("max",o.cantidadProducto[n])("ngModel",a.cantidad)("disabled",1==+a.combo),tt.Cb(2),tt.lc("ngModel",a.idcuenta),tt.Cb(1),tt.lc("ngForOf",o.comanda.cuentas)}}var Pa,_a=((Pa=function(){function t(e,a,n,i){var r=this;c(this,t),this.dialogRef=e,this.snackBar=a,this.comandaSrvc=n,this.data=i,this.cantidadProducto=[],this.cpLstProductos=[],this.compLstProductos=[],this.cancelar=function(){return r.dialogRef.close(!1)},this.guardar=function(){var t,e=[],a=0,n=o(r.cpLstProductos);try{for(n.s();!(t=n.n()).done;){var i=t.value;+i.idcuenta!=+r.compLstProductos[a].idcuenta&&e.push({detalle_comanda:+i.detalle_comanda,cuenta:+i.idcuenta,cantidad:+i.cantidad}),a++}}catch(c){n.e(c)}finally{n.f()}e.length>0?r.comandaSrvc.distribuirCuentas(e).subscribe(function(t){t.exito?(r.snackBar.open("Productos redistribuidos","Cuentas",{duration:3e3}),r.dialogRef.close(!0)):(r.snackBar.open("ERROR: ".concat(t.mensaje),"Cuentas",{duration:7e3}),r.cancelar())}):(r.snackBar.open("Sin cambios en las cuentas.","Cuentas",{duration:7e3}),r.dialogRef.close(!0))}}return s(t,[{key:"ngOnInit",value:function(){var t=this;if(+this.data.mesaEnUso.comanda>0){var e=this.data.mesaEnUso;this.comanda={area:+e.mesa.area.area,mesa:+e.mesa.mesa,mesero:+e.mesero.usuario,comensales:e.cuentas.length+1,dividirCuentasPorSillas:1,comanda:+e.comanda,cuentas:e.cuentas,replaceUnica:!1}}this.cpLstProductos=[],this.data.lstProductos.length>0&&(this.data.lstProductos.forEach(function(e){0==+t.data.mesaEnUso.cuentas.find(function(t){return+t.cuenta==+e.idcuenta}).cerrada&&(t.cpLstProductos.push(e),t.cantidadProducto.push(+e.cantidad))}),this.cpLstProductos=JSON.parse(JSON.stringify(this.cpLstProductos)),this.compLstProductos=JSON.parse(JSON.stringify(this.cpLstProductos)))}}]),t}()).\u0275fac=function(t){return new(t||Pa)(tt.Nb(N.f),tt.Nb(P.b),tt.Nb(Se),tt.Nb(N.a))},Pa.\u0275cmp=tt.Hb({type:Pa,selectors:[["app-distribuir-productos-cuentas"]],decls:17,vars:2,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[1,"rtxt","size-cantidad"],[4,"ngFor","ngForOf"],["mat-dialog-actions","","align","end"],["mat-raised-button","","color","warn",3,"click"],["mat-raised-button","","type","button","color","accent",3,"click"],[1,"rtxt"],[1,"size-cantidad"],["type","number","matInput","","name","cantidad","min","1","required","",3,"max","ngModel","disabled","ngModelChange"],["name","cuenta","required","",3,"ngModel","ngModelChange"],[3,"value","disabled",4,"ngFor","ngForOf"],[3,"value","disabled"]],template:function(t,e){1&t&&(tt.Tb(0,"h1",0),tt.Fc(1),tt.Sb(),tt.Tb(2,"div",1),tt.Tb(3,"table"),tt.Tb(4,"tr"),tt.Tb(5,"th"),tt.Fc(6,"Art\xedculo"),tt.Sb(),tt.Tb(7,"th",2),tt.Fc(8,"Cantidad"),tt.Sb(),tt.Tb(9,"th"),tt.Fc(10,"Cuenta"),tt.Sb(),tt.Sb(),tt.Dc(11,Ea,9,6,"tr",3),tt.Sb(),tt.Sb(),tt.Tb(12,"div",4),tt.Tb(13,"button",5),tt.bc("click",function(){return e.cancelar()}),tt.Fc(14," Cancelar "),tt.Sb(),tt.Tb(15,"button",6),tt.bc("click",function(){return e.guardar()}),tt.Fc(16," Guardar "),tt.Sb(),tt.Sb()),2&t&&(tt.Cb(1),tt.Hc("Distribuci\xf3n de productos - Comanda #",e.data.mesaEnUso.comanda,""),tt.Cb(10),tt.lc("ngForOf",e.cpLstProductos))},directives:[N.g,N.d,d.l,N.c,E.a,T.b,m.o,k.b,m.c,m.p,m.k,m.n,O.a,j.m],styles:[".size-cantidad[_ngcontent-%COMP%]{width:25%}"]}),Pa);function Ia(t,e){if(1&t){var a=tt.Ub();tt.Tb(0,"button",0),tt.bc("click",function(){return tt.xc(a),tt.fc().comandar()}),tt.Fc(1,"Comanda"),tt.Sb()}if(2&t){var n=tt.fc();tt.lc("disabled",!n.data.tranComanda.cuentaActiva.nombre||n.data.tranComanda.bloqueoBotones)}}function wa(t,e){if(1&t){var a=tt.Ub();tt.Tb(0,"button",0),tt.bc("click",function(){return tt.xc(a),tt.fc().imprimirCuenta()}),tt.Fc(1,"Cuenta"),tt.Sb()}if(2&t){var n=tt.fc();tt.lc("disabled",!n.data.tranComanda.cuentaActiva.nombre||n.data.tranComanda.bloqueoBotones)}}function Aa(t,e){if(1&t){var a=tt.Ub();tt.Tb(0,"button",0),tt.bc("click",function(){return tt.xc(a),tt.fc().distribuirProductos()}),tt.Fc(1,"Distribuir"),tt.Sb()}if(2&t){var n=tt.fc();tt.lc("disabled",n.data.tranComanda.mesaEnUso.cuentas.length<2||n.data.tranComanda.bloqueoBotones)}}function Na(t,e){if(1&t){var a=tt.Ub();tt.Tb(0,"button",0),tt.bc("click",function(){return tt.xc(a),tt.fc().unirCuentas()}),tt.Fc(1,"Unir cuentas"),tt.Sb()}if(2&t){var n=tt.fc();tt.lc("disabled",n.data.tranComanda.mesaEnUso.cuentas.length<2||n.data.tranComanda.bloqueoBotones)}}function Ra(t,e){if(1&t){var a=tt.Ub();tt.Tb(0,"button",0),tt.bc("click",function(){return tt.xc(a),tt.fc().cobrarCuenta()}),tt.Fc(1,"Cobrar cuenta"),tt.Sb()}if(2&t){var n=tt.fc();tt.lc("disabled",!n.data.tranComanda.cuentaActiva.nombre||n.data.tranComanda.esCajero()||n.data.tranComanda.bloqueoBotones)}}function Ua(t,e){if(1&t){var a=tt.Ub();tt.Tb(0,"button",0),tt.bc("click",function(){return tt.xc(a),tt.fc().enviarPedido()}),tt.Fc(1,"Enviar pedido"),tt.Sb()}if(2&t){var n=tt.fc();tt.lc("disabled",!n.data.tranComanda.cuentaActiva.nombre||n.data.tranComanda.esCajero()||n.data.tranComanda.bloqueoBotones)}}function ja(t,e){if(1&t){var a=tt.Ub();tt.Tb(0,"button",0),tt.bc("click",function(){return tt.xc(a),tt.fc().trasladarMesa()}),tt.Fc(1,"Trasladar"),tt.Sb()}if(2&t){var n=tt.fc();tt.lc("disabled",n.data.tranComanda.bloqueoBotones)}}function Ba(t,e){if(1&t){var a=tt.Ub();tt.Tb(0,"button",3),tt.bc("click",function(){return tt.xc(a),tt.fc().cerrarMesa()}),tt.Fc(1),tt.Sb()}if(2&t){var n=tt.fc();tt.Cb(1),tt.Hc("Cerrar ",0==+n.data.tranComanda.mesaEnUso.mesa.esmostrador?"Mesa":0==+n.data.tranComanda.mesaEnUso.mesa.escallcenter?"Mostrador":"Pedido","")}}var Ha,La=((Ha=function(){function t(e,a){var n=this;c(this,t),this.bsAccionesComanda=e,this.data=a,this.cerrar=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{cerrar:!1};return n.bsAccionesComanda.dismiss(t)},this.notasGenerales=function(){n.data.tranComanda.getNotasGenerales(),n.cerrar()},this.comandar=function(){n.data.tranComanda.validarImpresion(!1,n.data.dialogRef),n.cerrar()},this.imprimirCuenta=function(){n.data.tranComanda.printCuenta(n.data.dialogRef),n.cerrar()},this.distribuirProductos=function(){n.data.tranComanda.distribuirProductos(n.data.dialogRef),n.cerrar()},this.unirCuentas=function(){n.data.tranComanda.unirCuentas(n.data.dialogRef),n.cerrar()},this.cobrarCuenta=function(){n.data.tranComanda.cobrarCuenta(n.data.dialogRef),n.cerrar()},this.enviarPedido=function(){n.data.tranComanda.enviarPedido(n.data.dialogRef),n.cerrar()},this.trasladarMesa=function(){n.data.tranComanda.trasladoMesa(n.data.dialogRef),n.cerrar()},this.cerrarMesa=function(){n.data.tranComanda.cerrarMesa(),n.cerrar({cerrar:!0,mesaEnUso:n.data.tranComanda.mesaEnUso})}}return s(t,[{key:"ngOnInit",value:function(){}}]),t}()).\u0275fac=function(t){return new(t||Ha)(tt.Nb(q.d),tt.Nb(q.a))},Ha.\u0275cmp=tt.Hb({type:Ha,selectors:[["app-acciones-comanda"]],decls:11,vars:9,consts:[["mat-list-item","",1,"accion-comanda","mat-elevation-z4",3,"disabled","click"],["class","accion-comanda mat-elevation-z4","mat-list-item","",3,"disabled","click",4,"ngIf"],["class","accion-comanda mat-elevation-z4","mat-list-item","",3,"click",4,"ngIf"],["mat-list-item","",1,"accion-comanda","mat-elevation-z4",3,"click"]],template:function(t,e){1&t&&(tt.Tb(0,"mat-action-list"),tt.Tb(1,"button",0),tt.bc("click",function(){return e.notasGenerales()}),tt.Fc(2,"Notas"),tt.Sb(),tt.Dc(3,Ia,2,1,"button",1),tt.Dc(4,wa,2,1,"button",1),tt.Dc(5,Aa,2,1,"button",1),tt.Dc(6,Na,2,1,"button",1),tt.Dc(7,Ra,2,1,"button",1),tt.Dc(8,Ua,2,1,"button",1),tt.Dc(9,ja,2,1,"button",1),tt.Dc(10,Ba,2,1,"button",2),tt.Sb()),2&t&&(tt.Cb(1),tt.lc("disabled",e.data.tranComanda.bloqueoBotones),tt.Cb(2),tt.lc("ngIf",0==+e.data.tranComanda.mesaEnUso.mesa.escallcenter),tt.Cb(1),tt.lc("ngIf",0==+e.data.tranComanda.mesaEnUso.mesa.esmostrador),tt.Cb(1),tt.lc("ngIf",0==+e.data.tranComanda.mesaEnUso.mesa.esmostrador),tt.Cb(1),tt.lc("ngIf",0==+e.data.tranComanda.mesaEnUso.mesa.esmostrador),tt.Cb(1),tt.lc("ngIf",0==+e.data.tranComanda.mesaEnUso.mesa.escallcenter),tt.Cb(1),tt.lc("ngIf",1==+e.data.tranComanda.mesaEnUso.mesa.escallcenter),tt.Cb(1),tt.lc("ngIf",0==+e.data.tranComanda.mesaEnUso.mesa.esmostrador),tt.Cb(1),tt.lc("ngIf",e.data.tranComanda.lstProductosSeleccionados.length<=0))},directives:[S.a,S.c,d.m],styles:[".accion-comanda[_ngcontent-%COMP%]{background-color:#f3d852;font-weight:700;text-align:center;margin:10px 0}"]}),Ha),qa=i("FHMA");function $a(t,e){if(1&t){var a=tt.Ub();tt.Tb(0,"input",9),tt.bc("ngModelChange",function(t){return tt.xc(a),tt.fc().data.pwd=t}),tt.Sb()}if(2&t){var n=tt.fc();tt.lc("matKeyboard",n.keyboardLayout)("ngModel",n.data.pwd)}}function za(t,e){if(1&t){var a=tt.Ub();tt.Tb(0,"input",10),tt.bc("ngModelChange",function(t){return tt.xc(a),tt.fc().data.pwd=t}),tt.Sb()}if(2&t){var n=tt.fc();tt.lc("ngModel",n.data.pwd)}}var Ga,Wa,Va=((Ga=function(){function t(e,a,n){var o=this;c(this,t),this.dialogRef=e,this.comandaSrvc=a,this.ls=n,this.data={pwd:void 0},this.keyboardLayout=it.b.IDIOMA_TECLADO,this.esMovil=!1,this.cancelar=function(){return o.dialogRef.close()},this.terminar=function(){o.comandaSrvc.validaPwdGerenteTurno(o.data.pwd).subscribe(function(t){o.dialogRef.close(!!t.exito&&t.esgerente)})}}return s(t,[{key:"ngOnInit",value:function(){this.esMovil=this.ls.get(it.b.usrTokenVar).enmovil||!1}}]),t}()).\u0275fac=function(t){return new(t||Ga)(tt.Nb(N.f),tt.Nb(Se),tt.Nb(dt.a))},Ga.\u0275cmp=tt.Hb({type:Ga,selectors:[["app-valida-pwd-gerente-turno"]],decls:13,vars:3,consts:[["mat-dialog-title",""],["novalidate","",3,"ngSubmit"],["frmValidarPwdGerenteTurno","ngForm"],[1,"fullWidth"],["type","password","matInput","","placeholder","Contrase\xf1a del gerente de turno","name","pwd","required","",3,"matKeyboard","ngModel","ngModelChange",4,"ngIf"],["type","password","matInput","","placeholder","Contrase\xf1a del gerente de turno","name","pwd","required","",3,"ngModel","ngModelChange",4,"ngIf"],["align","end"],["mat-raised-button","","color","secondary",1,"btnAccion",3,"click"],["mat-raised-button","","color","accent",3,"disabled","click"],["type","password","matInput","","placeholder","Contrase\xf1a del gerente de turno","name","pwd","required","",3,"matKeyboard","ngModel","ngModelChange"],["type","password","matInput","","placeholder","Contrase\xf1a del gerente de turno","name","pwd","required","",3,"ngModel","ngModelChange"]],template:function(t,e){if(1&t){var a=tt.Ub();tt.Tb(0,"h1",0),tt.Fc(1,"Contrase\xf1a del gerente de turno"),tt.Sb(),tt.Tb(2,"mat-dialog-content"),tt.Tb(3,"form",1,2),tt.bc("ngSubmit",function(){return tt.xc(a),tt.tc(4).form.valid}),tt.Tb(5,"mat-form-field",3),tt.Dc(6,$a,1,2,"input",4),tt.Dc(7,za,1,1,"input",5),tt.Sb(),tt.Sb(),tt.Sb(),tt.Tb(8,"mat-dialog-actions",6),tt.Tb(9,"button",7),tt.bc("click",function(){return e.cancelar()}),tt.Fc(10," Cancelar "),tt.Sb(),tt.Tb(11,"button",8),tt.bc("click",function(){return e.terminar()}),tt.Fc(12," Eliminar producto "),tt.Sb(),tt.Sb()}if(2&t){var n=tt.tc(4);tt.Cb(6),tt.lc("ngIf",!e.esMovil),tt.Cb(1),tt.lc("ngIf",e.esMovil),tt.Cb(4),tt.lc("disabled",!n.form.valid)}},directives:[N.g,N.d,m.r,m.l,m.m,T.b,d.m,N.c,E.a,k.b,$.a,m.c,m.p,m.k,m.n],styles:[""]}),Ga),Ka=function(){return{standalone:!0}},Ja=function t(e){c(this,t),this.producto=e},Qa=((Wa=function(){function t(e,a,n){c(this,t),this.dialogRef=e,this.data=a,this.snackBar=n,this.datos={},this.prod=a.producto,this.cantidad=this.prod.cantidad,this.datos={respuesta:!1,producto:null}}return s(t,[{key:"ngOnInit",value:function(){}},{key:"onConfirm",value:function(){this.cantidad<1||this.cantidad>this.prod.cantidad?this.snackBar.open("La cantidad debe estar entre 1 y "+this.prod.cantidad,"Error",{duration:5e3}):(this.datos.respuesta=!0,this.prod.cantidad-=this.cantidad,this.datos.producto=this.prod,this.dialogRef.close(this.datos))}},{key:"onDismiss",value:function(){this.datos.respuesta=!1,this.dialogRef.close(this.datos)}}]),t}()).\u0275fac=function(t){return new(t||Wa)(tt.Nb(N.f),tt.Nb(N.a),tt.Nb(P.b))},Wa.\u0275cmp=tt.Hb({type:Wa,selectors:[["app-dialog-elminar-producto"]],decls:13,vars:4,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[1,"fullWidth"],["type","number","matInput","","placeholder","Cantidad","min","1","step","1",3,"max","ngModel","ngModelOptions","ngModelChange"],["mat-dialog-actions","","align","center"],["mat-raised-button","",1,"btnConfig",3,"click"],["mat-raised-button","","color","accent",1,"btnConfig",3,"click"]],template:function(t,e){1&t&&(tt.Tb(0,"h1",0),tt.Fc(1," Eliminar Articulos "),tt.Sb(),tt.Tb(2,"div",1),tt.Tb(3,"p"),tt.Fc(4,"Seleccione la cantidad que desea eliminar"),tt.Sb(),tt.Sb(),tt.Tb(5,"form"),tt.Tb(6,"mat-form-field",2),tt.Tb(7,"input",3),tt.bc("ngModelChange",function(t){return e.cantidad=t}),tt.Sb(),tt.Sb(),tt.Sb(),tt.Tb(8,"div",4),tt.Tb(9,"button",5),tt.bc("click",function(){return e.onDismiss()}),tt.Fc(10,"Cancelar"),tt.Sb(),tt.Tb(11,"button",6),tt.bc("click",function(){return e.onConfirm()}),tt.Fc(12,"Aceptar"),tt.Sb(),tt.Sb()),2&t&&(tt.Cb(7),tt.mc("max",e.prod.cantidad),tt.lc("ngModel",e.cantidad)("ngModelOptions",tt.nc(3,Ka)))},directives:[N.g,N.d,m.r,m.l,m.m,T.b,m.o,k.b,m.c,m.k,m.n,N.c,E.a],styles:[""]}),Wa);function Xa(t,e){if(1&t&&(tt.Tb(0,"mat-list-item"),tt.Tb(1,"div",3),tt.Tb(2,"span",4),tt.Fc(3),tt.gc(4,"number"),tt.Sb(),tt.Sb(),tt.Sb()),2&t){var a=tt.fc();tt.Cb(3),tt.Jc(" ",a.cantidadDeProductos," ",a.cantidadDeProductos>1?"art\xedculos":"art\xedculo"," por ",tt.ic(4,3,a.totalDeProductos,"1.2-2")," ")}}function Ya(t,e){if(1&t&&(tt.Tb(0,"span"),tt.Fc(1),tt.Sb()),2&t){var a=tt.fc(2).$implicit;tt.Cb(1),tt.Gc(a.cantidad)}}function Za(t,e){if(1&t&&(tt.Tb(0,"div",3),tt.Tb(1,"span",13),tt.Fc(2),tt.Sb(),tt.Sb()),2&t){var a=e.$implicit;tt.Cb(2),tt.Gc(a)}}function tn(t,e){if(1&t&&(tt.Rb(0),tt.Dc(1,Za,3,1,"div",12),tt.Qb()),2&t){var a=tt.fc(2).$implicit;tt.Cb(1),tt.lc("ngForOf",a.detalle)}}function en(t,e){if(1&t){var a=tt.Ub();tt.Tb(0,"button",17),tt.bc("click",function(){tt.xc(a);var t=tt.fc(3),e=t.$implicit,n=t.index;return tt.fc().removeProducto(e,n)}),tt.Tb(1,"mat-icon",18),tt.Fc(2,"remove_circle"),tt.Sb(),tt.Sb()}if(2&t){var n=tt.fc(4);tt.lc("disabled",n.bloqueoBotones)}}function an(t,e){if(1&t){var a=tt.Ub();tt.Tb(0,"eco-fab-speed-dial",14),tt.Tb(1,"eco-fab-speed-dial-trigger"),tt.Tb(2,"button",15),tt.Tb(3,"mat-icon",16),tt.Fc(4,"keyboard_arrow_left"),tt.Sb(),tt.Sb(),tt.Sb(),tt.Tb(5,"eco-fab-speed-dial-actions"),tt.Tb(6,"button",17),tt.bc("click",function(){tt.xc(a);var t=tt.fc(2),e=t.$implicit,n=t.index;return tt.fc().deleteProductoFromList(e,n)}),tt.Tb(7,"mat-icon",18),tt.Fc(8,"delete_forever"),tt.Sb(),tt.Sb(),tt.Dc(9,en,3,1,"button",19),tt.Tb(10,"button",20),tt.bc("click",function(){tt.xc(a);var t=tt.fc(2).$implicit;return tt.fc().toggleShowInputNotas(t)}),tt.Tb(11,"mat-icon",18),tt.Fc(12,"notes"),tt.Sb(),tt.Sb(),tt.Sb(),tt.Sb()}if(2&t){var n=tt.fc(2).$implicit,o=tt.fc();tt.Cb(6),tt.lc("disabled",o.bloqueoBotones),tt.Cb(3),tt.lc("ngIf",n.detalle.length<=1),tt.Cb(1),tt.lc("disabled",o.bloqueoBotones)}}function nn(t,e){if(1&t){var a=tt.Ub();tt.Tb(0,"eco-fab-speed-dial",14),tt.Tb(1,"eco-fab-speed-dial-trigger"),tt.Tb(2,"button",15),tt.Tb(3,"mat-icon",16),tt.Fc(4,"keyboard_arrow_left"),tt.Sb(),tt.Sb(),tt.Sb(),tt.Tb(5,"eco-fab-speed-dial-actions"),tt.Tb(6,"button",17),tt.bc("click",function(){tt.xc(a);var t=tt.fc(2),e=t.$implicit,n=t.index;return tt.fc().deleteProductoFromListAfterPrinted(e,n)}),tt.Tb(7,"mat-icon",18),tt.Fc(8,"delete_forever"),tt.Sb(),tt.Sb(),tt.Sb(),tt.Sb()}if(2&t){var n=tt.fc(3);tt.Cb(6),tt.lc("disabled",n.bloqueoBotones)}}function on(t,e){if(1&t&&(tt.Tb(0,"div",7),tt.Tb(1,"div",8),tt.Tb(2,"div",9),tt.Tb(3,"span",3),tt.Dc(4,Ya,2,1,"span",1),tt.Fc(5),tt.Sb(),tt.Dc(6,tn,2,1,"ng-container",1),tt.Sb(),tt.Tb(7,"div",10),tt.Tb(8,"span"),tt.Fc(9),tt.gc(10,"number"),tt.Sb(),tt.Fc(11,"\xa0 "),tt.Dc(12,an,13,3,"eco-fab-speed-dial",11),tt.Dc(13,nn,9,1,"eco-fab-speed-dial",11),tt.Sb(),tt.Sb(),tt.Sb()),2&t){var a=tt.fc().$implicit;tt.Cb(4),tt.lc("ngIf",0==+a.multiple),tt.Cb(1),tt.Hc("\xa0",a.nombre," "),tt.Cb(1),tt.lc("ngIf",1==+a.combo),tt.Cb(3),tt.Gc(tt.ic(10,6,a.cantidad*a.precio+a.monto_extra,"1.2-2")),tt.Cb(3),tt.lc("ngIf",0==+a.impreso),tt.Cb(1),tt.lc("ngIf",1==+a.impreso)}}function cn(t,e){if(1&t){var a=tt.Ub();tt.Tb(0,"input",24),tt.bc("ngModelChange",function(t){return tt.xc(a),tt.fc(3).$implicit.notas=t})("keyup.enter",function(){tt.xc(a);var t=tt.fc(3).$implicit;return tt.fc().toggleShowInputNotas(t)})("blur",function(){tt.xc(a);var t=tt.fc(3).$implicit;return tt.fc().saveNotasProducto(t)}),tt.Sb()}if(2&t){var n=tt.fc(3).$implicit,o=tt.fc();tt.lc("matKeyboard",o.keyboardLayout)("ngModel",n.notas)}}function rn(t,e){if(1&t){var a=tt.Ub();tt.Tb(0,"input",25),tt.bc("ngModelChange",function(t){return tt.xc(a),tt.fc(3).$implicit.notas=t})("keyup.enter",function(){tt.xc(a);var t=tt.fc(3).$implicit;return tt.fc().toggleShowInputNotas(t)})("blur",function(){tt.xc(a);var t=tt.fc(3).$implicit;return tt.fc().saveNotasProducto(t)}),tt.Sb()}if(2&t){var n=tt.fc(3).$implicit;tt.lc("ngModel",n.notas)}}function sn(t,e){if(1&t&&(tt.Tb(0,"mat-form-field",0),tt.Dc(1,cn,1,2,"input",22),tt.Dc(2,rn,1,1,"input",23),tt.Sb()),2&t){var a=tt.fc(3);tt.Cb(1),tt.lc("ngIf",!a.esMovil),tt.Cb(1),tt.lc("ngIf",a.esMovil)}}function ln(t,e){if(1&t&&(tt.Tb(0,"div",7),tt.Dc(1,sn,3,2,"mat-form-field",21),tt.Sb()),2&t){var a=tt.fc().$implicit;tt.Cb(1),tt.lc("ngIf",a.showInputNotas)}}var un=function(t){return{noImpreso:t}};function dn(t,e){if(1&t&&(tt.Tb(0,"mat-list-item",5),tt.Dc(1,on,14,9,"div",6),tt.Dc(2,ln,2,1,"div",6),tt.Sb()),2&t){var a=e.$implicit;tt.lc("ngClass",tt.oc(3,un,0==+a.impreso)),tt.Cb(1),tt.lc("ngIf",+a.cantidad>0),tt.Cb(1),tt.lc("ngIf",+a.cantidad>0)}}var bn,mn=((bn=function(){function t(e,a,n,i,r){var s=this;c(this,t),this.snackBar=e,this.ls=a,this.comandaSrvc=n,this.socket=i,this.dialog=r,this.listaProductos=[],this.noCuenta=null,this.listHeight="450px",this.IdComanda=0,this.IdCuenta=0,this.bloqueoBotones=!1,this.mesaEnUso={},this.productoRemovedEv=new tt.o,this.esMovil=!1,this.keyboardLayout=it.b.IDIOMA_TECLADO,this.totalDeProductos=0,this.cantidadDeProductos=0,this.removeProducto=function(t,e){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3?arguments[3]:void 0;s.bloqueoBotones=!0,s.detalleComanda={detalle_cuenta:t.detalle_cuenta,detalle_comanda:t.detalle_comanda,articulo:t.id,cantidad:+t.cantidad>1?+t.cantidad-1:0,precio:+t.precio,total:+t.cantidad>1?(+t.cantidad-1)*+t.precio:0,notas:t.notas,autorizado:a},n&&(s.detalleComanda.cantidad=n,s.detalleComanda.total=n*s.detalleComanda.precio),s.comandaSrvc.saveDetalle(s.IdComanda,s.IdCuenta,s.detalleComanda).subscribe(function(e){e.exito?(t.cantidad=s.detalleComanda.cantidad,s.productoRemovedEv.emit({listaProductos:s.listaProductos,comanda:e.comanda}),0==+t.cantidad&&(s.socket.emit("refrescar:mesa",{mesaenuso:s.mesaEnUso}),s.socket.emit("refrescar:listaCocina",{mesaenuso:s.mesaEnUso}))):s.snackBar.open("ERROR: ".concat(e.mensaje),"Comanda",{duration:3e3}),s.bloqueoBotones=!1})},this.deleteProductoFromList=function(t,e){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];t.cantidad=0,t.notas="",s.removeProducto(t,e,a)},this.deleteProductoFromListAfterPrinted=function(t,e){s.bloqueoBotones=!0,s.dialog.open(Va,{width:"40%",disableClose:!0}).afterClosed().subscribe(function(a){a?s.dialog.open(Qa,{width:"40%",disableClose:!0,data:new Ja(t)}).afterClosed().subscribe(function(t){t&&t.respuesta&&(s.removeProducto(t.producto,e,!0,t.producto.cantidad),s.snackBar.open("Se eliminar\xe1 el producto seleccionado.","Comanda",{duration:5e3}))}):s.snackBar.open("La contrase\xf1a no es correcta","Comanda",{duration:5e3}),s.bloqueoBotones=!1})},this.saveNotasProducto=function(t){s.comandaSrvc.saveNotasProducto({detalle_comanda:t.detalle_comanda,notas:t.notas}).subscribe(function(t){t.exito&&s.snackBar.open("Notas de producto guardadas con \xe9xito...","Producto",{duration:3e3})})},this.getTotalProductos=function(){s.totalDeProductos=0,s.cantidadDeProductos=0;var t,e=o(s.listaProductos);try{for(e.s();!(t=e.n()).done;){var a=t.value;s.totalDeProductos+=a.cantidad*a.precio+a.monto_extra,s.cantidadDeProductos+=a.cantidad}}catch(n){e.e(n)}finally{e.f()}}}return s(t,[{key:"ngOnInit",value:function(){this.esMovil=this.ls.get(it.b.usrTokenVar).enmovil||!1}},{key:"ngOnChanges",value:function(t){this.listaProductos&&this.listaProductos.length>0&&this.getTotalProductos()}},{key:"toggleShowInputNotas",value:function(t){console.log("ARTICULO = ",t),t.showInputNotas=!t.showInputNotas,t.showInputNotas?t.itemListHeight="140px":(t.itemListHeight="70px",this.saveNotasProducto(t))}},{key:"doAction",value:function(t){console.log(t)}}]),t}()).\u0275fac=function(t){return new(t||bn)(tt.Nb(P.b),tt.Nb(dt.a),tt.Nb(Se),tt.Nb(Ue.a),tt.Nb(N.b))},bn.\u0275cmp=tt.Hb({type:bn,selectors:[["app-lista-productos-comanda"]],inputs:{listaProductos:"listaProductos",noCuenta:"noCuenta",listHeight:"listHeight",IdComanda:"IdComanda",IdCuenta:"IdCuenta",bloqueoBotones:"bloqueoBotones",mesaEnUso:"mesaEnUso"},outputs:{productoRemovedEv:"productoRemovedEv"},features:[tt.Ab],decls:3,vars:4,consts:[[1,"fullWidth"],[4,"ngIf"],[3,"ngClass",4,"ngFor","ngForOf"],["matLine",""],[1,"lineaDeTotal"],[3,"ngClass"],["matLine","","class","fullWidth",4,"ngIf"],["matLine","",1,"fullWidth"],[1,"row"],[1,"col","m6","s12"],["align","end",1,"col","m6","s12"],["direction","left",4,"ngIf"],["matLine","",4,"ngFor","ngForOf"],[1,"tabulador"],["direction","left"],["mat-fab",""],[2,"font-size","18pt !important"],["mat-mini-fab","","color","warn",3,"disabled","click"],[2,"font-size","16pt !important"],["mat-mini-fab","","color","warn",3,"disabled","click",4,"ngIf"],["mat-mini-fab","","color","accent",3,"disabled","click"],["class","fullWidth",4,"ngIf"],["matInput","","placeholder","Notas de producto","maxlength","1000",3,"matKeyboard","ngModel","ngModelChange","keyup.enter","blur",4,"ngIf"],["matInput","","placeholder","Notas de producto","maxlength","1000",3,"ngModel","ngModelChange","keyup.enter","blur",4,"ngIf"],["matInput","","placeholder","Notas de producto","maxlength","1000",3,"matKeyboard","ngModel","ngModelChange","keyup.enter","blur"],["matInput","","placeholder","Notas de producto","maxlength","1000",3,"ngModel","ngModelChange","keyup.enter","blur"]],template:function(t,e){1&t&&(tt.Tb(0,"mat-list",0),tt.Dc(1,Xa,5,6,"mat-list-item",1),tt.Dc(2,dn,3,5,"mat-list-item",2),tt.Sb()),2&t&&(tt.Ac("height",e.listHeight),tt.Cb(1),tt.lc("ngIf",e.listaProductos.length>0),tt.Cb(1),tt.lc("ngForOf",e.listaProductos))},directives:[S.a,d.m,d.l,S.c,j.j,d.k,Ft.a,z.b,z.d,E.a,C.a,z.a,T.b,k.b,$.a,m.c,m.f,m.k,m.n],pipes:[d.f],styles:[".fullWidth[_ngcontent-%COMP%]{width:100%!important}.spacer[_ngcontent-%COMP%]{flex:1 1 auto!important}.noImpreso[_ngcontent-%COMP%]{background-color:#c7c7c7}.text-pre-wrap[_ngcontent-%COMP%]{white-space:pre-wrap!important}.lineaDeTotal[_ngcontent-%COMP%]{font-weight:700!important;font-size:11pt!important}"]}),bn),fn=["txtCodigoBarras"];function pn(t,e){if(1&t){var a=tt.Ub();tt.Tb(0,"mat-chip",20),tt.bc("click",function(){tt.xc(a);var t=e.$implicit,n=tt.fc();return 0==+t.cerrada&&n.setSelectedCuenta(t.numero)}),tt.Fc(1),tt.Sb()}if(2&t){var n=e.$implicit,o=tt.fc();tt.lc("disabled",1==+n.cerrada||o.bloqueoBotones)("selected",0==+n.cerrada),tt.Cb(1),tt.Hc(" ",n.nombre," ")}}function gn(t,e){if(1&t){var a=tt.Ub();tt.Tb(0,"mat-chip",21),tt.bc("click",function(){tt.xc(a);var t=tt.fc();return t.nuevaCuenta(t.dialogRef)}),tt.Fc(1," Nueva "),tt.Sb()}}var hn=function(){return{standalone:!0}};function vn(t,e){if(1&t){var a=tt.Ub();tt.Tb(0,"mat-form-field",22),tt.Tb(1,"input",23,24),tt.bc("ngModelChange",function(t){return tt.xc(a),tt.fc().codigoBarras=t})("onDetected",function(){return tt.xc(a),tt.fc().buscarArticulo()}),tt.Sb(),tt.Sb()}if(2&t){var n=tt.fc();tt.Cb(1),tt.lc("ngModel",n.codigoBarras)("ngModelOptions",tt.nc(2,hn))}}function Sn(t,e){1&t&&tt.Ob(0,"br")}function Cn(t,e){if(1&t){var a=tt.Ub();tt.Tb(0,"mat-chip",25),tt.bc("click",function(){tt.xc(a);var t=e.$implicit;return tt.fc().loadSubcategorias(t)}),tt.Fc(1),tt.Sb()}if(2&t){var n=e.$implicit,o=tt.fc();tt.lc("disabled",o.bloqueoBotones),tt.Cb(1),tt.Hc(" ",n.descripcion," ")}}function Tn(t,e){if(1&t){var a=tt.Ub();tt.Tb(0,"mat-chip",28),tt.bc("click",function(){tt.xc(a);var t=e.$implicit,n=tt.fc().index;return tt.fc().loadSubcategorias({categoria:t.categoria},t,n)}),tt.Fc(1),tt.Sb()}if(2&t){var n=e.$implicit,o=tt.fc(2);tt.lc("disabled",o.bloqueoBotones),tt.Cb(1),tt.Hc(" ",n.descripcion," ")}}function kn(t,e){if(1&t&&(tt.Tb(0,"div",26),tt.Tb(1,"mat-chip-list"),tt.Dc(2,Tn,2,2,"mat-chip",27),tt.Sb(),tt.Sb()),2&t){var a=e.$implicit;tt.Cb(2),tt.lc("ngForOf",a)}}function yn(t,e){if(1&t){var a=tt.Ub();tt.Tb(0,"div",29),tt.Tb(1,"mat-card",30),tt.bc("click",function(){tt.xc(a);var t=e.$implicit,n=tt.fc();return!n.bloqueoBotones&&n.addArticulo(t)}),tt.Tb(2,"mat-card-content"),tt.Tb(3,"p"),tt.Fc(4),tt.Sb(),tt.Sb(),tt.Sb(),tt.Sb()}if(2&t){var n=e.$implicit;tt.Cb(4),tt.Gc(n.descripcion)}}var Mn,Fn=((Mn=function(a){!function(e,a){if("function"!=typeof a&&null!==a)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(a&&a.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),a&&t(e,a)}(o,a);var n=e(o);function o(t,e,a,i,r,s,l,u,d,b,m){var f;return c(this,o),(f=n.call(this,a,i,r,s,l,u,d,b,m)).dialogRef=t,f.data=e,f.dialog=a,f.snackBar=i,f.comandaSrvc=r,f.socket=s,f.ls=l,f.pdfServicio=u,f.configSrvc=d,f.articuloSrvc=b,f.bsAccionesCmd=m,f.categorias=[],f.subCategorias=[],f.listaSubCategorias=[],f.articulos=[],f.fullListArticulos=[],f.setDatos=function(){f.data&&f.data.mesa&&(f.mesaEnUso=f.data.mesa,f.alIniciar(),f.setSelectedCuenta(f.mesaEnUso.cuentas[0].numero))},f.cerrar=function(){return f.dialogRef.close()},f.resetArticulos=function(){return f.articulos=[]},f.resetListaSubCategorias=function(){return f.listaSubCategorias=[]},f.loadArticulosDePOS=function(){f.endSubs.add(f.articuloSrvc.getArticulosDePOS().subscribe(function(t){t&&(f.categorias=t.categorias,f.subCategorias=t.subcategorias,f.articulos=t.articulos,f.fullListArticulos=JSON.parse(JSON.stringify(f.articulos)))}))},f.loadSubcategorias=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;f.bloqueoBotones||(e?(f.listaSubCategorias.length>0&&f.listaSubCategorias.splice(a+1),e.subcategorias&&(0===e.subcategorias.length?f.filterArticulos(+e.categoria_grupo):f.listaSubCategorias.push(e.subcategorias))):(f.resetListaSubCategorias(),f.resetArticulos(),f.listaSubCategorias.push(f.subCategorias.filter(function(e){return+e.categoria==+t.categoria}))))},f.filterArticulos=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;f.bloqueoBotones||(f.articulos=t?f.fullListArticulos.filter(function(e){return+e.categoria_grupo==+t}):f.fullListArticulos)},f.addArticulo=function(t){f.bloqueoBotones||f.agregarProductos({id:+t.articulo,nombre:t.descripcion,precio:+t.precio,impresora:t.impresora,presentacion:t.presentacion,codigo:t.codigo,combo:t.combo,multiple:t.multiple})},f}return s(o,[{key:"ngOnInit",value:function(){this.usaCodigoBarras=this.configSrvc.getConfig(it.b.CONSTANTES.RT_USA_CODIGO_BARRAS),this.loadArticulosDePOS(),this.setDatos()}},{key:"ngOnDestroy",value:function(){this.endSubs.unsubscribe()}}]),o}(function(){function t(e,a,n,i,r,s,l,u,d){var b=this;c(this,t),this.dialog=e,this.snackBar=a,this.comandaSrvc=n,this.socket=i,this.ls=r,this.pdfServicio=s,this.configSrvc=l,this.articuloSrvc=u,this.bsAccionesCmd=d,this.clientePedido=null,this.closeSideNavEv=new tt.o,this.mesaSavedEv=new tt.o,this.showPortalComanda=!1,this.showPortalCuenta=!1,this.noComanda=0,this.sumCuenta=0,this.categorias=[],this.bloqueoBotones=!1,this.rolesUsuario=[],this.impreso=0,this.usaCodigoBarras=!1,this.codigoBarras=null,this.imprimeRecetaEnComanda=!0,this.endSubs=new we.a,this.alIniciar=function(){b.resetLstProductosSeleccionados(),b.resetLstProductosDeCuenta(),b.resetCuentaActiva(),b.impreso=0,b.noComanda=b.mesaEnUso.comanda||0,b.llenaProductosSeleccionados(),b.ls.get(it.b.usrTokenVar).sede_uuid&&(b.socket.emit("joinRestaurant",b.ls.get(it.b.usrTokenVar).sede_uuid),b.socket.on("reconnect",function(){return b.socket.emit("joinRestaurant",b.ls.get(it.b.usrTokenVar).sede_uuid)})),b.usaCodigoBarras=b.configSrvc.getConfig(it.b.CONSTANTES.RT_USA_CODIGO_BARRAS),b.imprimeRecetaEnComanda=b.configSrvc.getConfig(it.b.CONSTANTES.RT_IMPRIME_RECETA_EN_COMANDA)},this.resetMesaEnUso=function(){return b.mesaEnUso={exito:!0,comanda:null,usuario:null,sede:null,estatus:null,mesa:{mesa:null,area:{area:null,sede:null,area_padre:null,nombre:null},numero:null,posx:null,posy:null,tamanio:null,estatus:null},numero_pedido:null,cuentas:[]}},this.resetLstProductosSeleccionados=function(){return b.lstProductosSeleccionados=[]},this.resetLstProductosDeCuenta=function(){return b.lstProductosDeCuenta=[]},this.resetCuentaActiva=function(){return b.cuentaActiva={cuenta:null,numero:null,nombre:null,productos:[]}},this.resetListadoArticulos=function(){return b.appLstProdAlt.loadArbolArticulos()},this.setListaCategorias=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return b.categorias=b.setVerBotones(t)},this.setVerBotones=function(t){var e,a=o(t);try{for(a.s();!(e=a.n()).done;){var n,i=e.value,c=o(i.categoria_grupo);try{t:for(c.s();!(n=c.n()).done;){var r,s=n.value,l=o(s.articulo);try{for(l.s();!(r=l.n()).done;)if(1==+r.value.mostrar_pos){s.mostrarEnPos=!0,i.mostrarEnPos=!0;continue t}}catch(u){l.e(u)}finally{l.f()}}}catch(u){c.e(u)}finally{c.f()}}}catch(u){a.e(u)}finally{a.f()}return t},this.clickOnCategoria=function(t){return b.appLstProdAlt.fillSubCategorias(t.categoria_grupo)},this.buscarArticulo=function(){b.codigoBarras&&b.codigoBarras.trim().length>0&&b.endSubs.add(b.articuloSrvc.getArticulos({codigo:b.codigoBarras.trim()}).subscribe(function(t){if(t&&t.length>0){var e=t[0];b.agregarProductos({id:+e.articulo,nombre:e.descripcion,precio:+e.precio,impresora:e.impresora,presentacion:e.presentacion,codigo:e.codigo,combo:e.combo,multiple:e.multiple})}b.codigoBarras=null,b.txtCodigoBarras.focus()}))},this.llenaProductosSeleccionados=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:b.mesaEnUso;null==b.mesaEnUso.comanda&&(b.mesaEnUso=t),b.lstProductosSeleccionados=[];var e,a=o(t.cuentas);try{for(a.s();!(e=a.n()).done;){var n,i=e.value,c=o(i.productos);try{for(c.s();!(n=c.n()).done;){var r=n.value;b.lstProductosSeleccionados.push({id:+r.articulo.articulo,nombre:r.articulo.descripcion,cuenta:+r.numero_cuenta||1,idcuenta:+i.cuenta,cantidad:+r.cantidad,impreso:+r.impreso,precio:parseFloat(r.precio)||10,total:parseFloat(r.total)||parseFloat(r.cantidad)*parseFloat(r.precio),notas:r.notas||"",showInputNotas:!1,itemListHeight:"70px",detalle_comanda:+r.detalle_comanda,detalle_cuenta:+r.detalle_cuenta,impresora:r.articulo.impresora,detalle:r.detalle,monto_extra:+r.monto_extra||0,multiple:+r.articulo.multiple,combo:+r.articulo.combo})}}catch(s){c.e(s)}finally{c.f()}}}catch(s){a.e(s)}finally{a.f()}},this.cerrarMesa=function(){b.endSubs.add(b.comandaSrvc.cerrarMesa(b.mesaEnUso.mesa.mesa).subscribe(function(t){t.exito?(b.snackBar.open(t.mensaje,"Comanda",{duration:3e3}),b.mesaEnUso.mesa.estatus=1,b.mesaSavedEv.emit(),b.socket.emit("refrescar:mesa",{mesaenuso:b.mesaEnUso})):b.snackBar.open("ERROR: ".concat(t.mensaje),"Comanda",{duration:7e3})}))},this.printToBT=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=b.configSrvc.getConfig(it.b.CONSTANTES.RT_ENVIA_COMO_BASE64)?Ie.a.encode(t,!0):t,a=it.b.DEEP_LINK_ANDROID.replace("__INFOBASE64__",e);try{window.location.href=a}catch(n){b.snackBar.open("No se pudo conectar con la aplicaci\xf3n de impresi\xf3n","Comanda",{duration:3e3})}b.bloqueoBotones=!1},this.printComandaPDF=function(){var t=+b.cuentaActiva.cuenta;b.endSubs.add(b.pdfServicio.getComanda(t).subscribe(function(e){if(e){var a=new Blob([e],{type:"application/pdf"}),n=window.URL.createObjectURL(a);window.open(n,"cuenta_".concat(t),"height=700,width=800,menubar=no,location=no,resizable=no,scrollbars=no,status=no")}else b.snackBar.open("No se pudo generar la comanda...","Comanda",{duration:3e3})}))},this.sumaDetalle=function(t){var e,a=0,n=o(t);try{for(n.s();!(e=n.n()).done;){var i=e.value;a+=+i.total||0,a+=+i.monto_extra||0}}catch(c){n.e(c)}finally{n.f()}return a},this.enviarPedido=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=b.mesaEnUso.cuentas[0];b.cuentaActiva=b.mesaEnUso.cuentas.find(function(t){return+t.numero==+e.numero});var a=b.lstProductosSeleccionados.filter(function(t){return+t.cuenta==+b.cuentaActiva.numero});a.map(function(t){return t.impreso=1}),b.noComanda=b.mesaEnUso.comanda,b.cuentaActiva.productos=b.prepProductosComanda(a),b.mesaEnUso.cuentas.findIndex(function(t){return+t.cuenta==+b.cuentaActiva.cuenta})>-1&&b.endSubs.add(b.comandaSrvc.save({area:b.mesaEnUso.mesa.area.area,mesa:b.mesaEnUso.mesa.mesa,mesero:b.mesaEnUso.usuario,comanda:b.mesaEnUso.comanda,cuentas:b.mesaEnUso.cuentas,numero_pedido:b.mesaEnUso.numero_pedido}).subscribe(function(a){a.exito&&(b.mesaEnUso.numero_pedido=a.comanda.numero_pedido,b.endSubs.add(b.comandaSrvc.setProductoImpreso(e.cuenta).subscribe(function(a){b.llenaProductosSeleccionados(a.comanda),b.setSelectedCuenta(e.numero),b.cobrarCuenta(t)})))}))},this.cambiarEstatusCuenta=function(t){var e=b.mesaEnUso.cuentas.findIndex(function(e){return+e.cuenta==+t.cuenta});b.mesaEnUso.cuentas[e].cerrada=+t.cerrada},this.esCajero=function(){return!1},this.trasladoMesa=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=b.dialog.open(De,{width:"55%",data:{mesaEnUso:b.mesaEnUso}});b.endSubs.add(e.afterClosed().subscribe(function(e){e&&(b.socket.emit("refrescar:mesa",{mesaenuso:b.mesaEnUso}),t?t.close(b.mesaEnUso):b.closeSideNavEv.emit(b.mesaEnUso))}))},this.getNotasGenerales=function(){var t=b.dialog.open(xa,{width:"50%",data:{notasGenerales:b.mesaEnUso.notas_generales||""}});b.endSubs.add(t.afterClosed().subscribe(function(t){null!==t&&t.trim().length>0&&b.endSubs.add(b.comandaSrvc.saveNotasGenerales({comanda:b.mesaEnUso.comanda,notas_generales:t}).subscribe(function(e){e.exito?(b.mesaEnUso.notas_generales=t,b.snackBar.open(e.mensaje,"Comanda",{duration:3e3})):b.snackBar.open("ERROR: ".concat(e.mensaje),"Comanda",{duration:7e3})}))}))},this.nuevaCuenta=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=b.dialog.open(Oa,{width:"50%",data:{mesaEnUso:b.mesaEnUso}});b.endSubs.add(e.afterClosed().subscribe(function(e){e&&(t?t.close():b.closeSideNavEv.emit())}))},this.distribuirProductos=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=b.dialog.open(_a,{width:"50%",data:{mesaEnUso:b.mesaEnUso,lstProductos:b.lstProductosSeleccionados||[]}});b.endSubs.add(e.afterClosed().subscribe(function(e){e&&(t?t.close():b.closeSideNavEv.emit())}))},this.abrirAccionesComanda=function(t){var e=b.bsAccionesCmd.open(La,{autoFocus:!1,data:{tranComanda:b,dialogRef:t}});b.endSubs.add(e.afterDismissed().subscribe(function(e){(null==e?void 0:e.cerrar)&&t.close(e.mesaEnUso||null)}))}}return s(t,[{key:"setSelectedCuenta",value:function(t){this.bloqueoBotones=!0,this.cuentaActiva=this.mesaEnUso.cuentas.find(function(e){return+e.numero==+t}),this.setLstProductosDeCuenta(),this.bloqueoBotones=!1}},{key:"setSumaCuenta",value:function(t){var e,a=0,n=o(t);try{for(n.s();!(e=n.n()).done;){var i=e.value;a+=i.precio*i.cantidad}}catch(c){n.e(c)}finally{n.f()}this.sumCuenta=a}},{key:"setLstProductosDeCuenta",value:function(){var t=this;this.lstProductosDeCuenta=this.lstProductosSeleccionados.filter(function(e){return+e.cuenta==+t.cuentaActiva.numero})}},{key:"agregarProductos",value:function(t){var e=this;if(1==+t.combo||1==+t.multiple){this.bloqueoBotones=!0;var a=this.dialog.open(Ta,{maxWidth:"50%",data:new Ca(t,"S\xed","No")});this.endSubs.add(a.afterClosed().subscribe(function(t){t&&t.respuesta&&t.seleccion.receta.length>0?e.endSubs.add(e.comandaSrvc.saveDetalleCombo(e.mesaEnUso.comanda,e.cuentaActiva.cuenta,t.seleccion).subscribe(function(t){t.exito?(e.mesaEnUso=t.comanda,e.llenaProductosSeleccionados(e.mesaEnUso),e.setSelectedCuenta(+e.cuentaActiva.numero)):e.snackBar.open("ERROR:".concat(t.mensaje),"Comanda",{duration:3e3}),e.bloqueoBotones=!1})):(e.bloqueoBotones=!1,e.snackBar.open("Error, Debe seleccionar los productos del combo","Comanda",{duration:7e3}))}))}else this.addProductoSelected(t)}},{key:"addProductoSelected",value:function(t){var e=this;if(this.bloqueoBotones=!0,+this.cuentaActiva.numero){var a=this.lstProductosSeleccionados.findIndex(function(a){return+a.id==+t.id&&+a.cuenta==+e.cuentaActiva.numero&&0==+a.impreso});if(a<0)this.detalleComanda={articulo:t.id,cantidad:1,precio:+t.precio,total:1*+t.precio,notas:""},this.endSubs.add(this.comandaSrvc.saveDetalle(this.mesaEnUso.comanda,this.cuentaActiva.cuenta,this.detalleComanda).subscribe(function(t){t.exito?(e.mesaEnUso=t.comanda,e.llenaProductosSeleccionados(e.mesaEnUso),e.setSelectedCuenta(+e.cuentaActiva.numero)):e.snackBar.open("ERROR:".concat(t.mensaje),"Comanda",{duration:3e3}),e.bloqueoBotones=!1}));else{var n=this.lstProductosSeleccionados[a];this.detalleComanda={detalle_cuenta:n.detalle_cuenta,detalle_comanda:n.detalle_comanda,articulo:n.id,cantidad:+n.cantidad+1,precio:+n.precio,total:(+n.cantidad+1)*+n.precio,notas:n.notas},this.endSubs.add(this.comandaSrvc.saveDetalle(this.mesaEnUso.comanda,this.cuentaActiva.cuenta,this.detalleComanda).subscribe(function(t){t.exito?(e.mesaEnUso=t.comanda,e.llenaProductosSeleccionados(e.mesaEnUso),e.setSelectedCuenta(+e.cuentaActiva.numero)):e.snackBar.open("ERROR:".concat(t.mensaje),"Comanda",{duration:3e3}),e.bloqueoBotones=!1}))}this.setLstProductosDeCuenta()}}},{key:"updProductosCuenta",value:function(t){var e=this,a=t.listaProductos||[],n=this.lstProductosSeleccionados.filter(function(t){return+t.cuenta!=+e.cuentaActiva.numero});this.lstProductosSeleccionados=a.length>0?n.concat(a):n,t.comanda&&(this.mesaEnUso=t.comanda,this.llenaProductosSeleccionados(this.mesaEnUso),this.setSelectedCuenta(+this.cuentaActiva.numero))}},{key:"prepProductosComanda",value:function(t){var e,a=[],n=o(t);try{for(n.s();!(e=n.n()).done;){var i=e.value;a.push({articulo:i.id,cantidad:i.cantidad,precio:i.precio,total:i.total,notas:i.notas,impreso:1,detalle_comanda:i.detalle_comanda,detalle_cuenta:i.detalle_cuenta})}}catch(c){n.e(c)}finally{n.f()}return a}},{key:"validarImpresion",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this.configSrvc.getConfig(it.b.CONSTANTES.RT_INGRESO_NUMERO_PEDIDO);if(1==+this.mesaEnUso.mesa.esmostrador&&n&&!this.mesaEnUso.numero_pedido){var o=this.configSrvc.getConfig(it.b.CONSTANTES.RT_TOTAL_NUMEROS_PEDIDO);(!o||o<=0)&&(o=30);var i=this.dialog.open(da,{maxWidth:"50%",data:new ua("Numero de Pedido",o,"S\xed","No")});this.endSubs.add(i.afterClosed().subscribe(function(n){n&&n.respuesta&&n.pedido?(t.mesaEnUso.numero_pedido=n.pedido,t.printComanda(e,a)):t.snackBar.open("Error, Debe seleccionar un numero de pedido","Comanda",{duration:7e3})}))}else this.printComanda(e,a)}},{key:"printComanda",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=JSON.parse(JSON.stringify(this.mesaEnUso));this.bloqueoBotones=!0,this.impreso=0;for(var o=this.configSrvc.getConfig(it.b.CONSTANTES.RT_MODO_COMANDA)||1,i=function(i){var c=n.cuentas[i];t.cuentaActiva=n.cuentas.find(function(t){return+t.numero==+c.numero});var r=t.lstProductosSeleccionados.filter(function(e){return+e.cuenta==+t.cuentaActiva.numero}),s=r.filter(function(t){return 0==+t.impreso&&+t.cantidad>0});s.length>0?(r.map(function(t){return t.impreso=1}),t.noComanda=n.comanda,t.cuentaActiva.productos=t.prepProductosComanda(r),n.cuentas.findIndex(function(e){return+e.cuenta==+t.cuentaActiva.cuenta})>-1&&t.endSubs.add(t.comandaSrvc.save({area:n.mesa.area.area,mesa:n.mesa.mesa,mesero:n.usuario,comanda:n.comanda,cuentas:n.cuentas,numero_pedido:n.numero_pedido}).subscribe(function(i){i.exito?(n.numero_pedido=i.comanda.numero_pedido,t.endSubs.add(t.comandaSrvc.setProductoImpreso(c.cuenta).subscribe(function(i){i.exito&&t.impreso++,t.llenaProductosSeleccionados(i.comanda),t.setSelectedCuenta(c.numero),t.snackBar.open("Cuenta actualizada","Cuenta #".concat(c.numero),{duration:3e3});var r=[],l=[];try{r=s.filter(function(t){return 0==+t.impresora.bluetooth}),l=s.filter(function(t){return 1==+t.impresora.bluetooth})}catch(u){console.log("PRODUCTOS A IMPRIMIR = ",s),console.log("NORMAL = ",r),console.log("BT = ",l),console.log(u)}e?t.printComandaPDF():(r.length>0&&(3!==o?(t.imprimeRecetaEnComanda||r.map(function(t){return 0==+t.combo&&1==+t.esreceta&&(t.detalle=[]),t}),t.socket.emit("print:comanda","".concat(JSON.stringify({Tipo:"Comanda",Nombre:t.cuentaActiva.nombre,Numero:t.noComanda,DetalleCuenta:r,Ubicacion:"".concat(n.mesa.area.nombre," - Mesa ").concat(n.mesa.etiqueta||n.mesa.numero),Mesero:"".concat(n.mesero.nombres," ").concat(n.mesero.apellidos),Total:null,NumeroPedido:n.numero_pedido,NotasGenerales:n.notas_generales||""}))),t.snackBar.open("Imprimiendo comanda #".concat(t.noComanda),"Comanda",{duration:7e3})):t.snackBar.open("Comanda #".concat(t.noComanda," enviada a cocina"),"Comanda",{duration:7e3}),t.bloqueoBotones=!1),l.length>0&&3!==o&&(t.imprimeRecetaEnComanda||r.map(function(t){return 0==+t.combo&&1==+t.esreceta&&(t.detalle=[]),t}),t.printToBT(JSON.stringify({Tipo:"Comanda",Nombre:t.cuentaActiva.nombre,Numero:t.noComanda,DetalleCuenta:l,Ubicacion:"".concat(n.mesa.area.nombre," - Mesa ").concat(n.mesa.etiqueta||n.mesa.numero),Mesero:"".concat(n.mesero.nombres," ").concat(n.mesero.apellidos),Total:null,NumeroPedido:n.numero_pedido})))),+t.impreso===n.cuentas.length&&(t.impreso=0,t.socket.emit("refrescar:mesa",{mesaenuso:n}),t.socket.emit("refrescar:listaCocina",{mesaenuso:n}),0==+n.mesa.esmostrador?a?a.close():t.closeSideNavEv.emit():t.cobrarCuenta(a))}))):t.snackBar.open("ERROR: ".concat(i.mensaje),"Cuenta #".concat(t.cuentaActiva.numero),{duration:3e3}),t.bloqueoBotones=!1}))):(t.impreso++,t.bloqueoBotones=!1)},c=0;c<n.cuentas.length;c++)i(c)}},{key:"printCuenta",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(this.bloqueoBotones=!0,this.lstProductosAImprimir=this.lstProductosDeCuenta.filter(function(t){return 1==+t.impreso}),this.lstProductosAImprimir.length>0){this.setSumaCuenta(this.lstProductosAImprimir);var e=this.sumaDetalle(this.lstProductosAImprimir),a=this.mesaEnUso.mesa.impresora||this.mesaEnUso.mesa.area.impresora,n=this.configSrvc.getConfig(it.b.CONSTANTES.RT_IMPRIME_PROPINA_SUGERIDA),o={Tipo:"Cuenta",Nombre:this.cuentaActiva.nombre,Numero:null,DetalleCuenta:this.lstProductosAImprimir,Total:e,Empresa:this.ls.get(it.b.usrTokenVar).empresa,Restaurante:this.ls.get(it.b.usrTokenVar).restaurante,PropinaSugerida:n?(.1*e).toFixed(2):null,Impresora:a,Ubicacion:"".concat(this.mesaEnUso.mesa.area.nombre," - Mesa ").concat(this.mesaEnUso.mesa.etiqueta||this.mesaEnUso.mesa.numero," - Comanda ").concat(this.mesaEnUso.comanda),Mesero:"".concat(this.mesaEnUso.mesero.nombres," ").concat(this.mesaEnUso.mesero.apellidos)};0==+a.bluetooth?this.socket.emit("print:cuenta","".concat(JSON.stringify(o))):this.printToBT(JSON.stringify(o)),this.snackBar.open("Imprimiendo cuenta de ".concat(this.cuentaActiva.nombre),"Cuenta",{duration:7e3}),t?t.close():this.closeSideNavEv.emit()}else this.snackBar.open("La cuenta de ".concat(this.cuentaActiva.nombre," no tiene ning\xfan art\xedculo."),"Cuenta",{duration:7e3});this.bloqueoBotones=!1}},{key:"unirCuentas",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,a=this.dialog.open(ye,{width:"55%",data:{lstProductosSeleccionados:this.lstProductosSeleccionados,mesaEnUso:this.mesaEnUso}});this.endSubs.add(a.afterClosed().subscribe(function(a){a&&(e?e.close():t.closeSideNavEv.emit())}))}},{key:"cobrarCuenta",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.endSubs.add(this.comandaSrvc.getCuenta(this.cuentaActiva.cuenta).subscribe(function(a){if(a.pendiente.length>0)t.snackBar.open("Cobro","Tiene productos sin comandar",{duration:3e3});else{var n=t.lstProductosDeCuenta.filter(function(t){return 1==+t.impreso});if(n.length>0){var o=t.dialog.open(ca,{width:"95%",data:{mesaenuso:t.mesaEnUso,cuenta:t.cuentaActiva.nombre,idcuenta:t.cuentaActiva.cuenta,productosACobrar:n,porcentajePropina:0,impresora:0==+t.mesaEnUso.mesa.esmostrador?t.mesaEnUso.mesa.area.impresora_factura||null:t.mesaEnUso.mesa.impresora||t.mesaEnUso.mesa.area.impresora,clientePedido:t.clientePedido}});t.endSubs.add(o.afterClosed().subscribe(function(a){a&&"closePanel"!==a?(t.cambiarEstatusCuenta(a),e?e.close(t.mesaEnUso):t.closeSideNavEv.emit(t.mesaEnUso)):"closePanel"===a&&(e?e.close(t.mesaEnUso):t.closeSideNavEv.emit())}))}else t.snackBar.open("Cobro","Sin productos a cobrar.",{duration:3e3})}}))}}]),t}())).\u0275fac=function(t){return new(t||Mn)(tt.Nb(N.f),tt.Nb(N.a),tt.Nb(N.b),tt.Nb(P.b),tt.Nb(Se),tt.Nb(Ue.a),tt.Nb(dt.a),tt.Nb(qa.a),tt.Nb(Be.a),tt.Nb(ba.a),tt.Nb(q.b))},Mn.\u0275cmp=tt.Hb({type:Mn,selectors:[["app-tran-comanda-alt"]],viewQuery:function(t,e){var a;1&t&&tt.Kc(fn,1),2&t&&tt.sc(a=tt.cc())&&(e.txtCodigoBarras=a.first)},features:[tt.zb],decls:25,vars:18,consts:[["fxLayout","row","fxLayout.xs","column"],["fxFlex","50%","fxFelx.xs","100%","fxLayoutAlign","start start"],[1,"bld",2,"font-size","16pt","margin-left","10px"],["fxFlex","50%","fxFelx.xs","100%","fxLayoutAlign","end start"],["mat-raised-button","","type","button","color","warn",3,"disabled","click"],["mat-raised-button","","type","button","color","accent",2,"margin-left","8px",3,"disabled","click"],["mat-dialog-content","",1,"contenido"],["fxLayout","row wrap","fxLayout.xs","column","fxLayoutAlign","center center",1,"divSeparacion"],["color","accent",3,"disabled","selected","click",4,"ngFor","ngForOf"],[3,"click",4,"ngIf"],["style","width: 25%;",4,"ngIf"],[4,"ngIf"],["fxLayout","row wrap","fxLayout.xs","column","fxLayoutAlign","start center"],["selected","","color","accent",3,"disabled","click",4,"ngFor","ngForOf"],["fxLayout","row wrap","fxLayout.xs","column","fxLayoutAlign","start center","class","divSubCategorias",4,"ngFor","ngForOf"],["fxLayout","row wrap","fxLayout.xs","column","fxLayoutAlign","start start"],["fxFlex","55%","fxFlex.xs","100%","fxFlex.sm","100%","fxLayout","row wrap","fxLayoutGap","8px grid","fxLayoutAlign","start start",1,"divArticulos"],["fxFlex","20%","fxFlex.xs","100%","fxFlex.sm","33%","fxFlex.md","25%",4,"ngFor","ngForOf"],["fxFlex","45%","fxFlex.xs","100%","fxFlex.sm","100%",1,"divArticulos"],[3,"listaProductos","noCuenta","IdComanda","IdCuenta","bloqueoBotones","mesaEnUso","productoRemovedEv"],["color","accent",3,"disabled","selected","click"],[3,"click"],[2,"width","25%"],["matInput","","cdkFocusInitial","","ngxBarCodePut","","type","text","placeholder","C\xf3digo","name","codigoBarras",3,"ngModel","ngModelOptions","ngModelChange","onDetected"],["txtCodigoBarras","matInput"],["selected","","color","accent",3,"disabled","click"],["fxLayout","row wrap","fxLayout.xs","column","fxLayoutAlign","start center",1,"divSubCategorias"],["selected","","color","warn","class","btnAccion",3,"disabled","click",4,"ngFor","ngForOf"],["selected","","color","warn",1,"btnAccion",3,"disabled","click"],["fxFlex","20%","fxFlex.xs","100%","fxFlex.sm","33%","fxFlex.md","25%"],[1,"mat-elevation-z4",3,"click"]],template:function(t,e){1&t&&(tt.Tb(0,"div",0),tt.Tb(1,"div",1),tt.Tb(2,"span",2),tt.Fc(3),tt.Sb(),tt.Sb(),tt.Tb(4,"div",3),tt.Tb(5,"button",4),tt.bc("click",function(){return e.abrirAccionesComanda(e.dialogRef)}),tt.Fc(6," Acciones "),tt.Sb(),tt.Tb(7,"button",5),tt.bc("click",function(){return e.cerrar()}),tt.Fc(8," Cerrar "),tt.Sb(),tt.Sb(),tt.Sb(),tt.Tb(9,"div",6),tt.Tb(10,"div",7),tt.Tb(11,"mat-chip-list"),tt.Dc(12,pn,2,3,"mat-chip",8),tt.Dc(13,gn,2,0,"mat-chip",9),tt.Sb(),tt.Sb(),tt.Dc(14,vn,3,3,"mat-form-field",10),tt.Dc(15,Sn,1,0,"br",11),tt.Tb(16,"div",12),tt.Tb(17,"mat-chip-list"),tt.Dc(18,Cn,2,2,"mat-chip",13),tt.Sb(),tt.Sb(),tt.Dc(19,kn,3,1,"div",14),tt.Tb(20,"div",15),tt.Tb(21,"div",16),tt.Dc(22,yn,5,1,"div",17),tt.Sb(),tt.Tb(23,"div",18),tt.Tb(24,"app-lista-productos-comanda",19),tt.bc("productoRemovedEv",function(t){return e.updProductosCuenta(t)}),tt.Sb(),tt.Sb(),tt.Sb(),tt.Sb()),2&t&&(tt.Cb(3),tt.Jc(" ",e.mesaEnUso.mesa.area.nombre," - Mesa",e.mesaEnUso.mesa.numero," - Comanda ",e.mesaEnUso.comanda," "),tt.Cb(2),tt.lc("disabled",e.bloqueoBotones),tt.Cb(2),tt.lc("disabled",e.bloqueoBotones),tt.Cb(5),tt.lc("ngForOf",e.mesaEnUso.cuentas),tt.Cb(1),tt.lc("ngIf",0==+e.mesaEnUso.mesa.esmostrador&&0==+e.mesaEnUso.mesa.escallcenter),tt.Cb(1),tt.lc("ngIf",e.usaCodigoBarras),tt.Cb(1),tt.lc("ngIf",e.usaCodigoBarras),tt.Cb(3),tt.lc("ngForOf",e.categorias),tt.Cb(1),tt.lc("ngForOf",e.listaSubCategorias),tt.Cb(3),tt.lc("ngForOf",e.articulos),tt.Cb(2),tt.lc("listaProductos",e.lstProductosDeCuenta)("noCuenta",+e.cuentaActiva.numero)("IdComanda",e.mesaEnUso.comanda)("IdCuenta",e.cuentaActiva.cuenta)("bloqueoBotones",e.bloqueoBotones)("mesaEnUso",e.mesaEnUso))},directives:[ra.c,ra.a,ra.b,E.a,N.d,L.b,d.l,d.m,ra.d,mn,L.a,T.b,k.b,m.c,et,m.k,m.n,y.a,y.c],styles:[".contenido[_ngcontent-%COMP%]{max-height:80vh!important;height:100%;overflow-y:auto;padding:0 5px}.divSubCategorias[_ngcontent-%COMP%]{padding-top:3px;padding-bottom:3px}.divArticulos[_ngcontent-%COMP%]{padding:3px 8px;overflow-y:auto;margin:0;height:73vh}.divArticulos[_ngcontent-%COMP%] > mat-card[_ngcontent-%COMP%]{width:200px;max-height:95px}.divSeparacion[_ngcontent-%COMP%]{padding-top:3px;padding-bottom:3px}.bordeTest2[_ngcontent-%COMP%]{border:1px solid #00f}.bordeTest3[_ngcontent-%COMP%]{border:1px solid #90ee90}@media (max-height:768px){.divArticulos[_ngcontent-%COMP%]{height:60vh}}@media (min-height:769px) and (max-height:960px){.divArticulos[_ngcontent-%COMP%]{height:69vh}}"]}),Mn);function xn(t,e){if(1&t){var a=tt.Ub();tt.Tb(0,"button",6),tt.bc("click",function(){tt.xc(a);var t=tt.fc().$implicit;return tt.fc().clickOnSubCategoria(t)}),tt.Fc(1),tt.Sb()}if(2&t){var n=tt.fc().$implicit,o=tt.fc();tt.lc("disabled",o.bloqueoBotones),tt.Cb(1),tt.Hc(" ",n.descripcion," ")}}function On(t,e){if(1&t&&(tt.Rb(0),tt.Dc(1,xn,2,2,"button",5),tt.Qb()),2&t){var a=e.$implicit;tt.Cb(1),tt.lc("ngIf",a.mostrarEnPos)}}function Dn(t,e){1&t&&tt.Ob(0,"hr")}function En(t,e){if(1&t){var a=tt.Ub();tt.Tb(0,"button",7),tt.bc("click",function(){tt.xc(a);var t=e.$implicit;return tt.fc().clickOnArticulo(t)}),tt.Fc(1),tt.Sb()}if(2&t){var n=e.$implicit,o=tt.fc();tt.lc("disabled",o.bloqueoBotones),tt.Cb(1),tt.Hc(" ",n.descripcion," ")}}var Pn,_n=((Pn=function(){function t(e,a){var n=this;c(this,t),this.articuloSrvc=e,this.ls=a,this.bloqueoBotones=!1,this.productoClickedEv=new tt.o,this.categoriasFilledEv=new tt.o,this.categorias=[],this.subcategorias=[],this.articulos=[],this.loadArbolArticulos=function(){n.articuloSrvc.getArbolArticulos(n.ls.get(it.b.usrTokenVar).sede||0).subscribe(function(t){n.fillCategorias(t)})},this.fillCategorias=function(t){n.categorias=[],n.subcategorias=[],n.articulos=[];var e,a=o(t);try{for(a.s();!(e=a.n()).done;){var i=e.value;n.categorias.push(i)}}catch(c){a.e(c)}finally{a.f()}n.categoriasFilledEv.emit(n.categorias)},this.fillSubCategorias=function(t){n.subcategorias=[],n.articulos=[];var e,a=o(t);try{for(a.s();!(e=a.n()).done;){var i=e.value;0==+i.debaja&&n.subcategorias.push(i)}}catch(c){a.e(c)}finally{a.f()}},this.fillArticulos=function(t){n.articulos=[];var e,a=o(t);try{for(a.s();!(e=a.n()).done;){var i=e.value;0==+i.debaja&&n.articulos.push(i)}}catch(c){a.e(c)}finally{a.f()}},this.clickOnCategoria=function(t){t.categoria_grupo.length>0&&n.fillSubCategorias(t.categoria_grupo)},this.clickOnSubCategoria=function(t){t.articulo.length>0&&n.fillArticulos(t.articulo)},this.clickOnArticulo=function(t){n.productoClickedEv.emit({id:+t.articulo,nombre:t.descripcion,precio:+t.precio,impresora:t.impresora,presentacion:t.presentacion,codigo:t.codigo,combo:t.combo,multiple:t.multiple,debaja:t.debaja})}}return s(t,[{key:"ngOnInit",value:function(){this.loadArbolArticulos()}}]),t}()).\u0275fac=function(t){return new(t||Pn)(tt.Nb(ba.a),tt.Nb(dt.a))},Pn.\u0275cmp=tt.Hb({type:Pn,selectors:[["app-lista-producto-alt"]],inputs:{bloqueoBotones:"bloqueoBotones"},outputs:{productoClickedEv:"productoClickedEv",categoriasFilledEv:"categoriasFilledEv"},decls:7,vars:3,consts:[[1,"row"],[1,"col","m12","s12"],[4,"ngFor","ngForOf"],[4,"ngIf"],["mat-raised-button","","class","btnAccion","color","warn",3,"disabled","click",4,"ngFor","ngForOf"],["mat-raised-button","","class","btnAccion","color","primary",3,"disabled","click",4,"ngIf"],["mat-raised-button","","color","primary",1,"btnAccion",3,"disabled","click"],["mat-raised-button","","color","warn",1,"btnAccion",3,"disabled","click"]],template:function(t,e){1&t&&(tt.Tb(0,"div",0),tt.Tb(1,"div",1),tt.Dc(2,On,2,1,"ng-container",2),tt.Sb(),tt.Sb(),tt.Dc(3,Dn,1,0,"hr",3),tt.Tb(4,"div",0),tt.Tb(5,"div",1),tt.Dc(6,En,2,2,"button",4),tt.Sb(),tt.Sb()),2&t&&(tt.Cb(2),tt.lc("ngForOf",e.subcategorias),tt.Cb(1),tt.lc("ngIf",e.articulos.length>0),tt.Cb(3),tt.lc("ngForOf",e.articulos))},directives:[d.l,d.m,E.a],styles:[""]}),Pn),In=["appLstProdAlt"],wn=["txtCodigoBarras"];function An(t,e){if(1&t&&(tt.Tb(0,"span",25),tt.Fc(1),tt.Sb()),2&t){var a=tt.fc();tt.Cb(1),tt.Jc(" ",a.mesaEnUso.mesa.area.nombre," - Mesa ",a.mesaEnUso.mesa.etiqueta||a.mesaEnUso.mesa.numero," - Comanda ",a.mesaEnUso.comanda," ")}}function Nn(t,e){if(1&t){var a=tt.Ub();tt.Tb(0,"button",29),tt.bc("click",function(){tt.xc(a);var t=e.$implicit;return tt.fc(2).setSelectedCuenta(t.numero)}),tt.Fc(1),tt.Sb()}if(2&t){var n=e.$implicit;tt.lc("disabled",1==+n.cerrada),tt.Cb(1),tt.Hc(" ",n.nombre," ")}}function Rn(t,e){if(1&t){var a=tt.Ub();tt.Tb(0,"button",30),tt.bc("click",function(){return tt.xc(a),tt.fc(2).nuevaCuenta()}),tt.Fc(1," Nueva "),tt.Sb()}}function Un(t,e){if(1&t&&(tt.Tb(0,"div",26),tt.Dc(1,Nn,2,2,"button",27),tt.Dc(2,Rn,2,0,"button",28),tt.Sb()),2&t){var a=tt.fc();tt.Cb(1),tt.lc("ngForOf",a.mesaEnUso.cuentas),tt.Cb(1),tt.lc("ngIf",a.mesaEnUso&&0==+a.mesaEnUso.mesa.esmostrador&&0==+a.mesaEnUso.mesa.escallcenter)}}var jn=function(){return{standalone:!0}};function Bn(t,e){if(1&t){var a=tt.Ub();tt.Tb(0,"mat-form-field",31),tt.Tb(1,"input",32,33),tt.bc("ngModelChange",function(t){return tt.xc(a),tt.fc().codigoBarras=t})("onDetected",function(){return tt.xc(a),tt.fc().buscarArticulo()}),tt.Sb(),tt.Sb()}if(2&t){var n=tt.fc();tt.Cb(1),tt.lc("ngModel",n.codigoBarras)("ngModelOptions",tt.nc(2,jn))}}function Hn(t,e){1&t&&tt.Ob(0,"br")}function Ln(t,e){if(1&t){var a=tt.Ub();tt.Tb(0,"button",35),tt.bc("click",function(){tt.xc(a);var t=tt.fc().$implicit;return tt.fc().clickOnCategoria(t)}),tt.Fc(1),tt.Sb()}if(2&t){var n=tt.fc().$implicit,o=tt.fc();tt.lc("disabled",!o.cuentaActiva||o.bloqueoBotones||!o.cuentaActiva.cuenta),tt.Cb(1),tt.Hc(" ",n.descripcion," ")}}function qn(t,e){if(1&t&&(tt.Rb(0),tt.Dc(1,Ln,2,2,"button",34),tt.Qb()),2&t){var a=e.$implicit;tt.Cb(1),tt.lc("ngIf",a.mostrarEnPos)}}function $n(t,e){if(1&t&&(tt.Tb(0,"span",9),tt.Fc(1),tt.Sb()),2&t){var a=tt.fc();tt.Cb(1),tt.Hc("Cuenta de ",a.cuentaActiva.nombre,"")}}function zn(t,e){1&t&&(tt.Tb(0,"span",9),tt.Fc(1,"Por favor seleccione una cuenta. Gracias."),tt.Sb())}function Gn(t,e){if(1&t){var a=tt.Ub();tt.Tb(0,"button",18),tt.bc("click",function(){return tt.xc(a),tt.fc().validarImpresion()}),tt.Fc(1," Comanda "),tt.Sb()}if(2&t){var n=tt.fc();tt.lc("disabled",!n.cuentaActiva.nombre||n.bloqueoBotones)}}function Wn(t,e){if(1&t){var a=tt.Ub();tt.Tb(0,"button",18),tt.bc("click",function(){return tt.xc(a),tt.fc().printCuenta()}),tt.Fc(1," Cuenta "),tt.Sb()}if(2&t){var n=tt.fc();tt.lc("disabled",!n.cuentaActiva.nombre||n.bloqueoBotones)}}function Vn(t,e){if(1&t){var a=tt.Ub();tt.Tb(0,"button",18),tt.bc("click",function(){return tt.xc(a),tt.fc().distribuirProductos()}),tt.Fc(1," Distribuir "),tt.Sb()}if(2&t){var n=tt.fc();tt.lc("disabled",n.mesaEnUso.cuentas.length<2||n.bloqueoBotones)}}function Kn(t,e){if(1&t){var a=tt.Ub();tt.Tb(0,"button",18),tt.bc("click",function(){return tt.xc(a),tt.fc().unirCuentas()}),tt.Fc(1," Unir cuentas "),tt.Sb()}if(2&t){var n=tt.fc();tt.lc("disabled",n.mesaEnUso.cuentas.length<2||n.bloqueoBotones)}}function Jn(t,e){if(1&t){var a=tt.Ub();tt.Tb(0,"button",18),tt.bc("click",function(){return tt.xc(a),tt.fc().cobrarCuenta()}),tt.Fc(1," Cobrar cuenta "),tt.Sb()}if(2&t){var n=tt.fc();tt.lc("disabled",!n.cuentaActiva.nombre||n.esCajero()||n.bloqueoBotones)}}function Qn(t,e){if(1&t){var a=tt.Ub();tt.Tb(0,"button",18),tt.bc("click",function(){return tt.xc(a),tt.fc().enviarPedido()}),tt.Fc(1," Enviar pedido "),tt.Sb()}if(2&t){var n=tt.fc();tt.lc("disabled",!n.cuentaActiva.nombre||n.esCajero()||n.bloqueoBotones)}}function Xn(t,e){if(1&t){var a=tt.Ub();tt.Tb(0,"button",18),tt.bc("click",function(){return tt.xc(a),tt.fc().trasladoMesa()}),tt.Fc(1," Trasladar "),tt.Sb()}if(2&t){var n=tt.fc();tt.lc("disabled",n.bloqueoBotones)}}function Yn(t,e){if(1&t){var a=tt.Ub();tt.Tb(0,"button",36),tt.bc("click",function(){return tt.xc(a),tt.fc().cerrarMesa()}),tt.Fc(1),tt.Sb()}if(2&t){var n=tt.fc();tt.Cb(1),tt.Hc(" Cerrar ",0==+n.mesaEnUso.mesa.esmostrador?"Mesa":0==+n.mesaEnUso.mesa.escallcenter?"Mostrador":"Pedido"," ")}}function Zn(t,e){if(1&t){var a=tt.Ub();tt.Tb(0,"app-lista-productos-comanda",37),tt.bc("productoRemovedEv",function(t){return tt.xc(a),tt.fc().updProductosCuenta(t)}),tt.Sb()}if(2&t){var n=tt.fc();tt.lc("listaProductos",n.lstProductosDeCuenta)("noCuenta",n.cuentaActiva&&+n.cuentaActiva.numero?+n.cuentaActiva.numero:1)("IdComanda",n.mesaEnUso.comanda)("IdCuenta",n.cuentaActiva.cuenta)("bloqueoBotones",n.bloqueoBotones)("mesaEnUso",n.mesaEnUso)}}var to,eo=((to=function(){function t(e,a,n,i,r,s,l,u){var d=this;c(this,t),this.dialog=e,this.snackBar=a,this.comandaSrvc=n,this.socket=i,this.ls=r,this.pdfServicio=s,this.configSrvc=l,this.articuloSrvc=u,this.clientePedido=null,this.closeSideNavEv=new tt.o,this.mesaSavedEv=new tt.o,this.showPortalComanda=!1,this.showPortalCuenta=!1,this.noComanda=0,this.sumCuenta=0,this.categorias=[],this.bloqueoBotones=!1,this.rolesUsuario=[],this.impreso=0,this.usaCodigoBarras=!1,this.codigoBarras=null,this.imprimeRecetaEnComanda=!0,this.resetMesaEnUso=function(){return d.mesaEnUso={exito:!0,comanda:null,usuario:null,sede:null,estatus:null,mesa:{mesa:null,area:{area:null,sede:null,area_padre:null,nombre:null},numero:null,posx:null,posy:null,tamanio:null,estatus:null},numero_pedido:null,cuentas:[]}},this.resetLstProductosSeleccionados=function(){return d.lstProductosSeleccionados=[]},this.resetLstProductosDeCuenta=function(){return d.lstProductosDeCuenta=[]},this.resetCuentaActiva=function(){return d.cuentaActiva={cuenta:null,numero:null,nombre:null,productos:[]}},this.resetListadoArticulos=function(){return d.appLstProdAlt.loadArbolArticulos()},this.setListaCategorias=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return d.categorias=d.setVerBotones(t)},this.setVerBotones=function(t){var e,a=o(t);try{for(a.s();!(e=a.n()).done;){var n,i=e.value,c=o(i.categoria_grupo);try{t:for(c.s();!(n=c.n()).done;){var r,s=n.value,l=o(s.articulo);try{for(l.s();!(r=l.n()).done;){var u=r.value;if(1==+u.mostrar_pos&&0==+u.debaja){s.mostrarEnPos=!0,i.mostrarEnPos=!0;continue t}}}catch(d){l.e(d)}finally{l.f()}}}catch(d){c.e(d)}finally{c.f()}}}catch(d){a.e(d)}finally{a.f()}return t},this.clickOnCategoria=function(t){return d.appLstProdAlt.fillSubCategorias(t.categoria_grupo)},this.buscarArticulo=function(){d.codigoBarras&&d.codigoBarras.trim().length>0&&d.articuloSrvc.getArticulos({codigo:d.codigoBarras.trim(),debaja:0}).subscribe(function(t){if(t&&t.length>0){var e=t[0];d.agregarProductos({id:+e.articulo,nombre:e.descripcion,precio:+e.precio,impresora:e.impresora,presentacion:e.presentacion,codigo:e.codigo,combo:e.combo,multiple:e.multiple,debaja:e.debaja})}d.codigoBarras=null,d.txtCodigoBarras.focus()})},this.llenaProductosSeleccionados=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d.mesaEnUso;null==d.mesaEnUso.comanda&&(d.mesaEnUso=t),d.lstProductosSeleccionados=[];var e,a=o(t.cuentas);try{for(a.s();!(e=a.n()).done;){var n,i=e.value,c=o(i.productos);try{for(c.s();!(n=c.n()).done;){var r=n.value;d.lstProductosSeleccionados.push({id:+r.articulo.articulo,nombre:r.articulo.descripcion,cuenta:+r.numero_cuenta||1,idcuenta:+i.cuenta,cantidad:+r.cantidad,impreso:+r.impreso,precio:parseFloat(r.precio)||10,total:parseFloat(r.total)||parseFloat(r.cantidad)*parseFloat(r.precio),notas:r.notas||"",showInputNotas:!1,itemListHeight:"70px",detalle_comanda:+r.detalle_comanda,detalle_cuenta:+r.detalle_cuenta,impresora:r.articulo.impresora,detalle:r.detalle,monto_extra:+r.monto_extra||0,multiple:+r.articulo.multiple,combo:+r.articulo.combo,esreceta:+r.articulo.esreceta||0})}}catch(s){c.e(s)}finally{c.f()}}}catch(s){a.e(s)}finally{a.f()}},this.cerrarMesa=function(){d.comandaSrvc.cerrarMesa(d.mesaEnUso.mesa.mesa).subscribe(function(t){t.exito?(d.snackBar.open(t.mensaje,"Comanda",{duration:3e3}),d.mesaEnUso.mesa.estatus=1,d.mesaSavedEv.emit(),d.socket.emit("refrescar:mesa",{mesaenuso:d.mesaEnUso})):d.snackBar.open("ERROR: ".concat(t.mensaje),"Comanda",{duration:7e3})})},this.printToBT=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=d.configSrvc.getConfig(it.b.CONSTANTES.RT_ENVIA_COMO_BASE64)?Ie.a.encode(t,!0):t,a=it.b.DEEP_LINK_ANDROID.replace("__INFOBASE64__",e);try{window.location.href=a}catch(n){d.snackBar.open("No se pudo conectar con la aplicaci\xf3n de impresi\xf3n","Comanda",{duration:3e3})}d.bloqueoBotones=!1},this.printComandaPDF=function(){var t=+d.cuentaActiva.cuenta;d.pdfServicio.getComanda(t).subscribe(function(e){if(e){var a=new Blob([e],{type:"application/pdf"}),n=window.URL.createObjectURL(a);window.open(n,"cuenta_".concat(t),"height=700,width=800,menubar=no,location=no,resizable=no,scrollbars=no,status=no")}else d.snackBar.open("No se pudo generar la comanda...","Comanda",{duration:3e3})})},this.sumaDetalle=function(t){var e,a=0,n=o(t);try{for(n.s();!(e=n.n()).done;){var i=e.value;a+=+i.total||0,a+=+i.monto_extra||0}}catch(c){n.e(c)}finally{n.f()}return a},this.enviarPedido=function(){var t=d.mesaEnUso.cuentas[0];d.cuentaActiva=d.mesaEnUso.cuentas.find(function(e){return+e.numero==+t.numero});var e=d.lstProductosSeleccionados.filter(function(t){return+t.cuenta==+d.cuentaActiva.numero});e.map(function(t){return t.impreso=1}),d.noComanda=d.mesaEnUso.comanda,d.cuentaActiva.productos=d.prepProductosComanda(e),d.mesaEnUso.cuentas.findIndex(function(t){return+t.cuenta==+d.cuentaActiva.cuenta})>-1&&d.comandaSrvc.save({area:d.mesaEnUso.mesa.area.area,mesa:d.mesaEnUso.mesa.mesa,mesero:d.mesaEnUso.usuario,comanda:d.mesaEnUso.comanda,cuentas:d.mesaEnUso.cuentas,numero_pedido:d.mesaEnUso.numero_pedido}).subscribe(function(e){e.exito&&(d.mesaEnUso.numero_pedido=e.comanda.numero_pedido,d.comandaSrvc.setProductoImpreso(t.cuenta).subscribe(function(e){d.llenaProductosSeleccionados(e.comanda),d.setSelectedCuenta(t.numero),d.cobrarCuenta()}))})},this.cambiarEstatusCuenta=function(t){var e=d.mesaEnUso.cuentas.findIndex(function(e){return+e.cuenta==+t.cuenta});d.mesaEnUso.cuentas[e].cerrada=+t.cerrada},this.esCajero=function(){return!1},this.trasladoMesa=function(){d.dialog.open(De,{width:"55%",data:{mesaEnUso:d.mesaEnUso}}).afterClosed().subscribe(function(t){t&&(d.socket.emit("refrescar:mesa",{mesaenuso:d.mesaEnUso}),d.closeSideNavEv.emit(d.mesaEnUso))})},this.getNotasGenerales=function(){d.dialog.open(xa,{width:"50%",data:{notasGenerales:d.mesaEnUso.notas_generales||""}}).afterClosed().subscribe(function(t){null!==t&&t.trim().length>0&&d.comandaSrvc.saveNotasGenerales({comanda:d.mesaEnUso.comanda,notas_generales:t}).subscribe(function(e){e.exito?(d.mesaEnUso.notas_generales=t,d.snackBar.open(e.mensaje,"Comanda",{duration:3e3})):d.snackBar.open("ERROR: ".concat(e.mensaje),"Comanda",{duration:7e3})})})},this.nuevaCuenta=function(){d.dialog.open(Oa,{width:"50%",data:{mesaEnUso:d.mesaEnUso}}).afterClosed().subscribe(function(t){t&&d.closeSideNavEv.emit()})},this.distribuirProductos=function(){d.dialog.open(_a,{width:"50%",data:{mesaEnUso:d.mesaEnUso,lstProductos:d.lstProductosSeleccionados||[]}}).afterClosed().subscribe(function(t){t&&d.closeSideNavEv.emit()})}}return s(t,[{key:"ngOnInit",value:function(){var t=this;this.resetMesaEnUso(),this.resetLstProductosSeleccionados(),this.resetLstProductosDeCuenta(),this.resetCuentaActiva(),this.impreso=0,this.noComanda=this.mesaEnUso.comanda||0,this.llenaProductosSeleccionados(),this.ls.get(it.b.usrTokenVar).sede_uuid&&(this.socket.emit("joinRestaurant",this.ls.get(it.b.usrTokenVar).sede_uuid),this.socket.on("reconnect",function(){return t.socket.emit("joinRestaurant",t.ls.get(it.b.usrTokenVar).sede_uuid)})),this.usaCodigoBarras=this.configSrvc.getConfig(it.b.CONSTANTES.RT_USA_CODIGO_BARRAS),this.imprimeRecetaEnComanda=this.configSrvc.getConfig(it.b.CONSTANTES.RT_IMPRIME_RECETA_EN_COMANDA)}},{key:"setSelectedCuenta",value:function(t){this.bloqueoBotones=!0,this.cuentaActiva=this.mesaEnUso.cuentas.find(function(e){return+e.numero==+t}),this.setLstProductosDeCuenta(),this.bloqueoBotones=!1}},{key:"setSumaCuenta",value:function(t){var e,a=0,n=o(t);try{for(n.s();!(e=n.n()).done;){var i=e.value;a+=i.precio*i.cantidad}}catch(c){n.e(c)}finally{n.f()}this.sumCuenta=a}},{key:"setLstProductosDeCuenta",value:function(){var t,e=(null===(t=this.cuentaActiva)||void 0===t?void 0:t.numero)||1;this.lstProductosDeCuenta=this.lstProductosSeleccionados.filter(function(t){return+t.cuenta==+e})}},{key:"agregarProductos",value:function(t){var e=this;1==+t.combo||1==+t.multiple?(this.bloqueoBotones=!0,this.dialog.open(Ta,{maxWidth:"50%",data:new Ca(t,"S\xed","No")}).afterClosed().subscribe(function(t){t&&t.respuesta&&t.seleccion.receta.length>0?e.comandaSrvc.saveDetalleCombo(e.mesaEnUso.comanda,e.cuentaActiva.cuenta,t.seleccion).subscribe(function(t){t.exito?(e.mesaEnUso=t.comanda,e.llenaProductosSeleccionados(e.mesaEnUso),e.setSelectedCuenta(+e.cuentaActiva.numero)):e.snackBar.open("ERROR:".concat(t.mensaje),"Comanda",{duration:3e3}),e.bloqueoBotones=!1}):(e.bloqueoBotones=!1,e.snackBar.open("Error, Debe seleccionar los productos del combo","Comanda",{duration:7e3}))})):this.addProductoSelected(t)}},{key:"addProductoSelected",value:function(t){var e=this;if(this.bloqueoBotones=!0,+this.cuentaActiva.numero){var a=this.lstProductosSeleccionados.findIndex(function(a){return+a.id==+t.id&&+a.cuenta==+e.cuentaActiva.numero&&0==+a.impreso});if(a<0)this.detalleComanda={articulo:t.id,cantidad:1,precio:+t.precio,total:1*+t.precio,notas:""},this.comandaSrvc.saveDetalle(this.mesaEnUso.comanda,this.cuentaActiva.cuenta,this.detalleComanda).subscribe(function(t){t.exito?(e.mesaEnUso=t.comanda,e.llenaProductosSeleccionados(e.mesaEnUso),e.setSelectedCuenta(+e.cuentaActiva.numero)):e.snackBar.open("ERROR:".concat(t.mensaje),"Comanda",{duration:3e3}),e.bloqueoBotones=!1});else{var n=this.lstProductosSeleccionados[a];this.detalleComanda={detalle_cuenta:n.detalle_cuenta,detalle_comanda:n.detalle_comanda,articulo:n.id,cantidad:+n.cantidad+1,precio:+n.precio,total:(+n.cantidad+1)*+n.precio,notas:n.notas},this.comandaSrvc.saveDetalle(this.mesaEnUso.comanda,this.cuentaActiva.cuenta,this.detalleComanda).subscribe(function(t){t.exito?(e.mesaEnUso=t.comanda,e.llenaProductosSeleccionados(e.mesaEnUso),e.setSelectedCuenta(+e.cuentaActiva.numero)):e.snackBar.open("ERROR:".concat(t.mensaje),"Comanda",{duration:3e3}),e.bloqueoBotones=!1})}this.setLstProductosDeCuenta()}}},{key:"updProductosCuenta",value:function(t){var e=this,a=t.listaProductos||[],n=this.lstProductosSeleccionados.filter(function(t){return+t.cuenta!=+e.cuentaActiva.numero});this.lstProductosSeleccionados=a.length>0?n.concat(a):n,t.comanda&&(this.mesaEnUso=t.comanda,this.llenaProductosSeleccionados(this.mesaEnUso),this.setSelectedCuenta(+this.cuentaActiva.numero))}},{key:"prepProductosComanda",value:function(t){for(var e=[],a=0;a<t.length;a++)e.push({articulo:t[a].id,cantidad:t[a].cantidad,precio:t[a].precio,total:t[a].total,notas:t[a].notas,impreso:1,detalle_comanda:t[a].detalle_comanda,detalle_cuenta:t[a].detalle_cuenta});return e}},{key:"validarImpresion",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],a=this.configSrvc.getConfig(it.b.CONSTANTES.RT_INGRESO_NUMERO_PEDIDO);if(1==+this.mesaEnUso.mesa.esmostrador&&a&&!this.mesaEnUso.numero_pedido){var n=this.configSrvc.getConfig(it.b.CONSTANTES.RT_TOTAL_NUMEROS_PEDIDO);(!n||n<=0)&&(n=30),this.dialog.open(da,{maxWidth:"50%",data:new ua("Numero de Pedido",n,"S\xed","No")}).afterClosed().subscribe(function(a){a&&a.respuesta&&a.pedido?(t.mesaEnUso.numero_pedido=a.pedido,t.printComanda(e)):t.snackBar.open("Error, Debe seleccionar un numero de pedido","Comanda",{duration:7e3})})}else this.printComanda(e)}},{key:"printComanda",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],a=JSON.parse(JSON.stringify(this.mesaEnUso));this.bloqueoBotones=!0,this.impreso=0;for(var n=this.configSrvc.getConfig(it.b.CONSTANTES.RT_MODO_COMANDA)||1,o=function(o){var i=a.cuentas[o];t.cuentaActiva=a.cuentas.find(function(t){return+t.numero==+i.numero});var c=t.lstProductosSeleccionados.filter(function(e){return+e.cuenta==+t.cuentaActiva.numero}),r=c.filter(function(t){return 0==+t.impreso&&+t.cantidad>0});r.length>0?(c.map(function(t){return t.impreso=1}),t.noComanda=a.comanda,t.cuentaActiva.productos=t.prepProductosComanda(c),a.cuentas.findIndex(function(e){return+e.cuenta==+t.cuentaActiva.cuenta})>-1&&t.comandaSrvc.save({area:a.mesa.area.area,mesa:a.mesa.mesa,mesero:a.mesero.usuario,comanda:a.comanda,cuentas:a.cuentas,numero_pedido:a.numero_pedido}).subscribe(function(o){o.exito?(a.numero_pedido=o.comanda.numero_pedido,t.comandaSrvc.setProductoImpreso(i.cuenta).subscribe(function(o){o.exito&&t.impreso++,t.llenaProductosSeleccionados(o.comanda),t.setSelectedCuenta(i.numero),t.snackBar.open("Cuenta actualizada","Cuenta #".concat(i.numero),{duration:3e3});var c=[],s=[];try{c=r.filter(function(t){return 0==+t.impresora.bluetooth}),s=r.filter(function(t){return 1==+t.impresora.bluetooth})}catch(l){console.log("PRODUCTOS A IMPRIMIR = ",r),console.log("NORMAL = ",c),console.log("BT = ",s),console.log(l)}e?t.printComandaPDF():(c.length>0&&(3!==n?(t.imprimeRecetaEnComanda||c.map(function(t){return 0==+t.combo&&1==+t.esreceta&&(t.detalle=[]),t}),t.socket.emit("print:comanda","".concat(JSON.stringify({Tipo:"Comanda",Nombre:t.cuentaActiva.nombre,Numero:t.noComanda,DetalleCuenta:c,Ubicacion:"".concat(a.mesa.area.nombre," - Mesa ").concat(a.mesa.etiqueta||a.mesa.numero),Mesero:"".concat(a.mesero.nombres," ").concat(a.mesero.apellidos),Total:null,NumeroPedido:a.numero_pedido,NotasGenerales:a.notas_generales||""}))),t.snackBar.open("Imprimiendo comanda #".concat(t.noComanda),"Comanda",{duration:7e3})):t.snackBar.open("Comanda #".concat(t.noComanda," enviada a cocina"),"Comanda",{duration:7e3}),t.bloqueoBotones=!1),s.length>0&&3!==n&&(t.imprimeRecetaEnComanda||s.map(function(t){return 0==+t.combo&&1==+t.esreceta&&(t.detalle=[]),t}),t.printToBT(JSON.stringify({Tipo:"Comanda",Nombre:t.cuentaActiva.nombre,Numero:t.noComanda,DetalleCuenta:s,Ubicacion:"".concat(a.mesa.area.nombre," - Mesa ").concat(a.mesa.etiqueta||a.mesa.numero),Mesero:"".concat(a.mesero.nombres," ").concat(a.mesero.apellidos),Total:null,NumeroPedido:a.numero_pedido})))),+t.impreso===a.cuentas.length&&(t.impreso=0,t.socket.emit("refrescar:mesa",{mesaenuso:a}),t.socket.emit("refrescar:listaCocina",{mesaenuso:a}),0==+a.mesa.esmostrador?t.closeSideNavEv.emit():t.cobrarCuenta())})):t.snackBar.open("ERROR: ".concat(o.mensaje),"Cuenta #".concat(t.cuentaActiva.numero),{duration:3e3}),t.bloqueoBotones=!1})):(t.impreso++,t.bloqueoBotones=!1)},i=0;i<a.cuentas.length;i++)o(i)}},{key:"printCuenta",value:function(){if(this.bloqueoBotones=!0,this.lstProductosAImprimir=this.lstProductosDeCuenta.filter(function(t){return 1==+t.impreso}),this.lstProductosAImprimir.length>0){this.setSumaCuenta(this.lstProductosAImprimir);var t=this.sumaDetalle(this.lstProductosAImprimir),e=this.mesaEnUso.mesa.impresora||this.mesaEnUso.mesa.area.impresora,a=this.configSrvc.getConfig(it.b.CONSTANTES.RT_IMPRIME_PROPINA_SUGERIDA),n={Tipo:"Cuenta",Nombre:this.cuentaActiva.nombre,Numero:null,DetalleCuenta:this.lstProductosAImprimir,Total:t,Empresa:this.ls.get(it.b.usrTokenVar).empresa,Restaurante:this.ls.get(it.b.usrTokenVar).restaurante,PropinaSugerida:a?(.1*t).toFixed(2):null,Impresora:e,Ubicacion:"".concat(this.mesaEnUso.mesa.area.nombre," - Mesa ").concat(this.mesaEnUso.mesa.etiqueta||this.mesaEnUso.mesa.numero," - Comanda ").concat(this.mesaEnUso.comanda),Mesero:"".concat(this.mesaEnUso.mesero.nombres," ").concat(this.mesaEnUso.mesero.apellidos)};0==+e.bluetooth?this.socket.emit("print:cuenta","".concat(JSON.stringify(n))):this.printToBT(JSON.stringify(n)),this.snackBar.open("Imprimiendo cuenta de ".concat(this.cuentaActiva.nombre),"Cuenta",{duration:7e3}),this.closeSideNavEv.emit()}else this.snackBar.open("La cuenta de ".concat(this.cuentaActiva.nombre," no tiene ning\xfan art\xedculo."),"Cuenta",{duration:7e3});this.bloqueoBotones=!1}},{key:"unirCuentas",value:function(){var t=this;this.dialog.open(ye,{width:"55%",data:{lstProductosSeleccionados:this.lstProductosSeleccionados,mesaEnUso:this.mesaEnUso}}).afterClosed().subscribe(function(e){e&&t.closeSideNavEv.emit()})}},{key:"cobrarCuenta",value:function(){var t=this;this.comandaSrvc.getCuenta(this.cuentaActiva.cuenta).subscribe(function(e){if(e.pendiente.length>0)t.snackBar.open("Cobro","Tiene productos sin comandar",{duration:3e3});else{var a=t.lstProductosDeCuenta.filter(function(t){return 1==+t.impreso});a.length>0?t.dialog.open(ca,{width:"95%",data:{mesaenuso:t.mesaEnUso,cuenta:t.cuentaActiva.nombre,idcuenta:t.cuentaActiva.cuenta,productosACobrar:a,porcentajePropina:0,impresora:0==+t.mesaEnUso.mesa.esmostrador?t.mesaEnUso.mesa.area.impresora_factura||null:t.mesaEnUso.mesa.impresora||t.mesaEnUso.mesa.area.impresora,clientePedido:t.clientePedido}}).afterClosed().subscribe(function(e){e&&"closePanel"!==e?(t.cambiarEstatusCuenta(e),t.closeSideNavEv.emit(t.mesaEnUso)):"closePanel"===e&&t.closeSideNavEv.emit()}):t.snackBar.open("Cobro","Sin productos a cobrar.",{duration:3e3})}})}}]),t}()).\u0275fac=function(t){return new(t||to)(tt.Nb(N.b),tt.Nb(P.b),tt.Nb(Se),tt.Nb(Ue.a),tt.Nb(dt.a),tt.Nb(qa.a),tt.Nb(Be.a),tt.Nb(ba.a))},to.\u0275cmp=tt.Hb({type:to,selectors:[["app-tran-comanda"]],viewQuery:function(t,e){var a;1&t&&(tt.Kc(In,1),tt.Kc(wn,1)),2&t&&(tt.sc(a=tt.cc())&&(e.appLstProdAlt=a.first),tt.sc(a=tt.cc())&&(e.txtCodigoBarras=a.first))},inputs:{mesaEnUso:"mesaEnUso",clientePedido:"clientePedido"},outputs:{closeSideNavEv:"closeSideNavEv",mesaSavedEv:"mesaSavedEv"},decls:43,vars:19,consts:[["fxLayout","row","fxLayout.xs","column"],["fxFlex","50%","fxFelx.xs","100%","fxLayoutAlign","center start"],["class","bld","style","font-size: 16pt; margin-left: 10px;",4,"ngIf"],["fxFlex","50%","fxFelx.xs","100%","fxLayoutAlign","end start"],["mat-raised-button","","type","button","color","accent",2,"margin-left","8px",3,"disabled","click"],[1,"divFullSize"],[1,"row"],["class","col m12 s12","align","center","style","padding: 0 !important;",4,"ngIf"],["align","center",1,"col","m6","s12",2,"padding","0 !important"],[1,"bld"],["class","fullWidth","style","margin-left: 10px; margin-right: 10px;",4,"ngIf"],[4,"ngIf"],[4,"ngFor","ngForOf"],["class","bld",4,"ngIf"],["align","center"],["direction","down"],["mat-fab","","color","warn"],[2,"font-size","18pt !important"],["mat-mini-fab","","type","button","color","warn",1,"btnAccion","btnAccionComanda",3,"disabled","click"],["mat-mini-fab","","type","button","color","warn","class","btnAccion btnAccionComanda",3,"disabled","click",4,"ngIf"],["mat-mini-fab","","type","button","color","warn","class","btnAccionComanda",3,"click",4,"ngIf"],[1,"col","m6","s12","mat-elevation-z3","colProductos"],[3,"bloqueoBotones","productoClickedEv","categoriasFilledEv"],["appLstProdAlt",""],[3,"listaProductos","noCuenta","IdComanda","IdCuenta","bloqueoBotones","mesaEnUso","productoRemovedEv",4,"ngIf"],[1,"bld",2,"font-size","16pt","margin-left","10px"],["align","center",1,"col","m12","s12",2,"padding","0 !important"],["mat-raised-button","","type","button","color","accent","class","btnAccion",3,"disabled","click",4,"ngFor","ngForOf"],["mat-raised-button","","type","button","class","btnAccion",3,"click",4,"ngIf"],["mat-raised-button","","type","button","color","accent",1,"btnAccion",3,"disabled","click"],["mat-raised-button","","type","button",1,"btnAccion",3,"click"],[1,"fullWidth",2,"margin-left","10px","margin-right","10px"],["matInput","","cdkFocusInitial","","ngxBarCodePut","","type","text","placeholder","C\xf3digo","name","codigoBarras",3,"ngModel","ngModelOptions","ngModelChange","onDetected"],["txtCodigoBarras","matInput"],["mat-raised-button","","class","btnAccion","color","accent",3,"disabled","click",4,"ngIf"],["mat-raised-button","","color","accent",1,"btnAccion",3,"disabled","click"],["mat-mini-fab","","type","button","color","warn",1,"btnAccionComanda",3,"click"],[3,"listaProductos","noCuenta","IdComanda","IdCuenta","bloqueoBotones","mesaEnUso","productoRemovedEv"]],template:function(t,e){1&t&&(tt.Tb(0,"div",0),tt.Tb(1,"div",1),tt.Dc(2,An,2,3,"span",2),tt.Sb(),tt.Tb(3,"div",3),tt.Tb(4,"button",4),tt.bc("click",function(){return e.closeSideNavEv.emit()}),tt.Fc(5," Cerrar Panel "),tt.Sb(),tt.Sb(),tt.Sb(),tt.Tb(6,"div",5),tt.Tb(7,"div",6),tt.Dc(8,Un,3,2,"div",7),tt.Sb(),tt.Tb(9,"div",6),tt.Tb(10,"div",8),tt.Tb(11,"span",9),tt.Fc(12,"Productos"),tt.Sb(),tt.Ob(13,"br"),tt.Dc(14,Bn,3,3,"mat-form-field",10),tt.Dc(15,Hn,1,0,"br",11),tt.Dc(16,qn,2,1,"ng-container",12),tt.Sb(),tt.Tb(17,"div",8),tt.Dc(18,$n,2,1,"span",13),tt.Dc(19,zn,2,0,"span",13),tt.Tb(20,"div",14),tt.Tb(21,"eco-fab-speed-dial",15),tt.Tb(22,"eco-fab-speed-dial-trigger"),tt.Tb(23,"button",16),tt.Tb(24,"mat-icon",17),tt.Fc(25,"keyboard_arrow_down"),tt.Sb(),tt.Sb(),tt.Sb(),tt.Tb(26,"eco-fab-speed-dial-actions"),tt.Tb(27,"button",18),tt.bc("click",function(){return e.getNotasGenerales()}),tt.Fc(28," Notas "),tt.Sb(),tt.Dc(29,Gn,2,1,"button",19),tt.Dc(30,Wn,2,1,"button",19),tt.Dc(31,Vn,2,1,"button",19),tt.Dc(32,Kn,2,1,"button",19),tt.Dc(33,Jn,2,1,"button",19),tt.Dc(34,Qn,2,1,"button",19),tt.Dc(35,Xn,2,1,"button",19),tt.Dc(36,Yn,2,1,"button",20),tt.Sb(),tt.Sb(),tt.Sb(),tt.Sb(),tt.Sb(),tt.Tb(37,"div",6),tt.Tb(38,"div",21),tt.Tb(39,"app-lista-producto-alt",22,23),tt.bc("productoClickedEv",function(t){return e.agregarProductos(t)})("categoriasFilledEv",function(t){return e.setListaCategorias(t)}),tt.Sb(),tt.Sb(),tt.Tb(41,"div",21),tt.Dc(42,Zn,1,6,"app-lista-productos-comanda",24),tt.Sb(),tt.Sb(),tt.Sb()),2&t&&(tt.Cb(2),tt.lc("ngIf",e.mesaEnUso),tt.Cb(2),tt.lc("disabled",e.bloqueoBotones),tt.Cb(4),tt.lc("ngIf",e.mesaEnUso),tt.Cb(6),tt.lc("ngIf",e.usaCodigoBarras),tt.Cb(1),tt.lc("ngIf",e.usaCodigoBarras),tt.Cb(1),tt.lc("ngForOf",e.categorias),tt.Cb(2),tt.lc("ngIf",e.cuentaActiva&&e.cuentaActiva.nombre),tt.Cb(1),tt.lc("ngIf",!e.cuentaActiva||!e.cuentaActiva.nombre),tt.Cb(8),tt.lc("disabled",e.bloqueoBotones),tt.Cb(2),tt.lc("ngIf",e.cuentaActiva&&e.mesaEnUso&&0==+e.mesaEnUso.mesa.escallcenter),tt.Cb(1),tt.lc("ngIf",e.cuentaActiva&&e.mesaEnUso&&0==+e.mesaEnUso.mesa.esmostrador),tt.Cb(1),tt.lc("ngIf",e.mesaEnUso&&0==+e.mesaEnUso.mesa.esmostrador),tt.Cb(1),tt.lc("ngIf",e.mesaEnUso&&0==+e.mesaEnUso.mesa.esmostrador),tt.Cb(1),tt.lc("ngIf",e.cuentaActiva&&e.mesaEnUso&&0==+e.mesaEnUso.mesa.escallcenter),tt.Cb(1),tt.lc("ngIf",e.cuentaActiva&&e.mesaEnUso&&1==+e.mesaEnUso.mesa.escallcenter),tt.Cb(1),tt.lc("ngIf",e.mesaEnUso&&0==+e.mesaEnUso.mesa.esmostrador),tt.Cb(1),tt.lc("ngIf",e.mesaEnUso&&e.lstProductosSeleccionados.length<=0),tt.Cb(3),tt.lc("bloqueoBotones",e.bloqueoBotones),tt.Cb(3),tt.lc("ngIf",e.mesaEnUso&&e.cuentaActiva))},directives:[ra.c,ra.a,ra.b,d.m,E.a,d.l,z.b,z.d,C.a,z.a,_n,T.b,k.b,m.c,et,m.k,m.n,mn],styles:[".divFullSize[_ngcontent-%COMP%]{width:100%;height:100%;overflow-y:hidden}.col[_ngcontent-%COMP%]{padding-top:1px;padding-bottom:1px}.btnAccionComanda[_ngcontent-%COMP%]{width:135px}.colProductos[_ngcontent-%COMP%]{overflow-y:auto;height:450px!important}@media (max-width:400px){.colProductos[_ngcontent-%COMP%]{height:300px!important}}@media (min-width:401px) and (max-width:1024px){.colProductos[_ngcontent-%COMP%]{height:450px!important}}@media (min-height:985px){.colProductos[_ngcontent-%COMP%]{height:600px!important}}@media (max-height:768px){.colProductos[_ngcontent-%COMP%]{height:400px!important}}"]}),to),ao=["matTabArea"],no=["rightSidenav"],oo=["tabArea"],io=["snTranComanda"];function co(t,e){if(1&t){var a=tt.Ub();tt.Tb(0,"app-mesa",12),tt.bc("onClickMesa",function(t){tt.xc(a);var e=tt.fc(2);return!e.cargando&&e.onClickMesa(t)}),tt.Sb()}if(2&t){var n=e.$implicit,o=tt.fc(2);tt.lc("configuracion",n)("isDisabled",o.cargando)}}function ro(t,e){if(1&t){var a=tt.Ub();tt.Tb(0,"mat-tab",7,8),tt.Tb(2,"div",9,10),tt.bc("resize",function(t){return tt.xc(a),tt.fc().onResize(t)},!1,tt.wc),tt.Dc(4,co,1,2,"app-mesa",11),tt.Sb(),tt.Sb()}if(2&t){var n=e.$implicit;tt.mc("label",n.nombre),tt.Cb(4),tt.lc("ngForOf",n.mesas)}}var so,lo,uo=((lo=function(){function t(e,a,n,i,r,s,l){var u=this;c(this,t),this.dialog=e,this.snackBar=a,this.ls=n,this.areaSrvc=i,this.comandaSrvc=r,this.configSrvc=s,this.socket=l,this.divSize={h:0,w:0},this.cargando=!1,this.lstTabsAreas=[],this.lstTabsAreasForUpdate=[],this.configTipoPantalla=1,this.clientePedido=null,this.endSubs=new we.a,this.actualizar=function(){var t=u.lstTabsAreas.find(function(t){return+t.area==+u.mesaSeleccionada.mesa.area.area}),e=u.lstTabsAreas.findIndex(function(t){return+t.area==+u.mesaSeleccionada.mesa.area.area}),a=t.mesas.findIndex(function(t){return+t.mesa==+u.mesaSeleccionada.mesa.mesa});u.lstTabsAreas[e].mesas[a].estatus=1,u.toggleRightSidenav()},this.resetMesaSeleccionada=function(){return u.mesaSeleccionada={comanda:null,usuario:null,sede:null,estatus:null,mesa:{mesa:null,area:{area:null,sede:null,area_padre:null,nombre:null},numero:null,posx:null,posy:null,tamanio:null,estatus:null},cuentas:[]}},this.loadAreas=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};u.cargando=!0,u.endSubs.add(u.areaSrvc.get({sede:+u.ls.get(it.b.usrTokenVar).sede||0}).subscribe(function(a){t?(u.lstTabsAreasForUpdate=a,u.updateTableStatus(e.mesaenuso)):(u.lstTabsAreas=a,u.cargando=!1)}))},this.updateTableStatus=function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=o(u.lstTabsAreasForUpdate);try{for(a.s();!(t=a.n()).done;){var n,i=t.value,c=o(i.mesas);try{for(c.s();!(n=c.n()).done;){var r=n.value;u.setEstatusMesa({area:+i.area,mesa:+r.mesa},+r.estatus)}}catch(s){c.e(s)}finally{c.f()}}}catch(s){a.e(s)}finally{a.f()}u.cargando=!1,u.rightSidenav.opened&&+u.mesaSeleccionada.comanda==+e.comanda&&u.toggleRightSidenav()},this.onResize=function(t){return u.setDivSize()},this.aperturaCargaMesa=function(t){switch(+t.mesaSelected.estatus){case 1:u.openAbrirMesaDialog(t.mesaSelected);break;case 2:u.loadComandaMesa(t.mesaSelected)}},this.setEstatusMesa=function(t,e){var a=u.lstTabsAreas.findIndex(function(e){return+e.area==+t.area});if(a>-1){var n=u.lstTabsAreas[a].mesas.findIndex(function(e){return+e.mesa==+t.mesa});n>-1&&(u.lstTabsAreas[a].mesas[n].estatus=e)}},this.guardarMesa=function(t){u.endSubs.add(u.comandaSrvc.save(u.mesaSeleccionadaToOpen).subscribe(function(e){if(u.cargando=!1,e.exito)switch(u.socket.emit("refrescar:mesa",{}),u.mesaSeleccionada=e.comanda,u.setEstatusMesa(t,+e.comanda.mesa.estatus),u.snTrancomanda.llenaProductosSeleccionados(u.mesaSeleccionada),u.snTrancomanda.setSelectedCuenta(u.mesaSeleccionada.cuentas[0].numero),u.snTrancomanda.rolesUsuario=u.mesaSeleccionada.turno_rol,u.configTipoPantalla){case 1:u.toggleRightSidenav();break;case 2:u.openTranComandaAlt();break;default:u.toggleRightSidenav()}else u.snackBar.open("".concat(e.mensaje),"ERROR",{duration:5e3})}))},this.toggleRightSidenav=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;u.rightSidenav.toggle().then(function(e){"close"===e?t?u.loadAreas(!0,{mesaenuso:t}):u.cargando=!1:"open"===e&&1===u.mesaSeleccionada.cuentas.length&&u.snTrancomanda.setSelectedCuenta(u.mesaSeleccionada.cuentas[0].numero)})},this.cerrandoRightSideNav=function(){u.snTrancomanda.resetMesaEnUso(),u.snTrancomanda.resetLstProductosDeCuenta(),u.snTrancomanda.resetLstProductosSeleccionados(),u.snTrancomanda.resetCuentaActiva(),u.snTrancomanda.resetListadoArticulos(),u.checkEstatusMesa(),u.resetMesaSeleccionada()},this.msnOpenedChange=function(t){t||u.cerrandoRightSideNav()},this.checkEstatusMesa=function(){u.mesaSeleccionada&&u.mesaSeleccionada.cuentas&&u.mesaSeleccionada.cuentas.length>0&&0===(u.mesaSeleccionada.cuentas.filter(function(t){return 0==+t.cerrada}).length||0)&&u.setEstatusMesa({area:u.mesaSeleccionada.mesa.area.area,mesa:u.mesaSeleccionada.mesa.mesa},1)},this.fuerzaCierreComanda=function(t){u.endSubs.add(u.comandaSrvc.cerrarEstacion(u.mesaSeleccionada.comanda).subscribe(function(e){u.loadComandaMesa(u.mesaSeleccionada.mesa,t)}))},this.openTranComandaAlt=function(){var t=u.dialog.open(Fn,{maxWidth:"100vw",maxHeight:"85vh",width:"99vw",height:"85vh",disableClose:!0,data:{mesa:u.mesaSeleccionada}});u.endSubs.add(t.afterClosed().subscribe(function(t){u.checkEstatusMesa(),t?u.loadAreas(!0,{mesaenuso:t}):u.cargando=!1}))},this.loadComandaMesa=function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];e&&u.cargando?u.snackBar.open("El sistema est\xe1 terminando de cargar informaci\xf3n. Por favor intente de nuevo.","\xc1reas",{duration:5e3}):(u.cargando=!0,u.endSubs.add(u.comandaSrvc.getComandaDeMesa(t.mesa).subscribe(function(t){if(t.exito)if(Array.isArray(t)?(0===t.length&&(u.mesaSeleccionada={mesa:u.mesaSeleccionada.mesa,cuentas:[{cerrada:1}]}),u.checkEstatusMesa()):(u.mesaSeleccionada=t,u.snTrancomanda.rolesUsuario=u.mesaSeleccionada.turno_rol),u.checkEstatusMesa(),e)switch(u.snTrancomanda.llenaProductosSeleccionados(u.mesaSeleccionada),u.configTipoPantalla){case 1:u.toggleRightSidenav();break;case 2:u.openTranComandaAlt();break;default:u.toggleRightSidenav()}else u.checkEstatusMesa(),u.cargando=!1;else t.mensaje&&u.snackBar.open("".concat(t.mensaje),"ERROR",{duration:5e3}),Array.isArray(t)&&0===t.length&&(u.mesaSeleccionada={mesa:u.mesaSeleccionada.mesa,cuentas:[{cerrada:1}]}),u.checkEstatusMesa(),u.cargando=!1;u.checkEstatusMesa()})))}}return s(t,[{key:"ngOnInit",value:function(){var t=this;this.loadAreas(),this.resetMesaSeleccionada(),this.ls.get(it.b.usrTokenVar).sede_uuid&&(this.socket.emit("joinRestaurant",this.ls.get(it.b.usrTokenVar).sede_uuid),this.socket.on("reconnect",function(){return t.socket.emit("joinRestaurant",t.ls.get(it.b.usrTokenVar).sede_uuid)}),this.socket.on("refrescar:mesa",function(e){t.loadAreas(!0,e)})),this.configTipoPantalla=this.configSrvc.getConfig(it.b.CONSTANTES.RT_PANTALLA_TOMA_COMANDA)}},{key:"ngAfterViewInit",value:function(){var t=this;setTimeout(function(){t.setDivSize(),t.snTrancomanda.resetMesaEnUso()},600)}},{key:"ngOnDestroy",value:function(){this.endSubs.unsubscribe()}},{key:"setDivSize",value:function(){}},{key:"onClickMesa",value:function(t){var e=this;if(this.cargando)this.snackBar.open("El sistema est\xe1 terminando de cargar informaci\xf3n. Por favor intente de nuevo.","\xc1reas",{duration:5e3});else if(0==+t.mesaSelected.escallcenter)this.aperturaCargaMesa(t);else{var a="".concat(it.b.rtClientePedido,"_").concat(t.mesaSelected.mesa);if(1==+t.mesaSelected.estatus){this.ls.clear(a);var n=this.dialog.open(ee,{width:"50%",disableClose:!0,data:{mesa:t.mesaSelected}});this.endSubs.add(n.afterClosed().subscribe(function(n){n&&(e.clientePedido=n,e.ls.set(a,e.clientePedido),e.aperturaCargaMesa(t))}))}else this.clientePedido=this.ls.get(a),this.aperturaCargaMesa(t)}}},{key:"openAbrirMesaDialog",value:function(t){var e,a=this;if(this.cargando=!0,this.mesaSeleccionadaToOpen={nombreArea:this.tabArea.textLabel,area:+t.area,mesa:+t.mesa,numero:+t.numero,mesero:"",comensales:"1",comanda:0,esEvento:!1,dividirCuentasPorSillas:!1,estatus:1,clientePedido:this.clientePedido||null,cuentas:[{numero:1,nombre:(null===(e=this.clientePedido)||void 0===e?void 0:e.nombre)||"\xdanica",productos:[]}]},0==+t.esmostrador){var n=this.dialog.open(ve,{width:"50%",height:"auto",disableClose:!0,data:this.mesaSeleccionadaToOpen});this.endSubs.add(n.afterClosed().subscribe(function(e){e?(a.mesaSeleccionadaToOpen=e,a.guardarMesa(t)):a.cargando=!1}))}else this.mesaSeleccionadaToOpen.mesero=this.ls.get(it.b.usrTokenVar).idusr,this.guardarMesa(t)}}]),t}()).\u0275fac=function(t){return new(t||lo)(tt.Nb(N.b),tt.Nb(P.b),tt.Nb(dt.a),tt.Nb(ut),tt.Nb(Se),tt.Nb(Be.a),tt.Nb(Ue.a))},lo.\u0275cmp=tt.Hb({type:lo,selectors:[["app-tran-areas"]],viewQuery:function(t,e){var a;1&t&&(tt.Kc(ao,1),tt.Kc(no,1),tt.Kc(oo,1),tt.Kc(io,1)),2&t&&(tt.sc(a=tt.cc())&&(e.pestania=a.first),tt.sc(a=tt.cc())&&(e.rightSidenav=a.first),tt.sc(a=tt.cc())&&(e.tabArea=a.first),tt.sc(a=tt.cc())&&(e.snTrancomanda=a.first))},decls:8,vars:4,consts:[[1,"matSideNavContainer"],["mode","over","position","end","disableClose","",3,"opened","openedChange"],["rightSidenav",""],[3,"mesaEnUso","clientePedido","mesaSavedEv","closeSideNavEv"],["snTranComanda",""],["dynamicHeight","","backgroundColor","primary"],[3,"label",4,"ngFor","ngForOf"],[3,"label"],["tabArea",""],[1,"divAreaMesa",3,"resize"],["matTabArea",""],[3,"configuracion","isDisabled","onClickMesa",4,"ngFor","ngForOf"],[3,"configuracion","isDisabled","onClickMesa"]],template:function(t,e){1&t&&(tt.Tb(0,"mat-sidenav-container",0),tt.Tb(1,"mat-sidenav",1,2),tt.bc("openedChange",function(t){return e.openedRightPanel=t})("openedChange",function(t){return e.msnOpenedChange(t)}),tt.Tb(3,"app-tran-comanda",3,4),tt.bc("mesaSavedEv",function(){return e.actualizar()})("closeSideNavEv",function(t){return e.toggleRightSidenav(t)}),tt.Sb(),tt.Sb(),tt.Tb(5,"mat-sidenav-content"),tt.Tb(6,"mat-tab-group",5),tt.Dc(7,ro,5,2,"mat-tab",6),tt.Sb(),tt.Sb(),tt.Sb()),2&t&&(tt.Cb(1),tt.lc("opened",e.openedRightPanel),tt.Cb(2),tt.lc("mesaEnUso",e.mesaSeleccionada)("clientePedido",e.clientePedido),tt.Cb(4),tt.lc("ngForOf",e.lstTabsAreas))},directives:[R.b,R.a,eo,R.c,F.b,d.l,F.a,Dt],styles:[".matSideNavContainer[_ngcontent-%COMP%]{height:90%;overflow:hidden!important}.divAreaMesa[_ngcontent-%COMP%]{width:100vw;height:90vh;background-color:hsla(0,0%,78%,.28627450980392155)}mat-sidenav[_ngcontent-%COMP%]{width:97vw}  .mat-drawer-inner-container{overflow-y:auto!important;overflow-x:hidden!important}"]}),lo),bo=((so=function(){function t(e){c(this,t),this.http=e,this.moduleUrl="turno",this.srvcErrHndl=new ct.a}return s(t,[{key:"get",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.http.get("".concat(it.b.urlMantenimientos,"/").concat(this.moduleUrl,"/buscar?").concat(lt.stringify(t))).pipe(Object(rt.a)(it.b.reintentos),Object(st.a)(this.srvcErrHndl.errorHandler))}},{key:"save",value:function(t){return this.http.post("".concat(it.b.urlMantenimientos,"/").concat(this.moduleUrl,"/guardar").concat(t.turno?"/"+t.turno:""),t).pipe(Object(rt.a)(it.b.reintentos),Object(st.a)(this.srvcErrHndl.errorHandler))}},{key:"getDetalle",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.http.get("".concat(it.b.urlMantenimientos,"/").concat(this.moduleUrl,"/buscar_usuario/").concat(t,"?").concat(lt.stringify(e))).pipe(Object(rt.a)(it.b.reintentos),Object(st.a)(this.srvcErrHndl.errorHandler))}},{key:"saveDetalle",value:function(t){return this.http.post("".concat(it.b.urlMantenimientos,"/").concat(this.moduleUrl,"/agregar_usuario/").concat(t.turno),t).pipe(Object(rt.a)(it.b.reintentos),Object(st.a)(this.srvcErrHndl.errorHandler))}},{key:"anularDetalle",value:function(t){return this.http.post("".concat(it.b.urlMantenimientos,"/").concat(this.moduleUrl,"/anular_usuario/").concat(t.turno),t).pipe(Object(rt.a)(it.b.reintentos),Object(st.a)(this.srvcErrHndl.errorHandler))}},{key:"replicaDetalleTurno",value:function(t,e){return this.http.get("".concat(it.b.urlMantenimientos,"/").concat(this.moduleUrl,"/replica_detalle_turno/").concat(t,"/").concat(e)).pipe(Object(rt.a)(it.b.reintentos),Object(st.a)(this.srvcErrHndl.errorHandler))}}]),t}()).\u0275fac=function(t){return new(t||so)(tt.Xb(b.b))},so.\u0275prov=tt.Jb({token:so,factory:so.\u0275fac,providedIn:"root"}),so);function mo(t,e){if(1&t){var a=tt.Ub();tt.Tb(0,"mat-list-item",5),tt.bc("click",function(){tt.xc(a);var t=e.$implicit;return tt.fc().getTurno(t)}),tt.Tb(1,"mat-icon",6),tt.Fc(2,"schedule"),tt.Sb(),tt.Tb(3,"h5",7),tt.Fc(4),tt.gc(5,"date"),tt.Sb(),tt.Ob(6,"br"),tt.Tb(7,"p",7),tt.Fc(8),tt.gc(9,"date"),tt.Sb(),tt.Sb()}if(2&t){var n=e.$implicit;tt.Cb(4),tt.Hc("Inicio: ",tt.ic(5,2,n.inicio,"dd/MM/yyyy HH:mm:ss"),""),tt.Cb(4),tt.Hc(" Fin: ",tt.ic(9,5,n.fin,"dd/MM/yyyy HH:mm:ss")," ")}}var fo,po=function(){return{standalone:!0}},go=((fo=function(){function t(e,a){var n=this;c(this,t),this.ls=e,this.turnoSrvc=a,this.getTurnoEv=new tt.o,this.length=0,this.pageSize=5,this.pageSizeOptions=[5,10,15],this.pageIndex=0,this.txtFiltro="",this.loadTurnos=function(){n.turnoSrvc.get({sede:+n.ls.get(it.b.usrTokenVar).sede||0}).subscribe(function(t){t&&t.length>0&&(n.lstTurnos=t,n.applyFilter())})},this.getTurno=function(t){n.getTurnoEv.emit({turno:t.turno,turno_tipo:t.turno_tipo.turno_tipo,fecha:t.fecha,inicio:t.inicio,fin:t.fin})},this.pageChange=function(t){n.pageSize=t.pageSize,n.pageIndex=t.pageIndex,n.applyFilter()}}return s(t,[{key:"ngOnInit",value:function(){this.loadTurnos()}},{key:"applyFilter",value:function(){if(this.txtFiltro.length>0){var t=Object(it.c)(this.lstTurnos,this.txtFiltro);this.length=t.length,this.lstTurnosPaged=Object(it.f)(t,this.pageSize,this.pageIndex+1)}else this.length=this.lstTurnos.length,this.lstTurnosPaged=Object(it.f)(this.lstTurnos,this.pageSize,this.pageIndex+1)}}]),t}()).\u0275fac=function(t){return new(t||fo)(tt.Nb(dt.a),tt.Nb(bo))},fo.\u0275cmp=tt.Hb({type:fo,selectors:[["app-lista-turno"]],outputs:{getTurnoEv:"getTurnoEv"},decls:7,vars:7,consts:[[1,"mat-elevation-z4","fullWidth"],[1,"fullWidth"],["matInput","","placeholder","Buscar...",3,"ngModel","ngModelOptions","keyup","ngModelChange"],[3,"click",4,"ngFor","ngForOf"],["showFirstLastButtons","",3,"length","pageSize","pageSizeOptions","page"],[3,"click"],["mat-list-icon",""],["mat-line",""]],template:function(t,e){1&t&&(tt.Tb(0,"mat-card",0),tt.Tb(1,"mat-card-content"),tt.Tb(2,"mat-form-field",1),tt.Tb(3,"input",2),tt.bc("keyup",function(){return e.applyFilter()})("ngModelChange",function(t){return e.txtFiltro=t}),tt.Sb(),tt.Sb(),tt.Tb(4,"mat-nav-list"),tt.Dc(5,mo,10,8,"mat-list-item",3),tt.Sb(),tt.Tb(6,"mat-paginator",4),tt.bc("page",function(t){return e.pageChange(t)}),tt.Sb(),tt.Sb(),tt.Sb()),2&t&&(tt.Cb(3),tt.lc("ngModel",e.txtFiltro)("ngModelOptions",tt.nc(6,po)),tt.Cb(2),tt.lc("ngForOf",e.lstTurnosPaged),tt.Cb(1),tt.lc("length",e.length)("pageSize",e.pageSize)("pageSizeOptions",e.pageSizeOptions))},directives:[y.a,y.c,T.b,k.b,m.c,m.k,m.n,S.e,d.l,A.a,S.c,C.a,S.b,j.j],pipes:[d.e],styles:[".fullWidth[_ngcontent-%COMP%], table[_ngcontent-%COMP%]{width:100%!important}"]}),fo);function ho(t,e){if(1&t){var a=tt.Ub();tt.Tb(0,"mat-list-item",8),tt.bc("click",function(){tt.xc(a);var t=tt.fc().$implicit;return tt.fc().turnoSelected=t}),tt.Tb(1,"mat-icon",9),tt.Fc(2,"schedule"),tt.Sb(),tt.Tb(3,"h5",10),tt.Fc(4),tt.gc(5,"date"),tt.Sb(),tt.Ob(6,"br"),tt.Tb(7,"p",10),tt.Fc(8),tt.gc(9,"date"),tt.Sb(),tt.Sb()}if(2&t){var n=tt.fc().$implicit;tt.Cb(4),tt.Hc("Inicio: ",tt.ic(5,2,n.inicio,"dd/MM/yyyy HH:mm:ss"),""),tt.Cb(4),tt.Hc("Fin: ",tt.ic(9,5,n.fin,"dd/MM/yyyy HH:mm:ss"),"")}}function vo(t,e){if(1&t&&(tt.Rb(0),tt.Dc(1,ho,10,8,"mat-list-item",7),tt.Qb()),2&t){var a=e.$implicit,n=tt.fc();tt.Cb(1),tt.lc("ngIf",+a.turno!=+n.data.turnoCopia.turno)}}function So(t,e){if(1&t&&(tt.Tb(0,"small"),tt.Tb(1,"div"),tt.Tb(2,"strong"),tt.Fc(3),tt.gc(4,"date"),tt.gc(5,"date"),tt.Sb(),tt.Sb(),tt.Sb()),2&t){var a=tt.fc();tt.Cb(3),tt.Ic("Seleccion\xf3 el turno que inicia el ",tt.ic(4,2,a.turnoSelected.inicio,"dd/MM/yyyy HH:mm:ss")," y finaliza el ",tt.ic(5,5,a.turnoSelected.fin,"dd/MM/yyyy HH:mm:ss"),"")}}var Co,To,ko,yo=((ko=function(){function t(e,a,n,o,i,r){var s=this;c(this,t),this.dialogRef=e,this.data=a,this.ls=n,this.snackBar=o,this.turnoSrvc=i,this.dialog=r,this.lstTurnos=[],this.loadTurnos=function(){s.lstTurnos=[],s.turnoSrvc.get({sede:+s.ls.get(it.b.usrTokenVar).sede||0}).subscribe(function(t){if(t&&t.length>0)for(var e=t.length>=11?11:t.length,a=0;a<e;a++)s.lstTurnos.push(t[a])})},this.cancelar=function(){return s.dialogRef.close()},this.copiar=function(){s.turnoSelected&&s.dialog.open(Mt.a,{maxWidth:"400px",data:new Mt.b("Detalle de turno","Esto copiar\xe1 el detalle del turno que seleccion\xf3. \xbfDesea continuar?","S\xed","No")}).afterClosed().subscribe(function(t){t&&s.turnoSrvc.replicaDetalleTurno(s.turnoSelected.turno,s.data.turnoCopia.turno).subscribe(function(t){t.exito?s.snackBar.open("Turno copiado con \xe9xito","Detalle turno",{duration:3e3}):s.snackBar.open("ERROR: ".concat(t.mensaje),"Detalle turno",{duration:7e3}),s.dialogRef.close()})})}}return s(t,[{key:"ngOnInit",value:function(){this.loadTurnos()}}]),t}()).\u0275fac=function(t){return new(t||ko)(tt.Nb(N.f),tt.Nb(N.a),tt.Nb(dt.a),tt.Nb(P.b),tt.Nb(bo),tt.Nb(N.b))},ko.\u0275cmp=tt.Hb({type:ko,selectors:[["app-selecciona-turno-previo"]],decls:11,vars:3,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[4,"ngFor","ngForOf"],[4,"ngIf"],["mat-dialog-actions","","align","end"],["mat-raised-button","","type","button","color","warn",3,"click"],["mat-raised-button","","type","button","color","accent",3,"disabled","click"],[3,"click",4,"ngIf"],[3,"click"],["mat-list-icon",""],["mat-line",""]],template:function(t,e){1&t&&(tt.Tb(0,"h1",0),tt.Fc(1,"\xbfDe qu\xe9 turno quiere copiar el detalle?"),tt.Sb(),tt.Tb(2,"div",1),tt.Tb(3,"mat-nav-list"),tt.Dc(4,vo,2,1,"ng-container",2),tt.Sb(),tt.Dc(5,So,6,8,"small",3),tt.Sb(),tt.Tb(6,"div",4),tt.Tb(7,"button",5),tt.bc("click",function(){return e.cancelar()}),tt.Fc(8," Cancelar "),tt.Sb(),tt.Tb(9,"button",6),tt.bc("click",function(){return e.copiar()}),tt.Fc(10," Copiar "),tt.Sb(),tt.Sb()),2&t&&(tt.Cb(4),tt.lc("ngForOf",e.lstTurnos),tt.Cb(1),tt.lc("ngIf",e.turnoSelected),tt.Cb(4),tt.lc("disabled",!e.turnoSelected))},directives:[N.g,N.d,S.e,d.l,d.m,N.c,E.a,S.c,C.a,S.b,j.j],pipes:[d.e],styles:[""]}),ko),Mo=((To=function(){function t(e){c(this,t),this.http=e,this.moduleUrl="turno",this.srvcErrHndl=new ct.a}return s(t,[{key:"get",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.http.get("".concat(it.b.urlMantenimientos,"/").concat(this.moduleUrl,"/get_turno_tipo?").concat(lt.stringify(t))).pipe(Object(rt.a)(it.b.reintentos),Object(st.a)(this.srvcErrHndl.errorHandler))}},{key:"save",value:function(t){return this.http.post("".concat(it.b.urlMantenimientos,"/").concat(this.moduleUrl,"/guardar_turno_tipo").concat(t.turno_tipo?"/"+t.turno_tipo:""),t).pipe(Object(rt.a)(it.b.reintentos),Object(st.a)(this.srvcErrHndl.errorHandler))}}]),t}()).\u0275fac=function(t){return new(t||To)(tt.Xb(b.b))},To.\u0275prov=tt.Jb({token:To,factory:To.\u0275fac,providedIn:"root"}),To),Fo=((Co=function(){function t(e){c(this,t),this.http=e,this.srvcErrHndl=new ct.a}return s(t,[{key:"get",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.http.get("".concat(it.b.urlCatalogos,"/get_tipo_usuario?").concat(lt.stringify(t))).pipe(Object(rt.a)(it.b.reintentos),Object(st.a)(this.srvcErrHndl.errorHandler))}}]),t}()).\u0275fac=function(t){return new(t||Co)(tt.Xb(b.b))},Co.\u0275prov=tt.Jb({token:Co,factory:Co.\u0275fac,providedIn:"root"}),Co);function xo(t,e){if(1&t){var a=tt.Ub();tt.Tb(0,"button",5),tt.bc("click",function(){return tt.xc(a),tt.fc().showTurnoForm=!0}),tt.Tb(1,"mat-icon",6),tt.Fc(2,"expand_more"),tt.Sb(),tt.Sb()}}function Oo(t,e){if(1&t){var a=tt.Ub();tt.Tb(0,"button",5),tt.bc("click",function(){return tt.xc(a),tt.fc().showTurnoForm=!1}),tt.Tb(1,"mat-icon",6),tt.Fc(2,"expand_less"),tt.Sb(),tt.Sb()}}function Do(t,e){if(1&t&&(tt.Tb(0,"mat-option",20),tt.Fc(1),tt.Sb()),2&t){var a=e.$implicit;tt.lc("value",a.turno_tipo),tt.Cb(1),tt.Hc(" ",a.descripcion," ")}}function Eo(t,e){if(1&t){var a=tt.Ub();tt.Tb(0,"button",21),tt.bc("click",function(){tt.xc(a);var t=tt.fc(2);return t.turno.inicio=t.getNow()}),tt.Tb(1,"mat-icon",6),tt.Fc(2,"query_builder"),tt.Sb(),tt.Sb()}}function Po(t,e){if(1&t){var a=tt.Ub();tt.Tb(0,"button",22),tt.bc("click",function(){return tt.xc(a),tt.fc(2).turno.inicio=null}),tt.Tb(1,"mat-icon",6),tt.Fc(2,"close"),tt.Sb(),tt.Sb()}}function _o(t,e){if(1&t){var a=tt.Ub();tt.Tb(0,"button",21),tt.bc("click",function(){tt.xc(a);var t=tt.fc(2);return t.turno.fin=t.getNow()}),tt.Tb(1,"mat-icon",6),tt.Fc(2,"query_builder"),tt.Sb(),tt.Sb()}}function Io(t,e){if(1&t){var a=tt.Ub();tt.Tb(0,"button",22),tt.bc("click",function(){return tt.xc(a),tt.fc(2).turno.fin=null}),tt.Tb(1,"mat-icon",6),tt.Fc(2,"close"),tt.Sb(),tt.Sb()}}function wo(t,e){if(1&t){var a=tt.Ub();tt.Tb(0,"button",23),tt.bc("click",function(){return tt.xc(a),tt.fc(2).resetTurno()}),tt.Fc(1," Nuevo "),tt.Sb()}}function Ao(t,e){if(1&t&&(tt.Tb(0,"li"),tt.Fc(1),tt.Sb()),2&t){var a=e.$implicit;tt.Cb(1),tt.Gc(a)}}function No(t,e){if(1&t&&(tt.Tb(0,"li"),tt.Fc(1),tt.Sb()),2&t){var a=e.$implicit;tt.Cb(1),tt.Gc(a)}}function Ro(t,e){if(1&t&&(tt.Tb(0,"div"),tt.Tb(1,"h6"),tt.Fc(2,"Documentos Pendientes"),tt.Sb(),tt.Tb(3,"div",24),tt.Tb(4,"div",25),tt.Tb(5,"label"),tt.Tb(6,"b"),tt.Fc(7,"Comandas sin facturar"),tt.Sb(),tt.Sb(),tt.Tb(8,"ul"),tt.Dc(9,Ao,2,1,"li",26),tt.Sb(),tt.Sb(),tt.Tb(10,"div",25),tt.Tb(11,"label"),tt.Tb(12,"b"),tt.Fc(13,"Facturas sin firmar"),tt.Sb(),tt.Sb(),tt.Tb(14,"ul"),tt.Dc(15,No,2,1,"li",26),tt.Sb(),tt.Sb(),tt.Sb(),tt.Sb()),2&t){var a=tt.fc(2);tt.Cb(9),tt.lc("ngForOf",a.comandas),tt.Cb(6),tt.lc("ngForOf",a.facturas)}}function Uo(t,e){if(1&t){var a=tt.Ub();tt.Tb(0,"form",7,8),tt.bc("ngSubmit",function(){tt.xc(a);var t=tt.tc(1),e=tt.fc();return t.form.valid&&e.onSubmit()}),tt.Tb(2,"div",9),tt.Tb(3,"mat-form-field",10),tt.Tb(4,"mat-label"),tt.Fc(5,"Tipo de turno"),tt.Sb(),tt.Tb(6,"mat-select",11),tt.bc("ngModelChange",function(t){return tt.xc(a),tt.fc().turno.turno_tipo=t}),tt.Dc(7,Do,2,2,"mat-option",12),tt.Sb(),tt.Sb(),tt.Sb(),tt.Tb(8,"div",9),tt.Tb(9,"mat-form-field",10),tt.Tb(10,"input",13),tt.bc("ngModelChange",function(t){return tt.xc(a),tt.fc().turno.inicio=t}),tt.Sb(),tt.Dc(11,Eo,3,0,"button",14),tt.Dc(12,Po,3,0,"button",15),tt.Sb(),tt.Sb(),tt.Tb(13,"div",9),tt.Tb(14,"mat-form-field",10),tt.Tb(15,"input",16),tt.bc("ngModelChange",function(t){return tt.xc(a),tt.fc().turno.fin=t}),tt.Sb(),tt.Dc(16,_o,3,0,"button",14),tt.Dc(17,Io,3,0,"button",15),tt.Sb(),tt.Sb(),tt.Tb(18,"div",17),tt.Tb(19,"button",18),tt.Fc(20," Guardar "),tt.Sb(),tt.Dc(21,wo,2,0,"button",19),tt.Sb(),tt.Dc(22,Ro,16,2,"div",3),tt.Sb()}if(2&t){var n=tt.tc(1),o=tt.fc();tt.Cb(6),tt.lc("ngModel",o.turno.turno_tipo),tt.Cb(1),tt.lc("ngForOf",o.tiposTurno),tt.Cb(3),tt.lc("ngModel",o.turno.inicio),tt.Cb(1),tt.lc("ngIf",!o.turno.inicio),tt.Cb(1),tt.lc("ngIf",o.turno.inicio),tt.Cb(3),tt.lc("ngModel",o.turno.fin),tt.Cb(1),tt.lc("ngIf",!o.turno.fin),tt.Cb(1),tt.lc("ngIf",o.turno.fin),tt.Cb(2),tt.lc("disabled",!n.form.valid),tt.Cb(2),tt.lc("ngIf",o.turno.turno),tt.Cb(1),tt.lc("ngIf",o.pendientes)}}function jo(t,e){1&t&&tt.Ob(0,"hr")}function Bo(t,e){if(1&t){var a=tt.Ub();tt.Tb(0,"button",5),tt.bc("click",function(){return tt.xc(a),tt.fc(2).showDetalleTurnoForm=!0}),tt.Tb(1,"mat-icon",6),tt.Fc(2,"expand_more"),tt.Sb(),tt.Sb()}}function Ho(t,e){if(1&t){var a=tt.Ub();tt.Tb(0,"button",5),tt.bc("click",function(){return tt.xc(a),tt.fc(2).showDetalleTurnoForm=!1}),tt.Tb(1,"mat-icon",6),tt.Fc(2,"expand_less"),tt.Sb(),tt.Sb()}}function Lo(t,e){if(1&t&&(tt.Tb(0,"mat-option",20),tt.Fc(1),tt.Sb()),2&t){var a=e.$implicit;tt.lc("value",a.usuario_tipo),tt.Cb(1),tt.Hc(" ",a.descripcion," ")}}function qo(t,e){if(1&t&&(tt.Tb(0,"mat-option",20),tt.Fc(1),tt.Sb()),2&t){var a=e.$implicit;tt.lc("value",a.usuario),tt.Cb(1),tt.Ic(" ",a.nombres," ",a.apellidos," ")}}function $o(t,e){if(1&t){var a=tt.Ub();tt.Tb(0,"form",7,28),tt.bc("ngSubmit",function(){tt.xc(a);var t=tt.tc(1),e=tt.fc(2);return t.form.valid&&e.onSubmitDetail()}),tt.Tb(2,"div",9),tt.Tb(3,"mat-form-field",10),tt.Tb(4,"mat-label"),tt.Fc(5,"Tipo"),tt.Sb(),tt.Tb(6,"mat-select",29),tt.bc("ngModelChange",function(t){return tt.xc(a),tt.fc(2).detalleTurno.usuario_tipo=t}),tt.Dc(7,Lo,2,2,"mat-option",12),tt.Sb(),tt.Sb(),tt.Sb(),tt.Tb(8,"div",9),tt.Tb(9,"mat-form-field",10),tt.Tb(10,"mat-label"),tt.Fc(11,"Usuario"),tt.Sb(),tt.Tb(12,"mat-select",30),tt.bc("ngModelChange",function(t){return tt.xc(a),tt.fc(2).detalleTurno.usuario=t}),tt.Dc(13,qo,2,3,"mat-option",12),tt.Sb(),tt.Sb(),tt.Sb(),tt.Tb(14,"div",31),tt.Tb(15,"button",32),tt.bc("click",function(){return tt.xc(a),tt.fc(2).copiaDetalleTurno()}),tt.Fc(16," Copiar de turno anterior "),tt.Sb(),tt.Tb(17,"button",18),tt.Fc(18," Guardar "),tt.Sb(),tt.Sb(),tt.Sb()}if(2&t){var n=tt.tc(1),o=tt.fc(2);tt.Cb(6),tt.lc("ngModel",o.detalleTurno.usuario_tipo),tt.Cb(1),tt.lc("ngForOf",o.tiposUsuario),tt.Cb(5),tt.lc("ngModel",o.detalleTurno.usuario),tt.Cb(1),tt.lc("ngForOf",o.usuarios),tt.Cb(2),tt.lc("disabled",!!o.turno.fin),tt.Cb(2),tt.lc("disabled",!n.form.valid||!!o.turno.fin)}}function zo(t,e){1&t&&tt.Ob(0,"hr")}function Go(t,e){1&t&&(tt.Tb(0,"th",43),tt.Fc(1,"Tipo"),tt.Sb())}function Wo(t,e){if(1&t&&(tt.Tb(0,"td",44),tt.Fc(1),tt.Sb()),2&t){var a=e.$implicit;tt.Cb(1),tt.Gc(a.usuario_tipo.descripcion)}}function Vo(t,e){1&t&&(tt.Tb(0,"th",45),tt.Fc(1,"Usuario"),tt.Sb())}function Ko(t,e){if(1&t&&(tt.Tb(0,"td",46),tt.Fc(1),tt.Sb()),2&t){var a=e.$implicit;tt.Cb(1),tt.Ic("",a.usuario.nombres," ",a.usuario.apellidos,"")}}function Jo(t,e){1&t&&(tt.Tb(0,"th",43),tt.Fc(1,"\xa0"),tt.Sb())}function Qo(t,e){if(1&t){var a=tt.Ub();tt.Tb(0,"td",44),tt.Tb(1,"button",47),tt.bc("click",function(){tt.xc(a);var t=e.$implicit;return tt.fc(3).anularDetalleTurno(t)}),tt.Fc(2," Anular "),tt.Sb(),tt.Sb()}if(2&t){var n=tt.fc(3);tt.Cb(1),tt.lc("disabled",!!n.turno.fin)}}function Xo(t,e){1&t&&tt.Ob(0,"tr",48)}function Yo(t,e){1&t&&tt.Ob(0,"tr",49)}function Zo(t,e){if(1&t&&(tt.Tb(0,"table",33),tt.Rb(1,34),tt.Dc(2,Go,2,0,"th",35),tt.Dc(3,Wo,2,1,"td",36),tt.Qb(),tt.Rb(4,37),tt.Dc(5,Vo,2,0,"th",38),tt.Dc(6,Ko,2,2,"td",39),tt.Qb(),tt.Rb(7,40),tt.Dc(8,Jo,2,0,"th",35),tt.Dc(9,Qo,3,1,"td",36),tt.Qb(),tt.Dc(10,Xo,1,0,"tr",41),tt.Dc(11,Yo,1,0,"tr",42),tt.Sb()),2&t){var a=tt.fc(2);tt.lc("dataSource",a.dataSource),tt.Cb(10),tt.lc("matHeaderRowDef",a.displayedColumns),tt.Cb(1),tt.lc("matRowDefColumns",a.displayedColumns)}}function ti(t,e){if(1&t&&(tt.Tb(0,"mat-card",0),tt.Tb(1,"mat-card-title"),tt.Tb(2,"h4"),tt.Fc(3),tt.gc(4,"date"),tt.Dc(5,Bo,3,0,"button",1),tt.Dc(6,Ho,3,0,"button",1),tt.Sb(),tt.Sb(),tt.Tb(7,"mat-card-content"),tt.Dc(8,$o,19,6,"form",2),tt.Dc(9,zo,1,0,"hr",3),tt.Dc(10,Zo,12,3,"table",27),tt.Sb(),tt.Sb()),2&t){var a=tt.fc();tt.Cb(3),tt.Hc(" Detalle del turno ",tt.ic(4,6,a.turno.inicio,"dd/MM/yyyy HH:mm:ss")," "),tt.Cb(2),tt.lc("ngIf",!a.showDetalleTurnoForm),tt.Cb(1),tt.lc("ngIf",a.showDetalleTurnoForm),tt.Cb(2),tt.lc("ngIf",a.showDetalleTurnoForm),tt.Cb(1),tt.lc("ngIf",a.detallesTurno.length>0),tt.Cb(1),tt.lc("ngIf",a.detallesTurno.length>0)}}var ei,ai,ni,oi=((ei=function(){function t(e,a,n,o,i,r,s){var l=this;c(this,t),this.snackBar=e,this.ls=a,this.tipoTurnoSrvc=n,this.turnoSrvc=o,this.usuarioTipoSrvc=i,this.usuarioSrvc=r,this.dialog=s,this.turnoSavedEv=new tt.o,this.showTurnoForm=!0,this.showDetalleTurnoForm=!0,this.detallesTurno=[],this.displayedColumns=["usuario_tipo","usuario","editItem"],this.tiposTurno=[],this.tiposUsuario=[],this.usuarios=[],this.esMovil=!1,this.comandas=[],this.facturas=[],this.pendientes=!1,this.loadTiposTurno=function(){l.tipoTurnoSrvc.get().subscribe(function(t){t&&(l.tiposTurno=t)})},this.loadTiposUsuario=function(){l.usuarioTipoSrvc.get().subscribe(function(t){t&&(l.tiposUsuario=t)})},this.loadUsuarios=function(){l.usuarioSrvc.get({sede:l.ls.get(it.b.usrTokenVar).sede||0}).subscribe(function(t){t&&(l.usuarios=t)})},this.resetTurno=function(){l.pendientes=!1,l.comandas=[],l.facturas=[],l.turno={turno:null,turno_tipo:null,inicio:Ee().format(it.b.dbDateTimeFormat),fin:null},l.resetDetalleTurno(),l.detallesTurno=[],l.updateTableDataSource()},this.saveInfoTurno=function(){l.pendientes=!1,l.turnoSrvc.save(l.turno).subscribe(function(t){t.exito?(l.turnoSavedEv.emit(),l.resetTurno(),l.turno=t.turno,l.snackBar.open("Turno modificado con \xe9xito...","Turno",{duration:3e3})):(t.pendientes&&(l.snackBar.open("ERROR: Error al cerrar el turno","Turno",{duration:3e3}),l.pendientes=!0,l.comandas=t.comandas,l.facturas=t.facturas),l.snackBar.open("ERROR: ".concat(t.mensaje),"Turno",{duration:3e3}))})},this.onSubmit=function(){Ee(l.turno.fin).isValid()?l.dialog.open(Mt.a,{maxWidth:"400px",data:new Mt.b("Cerrar turno","La fecha de finalizaci\xf3n cerrar\xe1 el turno. \xbfDesea continuar?","S\xed","No")}).afterClosed().subscribe(function(t){t&&l.saveInfoTurno()}):l.saveInfoTurno()},this.resetDetalleTurno=function(){return l.detalleTurno={turno:l.turno.turno?l.turno.turno:null,usuario:null,usuario_tipo:null}},this.loadDetalleTurno=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:+l.turno.turno;l.turnoSrvc.getDetalle(t,{turno:t}).subscribe(function(t){t&&(l.detallesTurno=t,l.updateTableDataSource())})},this.onSubmitDetail=function(){l.detalleTurno.turno=l.turno.turno,l.turnoSrvc.saveDetalle(l.detalleTurno).subscribe(function(t){t.exito?(l.loadDetalleTurno(),l.resetDetalleTurno(),l.snackBar.open("Usuario agregado al turno...","Turno",{duration:3e3})):l.snackBar.open("ERROR: ".concat(t.mensaje),"Turno",{duration:3e3})})},this.anularDetalleTurno=function(t){l.turnoSrvc.anularDetalle({turno:t.turno,usuario:t.usuario.usuario,usuario_tipo:t.usuario_tipo.usuario_tipo}).subscribe(function(t){t.exito?(l.loadDetalleTurno(),l.resetDetalleTurno(),l.snackBar.open("Se quit\xf3 al usuario del turno...","Turno",{duration:3e3})):l.snackBar.open("ERROR: ".concat(t.mensaje),"Turno",{duration:3e3})})},this.updateTableDataSource=function(){return l.dataSource=new x.l(l.detallesTurno)},this.getNow=function(){return Ee().format(it.b.dbDateTimeFormat)},this.copiaDetalleTurno=function(){l.dialog.open(yo,{maxWidth:"400px",data:{turnoCopia:l.turno}}).afterClosed().subscribe(function(){return l.loadDetalleTurno(+l.turno.turno)})}}return s(t,[{key:"ngOnInit",value:function(){this.esMovil=this.ls.get(it.b.usrTokenVar).enmovil||!1,this.resetTurno(),this.loadTiposTurno(),this.loadTiposUsuario(),this.loadUsuarios()}}]),t}()).\u0275fac=function(t){return new(t||ei)(tt.Nb(P.b),tt.Nb(dt.a),tt.Nb(Mo),tt.Nb(bo),tt.Nb(Fo),tt.Nb(be.a),tt.Nb(N.b))},ei.\u0275cmp=tt.Hb({type:ei,selectors:[["app-form-turno"]],inputs:{turno:"turno"},outputs:{turnoSavedEv:"turnoSavedEv"},decls:11,vars:9,consts:[[1,"mat-elevation-z4","fullWidth"],["mat-icon-button","","type","button","color","accent",3,"click",4,"ngIf"],["novalidate","",3,"ngSubmit",4,"ngIf"],[4,"ngIf"],["class","mat-elevation-z4 fullWidth",4,"ngIf"],["mat-icon-button","","type","button","color","accent",3,"click"],[1,"iconFontSize"],["novalidate","",3,"ngSubmit"],["frmTurno","ngForm"],[1,"form-group"],[1,"fullWidth"],["name","turno_tipo","required","",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["matInput","","type","datetime-locale","placeholder","Inicio","name","inicio","required","",3,"ngModel","ngModelChange"],["type","button","mat-button","","matSuffix","","mat-icon-button","",3,"click",4,"ngIf"],["type","button","mat-button","","matSuffix","","mat-icon-button","","aria-label","Clear",3,"click",4,"ngIf"],["matInput","","type","datetime-locale","placeholder","Fin","name","fin",3,"ngModel","ngModelChange"],["role","group","align","end"],["mat-raised-button","","type","submit","color","accent",1,"btnAccion",3,"disabled"],["mat-raised-button","","type","button","color","accent",3,"click",4,"ngIf"],[3,"value"],["type","button","mat-button","","matSuffix","","mat-icon-button","",3,"click"],["type","button","mat-button","","matSuffix","","mat-icon-button","","aria-label","Clear",3,"click"],["mat-raised-button","","type","button","color","accent",3,"click"],[1,"row"],[1,"col"],[4,"ngFor","ngForOf"],["mat-table","","class","mat-elevation-z4 full-width",3,"dataSource",4,"ngIf"],["frmDetalleTurno","ngForm"],["name","usuario_tipo","required","",3,"ngModel","ngModelChange"],["name","usuario","required","",3,"ngModel","ngModelChange"],["align","right"],["mat-raised-button","","type","button","color","accent",1,"btnAccion",3,"disabled","click"],["mat-table","",1,"mat-elevation-z4","full-width",3,"dataSource"],["matColumnDef","usuario_tipo"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","","class","text-wrap",4,"matCellDef"],["matColumnDef","usuario"],["mat-header-cell","","class","text-right",4,"matHeaderCellDef"],["mat-cell","","class","text-right",4,"matCellDef"],["matColumnDef","editItem"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell","",1,"text-wrap"],["mat-header-cell","",1,"text-right"],["mat-cell","",1,"text-right"],["mat-raised-button","","type","button","color","accent",3,"disabled","click"],["mat-header-row",""],["mat-row",""]],template:function(t,e){1&t&&(tt.Tb(0,"mat-card",0),tt.Tb(1,"mat-card-title"),tt.Tb(2,"h4"),tt.Fc(3),tt.gc(4,"date"),tt.Dc(5,xo,3,0,"button",1),tt.Dc(6,Oo,3,0,"button",1),tt.Sb(),tt.Sb(),tt.Tb(7,"mat-card-content"),tt.Dc(8,Uo,23,11,"form",2),tt.Sb(),tt.Sb(),tt.Dc(9,jo,1,0,"hr",3),tt.Dc(10,ti,11,9,"mat-card",4)),2&t&&(tt.Cb(3),tt.Hc(" Turno ",e.turno.turno?tt.ic(4,6,e.turno.inicio,"dd/MM/yyyy HH:mm:ss"):""," "),tt.Cb(2),tt.lc("ngIf",!e.showTurnoForm),tt.Cb(1),tt.lc("ngIf",e.showTurnoForm),tt.Cb(2),tt.lc("ngIf",e.showTurnoForm),tt.Cb(1),tt.lc("ngIf",e.turno.turno),tt.Cb(1),tt.lc("ngIf",e.turno.turno))},directives:[y.a,y.h,d.m,y.c,E.a,C.a,m.r,m.l,m.m,T.b,T.f,O.a,m.p,m.k,m.n,d.l,k.b,m.c,j.m,T.g,x.k,x.c,x.e,x.b,x.g,x.j,x.d,x.a,x.f,x.i],pipes:[d.e],styles:[".full-width[_ngcontent-%COMP%]{width:100%}.iconFontSize[_ngcontent-%COMP%]{font-size:34pt!important}"]}),ei),ii=["lstTurno"],ci=["frmTurno"],ri=((ai=function(){function t(){var e=this;c(this,t),this.setTurno=function(t){e.turno=t,e.frmTurno.loadDetalleTurno(+e.turno.turno),e.frmTurno.pendientes=!1,e.frmTurno.comandas=[],e.frmTurno.facturas=[]},this.refreshTurnoList=function(){return e.lstTurnoComponent.loadTurnos()},this.turno={turno:null,turno_tipo:null,inicio:Ee().format(it.b.dbDateTimeFormat),fin:null}}return s(t,[{key:"ngOnInit",value:function(){}}]),t}()).\u0275fac=function(t){return new(t||ai)},ai.\u0275cmp=tt.Hb({type:ai,selectors:[["app-turno"]],viewQuery:function(t,e){var a;1&t&&(tt.Kc(ii,1),tt.Kc(ci,1)),2&t&&(tt.sc(a=tt.cc())&&(e.lstTurnoComponent=a.first),tt.sc(a=tt.cc())&&(e.frmTurno=a.first))},decls:7,vars:1,consts:[[1,"row"],[1,"col","m5","s12"],[3,"getTurnoEv"],["lstTurno",""],[1,"col","m7","s12"],[3,"turno","turnoSavedEv"],["frmTurno",""]],template:function(t,e){1&t&&(tt.Tb(0,"div",0),tt.Tb(1,"div",1),tt.Tb(2,"app-lista-turno",2,3),tt.bc("getTurnoEv",function(t){return e.setTurno(t)}),tt.Sb(),tt.Sb(),tt.Tb(4,"div",4),tt.Tb(5,"app-form-turno",5,6),tt.bc("turnoSavedEv",function(){return e.refreshTurnoList()}),tt.Sb(),tt.Sb(),tt.Sb()),2&t&&(tt.Cb(5),tt.lc("turno",e.turno))},directives:[go,oi],styles:[""]}),ai),si=i("Iab2"),li=((ni=function(){function t(e){c(this,t),this.http=e,this.moduleUrl="reporte/venta",this.srvcErrHndl=new ct.a}return s(t,[{key:"porCategoria",value:function(t){return this.http.get("".concat(it.b.urlFacturacion,"/").concat(this.moduleUrl,"/categoria?").concat(lt.stringify(t))).pipe(Object(rt.a)(it.b.reintentos),Object(st.a)(this.srvcErrHndl.errorHandler))}},{key:"porArticulo",value:function(t){return this.http.get("".concat(it.b.urlFacturacion,"/").concat(this.moduleUrl,"/articulo?").concat(lt.stringify(t))).pipe(Object(rt.a)(it.b.reintentos),Object(st.a)(this.srvcErrHndl.errorHandler))}},{key:"porCategoriaPdf",value:function(t){var e={headers:new b.d({Accept:"application/pdf"}),responseType:"blob"};return this.http.get("".concat(it.b.urlFacturacion,"/").concat(this.moduleUrl,"/categoriapdf/1?").concat(lt.stringify(t)),e).pipe(Object(rt.a)(it.b.reintentos),Object(st.a)(this.srvcErrHndl.errorHandler))}},{key:"porArticuloPdf",value:function(t){var e={headers:new b.d({Accept:"application/pdf"}),responseType:"blob"};return this.http.get("".concat(it.b.urlFacturacion,"/").concat(this.moduleUrl,"/articulopdf/1?").concat(lt.stringify(t)),e).pipe(Object(rt.a)(it.b.reintentos),Object(st.a)(this.srvcErrHndl.errorHandler))}}]),t}()).\u0275fac=function(t){return new(t||ni)(tt.Xb(b.b))},ni.\u0275prov=tt.Jb({token:ni,factory:ni.\u0275fac,providedIn:"root"}),ni),ui=i("2qVp"),di=i("NU9O");function bi(t,e){if(1&t&&(tt.Rb(0),tt.Tb(1,"tr"),tt.Tb(2,"td",10),tt.Fc(3),tt.Sb(),tt.Tb(4,"td",11),tt.Fc(5),tt.gc(6,"number"),tt.Sb(),tt.Tb(7,"td",11),tt.Fc(8),tt.gc(9,"number"),tt.Sb(),tt.Tb(10,"td",11),tt.Fc(11),tt.gc(12,"number"),tt.Sb(),tt.Tb(13,"td",11),tt.Fc(14),tt.gc(15,"number"),tt.Sb(),tt.Sb(),tt.Qb()),2&t){var a=e.$implicit;tt.Cb(3),tt.Gc(a.descripcion),tt.Cb(2),tt.Gc(tt.ic(6,5,a.cantidad,"1.2-2")),tt.Cb(3),tt.Gc(tt.ic(9,8,a.porcentaje,"1.2-2")),tt.Cb(3),tt.Gc(tt.ic(12,11,a.precio_unitario,"1.2-2")),tt.Cb(3),tt.Gc(tt.ic(15,14,a.total,"1.2-2"))}}function mi(t,e){if(1&t&&(tt.Rb(0),tt.Tb(1,"tr"),tt.Tb(2,"th",7),tt.Fc(3),tt.Sb(),tt.Sb(),tt.Dc(4,bi,16,17,"ng-container",4),tt.Tb(5,"tr"),tt.Tb(6,"th",8),tt.Fc(7,"Total de subcategor\xeda:"),tt.Sb(),tt.Tb(8,"th",9),tt.Fc(9),tt.gc(10,"number"),tt.Sb(),tt.Sb(),tt.Qb()),2&t){var a=tt.fc().$implicit;tt.Cb(3),tt.Gc(a.descripcion),tt.Cb(1),tt.lc("ngForOf",a.articulos),tt.Cb(5),tt.Gc(tt.ic(10,3,a.total,"1.2-2"))}}function fi(t,e){if(1&t&&(tt.Rb(0),tt.Dc(1,mi,11,6,"ng-container",5),tt.Qb()),2&t){var a=e.$implicit;tt.Cb(1),tt.lc("ngIf",a.articulos.length>0)}}function pi(t,e){if(1&t&&(tt.Rb(0),tt.Tb(1,"tr"),tt.Tb(2,"th",6),tt.Fc(3),tt.Sb(),tt.Sb(),tt.Dc(4,fi,2,1,"ng-container",4),tt.Qb()),2&t){var a=tt.fc().$implicit;tt.Cb(3),tt.Gc(a.descripcion),tt.Cb(1),tt.lc("ngForOf",a.subcategoria)}}function gi(t,e){if(1&t&&(tt.Rb(0),tt.Dc(1,pi,5,2,"ng-container",5),tt.Qb()),2&t){var a=e.$implicit;tt.Cb(1),tt.lc("ngIf",a.subcategoria.length>0)}}var hi,vi=((hi=function(){function t(){c(this,t),this.params={},this.data=[]}return s(t,[{key:"ngOnInit",value:function(){}}]),t}()).\u0275fac=function(t){return new(t||hi)},hi.\u0275cmp=tt.Hb({type:hi,selectors:[["app-por-categoria"]],inputs:{params:"params",data:"data"},decls:26,vars:9,consts:[[1,"mat-elevation-z4","fullWidth"],[1,"tbl"],[1,"brdTSingleBSingle"],[1,"rtxt","numWidth","brdTSingleBSingle"],[4,"ngFor","ngForOf"],[4,"ngIf"],["colspan","5"],["colspan","5",1,"tab"],["colspan","4",1,"rtxt"],[1,"rtxt","brdTSingleBDouble","numWidth"],[1,"doubleTab","brdBSingle"],[1,"rtxt","numWidth","brdBSingle"]],template:function(t,e){1&t&&(tt.Tb(0,"mat-card",0),tt.Tb(1,"mat-card-header"),tt.Tb(2,"mat-card-title"),tt.Fc(3,"Reporte de ventas"),tt.Sb(),tt.Tb(4,"mat-card-subtitle"),tt.Fc(5," Por categor\xeda"),tt.Ob(6,"br"),tt.Fc(7),tt.gc(8,"date"),tt.gc(9,"date"),tt.Sb(),tt.Sb(),tt.Tb(10,"mat-card-content"),tt.Tb(11,"table",1),tt.Tb(12,"thead"),tt.Tb(13,"tr"),tt.Tb(14,"th",2),tt.Fc(15,"Descripci\xf3n"),tt.Sb(),tt.Tb(16,"th",3),tt.Fc(17,"Cantidad"),tt.Sb(),tt.Tb(18,"th",3),tt.Fc(19,"Porcentaje"),tt.Sb(),tt.Tb(20,"th",3),tt.Fc(21,"Precio unitario"),tt.Sb(),tt.Tb(22,"th",3),tt.Fc(23,"Total"),tt.Sb(),tt.Sb(),tt.Sb(),tt.Tb(24,"tbody"),tt.Dc(25,gi,2,1,"ng-container",4),tt.Sb(),tt.Sb(),tt.Sb(),tt.Sb()),2&t&&(tt.Cb(7),tt.Ic(" Del ",tt.ic(8,3,e.params.fdel,"dd/MM/yyyy")," al ",tt.ic(9,6,e.params.fal,"dd/MM/yyyy")," "),tt.Cb(18),tt.lc("ngForOf",e.data))},directives:[y.a,y.d,y.h,y.g,y.c,d.l,d.m],pipes:[d.e,d.f],styles:[".numWidth[_ngcontent-%COMP%]{width:10%}tr[_ngcontent-%COMP%]{border:none}td[_ngcontent-%COMP%], th[_ngcontent-%COMP%]{padding-top:.25em;padding-bottom:.25em}"]}),hi);function Si(t,e){if(1&t&&(tt.Rb(0),tt.Tb(1,"tr"),tt.Tb(2,"td",6),tt.Fc(3),tt.Sb(),tt.Tb(4,"td",7),tt.Fc(5),tt.gc(6,"number"),tt.Sb(),tt.Tb(7,"td",7),tt.Fc(8),tt.gc(9,"number"),tt.Sb(),tt.Sb(),tt.Qb()),2&t){var a=e.$implicit;tt.Cb(3),tt.Gc(a.articulo.descripcion),tt.Cb(2),tt.Gc(tt.ic(6,3,a.cantidad,"1.2-2")),tt.Cb(3),tt.Gc(tt.ic(9,6,a.total,"1.2-2"))}}function Ci(t,e){if(1&t&&(tt.Tb(0,"mat-card-content"),tt.Tb(1,"table",2),tt.Tb(2,"thead"),tt.Tb(3,"tr"),tt.Tb(4,"th",3),tt.Fc(5,"Descripci\xf3n"),tt.Sb(),tt.Tb(6,"th",4),tt.Fc(7,"Cantidad"),tt.Sb(),tt.Tb(8,"th",4),tt.Fc(9,"Total"),tt.Sb(),tt.Sb(),tt.Sb(),tt.Tb(10,"tbody"),tt.Dc(11,Si,10,9,"ng-container",5),tt.Sb(),tt.Sb(),tt.Sb()),2&t){var a=tt.fc();tt.Cb(11),tt.lc("ngForOf",a.data.datos)}}function Ti(t,e){if(1&t&&(tt.Tb(0,"tr"),tt.Tb(1,"td",6),tt.Fc(2),tt.Sb(),tt.Tb(3,"td",7),tt.Fc(4),tt.gc(5,"number"),tt.Sb(),tt.Tb(6,"td",7),tt.Fc(7),tt.gc(8,"number"),tt.Sb(),tt.Sb()),2&t){var a=e.$implicit;tt.Cb(2),tt.Gc(a.articulo.descripcion),tt.Cb(2),tt.Gc(tt.ic(5,3,a.cantidad,"1.2-2")),tt.Cb(3),tt.Gc(tt.ic(8,6,a.total,"1.2-2"))}}function ki(t,e){if(1&t&&(tt.Rb(0),tt.Tb(1,"tr"),tt.Tb(2,"th",8),tt.Fc(3),tt.Sb(),tt.Sb(),tt.Dc(4,Ti,9,9,"tr",5),tt.Qb()),2&t){var a=e.$implicit;tt.Cb(3),tt.Gc(a.sede),tt.Cb(1),tt.lc("ngForOf",a.articulos)}}function yi(t,e){if(1&t&&(tt.Tb(0,"mat-card-content"),tt.Tb(1,"table",2),tt.Tb(2,"thead"),tt.Tb(3,"tr"),tt.Tb(4,"th",3),tt.Fc(5,"Descripci\xf3n"),tt.Sb(),tt.Tb(6,"th",4),tt.Fc(7,"Cantidad"),tt.Sb(),tt.Tb(8,"th",4),tt.Fc(9,"Total"),tt.Sb(),tt.Sb(),tt.Sb(),tt.Tb(10,"tbody"),tt.Dc(11,ki,5,2,"ng-container",5),tt.Sb(),tt.Sb(),tt.Sb()),2&t){var a=tt.fc();tt.Cb(11),tt.lc("ngForOf",a.data.datos)}}var Mi,Fi=((Mi=function(){function t(){c(this,t),this.params={},this.data={}}return s(t,[{key:"ngOnInit",value:function(){}}]),t}()).\u0275fac=function(t){return new(t||Mi)},Mi.\u0275cmp=tt.Hb({type:Mi,selectors:[["app-por-articulo"]],inputs:{params:"params",data:"data"},decls:12,vars:10,consts:[[1,"mat-elevation-z4","fullWidth"],[4,"ngIf"],[1,"tbl"],[1,"brdTSingleBSingle"],[1,"rtxt","numWidth","brdTSingleBSingle"],[4,"ngFor","ngForOf"],[1,"doubleTab","brdBSingle"],[1,"rtxt","numWidth","brdBSingle"],["colspan","3",1,"brdTSingleBSingle"]],template:function(t,e){1&t&&(tt.Tb(0,"mat-card",0),tt.Tb(1,"mat-card-header"),tt.Tb(2,"mat-card-title"),tt.Fc(3,"Reporte de ventas"),tt.Sb(),tt.Tb(4,"mat-card-subtitle"),tt.Fc(5," Por art\xedculo"),tt.Ob(6,"br"),tt.Fc(7),tt.gc(8,"date"),tt.gc(9,"date"),tt.Sb(),tt.Sb(),tt.Dc(10,Ci,12,1,"mat-card-content",1),tt.Dc(11,yi,12,1,"mat-card-content",1),tt.Sb()),2&t&&(tt.Cb(7),tt.Ic(" Del ",tt.ic(8,4,e.params.fdel,"dd/MM/yyyy")," al ",tt.ic(9,7,e.params.fal,"dd/MM/yyyy")," "),tt.Cb(3),tt.lc("ngIf",1==e.data.grupo),tt.Cb(1),tt.lc("ngIf",2==e.data.grupo))},directives:[y.a,y.d,y.h,y.g,d.m,y.c,d.l],pipes:[d.e,d.f],styles:[".numWidth[_ngcontent-%COMP%]{width:10%}tr[_ngcontent-%COMP%]{border:none}td[_ngcontent-%COMP%], th[_ngcontent-%COMP%]{padding-top:.25em;padding-bottom:.25em}"]}),Mi);function xi(t,e){if(1&t&&(tt.Tb(0,"mat-option",16),tt.Fc(1),tt.Sb()),2&t){var a=e.$implicit;tt.lc("value",a.tipo_reporte),tt.Cb(1),tt.Hc(" ",a.descripcion," ")}}function Oi(t,e){if(1&t&&(tt.Tb(0,"mat-option",16),tt.Fc(1),tt.Sb()),2&t){var a=e.$implicit;tt.lc("value",a.turno_tipo),tt.Cb(1),tt.Hc(" ",a.descripcion," ")}}function Di(t,e){if(1&t&&(tt.Tb(0,"mat-option",16),tt.Fc(1),tt.Sb()),2&t){var a=e.$implicit;tt.lc("value",a.sede.sede),tt.Cb(1),tt.Hc(" ",a.sede.nombre," ")}}function Ei(t,e){if(1&t&&(tt.Tb(0,"mat-option",16),tt.Fc(1),tt.Sb()),2&t){var a=e.$implicit;tt.lc("value",a.id),tt.Cb(1),tt.Hc(" ",a.descripcion," ")}}function Pi(t,e){if(1&t){var a=tt.Ub();tt.Tb(0,"mat-form-field",5),tt.Tb(1,"mat-label"),tt.Fc(2,"Agrupar por"),tt.Sb(),tt.Tb(3,"mat-select",17),tt.bc("ngModelChange",function(t){return tt.xc(a),tt.fc().params._grupo=t}),tt.Dc(4,Ei,2,2,"mat-option",7),tt.Sb(),tt.Sb()}if(2&t){var n=tt.fc();tt.Cb(3),tt.lc("ngModel",n.params._grupo),tt.Cb(1),tt.lc("ngForOf",n.grupos)}}function _i(t,e){1&t&&tt.Ob(0,"app-cargando")}function Ii(t,e){if(1&t&&(tt.Tb(0,"div",0),tt.Tb(1,"div",1),tt.Ob(2,"app-por-categoria",18),tt.Sb(),tt.Sb()),2&t){var a=tt.fc();tt.Cb(2),tt.lc("params",a.params)("data",a.porCategoria)}}function wi(t,e){if(1&t&&(tt.Tb(0,"div",0),tt.Tb(1,"div",1),tt.Ob(2,"app-por-articulo",18),tt.Sb(),tt.Sb()),2&t){var a=tt.fc();tt.Cb(2),tt.lc("params",a.params)("data",a.porArticulo)}}var Ai,Ni=((Ai=function(){function t(e,a,n,o){var i=this;c(this,t),this.snackBar=e,this.rptVentasSrvc=a,this.tipoTurnoSrvc=n,this.sedeSrvc=o,this.tiposReporte=[],this.params={},this.paramsToSend={},this.msgGenerandoReporte=null,this.porCategoria=[],this.porArticulo={datos:[]},this.tiposTurno=[],this.sedes=[],this.grupos=it.b.grupos,this.tituloCategoria="Ventas por categoria",this.tituloArticulo="Ventas por articulo",this.cargando=!1,this.configBotones={showPdf:!0,showHtml:!0,showExcel:!0},this.loadSedes=function(){i.sedeSrvc.getSedes({reporte:!0}).subscribe(function(t){t&&(i.sedes=t)})},this.loadTiposTurno=function(){i.tipoTurnoSrvc.get().subscribe(function(t){t&&(i.tiposTurno=t)})},this.loadTiposReporte=function(){i.tiposReporte=[{tipo_reporte:1,descripcion:"Por categor\xeda"},{tipo_reporte:2,descripcion:"Por art\xedculo"}]},this.resetParams=function(){i.porCategoria=[],i.porArticulo=[],i.msgGenerandoReporte=null,i.params={tipo_reporte:void 0,fdel:Ee().startOf("week").format(it.b.dbDateFormat),fal:Ee().endOf("week").format(it.b.dbDateFormat)},i.cargando=!1},this.getReporte=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;switch(i.paramsToSend=JSON.parse(JSON.stringify(i.params)),i.msgGenerandoReporte="GENERANDO REPORTE EN ",t){case 1:i.getEnPantalla();break;case 2:i.getPdf();break;case 3:i.getExcel()}},this.getPdf=function(){switch(i.params.tipo_reporte){case 1:i.getPorCategoriaPdf();break;case 2:i.getPorArticuloPdf()}},this.getExcel=function(){switch(i.params.tipo_reporte){case 1:i.getPorCategoriaExcel();break;case 2:i.getPorArticuloExcel()}},this.getPorCategoriaExcel=function(){i.paramsToSend._excel=1,i.cargando=!0,i.cleanParams(),i.rptVentasSrvc.porCategoriaPdf(i.paramsToSend).subscribe(function(t){if(i.cargando=!1,t){var e=new Blob([t],{type:"application/vnd.ms-excel"});Object(si.saveAs)(e,"".concat(i.tituloCategoria,".xls"))}else i.snackBar.open("No se pudo generar el reporte...",i.tituloCategoria,{duration:3e3})})},this.getPorCategoriaPdf=function(){i.paramsToSend._excel=0,i.cargando=!0,i.cleanParams(),i.rptVentasSrvc.porCategoriaPdf(i.paramsToSend).subscribe(function(t){if(i.cargando=!1,t){var e=new Blob([t],{type:"application/pdf"});Object(si.saveAs)(e,"".concat(i.tituloCategoria,".pdf"))}else i.snackBar.open("No se pudo generar el reporte...",i.tituloCategoria,{duration:3e3})})},this.getPorArticuloPdf=function(){i.paramsToSend._excel=0,i.cargando=!0,i.cleanParams(),i.rptVentasSrvc.porArticuloPdf(i.paramsToSend).subscribe(function(t){if(i.cargando=!1,t){var e=new Blob([t],{type:"application/pdf"});Object(si.saveAs)(e,"".concat(i.tituloArticulo,".pdf"))}else i.snackBar.open("No se pudo generar el reporte...",i.tituloArticulo,{duration:3e3})})},this.getPorArticuloExcel=function(){i.paramsToSend._excel=1,i.cargando=!0,i.cleanParams(),i.rptVentasSrvc.porArticuloPdf(i.paramsToSend).subscribe(function(t){if(i.cargando=!1,t){var e=new Blob([t],{type:"application/vnd.ms-excel"});Object(si.saveAs)(e,"".concat(i.tituloArticulo,".xls"))}else i.snackBar.open("No se pudo generar el reporte...",i.tituloArticulo,{duration:3e3})})},this.getEnPantalla=function(){switch(i.params.tipo_reporte){case 1:i.getPorCategoriaEnPantalla();break;case 2:i.getPorArticuloEnPantalla()}},this.cleanParams=function(){return delete i.paramsToSend.tipo_reporte},this.getPorCategoriaEnPantalla=function(){i.cargando=!0,i.cleanParams(),i.rptVentasSrvc.porCategoria(i.paramsToSend).subscribe(function(t){i.cargando=!1,t?i.porCategoria=t:i.snackBar.open("No se pudo generar el reporte...","Ventas por categor\xeda",{duration:3e3})})},this.getPorArticuloEnPantalla=function(){i.cargando=!0,i.cleanParams(),i.rptVentasSrvc.porArticulo(i.paramsToSend).subscribe(function(t){i.cargando=!1,t?i.porArticulo=t:i.snackBar.open("No se pudo generar el reporte...","Ventas por art\xedculo",{duration:3e3})})}}return s(t,[{key:"ngOnInit",value:function(){this.resetParams(),this.loadTiposReporte(),this.loadTiposTurno(),this.loadSedes()}}]),t}()).\u0275fac=function(t){return new(t||Ai)(tt.Nb(P.b),tt.Nb(li),tt.Nb(Mo),tt.Nb(ui.a))},Ai.\u0275cmp=tt.Hb({type:Ai,selectors:[["app-rpt-ventas"]],decls:33,vars:13,consts:[[1,"row"],[1,"col","m12","s12"],[1,"mat-elevation-z4","fullWidth"],["novalidate",""],["frmEntidad","ngForm"],[1,"fullWidth"],["name","tipo_reporte","required","",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["name","turno_tipo",3,"ngModel","ngModelChange"],["type","date","matInput","","placeholder","Del","name","fdel","required","",3,"ngModel","ngModelChange"],["type","date","matInput","","placeholder","Al","name","fal","required","",3,"ngModel","ngModelChange"],["name","sede","multiple","",3,"ngModel","ngModelChange"],["class","fullWidth",4,"ngIf"],[3,"configuracion","excelClick","htmlClick","pdfClick","resetParamsClick"],[4,"ngIf"],["class","row",4,"ngIf"],[3,"value"],["name","grupo",3,"ngModel","ngModelChange"],[3,"params","data"]],template:function(t,e){1&t&&(tt.Tb(0,"div",0),tt.Tb(1,"div",1),tt.Tb(2,"mat-card",2),tt.Tb(3,"mat-card-title"),tt.Tb(4,"h4"),tt.Fc(5,"Reporte de ventas"),tt.Sb(),tt.Sb(),tt.Tb(6,"mat-card-content"),tt.Tb(7,"form",3,4),tt.Tb(9,"mat-form-field",5),tt.Tb(10,"mat-label"),tt.Fc(11,"Tipo"),tt.Sb(),tt.Tb(12,"mat-select",6),tt.bc("ngModelChange",function(t){return e.params.tipo_reporte=t}),tt.Dc(13,xi,2,2,"mat-option",7),tt.Sb(),tt.Sb(),tt.Tb(14,"mat-form-field",5),tt.Tb(15,"mat-label"),tt.Fc(16,"Tipo de turno"),tt.Sb(),tt.Tb(17,"mat-select",8),tt.bc("ngModelChange",function(t){return e.params.turno_tipo=t}),tt.Dc(18,Oi,2,2,"mat-option",7),tt.Sb(),tt.Sb(),tt.Tb(19,"mat-form-field",5),tt.Tb(20,"input",9),tt.bc("ngModelChange",function(t){return e.params.fdel=t}),tt.Sb(),tt.Sb(),tt.Tb(21,"mat-form-field",5),tt.Tb(22,"input",10),tt.bc("ngModelChange",function(t){return e.params.fal=t}),tt.Sb(),tt.Sb(),tt.Tb(23,"mat-form-field",5),tt.Tb(24,"mat-label"),tt.Fc(25,"Sede"),tt.Sb(),tt.Tb(26,"mat-select",11),tt.bc("ngModelChange",function(t){return e.params.sede=t}),tt.Dc(27,Di,2,2,"mat-option",7),tt.Sb(),tt.Sb(),tt.Dc(28,Pi,5,2,"mat-form-field",12),tt.Tb(29,"app-rpt-botones",13),tt.bc("excelClick",function(){return e.getReporte(3)})("htmlClick",function(){return e.getReporte(1)})("pdfClick",function(){return e.getReporte(2)})("resetParamsClick",function(){return e.resetParams()}),tt.Sb(),tt.Sb(),tt.Dc(30,_i,1,0,"app-cargando",14),tt.Sb(),tt.Sb(),tt.Sb(),tt.Sb(),tt.Dc(31,Ii,3,2,"div",15),tt.Dc(32,wi,3,2,"div",15)),2&t&&(tt.Cb(12),tt.lc("ngModel",e.params.tipo_reporte),tt.Cb(1),tt.lc("ngForOf",e.tiposReporte),tt.Cb(4),tt.lc("ngModel",e.params.turno_tipo),tt.Cb(1),tt.lc("ngForOf",e.tiposTurno),tt.Cb(2),tt.lc("ngModel",e.params.fdel),tt.Cb(2),tt.lc("ngModel",e.params.fal),tt.Cb(4),tt.lc("ngModel",e.params.sede),tt.Cb(1),tt.lc("ngForOf",e.sedes),tt.Cb(1),tt.lc("ngIf",e.params.sede&&e.params.sede.length>1),tt.Cb(1),tt.lc("configuracion",e.configBotones),tt.Cb(1),tt.lc("ngIf",e.cargando),tt.Cb(1),tt.lc("ngIf",1===e.params.tipo_reporte&&e.porCategoria.length>0),tt.Cb(1),tt.lc("ngIf",2===e.params.tipo_reporte))},directives:[y.a,y.h,y.c,m.r,m.l,m.m,T.b,T.f,O.a,m.p,m.k,m.n,d.l,k.b,m.c,d.m,di.a,j.m,Le.a,vi,Fi],styles:[""]}),Ai),Ri=i("EwG7");function Ui(t,e){1&t&&tt.Ob(0,"app-cargando")}var ji,Bi=((ji=function(){function t(){var e=this;c(this,t),this.params={},this.configParams={isRequiredFDel:!0,isRequiredFAl:!0},this.configBotones={isHtmlDisabled:!1,isPdfDisabled:!1,isExcelDisabled:!1},this.cargando=!1,this.resetParams=function(){e.params={fdel:Ee().startOf("week").format(it.b.dbDateFormat),fal:Ee().endOf("week").format(it.b.dbDateFormat)}},this.getReporte=function(){console.log("GENERANDO CON PARAMETROS = ",e.params)}}return s(t,[{key:"ngOnInit",value:function(){this.resetParams()}}]),t}()).\u0275fac=function(t){return new(t||ji)},ji.\u0275cmp=tt.Hb({type:ji,selectors:[["app-turnos"]],decls:12,vars:5,consts:[[1,"row"],[1,"col","m12","s12"],[1,"mat-elevation-z4","fullWidth"],["novalidate",""],["frmEntidad","ngForm"],[3,"fdel","fal","configuracion","fdelChange","falChange"],[3,"configuracion","htmlClick","pdfClick","excelClick","resetParamsClick"],[4,"ngIf"]],template:function(t,e){1&t&&(tt.Tb(0,"div",0),tt.Tb(1,"div",1),tt.Tb(2,"mat-card",2),tt.Tb(3,"mat-card-title"),tt.Tb(4,"h4"),tt.Fc(5,"Reporte de Turnos"),tt.Sb(),tt.Sb(),tt.Tb(6,"mat-card-content"),tt.Tb(7,"form",3,4),tt.Tb(9,"app-rpt-fechas",5),tt.bc("fdelChange",function(t){return e.params.fdel=t})("falChange",function(t){return e.params.fal=t}),tt.Sb(),tt.Tb(10,"app-rpt-botones",6),tt.bc("htmlClick",function(){return e.getReporte()})("pdfClick",function(){return e.getReporte()})("excelClick",function(){return e.getReporte()})("resetParamsClick",function(){return e.resetParams()}),tt.Sb(),tt.Sb(),tt.Dc(11,Ui,1,0,"app-cargando",7),tt.Sb(),tt.Sb(),tt.Sb(),tt.Sb()),2&t&&(tt.Cb(9),tt.lc("fdel",e.params.fdel)("fal",e.params.fal)("configuracion",e.configParams),tt.Cb(1),tt.lc("configuracion",e.configBotones),tt.Cb(1),tt.lc("ngIf",e.cargando))},directives:[y.a,y.h,y.c,m.r,m.l,m.m,Ri.a,di.a,d.m,Le.a],styles:[""]}),ji);function Hi(t,e){1&t&&tt.Ob(0,"app-cargando")}var Li,qi=function(){return{standalone:!0}},$i=((Li=function(){function t(e,a){var n=this;c(this,t),this.snackBar=e,this.pdfServicio=a,this.params={},this.titulo="Propinas",this.configBotones={isHtmlDisabled:!0,isPdfDisabled:!1,isExcelDisabled:!1,showHtml:!1,showExcel:!0,showPdf:!0},this.cargando=!1,this.resetParams=function(){n.params={},n.cargando=!1}}return s(t,[{key:"ngOnInit",value:function(){}},{key:"onSubmit",value:function(){var t=this;this.params._excel=0,this.cargando=!0,this.pdfServicio.getReportePropina(this.params).subscribe(function(e){if(t.cargando=!1,e){var a=new Blob([e],{type:"application/pdf"});Object(si.saveAs)(a,"".concat(t.titulo,".pdf"))}else t.snackBar.open("No se pudo generar el reporte...",t.titulo,{duration:3e3})})}},{key:"excelClick",value:function(){var t=this;this.params._excel=1,this.cargando=!0,this.pdfServicio.getReportePropina(this.params).subscribe(function(e){if(t.cargando=!1,e){var a=new Blob([e],{type:"application/vnd.ms-excel"});Object(si.saveAs)(a,"".concat(t.titulo,".xls"))}else t.snackBar.open("No se pudo generar el reporte...",t.titulo,{duration:3e3})})}}]),t}()).\u0275fac=function(t){return new(t||Li)(tt.Nb(P.b),tt.Nb(qa.a))},Li.\u0275cmp=tt.Hb({type:Li,selectors:[["app-propinas"]],decls:17,vars:9,consts:[[1,"row"],[1,"col","m12","s12"],[1,"mat-elevation-z4","fullWidth"],["novalidate",""],["frmRptPropinas","ngForm"],[1,"fullWidth"],["matInput","","type","date","placeholder","Del","required","",3,"ngModel","ngModelOptions","ngModelChange"],["matInput","","type","date","placeholder","Al","required","",3,"ngModel","ngModelOptions","ngModelChange"],["name","mostrar_detalle",1,"fullWidth",3,"ngModel","ngModelChange"],[3,"configuracion","pdfClick","resetParamsClick","excelClick"],[4,"ngIf"]],template:function(t,e){1&t&&(tt.Tb(0,"div",0),tt.Tb(1,"div",1),tt.Tb(2,"mat-card",2),tt.Tb(3,"mat-card-title"),tt.Tb(4,"h4"),tt.Fc(5,"Reporte de propinas"),tt.Sb(),tt.Sb(),tt.Tb(6,"mat-card-content"),tt.Tb(7,"form",3,4),tt.Tb(9,"mat-form-field",5),tt.Tb(10,"input",6),tt.bc("ngModelChange",function(t){return e.params.fdel=t}),tt.Sb(),tt.Sb(),tt.Tb(11,"mat-form-field",5),tt.Tb(12,"input",7),tt.bc("ngModelChange",function(t){return e.params.fal=t}),tt.Sb(),tt.Sb(),tt.Tb(13,"mat-checkbox",8),tt.bc("ngModelChange",function(t){return+(e.params._detalle=t)}),tt.Fc(14,"Mostrar Detalle"),tt.Sb(),tt.Tb(15,"app-rpt-botones",9),tt.bc("pdfClick",function(){return e.onSubmit()})("resetParamsClick",function(){return e.resetParams()})("excelClick",function(){return e.excelClick()}),tt.Sb(),tt.Sb(),tt.Dc(16,Hi,1,0,"app-cargando",10),tt.Sb(),tt.Sb(),tt.Sb(),tt.Sb()),2&t&&(tt.Cb(10),tt.lc("ngModel",e.params.fdel)("ngModelOptions",tt.nc(7,qi)),tt.Cb(2),tt.lc("ngModel",e.params.fal)("ngModelOptions",tt.nc(8,qi)),tt.Cb(1),tt.lc("ngModel",+e.params._detalle),tt.Cb(2),tt.lc("configuracion",e.configBotones),tt.Cb(1),tt.lc("ngIf",e.cargando))},directives:[y.a,y.h,y.c,m.r,m.l,m.m,T.b,k.b,m.c,m.p,m.k,m.n,D.a,di.a,d.m,Le.a],styles:[""]}),Li),zi=i("R0Ic"),Gi=i("+iZS"),Wi=i("u0wK");function Vi(t,e){1&t&&(tt.Tb(0,"th",19),tt.Fc(1,"No."),tt.Sb())}function Ki(t,e){if(1&t&&(tt.Tb(0,"td",20),tt.Fc(1),tt.Sb()),2&t){var a=e.$implicit;tt.Cb(1),tt.Hc("",a.comanda," ")}}function Ji(t,e){1&t&&(tt.Tb(0,"th",19),tt.Fc(1,"Orden"),tt.Sb())}function Qi(t,e){if(1&t&&(tt.Tb(0,"td",20),tt.Fc(1),tt.Sb()),2&t){var a=e.$implicit;tt.Cb(1),tt.Gc(a.origen_datos.numero_orden||"")}}function Xi(t,e){1&t&&(tt.Tb(0,"th",19),tt.Fc(1,"Fecha/Hora"),tt.Sb())}function Yi(t,e){if(1&t&&(tt.Tb(0,"td",20),tt.Fc(1),tt.gc(2,"date"),tt.Sb()),2&t){var a=e.$implicit;tt.Cb(1),tt.Gc(tt.ic(2,1,a.fhcreacion,"dd/MM/yyyy HH:mm:ss")||"")}}function Zi(t,e){1&t&&(tt.Tb(0,"th",19),tt.Fc(1,"Cliente"),tt.Sb())}function tc(t,e){if(1&t&&(tt.Tb(0,"td",20),tt.Fc(1),tt.Sb()),2&t){var a=e.$implicit;tt.Cb(1),tt.Gc(a.cuentas[0].nombre)}}function ec(t,e){1&t&&(tt.Tb(0,"th",19),tt.Fc(1,"Total"),tt.Sb())}function ac(t,e){if(1&t&&(tt.Tb(0,"td",20),tt.Fc(1),tt.gc(2,"number"),tt.Sb()),2&t){var a=e.$implicit;tt.Cb(1),tt.Gc(tt.ic(2,1,a.total,"1.2-2"))}}function nc(t,e){1&t&&(tt.Tb(0,"th",21),tt.Fc(1,"Imprimir"),tt.Sb())}function oc(t,e){if(1&t){var a=tt.Ub();tt.Tb(0,"td",22),tt.Tb(1,"button",23),tt.bc("click",function(){tt.xc(a);var t=e.$implicit;return tt.fc().imprimir(t)}),tt.Fc(2," Imprimir "),tt.Sb(),tt.Sb()}}function ic(t,e){1&t&&(tt.Tb(0,"th",21),tt.Fc(1,"Cancelar"),tt.Sb())}function cc(t,e){if(1&t){var a=tt.Ub();tt.Tb(0,"td",22),tt.Tb(1,"button",23),tt.bc("click",function(){tt.xc(a);var t=e.$implicit;return tt.fc().cancelarPedido(t)}),tt.Fc(2," Cancelar "),tt.Sb(),tt.Sb()}}function rc(t,e){1&t&&(tt.Tb(0,"th",21),tt.Fc(1,"Facturar"),tt.Sb())}function sc(t,e){if(1&t){var a=tt.Ub();tt.Tb(0,"td",22),tt.Tb(1,"button",23),tt.bc("click",function(){tt.xc(a);var t=e.$implicit;return tt.fc().firmar(t)}),tt.Fc(2," Facturar "),tt.Sb(),tt.Sb()}}function lc(t,e){if(1&t&&(tt.Tb(0,"h6"),tt.Fc(1),tt.Sb()),2&t){var a=tt.fc().$implicit;tt.Cb(1),tt.Hc("Orden #",a.origen_datos.numero_orden,"")}}function uc(t,e){if(1&t&&(tt.Tb(0,"tr"),tt.Tb(1,"td",29),tt.Tb(2,"p",30),tt.Fc(3),tt.Sb(),tt.Sb(),tt.Sb()),2&t){var a=tt.fc().$implicit;tt.Cb(3),tt.Gc(a.notas_generales)}}function dc(t,e){1&t&&tt.Ob(0,"br")}function bc(t,e){if(1&t&&(tt.Tb(0,"span"),tt.Fc(1),tt.Sb()),2&t){var a=tt.fc().$implicit;tt.Cb(1),tt.Hc("\xa0\xa0\xa0",a.notas,"")}}function mc(t,e){if(1&t&&(tt.Tb(0,"tr"),tt.Tb(1,"td",31),tt.Fc(2),tt.Sb(),tt.Sb()),2&t){var a=tt.fc().$implicit;tt.Cb(2),tt.Hc(" ",a," ")}}function fc(t,e){if(1&t&&(tt.Rb(0),tt.Dc(1,mc,3,1,"tr",26),tt.Qb()),2&t){var a=e.$implicit;tt.Cb(1),tt.lc("ngIf",a.length>0)}}function pc(t,e){if(1&t&&(tt.Rb(0),tt.Tb(1,"tr"),tt.Tb(2,"td"),tt.Fc(3),tt.Dc(4,dc,1,0,"br",26),tt.Dc(5,bc,2,1,"span",26),tt.Sb(),tt.Tb(6,"td",27),tt.Fc(7),tt.gc(8,"number"),tt.Sb(),tt.Sb(),tt.Dc(9,fc,2,1,"ng-container",28),tt.Qb()),2&t){var a=e.$implicit;tt.Cb(3),tt.Ic(" ",a.cantidad," ",a.articulo.descripcion,""),tt.Cb(1),tt.lc("ngIf",a.notas.length>0),tt.Cb(1),tt.lc("ngIf",a.notas.length>0),tt.Cb(2),tt.Gc(tt.ic(8,6,+a.precio*+a.cantidad+ +a.monto_extra,"1.2-2")),tt.Cb(2),tt.lc("ngForOf",a.detalle)}}function gc(t,e){if(1&t&&(tt.Tb(0,"td",20),tt.Tb(1,"div",24),tt.Tb(2,"table",25),tt.Tb(3,"caption"),tt.Tb(4,"h5"),tt.Fc(5),tt.Sb(),tt.Dc(6,lc,2,1,"h6",26),tt.Sb(),tt.Tb(7,"thead"),tt.Tb(8,"th"),tt.Fc(9,"Producto"),tt.Sb(),tt.Tb(10,"th",27),tt.Fc(11,"Total"),tt.Sb(),tt.Sb(),tt.Tb(12,"tbody"),tt.Dc(13,uc,4,1,"tr",26),tt.Dc(14,pc,10,9,"ng-container",28),tt.Sb(),tt.Sb(),tt.Sb(),tt.Sb()),2&t){var a=e.$implicit,n=tt.fc();tt.Db("colspan",n.columnsToDisplay.length),tt.Cb(1),tt.lc("@detailExpand",a==n.expandedElement?"expanded":"collapsed"),tt.Cb(4),tt.Hc("Detalle del pedido #",a.comanda,""),tt.Cb(1),tt.lc("ngIf",a.origen_datos.numero_orden),tt.Cb(7),tt.lc("ngIf",a.notas_generales),tt.Cb(1),tt.lc("ngForOf",a.cuentas[0].productos)}}function hc(t,e){1&t&&tt.Ob(0,"tr",32)}function vc(t,e){if(1&t){var a=tt.Ub();tt.Tb(0,"tr",33),tt.bc("click",function(){tt.xc(a);var t=e.$implicit,n=tt.fc();return n.expandedElement=n.expandedElement===t?null:t}),tt.Sb()}if(2&t){var n=e.$implicit,o=tt.fc();tt.Fb("example-expanded-row",o.expandedElement===n)}}function Sc(t,e){1&t&&tt.Ob(0,"tr",34)}var Cc,Tc=function(){return["expandedDetail"]},kc=((Cc=function(){function t(e,a,n,i,r,s,l,u,d,b){var m=this;c(this,t),this.dialog=e,this.snackBar=a,this.socket=n,this.ls=i,this.comandaSrvc=r,this.facturaSrvc=s,this.dns=l,this.pdfServicio=u,this.configSrvc=d,this.ordenGkSrvc=b,this.dataSource=[],this.columnsToDisplay=["comanda","orden","fechahora","nombre","total","imprimir","cancelar","facturar"],this.comandasEnLinea=[],this.params={de:0,a:99},this.avisoSocketIOEvent=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";m.dialog.open(Mt.a,{maxWidth:"400px",data:new Mt.b("Socket.IO",t,"Aceptar","Cancelar")}).afterClosed().subscribe(function(t){})},this.notificarUsuario=function(){var t={icon:"assets/img/minilogo.png",body:"Se recibi\xf3 una nueva orden a las ".concat(Ee().format(it.b.dateTimeFormat),"."),dir:"auto"};m.dns.createNotification("Rest-Touch Pro",1e4,t)},this.loadComandasEnLinea=function(){m.comandaSrvc.getComandasOnLIne().subscribe(function(t){m.comandasEnLinea=t,m.dataSource=m.comandasEnLinea})},this.setToPrint=function(t){var e=[];return t.forEach(function(t){e.push({id:+t.articulo.articulo,nombre:t.articulo.descripcion,cantidad:+t.cantidad,total:+t.total,notas:t.notas||"",impresora:{bluetooth:+t.articulo.impresora.bluetooth,direccion_ip:t.articulo.impresora.direccion_ip||"",impresora:+t.articulo.impresora.impresora,nombre:t.articulo.impresora.nombre||"",sede:+t.articulo.impresora.sede,ubicacion:t.articulo.impresora.ubicacion||""},detalle:t.detalle})}),e},this.getPdf=function(t){var e=+t.cuentas[0].cuenta;m.pdfServicio.getComanda(e).subscribe(function(t){if(t){var a=new Blob([t],{type:"application/pdf"}),n=window.URL.createObjectURL(a);window.open(n,"cuenta_".concat(e),"height=700,width=800,menubar=no,location=no,resizable=no,scrollbars=no,status=no")}else m.snackBar.open("No se pudo generar la comanda...","Comanda",{duration:3e3})})},this.imprimir=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=m.setToPrint(t.cuentas[0].productos),n=a.filter(function(t){return 0==+t.impresora.bluetooth}),o=a.filter(function(t){return 1==+t.impresora.bluetooth}),i={};if(n.length>0&&(i={Indice:e+1,Tipo:"Comanda",Nombre:t.cuentas[0].nombre,Numero:t.comanda,NoOrdenEnLinea:t.origen_datos.numero_orden,DireccionEntrega:t.origen_datos.direccion_entrega,DetalleCuenta:n,Total:0,NotasGenerales:t.notas_generales||""},m.socket.emit("print:comanda","".concat(JSON.stringify(i)))),o.length>0&&(i={Tipo:"Comanda",Nombre:t.cuentas[0].nombre,Numero:t.comanda,NoOrdenEnLinea:t.origen_datos.numero_orden,DireccionEntrega:t.origen_datos.direccion_entrega,DetalleCuenta:o,Total:0},m.printToBT(JSON.stringify(i))),+t.orden_gk>0){var c={orden_gk:+t.orden_gk,estatus_orden_gk:5,sede:m.ls.get(it.b.usrTokenVar).sede,comentario:"Se mand\xf3 a imprimir la comanda #".concat(t.comanda," de la orden #").concat(t.orden_gk," de Ghost Kitchen.")};m.cambiarEstatusOrdenGK(c)}},this.printToBT=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=window.open("com.restouch.impresion://impresion/".concat(t),"PrntBT","height=200,width=200,menubar=no,location=no,resizable=no,scrollbars=no,status=no");setTimeout(function(){return e.close()},1e3)},this.firmar=function(t){m.facturaSrvc.firmar(+t.factura.factura).subscribe(function(e){if(e.exito){if(m.loadComandasEnLinea(),+t.orden_gk>0){var a={orden_gk:+t.orden_gk,estatus_orden_gk:6,sede:m.ls.get(it.b.usrTokenVar).sede,comentario:"Se firm\xf3 la factura de la comanda #".concat(t.comanda," de la orden #").concat(t.orden_gk," de Ghost Kitchen.")};m.cambiarEstatusOrdenGK(a)}m.dialog.open(Mt.a,{maxWidth:"400px",data:new Mt.b("Imprimir factura","\xbfDesea imprimir la factura?","S\xed","No")}).afterClosed().subscribe(function(a){a&&(1===(m.configSrvc.getConfig(it.b.CONSTANTES.RT_MODO_FACTURA)||1)?m.printFactura(e.factura,t.origen_datos):m.representacionGrafica(+t.factura.factura))})}m.snackBar.open(e.mensaje,"Facturaci\xf3n",{duration:e.exito?3e3:1e4})})},this.printFactura=function(t){var e,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n={NombreEmpresa:t.empresa.nombre_comercial,NitEmpresa:t.empresa.nit,SedeEmpresa:t.sedeFactura.nombre,DireccionEmpresa:t.empresa.direccion,Fecha:Ee(t.fecha_factura).format(it.b.dateFormat),Nit:t.receptor.nit,Nombre:t.receptor.nombre,Direccion:t.receptor.direccion,Serie:t.serie_factura,Numero:t.numero_factura,Total:0,NoAutorizacion:t.fel_uuid,NombreCertificador:t.certificador_fel.nombre,NitCertificador:t.certificador_fel.nit,FechaDeAutorizacion:t.fecha_autorizacion,NoOrdenEnLinea:a.numero_orden,FormaDePago:a.metodo_pago&&a.metodo_pago.length>0?a.metodo_pago.join(", "):"",DetalleFactura:[]},i=o(t.detalle);try{for(i.s();!(e=i.n()).done;){var c=e.value;n.DetalleFactura.push({Cantidad:parseInt(c.cantidad),Descripcion:c.articulo.descripcion,Total:parseFloat(c.total),PrecioUnitario:+c.precio_unitario}),n.Total+=parseFloat(c.total)}}catch(r){i.e(r)}finally{i.f()}m.socket.emit("print:factura",JSON.stringify(n))},this.representacionGrafica=function(t){m.facturaSrvc.getGrafo(t).subscribe(function(t){if(t.exito)switch(t.tipo){case"link":m.openLinkWindow(t.documento);break;case"pdf":m.openPdfDocument(t.documento)}})},this.openLinkWindow=function(t){return window.open(t,"winFactPdf","height=700,width=800,menubar=no,location=no,resizable=no,scrollbars=no,status=no")},this.openPdfDocument=function(t){window.open("","winFactPdf","height=700,width=800,menubar=no,location=no,resizable=no,scrollbars=no,status=no").document.write('<iframe width="100%" style="margin: -8px;border: none;" height="100%" src="data:application/pdf;base64, '+encodeURI(t)+'"></iframe>')},this.imprimirLote=function(){for(var t=m.params.de;t<=m.params.a;t++)m.imprimir(m.comandasEnLinea[t],t)},this.cancelarPedido=function(t){m.dialog.open(Mt.a,{maxWidth:"400px",data:new Mt.b("Cancelar pedido","Si cancela el pedido, ser\xe1 necesario volver a ingresarlo. \xbfDesea continuar?","S\xed","No",{input:[{select:!1,label:"Comentario",valor:null,id:"comentario",requerido:!1}]})}).afterClosed().subscribe(function(e){if(e.resultado){var a,n={},i=o(e.config.input);try{for(i.s();!(a=i.n()).done;){var c=a.value;n[c.id]=c.valor}}catch(r){i.e(r)}finally{i.f()}m.comandaSrvc.cancelarPedido(t.comanda,n).subscribe(function(e){if(e.exito){if(+t.orden_gk>0){var a={orden_gk:+t.orden_gk,estatus_orden_gk:2,sede:m.ls.get(it.b.usrTokenVar).sede,comentario:"Se cancel\xf3 la comanda #".concat(t.comanda," de la orden #").concat(t.orden_gk," de Ghost Kitchen.")};m.cambiarEstatusOrdenGK(a)}m.snackBar.open("Pedido cancelado con \xe9xito...","Pedido",{duration:3e3})}else m.snackBar.open("ERROR: ".concat(e.mensaje),"Pedido",{duration:7e3});m.loadComandasEnLinea()})}})},this.cambiarEstatusOrdenGK=function(t){m.ordenGkSrvc.cambiarEstatus(t).subscribe(function(e){e.exito?m.socket.emit("gk:updEstatusOrden","".concat(JSON.stringify({orden_gk:t.orden_gk,estatus_orden_gk:e.estatus_orden_gk,sede_uuid:m.ls.get(it.b.usrTokenVar).sede_uuid}))):m.snackBar.open("ERROR:".concat(e.mensaje),"Orden de Ghost Kitchen",{duration:7e3})})}}return s(t,[{key:"ngOnInit",value:function(){var t=this;this.ls.get(it.b.usrTokenVar).sede_uuid&&(this.socket.emit("joinRestaurant",this.ls.get(it.b.usrTokenVar).sede_uuid),this.socket.on("shopify:updlist",function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;e&&e.corporacion?t.ls.get(it.b.usrTokenVar).sede_uuid.indexOf(e.corporacion)>-1&&(t.loadComandasEnLinea(),t.notificarUsuario()):(t.loadComandasEnLinea(),t.notificarUsuario())}),this.socket.on("reconnect",function(){return t.socket.emit("joinRestaurant",t.ls.get(it.b.usrTokenVar).sede_uuid)}),this.socket.on("connect_timeout",function(){var e="DESCONECTADO DEL SERVIDOR (TIMEOUT)";t.snackBar.open(e,"ERROR",{duration:5e3}),t.avisoSocketIOEvent(e)}),this.socket.on("reconnect_attempt",function(e){return t.snackBar.open("INTENTO DE RECONEXI\xd3N #".concat(e),"ERROR",{duration:1e4})}),this.socket.on("shopify:error",function(e){t.loadComandasEnLinea(),t.snackBar.open("ERROR: ".concat(e),"Firmar",{duration:1e4})})),this.loadComandasEnLinea()}},{key:"ngOnDestroy",value:function(){}}]),t}()).\u0275fac=function(t){return new(t||Cc)(tt.Nb(N.b),tt.Nb(P.b),tt.Nb(Ue.a),tt.Nb(dt.a),tt.Nb(Se),tt.Nb(Re.a),tt.Nb(Gi.a),tt.Nb(qa.a),tt.Nb(Be.a),tt.Nb(Wi.a))},Cc.\u0275cmp=tt.Hb({type:Cc,selectors:[["app-comanda-en-linea"]],decls:32,vars:5,consts:[[1,"row"],[1,"col","m12","s12"],["mat-table","","multiTemplateDataRows","",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","comanda"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","orden"],["matColumnDef","fechahora"],["matColumnDef","nombre"],["matColumnDef","total"],["matColumnDef","imprimir"],["mat-header-cell","","style","width: 10%;",4,"matHeaderCellDef"],["mat-cell","","class","tamanioAmigable","style","width: 10%;",4,"matCellDef"],["matColumnDef","cancelar"],["matColumnDef","facturar"],["matColumnDef","expandedDetail"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","","class","example-element-row",3,"example-expanded-row","click",4,"matRowDef","matRowDefColumns"],["mat-row","","class","example-detail-row",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],["mat-header-cell","",2,"width","10%"],["mat-cell","",1,"tamanioAmigable",2,"width","10%"],["mat-flat-button","","type","button","color","accent",1,"btnCelSize",3,"click"],[1,"example-element-detail"],[2,"width","75%","background-color","#f5f5f5","table-layout","fixed"],[4,"ngIf"],[1,"rtxt"],[4,"ngFor","ngForOf"],["colspan","2"],[1,"long-notes"],["colspan","2",1,"tabulador-doble"],["mat-header-row",""],["mat-row","",1,"example-element-row",3,"click"],["mat-row","",1,"example-detail-row"]],template:function(t,e){1&t&&(tt.Tb(0,"div",0),tt.Tb(1,"div",1),tt.Tb(2,"table",2),tt.Rb(3,3),tt.Dc(4,Vi,2,0,"th",4),tt.Dc(5,Ki,2,1,"td",5),tt.Qb(),tt.Rb(6,6),tt.Dc(7,Ji,2,0,"th",4),tt.Dc(8,Qi,2,1,"td",5),tt.Qb(),tt.Rb(9,7),tt.Dc(10,Xi,2,0,"th",4),tt.Dc(11,Yi,3,4,"td",5),tt.Qb(),tt.Rb(12,8),tt.Dc(13,Zi,2,0,"th",4),tt.Dc(14,tc,2,1,"td",5),tt.Qb(),tt.Rb(15,9),tt.Dc(16,ec,2,0,"th",4),tt.Dc(17,ac,3,4,"td",5),tt.Qb(),tt.Rb(18,10),tt.Dc(19,nc,2,0,"th",11),tt.Dc(20,oc,3,0,"td",12),tt.Qb(),tt.Rb(21,13),tt.Dc(22,ic,2,0,"th",11),tt.Dc(23,cc,3,0,"td",12),tt.Qb(),tt.Rb(24,14),tt.Dc(25,rc,2,0,"th",11),tt.Dc(26,sc,3,0,"td",12),tt.Qb(),tt.Rb(27,15),tt.Dc(28,gc,15,6,"td",5),tt.Qb(),tt.Dc(29,hc,1,0,"tr",16),tt.Dc(30,vc,1,2,"tr",17),tt.Dc(31,Sc,1,0,"tr",18),tt.Sb(),tt.Sb(),tt.Sb()),2&t&&(tt.Cb(2),tt.lc("dataSource",e.dataSource),tt.Cb(27),tt.lc("matHeaderRowDef",e.columnsToDisplay),tt.Cb(1),tt.lc("matRowDefColumns",e.columnsToDisplay),tt.Cb(1),tt.lc("matRowDefColumns",tt.nc(4,Tc)))},directives:[x.k,x.c,x.e,x.b,x.g,x.j,x.d,x.a,E.a,d.m,d.l,x.f,x.i],pipes:[d.e,d.f],styles:["table[_ngcontent-%COMP%]{width:100%}tr.example-detail-row[_ngcontent-%COMP%]{height:0}tr.example-element-row[_ngcontent-%COMP%]:not(.example-expanded-row):hover{background:#777}tr.example-element-row[_ngcontent-%COMP%]:not(.example-expanded-row):active{background:#efefef}.tamanioAmigable[_ngcontent-%COMP%]{padding:5px;width:10%!important;min-height:55px}.btnCelSize[_ngcontent-%COMP%]{min-width:55px;width:100%}.example-element-row[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border-bottom-width:0}.example-element-detail[_ngcontent-%COMP%]{overflow:hidden;display:flex}.example-element-diagram[_ngcontent-%COMP%]{min-width:80px;border:2px solid #000;padding:8px;font-weight:lighter;margin:8px 0;height:104px}.example-element-symbol[_ngcontent-%COMP%]{font-weight:700;font-size:40px;line-height:normal}.example-element-description[_ngcontent-%COMP%]{padding:16px}.example-element-description-attribution[_ngcontent-%COMP%]{opacity:.5}.long-notes[_ngcontent-%COMP%]{overflow-wrap:break-word}"],data:{animation:[Object(zi.m)("detailExpand",[Object(zi.j)("collapsed",Object(zi.k)({height:"0px",minHeight:"0"})),Object(zi.j)("expanded",Object(zi.k)({height:"*"})),Object(zi.l)("expanded <=> collapsed",Object(zi.e)("225ms cubic-bezier(0.4, 0.0, 0.2, 1)"))])]}}),Cc),yc=i("roIu");function Mc(t,e){if(1&t&&(tt.Tb(0,"mat-option",17),tt.Fc(1),tt.Sb()),2&t){var a=e.$implicit;tt.lc("value",a.turno_tipo),tt.Cb(1),tt.Hc(" ",a.descripcion," ")}}function Fc(t,e){if(1&t&&(tt.Tb(0,"mat-option",17),tt.Fc(1),tt.Sb()),2&t){var a=e.$implicit;tt.lc("value",a.sede.sede),tt.Cb(1),tt.Hc(" ",a.sede.nombre," ")}}function xc(t,e){if(1&t&&(tt.Tb(0,"mat-option",17),tt.Fc(1),tt.Sb()),2&t){var a=e.$implicit;tt.lc("value",a.id),tt.Cb(1),tt.Hc(" ",a.descripcion," ")}}function Oc(t,e){if(1&t){var a=tt.Ub();tt.Tb(0,"mat-form-field",5),tt.Tb(1,"mat-label"),tt.Fc(2,"Agrupar por"),tt.Sb(),tt.Tb(3,"mat-select",18),tt.bc("ngModelChange",function(t){return tt.xc(a),tt.fc().params._grupo=t}),tt.Dc(4,xc,2,2,"mat-option",7),tt.Sb(),tt.Sb()}if(2&t){var n=tt.fc();tt.Cb(3),tt.lc("ngModel",n.params._grupo),tt.Cb(1),tt.lc("ngForOf",n.grupos)}}function Dc(t,e){1&t&&tt.Ob(0,"hr")}var Ec=function(){return{standalone:!0}};function Pc(t,e){if(1&t&&(tt.Tb(0,"div"),tt.Tb(1,"mat-form-field",5),tt.Tb(2,"input",20),tt.bc("ngModelChange",function(t){return e.$implicit.monto=t}),tt.Sb(),tt.Sb(),tt.Sb()),2&t){var a=e.$implicit;tt.Cb(2),tt.mc("placeholder",a.descripcion),tt.lc("ngModel",a.monto)("ngModelOptions",tt.nc(3,Ec))}}function _c(t,e){if(1&t&&(tt.Tb(0,"form"),tt.Dc(1,Pc,3,4,"div",19),tt.Sb()),2&t){var a=tt.fc();tt.Cb(1),tt.lc("ngForOf",a.fpagos)}}function Ic(t,e){1&t&&tt.Ob(0,"app-cargando")}var wc,Ac=((wc=function(){function t(e,a,n,o,i){var r=this;c(this,t),this.snackBar=e,this.pdfServicio=a,this.tipoTurnoSrvc=n,this.fpagoSrvc=o,this.sedeSrvc=i,this.params={_validar:!1,sede:[]},this.titulo="Resumen de caja",this.tiposTurno=[],this.cargando=!1,this.fpagos=[],this.sedes=[],this.grupos=it.b.grupos,this.configBotones={showPdf:!0,showHtml:!1,showExcel:!0},this.loadFormaPago=function(){r.fpagoSrvc.get().subscribe(function(t){t&&(r.fpagos=t)})},this.loadSedes=function(){r.sedeSrvc.getSedes({reporte:!0}).subscribe(function(t){t&&(r.sedes=t)})},this.loadTiposTurno=function(){r.tipoTurnoSrvc.get().subscribe(function(t){t&&(r.tiposTurno=t)})},this.resetParams=function(){r.params={},r.cargando=!1},this.excelClick=function(){r.cargando=!0,r.params._pagos=r.fpagos,r.params._excel=1,r.pdfServicio.getReporteCaja(r.params).subscribe(function(t){if(r.cargando=!1,t){var e=new Blob([t],{type:"application/vnd.ms-excel"});Object(si.saveAs)(e,"".concat(r.titulo,".xls"))}else r.snackBar.open("No se pudo generar el reporte...",r.titulo,{duration:3e3})})}}return s(t,[{key:"ngOnInit",value:function(){this.loadTiposTurno(),this.loadFormaPago(),this.loadSedes()}},{key:"onSubmit",value:function(){var t=this;this.cargando=!0,this.params._pagos=this.fpagos,this.params._excel=0,this.pdfServicio.getReporteCaja(this.params).subscribe(function(e){if(t.cargando=!1,e){var a=new Blob([e],{type:"application/pdf"});Object(si.saveAs)(a,"".concat(t.titulo,".pdf"))}else t.snackBar.open("No se pudo generar el reporte...",t.titulo,{duration:3e3})})}}]),t}()).\u0275fac=function(t){return new(t||wc)(tt.Nb(P.b),tt.Nb(qa.a),tt.Nb(Mo),tt.Nb(yc.a),tt.Nb(ui.a))},wc.\u0275cmp=tt.Hb({type:wc,selectors:[["app-caja"]],decls:35,vars:17,consts:[[1,"row"],[1,"col","m12","s12"],[1,"mat-elevation-z4","fullWidth"],["novalidate",""],["frmRptCaja","ngForm"],[1,"fullWidth"],["name","turno_tipo",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["matInput","","type","date","placeholder","Del","required","",3,"ngModel","ngModelOptions","ngModelChange"],["matInput","","type","date","placeholder","Al","required","",3,"ngModel","ngModelOptions","ngModelChange"],["name","sede","multiple","",3,"ngModel","ngModelChange"],["class","fullWidth",4,"ngIf"],[1,"col"],["name","mostrar_detalle",1,"fullWidth",3,"ngModel","ngModelChange"],["name","validar",1,"fullWidth",3,"ngModel","ngModelChange"],[4,"ngIf"],[3,"configuracion","excelClick","pdfClick","resetParamsClick"],[3,"value"],["name","grupo",3,"ngModel","ngModelChange"],[4,"ngFor","ngForOf"],["matInput","","type","number","step","0.01",3,"placeholder","ngModel","ngModelOptions","ngModelChange"]],template:function(t,e){1&t&&(tt.Tb(0,"div",0),tt.Tb(1,"div",1),tt.Tb(2,"mat-card",2),tt.Tb(3,"mat-card-title"),tt.Tb(4,"h4"),tt.Fc(5,"Reporte de caja"),tt.Sb(),tt.Sb(),tt.Tb(6,"mat-card-content"),tt.Tb(7,"form",3,4),tt.Tb(9,"mat-form-field",5),tt.Tb(10,"mat-label"),tt.Fc(11,"Tipo de turno"),tt.Sb(),tt.Tb(12,"mat-select",6),tt.bc("ngModelChange",function(t){return e.params.turno_tipo=t}),tt.Dc(13,Mc,2,2,"mat-option",7),tt.Sb(),tt.Sb(),tt.Tb(14,"mat-form-field",5),tt.Tb(15,"input",8),tt.bc("ngModelChange",function(t){return e.params.fdel=t}),tt.Sb(),tt.Sb(),tt.Tb(16,"mat-form-field",5),tt.Tb(17,"input",9),tt.bc("ngModelChange",function(t){return e.params.fal=t}),tt.Sb(),tt.Sb(),tt.Tb(18,"mat-form-field",5),tt.Tb(19,"mat-label"),tt.Fc(20,"Sede"),tt.Sb(),tt.Tb(21,"mat-select",10),tt.bc("ngModelChange",function(t){return e.params.sede=t}),tt.Dc(22,Fc,2,2,"mat-option",7),tt.Sb(),tt.Sb(),tt.Dc(23,Oc,5,2,"mat-form-field",11),tt.Tb(24,"div",0),tt.Tb(25,"div",12),tt.Tb(26,"mat-checkbox",13),tt.bc("ngModelChange",function(t){return+(e.params._detalle=t)}),tt.Fc(27,"Mostrar Detalle"),tt.Sb(),tt.Sb(),tt.Tb(28,"div",12),tt.Tb(29,"mat-checkbox",14),tt.bc("ngModelChange",function(t){return+(e.params._validar=t)}),tt.Fc(30,"Validar Montos"),tt.Sb(),tt.Sb(),tt.Sb(),tt.Dc(31,Dc,1,0,"hr",15),tt.Dc(32,_c,2,1,"form",15),tt.Tb(33,"app-rpt-botones",16),tt.bc("excelClick",function(){return e.excelClick()})("pdfClick",function(){return e.onSubmit()})("resetParamsClick",function(){return e.resetParams()}),tt.Sb(),tt.Sb(),tt.Dc(34,Ic,1,0,"app-cargando",15),tt.Sb(),tt.Sb(),tt.Sb(),tt.Sb()),2&t&&(tt.Cb(12),tt.lc("ngModel",e.params.turno_tipo),tt.Cb(1),tt.lc("ngForOf",e.tiposTurno),tt.Cb(2),tt.lc("ngModel",e.params.fdel)("ngModelOptions",tt.nc(15,Ec)),tt.Cb(2),tt.lc("ngModel",e.params.fal)("ngModelOptions",tt.nc(16,Ec)),tt.Cb(4),tt.lc("ngModel",e.params.sede),tt.Cb(1),tt.lc("ngForOf",e.sedes),tt.Cb(1),tt.lc("ngIf",e.params.sede&&e.params.sede.length>1),tt.Cb(3),tt.lc("ngModel",+e.params._detalle),tt.Cb(3),tt.lc("ngModel",+e.params._validar),tt.Cb(2),tt.lc("ngIf",e.params._validar),tt.Cb(1),tt.lc("ngIf",e.params._validar),tt.Cb(1),tt.lc("configuracion",e.configBotones),tt.Cb(1),tt.lc("ngIf",e.cargando))},directives:[y.a,y.h,y.c,m.r,m.l,m.m,T.b,T.f,O.a,m.k,m.n,d.l,k.b,m.c,m.p,d.m,D.a,di.a,j.m,m.o,Le.a],styles:[""]}),wc);function Nc(t,e){1&t&&tt.Ob(0,"app-cargando")}var Rc,Uc=((Rc=function(){function t(e,a){var n=this;c(this,t),this.snackBar=e,this.pdfServicio=a,this.params={},this.titulo="Facturas",this.cargando=!1,this.configBotones={showPdf:!0,showHtml:!1,showExcel:!0,isPdfDisabled:!1,isExcelDisabled:!1},this.resetParams=function(){n.params={fdel:Ee().startOf("month").format(it.b.dbDateFormat),fal:Ee().format(it.b.dbDateFormat)},n.cargando=!1},this.chkDates=function(){n.configBotones.isPdfDisabled=!n.params.fdel||!n.params.fal,n.configBotones.isExcelDisabled=!n.params.fdel||!n.params.fal}}return s(t,[{key:"ngOnInit",value:function(){this.resetParams()}},{key:"onSubmit",value:function(){var t=this;this.cargando=!0,this.params._excel=0,this.pdfServicio.getReporteFactura(this.params).subscribe(function(e){if(t.cargando=!1,e){var a=new Blob([e],{type:"application/pdf"});Object(si.saveAs)(a,"".concat(t.titulo,".pdf"))}else t.snackBar.open("No se pudo generar el reporte...",t.titulo,{duration:3e3})})}},{key:"excelClick",value:function(){var t=this;this.cargando=!0,this.params._excel=1,this.pdfServicio.getReporteFactura(this.params).subscribe(function(e){if(t.cargando=!1,e){var a=new Blob([e],{type:"application/vnd.ms-excel"});Object(si.saveAs)(a,"".concat(t.titulo,".xls"))}else t.snackBar.open("No se pudo generar el reporte...",t.titulo,{duration:3e3})})}}]),t}()).\u0275fac=function(t){return new(t||Rc)(tt.Nb(P.b),tt.Nb(qa.a))},Rc.\u0275cmp=tt.Hb({type:Rc,selectors:[["app-factura"]],decls:22,vars:6,consts:[[1,"row"],[1,"col","m12","s12"],[1,"mat-elevation-z4","fullWidth"],["novalidate",""],["frmRptFactura","ngForm"],[1,"fullWidth"],["matInput","","type","date","placeholder","Del","name","fdel","required","",3,"ngModel","ngModelChange","change"],["matInput","","type","date","placeholder","Al","name","fal","required","",3,"ngModel","ngModelChange","change"],[1,"col"],["name","detalle",1,"fullWidth",3,"ngModel","ngModelChange"],["name","anuladas",1,"fullWidth",3,"ngModel","ngModelChange"],[3,"configuracion","excelClick","pdfClick","resetParamsClick"],[4,"ngIf"]],template:function(t,e){1&t&&(tt.Tb(0,"div",0),tt.Tb(1,"div",1),tt.Tb(2,"mat-card",2),tt.Tb(3,"mat-card-title"),tt.Tb(4,"h4"),tt.Fc(5,"Reporte de facturas"),tt.Sb(),tt.Sb(),tt.Tb(6,"mat-card-content"),tt.Tb(7,"form",3,4),tt.Tb(9,"mat-form-field",5),tt.Tb(10,"input",6),tt.bc("ngModelChange",function(t){return e.params.fdel=t})("change",function(){return e.chkDates()}),tt.Sb(),tt.Sb(),tt.Tb(11,"mat-form-field",5),tt.Tb(12,"input",7),tt.bc("ngModelChange",function(t){return e.params.fal=t})("change",function(){return e.chkDates()}),tt.Sb(),tt.Sb(),tt.Tb(13,"div",0),tt.Tb(14,"div",8),tt.Tb(15,"mat-checkbox",9),tt.bc("ngModelChange",function(t){return+(e.params._detalle=t)}),tt.Fc(16,"Mostrar Detalle"),tt.Sb(),tt.Sb(),tt.Tb(17,"div",8),tt.Tb(18,"mat-checkbox",10),tt.bc("ngModelChange",function(t){return+(e.params._anuladas=t)}),tt.Fc(19,"Mostrar \xdanicamente Anuladas"),tt.Sb(),tt.Sb(),tt.Sb(),tt.Tb(20,"app-rpt-botones",11),tt.bc("excelClick",function(){return e.excelClick()})("pdfClick",function(){return e.onSubmit()})("resetParamsClick",function(){return e.resetParams()}),tt.Sb(),tt.Sb(),tt.Dc(21,Nc,1,0,"app-cargando",12),tt.Sb(),tt.Sb(),tt.Sb(),tt.Sb()),2&t&&(tt.Cb(10),tt.lc("ngModel",e.params.fdel),tt.Cb(2),tt.lc("ngModel",e.params.fal),tt.Cb(3),tt.lc("ngModel",+e.params._detalle),tt.Cb(3),tt.lc("ngModel",+e.params._anuladas),tt.Cb(2),tt.lc("configuracion",e.configBotones),tt.Cb(1),tt.lc("ngIf",e.cargando))},directives:[y.a,y.h,y.c,m.r,m.l,m.m,T.b,k.b,m.c,m.p,m.k,m.n,D.a,di.a,d.m,Le.a],styles:[""]}),Rc);function jc(t,e){if(1&t){var a=tt.Ub();tt.Tb(0,"mat-list-item",5),tt.bc("click",function(){tt.xc(a);var t=e.$implicit;return tt.fc().getTurno(t)}),tt.Tb(1,"mat-icon",6),tt.Fc(2,"line_weight"),tt.Sb(),tt.Tb(3,"h5",7),tt.Fc(4),tt.Sb(),tt.Sb()}if(2&t){var n=e.$implicit;tt.Cb(4),tt.Gc(n.descripcion)}}var Bc,Hc=function(){return{standalone:!0}},Lc=((Bc=function(){function t(e){var a=this;c(this,t),this.turnoSrvc=e,this.getTurnoEv=new tt.o,this.length=0,this.pageSize=5,this.pageSizeOptions=[5,10,15],this.pageIndex=0,this.txtFiltro="",this.loadTurnos=function(){a.turnoSrvc.get().subscribe(function(t){t&&t.length>0&&(a.lstTurnos=t,a.applyFilter())})},this.getTurno=function(t){a.getTurnoEv.emit(t)},this.pageChange=function(t){a.pageSize=t.pageSize,a.pageIndex=t.pageIndex,a.applyFilter()}}return s(t,[{key:"ngOnInit",value:function(){this.loadTurnos()}},{key:"applyFilter",value:function(){if(this.txtFiltro.length>0){var t=Object(it.c)(this.lstTurnos,this.txtFiltro);this.length=t.length,this.lstTurnosPaged=Object(it.f)(t,this.pageSize,this.pageIndex+1)}else this.length=this.lstTurnos.length,this.lstTurnosPaged=Object(it.f)(this.lstTurnos,this.pageSize,this.pageIndex+1)}}]),t}()).\u0275fac=function(t){return new(t||Bc)(tt.Nb(Mo))},Bc.\u0275cmp=tt.Hb({type:Bc,selectors:[["app-lista-turno-tipo"]],outputs:{getTurnoEv:"getTurnoEv"},decls:7,vars:7,consts:[[1,"mat-elevation-z4","fullWidth"],[1,"fullWidth"],["matInput","","placeholder","Buscar...",3,"ngModel","ngModelOptions","keyup","ngModelChange"],[3,"click",4,"ngFor","ngForOf"],["showFirstLastButtons","",3,"length","pageSize","pageSizeOptions","page"],[3,"click"],["mat-list-icon",""],["mat-line",""]],template:function(t,e){1&t&&(tt.Tb(0,"mat-card",0),tt.Tb(1,"mat-card-content"),tt.Tb(2,"mat-form-field",1),tt.Tb(3,"input",2),tt.bc("keyup",function(){return e.applyFilter()})("ngModelChange",function(t){return e.txtFiltro=t}),tt.Sb(),tt.Sb(),tt.Tb(4,"mat-nav-list"),tt.Dc(5,jc,5,1,"mat-list-item",3),tt.Sb(),tt.Tb(6,"mat-paginator",4),tt.bc("page",function(t){return e.pageChange(t)}),tt.Sb(),tt.Sb(),tt.Sb()),2&t&&(tt.Cb(3),tt.lc("ngModel",e.txtFiltro)("ngModelOptions",tt.nc(6,Hc)),tt.Cb(2),tt.lc("ngForOf",e.lstTurnosPaged),tt.Cb(1),tt.lc("length",e.length)("pageSize",e.pageSize)("pageSizeOptions",e.pageSizeOptions))},directives:[y.a,y.c,T.b,k.b,m.c,m.k,m.n,S.e,d.l,A.a,S.c,C.a,S.b,j.j],styles:[""]}),Bc);function qc(t,e){if(1&t){var a=tt.Ub();tt.Tb(0,"button",9),tt.bc("click",function(){return tt.xc(a),tt.fc().resetTurno()}),tt.Fc(1," Nuevo "),tt.Sb()}}var $c,zc,Gc,Wc=(($c=function(){function t(e,a){var n=this;c(this,t),this._snackBar=e,this.turnoSrvc=a,this.turnoSavedEv=new tt.o,this.resetTurno=function(){return n.turno={turno_tipo:null,descripcion:null,activo:1}},this.onSubmit=function(){n.turnoSrvc.save(n.turno).subscribe(function(t){t.exito?(n.turnoSavedEv.emit(),n.resetTurno(),n._snackBar.open("Tipo de Turno agregado...","Turno",{duration:3e3})):n._snackBar.open("ERROR: ".concat(t.mensaje),"Turno",{duration:3e3})})}}return s(t,[{key:"ngOnInit",value:function(){}}]),t}()).\u0275fac=function(t){return new(t||$c)(tt.Nb(P.b),tt.Nb(Mo))},$c.\u0275cmp=tt.Hb({type:$c,selectors:[["app-form-turno-tipo"]],inputs:{turno:"turno"},outputs:{turnoSavedEv:"turnoSavedEv"},decls:15,vars:5,consts:[[1,"mat-elevation-z4","fullWidth"],["novalidate","",3,"ngSubmit"],["frmTurno","ngForm"],[1,"fullWidth"],["matInput","","type","text","placeholder","Descripci\xf3n","name","descripcion","required","",3,"ngModel","ngModelChange"],["name","activo",1,"fullWidth",3,"ngModel","ngModelChange"],["align","end"],["mat-raised-button","","type","submit","color","accent",1,"btnAccion",3,"disabled"],["mat-raised-button","","type","button","color","accent",3,"click",4,"ngIf"],["mat-raised-button","","type","button","color","accent",3,"click"]],template:function(t,e){if(1&t){var a=tt.Ub();tt.Tb(0,"mat-card",0),tt.Tb(1,"mat-card-title"),tt.Tb(2,"h4"),tt.Fc(3),tt.Sb(),tt.Sb(),tt.Tb(4,"mat-card-content"),tt.Tb(5,"form",1,2),tt.bc("ngSubmit",function(){return tt.xc(a),tt.tc(6).form.valid&&e.onSubmit()}),tt.Tb(7,"mat-form-field",3),tt.Tb(8,"input",4),tt.bc("ngModelChange",function(t){return e.turno.descripcion=t}),tt.Sb(),tt.Sb(),tt.Tb(9,"mat-checkbox",5),tt.bc("ngModelChange",function(t){return+(e.turno.activo=t)}),tt.Fc(10,"Activo"),tt.Sb(),tt.Tb(11,"div",6),tt.Tb(12,"button",7),tt.Fc(13," Guardar "),tt.Sb(),tt.Dc(14,qc,2,0,"button",8),tt.Sb(),tt.Sb(),tt.Sb(),tt.Sb()}if(2&t){var n=tt.tc(6);tt.Cb(3),tt.Hc(" Tipo de Turno ",e.turno.turno_tipo?e.turno.descripcion:""," "),tt.Cb(5),tt.lc("ngModel",e.turno.descripcion),tt.Cb(1),tt.lc("ngModel",+e.turno.activo),tt.Cb(3),tt.lc("disabled",!n.form.valid),tt.Cb(2),tt.lc("ngIf",e.turno.turno_tipo)}},directives:[y.a,y.h,y.c,m.r,m.l,m.m,T.b,k.b,m.c,m.p,m.k,m.n,D.a,E.a,d.m],styles:[""]}),$c),Vc=["lstTurno"],Kc=((Gc=function(){function t(){var e=this;c(this,t),this.setTurno=function(t){return e.turno=t},this.refreshTurnoList=function(){return e.lstTurnoComponent.loadTurnos()},this.turno={turno_tipo:null,descripcion:null,activo:1}}return s(t,[{key:"ngOnInit",value:function(){}}]),t}()).\u0275fac=function(t){return new(t||Gc)},Gc.\u0275cmp=tt.Hb({type:Gc,selectors:[["app-turno-tipo"]],viewQuery:function(t,e){var a;1&t&&tt.Kc(Vc,1),2&t&&tt.sc(a=tt.cc())&&(e.lstTurnoComponent=a.first)},decls:7,vars:1,consts:[[1,"row"],[1,"col","m5","s12"],[3,"getTurnoEv"],["lstTurno",""],[1,"col","m7","s12"],[3,"turno","turnoSavedEv"],["frmTurno",""]],template:function(t,e){1&t&&(tt.Tb(0,"div",0),tt.Tb(1,"div",1),tt.Tb(2,"app-lista-turno-tipo",2,3),tt.bc("getTurnoEv",function(t){return e.setTurno(t)}),tt.Sb(),tt.Sb(),tt.Tb(4,"div",4),tt.Tb(5,"app-form-turno-tipo",5,6),tt.bc("turnoSavedEv",function(){return e.refreshTurnoList()}),tt.Sb(),tt.Sb(),tt.Sb()),2&t&&(tt.Cb(5),tt.lc("turno",e.turno))},directives:[Lc,Wc],styles:[""]}),Gc),Jc=((zc=function(){function t(e){c(this,t),this.http=e,this.moduleUrl="propina",this.srvcErrHndl=new ct.a}return s(t,[{key:"get",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.http.get("".concat(it.b.urlAppRestaurante,"/").concat(this.moduleUrl,"/buscar?").concat(lt.stringify(t))).pipe(Object(rt.a)(it.b.reintentos),Object(st.a)(this.srvcErrHndl.errorHandler))}},{key:"save",value:function(t){return this.http.post("".concat(it.b.urlAppRestaurante,"/").concat(this.moduleUrl,"/guardar").concat(t.propina_distribucion?"/"+t.propina_distribucion:""),t).pipe(Object(rt.a)(it.b.reintentos),Object(st.a)(this.srvcErrHndl.errorHandler))}}]),t}()).\u0275fac=function(t){return new(t||zc)(tt.Xb(b.b))},zc.\u0275prov=tt.Jb({token:zc,factory:zc.\u0275fac,providedIn:"root"}),zc);function Qc(t,e){if(1&t){var a=tt.Ub();tt.Tb(0,"td",7),tt.bc("click",function(){tt.xc(a);var t=e.$implicit;return tt.fc().getPropina(t)}),tt.Tb(1,"mat-list"),tt.Tb(2,"mat-list-item"),tt.Tb(3,"mat-icon",8),tt.Fc(4,"line_weight"),tt.Sb(),tt.Tb(5,"h5",9),tt.Fc(6),tt.Sb(),tt.Tb(7,"span",9),tt.Fc(8),tt.Sb(),tt.Tb(9,"button",10),tt.Tb(10,"mat-icon"),tt.Fc(11,"arrow_right_alt"),tt.Sb(),tt.Sb(),tt.Sb(),tt.Sb(),tt.Sb()}if(2&t){var n=e.$implicit;tt.Cb(6),tt.Hc("",n.porcentaje,"%"),tt.Cb(2),tt.Gc(n.usuario_tipo.descripcion)}}function Xc(t,e){1&t&&tt.Ob(0,"tr",11)}var Yc,Zc=function(){return[5,10,20]},tr=((Yc=function(){function t(e){var a=this;c(this,t),this.propinaSrvc=e,this.displayedColumns=["propina"],this.getPropinaEv=new tt.o,this.loadPropinas=function(){a.propinaSrvc.get().subscribe(function(t){t&&t.length>0&&(a.lstPropinas=t,a.dataSource=new x.l(a.lstPropinas),a.dataSource.paginator=a.paginator)})},this.getPropina=function(t){a.getPropinaEv.emit(t)}}return s(t,[{key:"ngOnInit",value:function(){this.loadPropinas()}},{key:"applyFilter",value:function(t){this.dataSource.filter=t.trim().toLowerCase()}}]),t}()).\u0275fac=function(t){return new(t||Yc)(tt.Nb(Jc))},Yc.\u0275cmp=tt.Hb({type:Yc,selectors:[["app-lista-propina"]],viewQuery:function(t,e){var a;1&t&&tt.Kc(A.a,3),2&t&&tt.sc(a=tt.cc())&&(e.paginator=a.first)},outputs:{getPropinaEv:"getPropinaEv"},decls:9,vars:4,consts:[[1,"mat-elevation-z4","fullWidth"],["matInput","","placeholder","Buscar...",3,"keyup"],["mat-table","",3,"dataSource"],["matColumnDef","propina"],["mat-cell","",3,"click",4,"matCellDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["showFirstLastButtons","",3,"pageSizeOptions"],["mat-cell","",3,"click"],["mat-list-icon",""],["mat-line",""],["mat-icon-button","","type","button","color","accent"],["mat-row",""]],template:function(t,e){1&t&&(tt.Tb(0,"mat-card",0),tt.Tb(1,"mat-card-content"),tt.Tb(2,"mat-form-field"),tt.Tb(3,"input",1),tt.bc("keyup",function(t){return e.applyFilter(t.target.value)}),tt.Sb(),tt.Sb(),tt.Tb(4,"table",2),tt.Rb(5,3),tt.Dc(6,Qc,12,2,"td",4),tt.Qb(),tt.Dc(7,Xc,1,0,"tr",5),tt.Sb(),tt.Ob(8,"mat-paginator",6),tt.Sb(),tt.Sb()),2&t&&(tt.Cb(4),tt.lc("dataSource",e.dataSource),tt.Cb(3),tt.lc("matRowDefColumns",e.displayedColumns),tt.Cb(1),tt.lc("pageSizeOptions",tt.nc(3,Zc)))},directives:[y.a,y.c,T.b,k.b,x.k,x.c,x.b,x.j,A.a,x.a,S.a,S.c,C.a,S.b,j.j,E.a,x.i],styles:[""]}),Yc);function er(t,e){if(1&t&&(tt.Tb(0,"mat-option",14),tt.Fc(1),tt.Sb()),2&t){var a=e.$implicit;tt.lc("value",a.usuario_tipo),tt.Cb(1),tt.Hc(" ",a.descripcion," ")}}function ar(t,e){if(1&t){var a=tt.Ub();tt.Tb(0,"button",15),tt.bc("click",function(){return tt.xc(a),tt.fc().resetPropina()}),tt.Tb(1,"mat-icon"),tt.Fc(2,"add"),tt.Sb(),tt.Sb()}}var nr,or,ir,cr=((nr=function(){function t(e,a,n){var o=this;c(this,t),this.snackBar=e,this.propinaSrvc=a,this.usuarioSrvc=n,this.propinaSavedEv=new tt.o,this.usuarios=[],this.loadUsuario=function(){o.usuarioSrvc.get().subscribe(function(t){o.usuarios=t})},this.resetPropina=function(){return o.propina={propina_distribucion:null,usuario_tipo:null,porcentaje:null,anulado:0,sede:null,grupal:0}},this.onSubmit=function(){o.propinaSrvc.save(o.propina).subscribe(function(t){t.exito?(o.propinaSavedEv.emit(),o.resetPropina(),o.snackBar.open("Propina agregada...","Distribucion de propinas",{duration:3e3})):o.snackBar.open("ERROR: ".concat(t.mensaje),"Distribucion de propinas",{duration:3e3})})}}return s(t,[{key:"ngOnInit",value:function(){this.resetPropina(),this.loadUsuario()}}]),t}()).\u0275fac=function(t){return new(t||nr)(tt.Nb(P.b),tt.Nb(Jc),tt.Nb(Fo))},nr.\u0275cmp=tt.Hb({type:nr,selectors:[["app-form-propina"]],inputs:{propina:"propina"},outputs:{propinaSavedEv:"propinaSavedEv"},decls:24,vars:7,consts:[[1,"mat-elevation-z4","fullWidth"],["novalidate","",3,"ngSubmit"],["frmPropina","ngForm"],[1,"fullWidth"],["name","usuario","required","",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["matInput","","type","number","step","0.01","placeholder","Porcentaje","name","porcentaje","required","",3,"ngModel","ngModelChange"],[1,"row"],[1,"col","m6","s6"],["name","grupal",1,"fullWidth",3,"ngModel","ngModelChange"],["name","anulado",1,"fullWidth",3,"ngModel","ngModelChange"],["align","end"],["mat-icon-button","","type","submit","color","accent",3,"disabled"],["mat-icon-button","","type","button","color","accent",3,"click",4,"ngIf"],[3,"value"],["mat-icon-button","","type","button","color","accent",3,"click"]],template:function(t,e){if(1&t){var a=tt.Ub();tt.Tb(0,"mat-card",0),tt.Ob(1,"mat-card-title"),tt.Tb(2,"mat-card-content"),tt.Tb(3,"form",1,2),tt.bc("ngSubmit",function(){return tt.xc(a),tt.tc(4).form.valid&&e.onSubmit()}),tt.Tb(5,"mat-form-field",3),tt.Tb(6,"mat-label"),tt.Fc(7,"Tipo Usuario"),tt.Sb(),tt.Tb(8,"mat-select",4),tt.bc("ngModelChange",function(t){return e.propina.usuario_tipo=t}),tt.Dc(9,er,2,2,"mat-option",5),tt.Sb(),tt.Sb(),tt.Tb(10,"mat-form-field",3),tt.Tb(11,"input",6),tt.bc("ngModelChange",function(t){return e.propina.porcentaje=t}),tt.Sb(),tt.Sb(),tt.Tb(12,"div",7),tt.Tb(13,"div",8),tt.Tb(14,"mat-checkbox",9),tt.bc("ngModelChange",function(t){return+(e.propina.grupal=t)}),tt.Fc(15,"Propina Grupal"),tt.Sb(),tt.Sb(),tt.Tb(16,"div",8),tt.Tb(17,"mat-checkbox",10),tt.bc("ngModelChange",function(t){return+(e.propina.anulado=t)}),tt.Fc(18,"Anulado"),tt.Sb(),tt.Sb(),tt.Sb(),tt.Tb(19,"div",11),tt.Tb(20,"button",12),tt.Tb(21,"mat-icon"),tt.Fc(22,"save"),tt.Sb(),tt.Sb(),tt.Dc(23,ar,3,0,"button",13),tt.Sb(),tt.Sb(),tt.Sb(),tt.Sb()}if(2&t){var n=tt.tc(4);tt.Cb(8),tt.lc("ngModel",e.propina.usuario_tipo),tt.Cb(1),tt.lc("ngForOf",e.usuarios),tt.Cb(2),tt.lc("ngModel",e.propina.porcentaje),tt.Cb(3),tt.lc("ngModel",+e.propina.grupal),tt.Cb(3),tt.lc("ngModel",+e.propina.anulado),tt.Cb(3),tt.lc("disabled",!n.form.valid),tt.Cb(3),tt.lc("ngIf",e.propina.propina_distribucion)}},directives:[y.a,y.h,y.c,m.r,m.l,m.m,T.b,T.f,O.a,m.p,m.k,m.n,d.l,k.b,m.o,m.c,D.a,E.a,C.a,d.m,j.m],styles:[""]}),nr),rr=["lstPropina"],sr=((ir=function(){function t(){var e=this;c(this,t),this.setPropina=function(t){return e.propina={propina_distribucion:t.propina_distribucion,usuario_tipo:t.usuario_tipo.usuario_tipo,porcentaje:t.porcentaje,anulado:t.anulado,sede:t.sede,grupal:t.grupal}},this.refreshPropinaList=function(){return e.lstPropinaComponent.loadPropinas()},this.propina={propina_distribucion:null,usuario_tipo:null,porcentaje:null,anulado:null,sede:null,grupal:null}}return s(t,[{key:"ngOnInit",value:function(){}}]),t}()).\u0275fac=function(t){return new(t||ir)},ir.\u0275cmp=tt.Hb({type:ir,selectors:[["app-propina"]],viewQuery:function(t,e){var a;1&t&&tt.Kc(rr,1),2&t&&tt.sc(a=tt.cc())&&(e.lstPropinaComponent=a.first)},decls:7,vars:1,consts:[[1,"row"],[1,"col","m5","s12"],[3,"getPropinaEv"],["lstPropina",""],[1,"col","m7","s12"],[3,"propina","propinaSavedEv"],["frmPropina",""]],template:function(t,e){1&t&&(tt.Tb(0,"div",0),tt.Tb(1,"div",1),tt.Tb(2,"app-lista-propina",2,3),tt.bc("getPropinaEv",function(t){return e.setPropina(t)}),tt.Sb(),tt.Sb(),tt.Tb(4,"div",4),tt.Tb(5,"app-form-propina",5,6),tt.bc("propinaSavedEv",function(){return e.refreshPropinaList()}),tt.Sb(),tt.Sb(),tt.Sb()),2&t&&(tt.Cb(5),tt.lc("propina",e.propina))},directives:[tr,cr],styles:[""]}),ir),lr=((or=function(){function t(e){c(this,t),this.http=e,this.srvcErrHndl=new ct.a}return s(t,[{key:"getCampos",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.http.get("".concat(it.b.urlCatalogos,"/get_campos?").concat(lt.stringify(t))).pipe(Object(rt.a)(it.b.reintentos),Object(st.a)(this.srvcErrHndl.errorHandler))}},{key:"getReporte",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e={headers:new b.d({Accept:"application/vnd.ms-excel"}),responseType:"blob"};return this.http.post("".concat(it.b.urlAppRestaurante,"/reporte/autoconsulta"),t,e).pipe(Object(rt.a)(it.b.reintentos),Object(st.a)(this.srvcErrHndl.errorHandler))}}]),t}()).\u0275fac=function(t){return new(t||or)(tt.Xb(b.b))},or.\u0275prov=tt.Jb({token:or,factory:or.\u0275fac,providedIn:"root"}),or);function ur(t,e){if(1&t&&(tt.Tb(0,"mat-option",14),tt.Fc(1),tt.Sb()),2&t){var a=e.$implicit;tt.lc("value",a.tabla_campo),tt.Cb(1),tt.Hc(" ",a.descripcion," ")}}function dr(t,e){if(1&t&&(tt.Tb(0,"mat-option",14),tt.Fc(1),tt.Sb()),2&t){var a=e.$implicit;tt.lc("value",a.tabla_campo),tt.Cb(1),tt.Hc(" ",a.descripcion," ")}}function br(t,e){if(1&t&&(tt.Tb(0,"mat-option",14),tt.Fc(1),tt.Sb()),2&t){var a=e.$implicit;tt.lc("value",a.tabla_campo),tt.Cb(1),tt.Hc(" ",a.descripcion," ")}}function mr(t,e){1&t&&tt.Ob(0,"app-cargando")}var fr,pr,gr=((pr=function(){function t(e,a){var n=this;c(this,t),this.snackBar=e,this.autoconsultaSrvc=a,this.params={campos:[],datos:[]},this.titulo="Autoconsulta",this.campos=[],this.fechas=[],this.orden=[],this.cargando=!1,this.configBotones={showPdf:!1,showHtml:!1,showExcel:!0},this.resetParams=function(){n.params={campos:[],datos:[]},n.cargando=!1},this.getReporte=function(){for(var t in n.cargando=!0,n.params.campos)n.params.datos.push(n.params.campos[t]);n.autoconsultaSrvc.getReporte(n.params).subscribe(function(t){if(n.cargando=!1,t){var e=new Blob([t],{type:"application/vnd.ms-excel"});Object(si.saveAs)(e,"".concat(n.titulo,".xls"))}else n.snackBar.open("No se pudo generar el reporte...",n.titulo,{duration:3e3})})},this.getCampos=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;n.cargando=!0,n.autoconsultaSrvc.getCampos(t).subscribe(function(t){switch(n.cargando=!1,e){case 1:n.campos=t;break;case 2:n.fechas=t;break;case 3:n.orden=t}})}}return s(t,[{key:"ngOnInit",value:function(){this.getCampos(),this.getCampos({por_fecha:1},2),this.getCampos({ordenar_por:1},3)}}]),t}()).\u0275fac=function(t){return new(t||pr)(tt.Nb(P.b),tt.Nb(lr))},pr.\u0275cmp=tt.Hb({type:pr,selectors:[["app-autoconsulta"]],decls:30,vars:10,consts:[[1,"row"],[1,"col","m12","s12"],[1,"mat-elevation-z4","fullWidth"],["novalidate",""],["frmEntidad","ngForm"],[1,"fullWidth"],["name","campos","multiple","multiple","required","",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["type","date","matInput","","placeholder","Del","name","fdel","required","",3,"ngModel","ngModelChange"],["type","date","matInput","","placeholder","Al","name","fal","required","",3,"ngModel","ngModelChange"],["name","campos","required","",3,"ngModel","ngModelChange"],["name","campos",3,"ngModel","ngModelChange"],[3,"configuracion","excelClick","resetParamsClick"],[4,"ngIf"],[3,"value"]],template:function(t,e){1&t&&(tt.Tb(0,"div",0),tt.Tb(1,"div",1),tt.Tb(2,"mat-card",2),tt.Tb(3,"mat-card-title"),tt.Tb(4,"h4"),tt.Fc(5,"Autoconsulta"),tt.Sb(),tt.Sb(),tt.Tb(6,"mat-card-content"),tt.Tb(7,"form",3,4),tt.Tb(9,"mat-form-field",5),tt.Tb(10,"mat-label"),tt.Fc(11,"Campos"),tt.Sb(),tt.Tb(12,"mat-select",6),tt.bc("ngModelChange",function(t){return e.params.campos=t}),tt.Dc(13,ur,2,2,"mat-option",7),tt.Sb(),tt.Sb(),tt.Tb(14,"mat-form-field",5),tt.Tb(15,"input",8),tt.bc("ngModelChange",function(t){return e.params.fdel=t}),tt.Sb(),tt.Sb(),tt.Tb(16,"mat-form-field",5),tt.Tb(17,"input",9),tt.bc("ngModelChange",function(t){return e.params.fal=t}),tt.Sb(),tt.Sb(),tt.Tb(18,"mat-form-field",5),tt.Tb(19,"mat-label"),tt.Fc(20,"Filtrar Por"),tt.Sb(),tt.Tb(21,"mat-select",10),tt.bc("ngModelChange",function(t){return e.params.fecha=t}),tt.Dc(22,dr,2,2,"mat-option",7),tt.Sb(),tt.Sb(),tt.Tb(23,"mat-form-field",5),tt.Tb(24,"mat-label"),tt.Fc(25,"Ordenar Por"),tt.Sb(),tt.Tb(26,"mat-select",11),tt.bc("ngModelChange",function(t){return e.params.orden=t}),tt.Dc(27,br,2,2,"mat-option",7),tt.Sb(),tt.Sb(),tt.Tb(28,"app-rpt-botones",12),tt.bc("excelClick",function(){return e.getReporte()})("resetParamsClick",function(){return e.resetParams()}),tt.Sb(),tt.Sb(),tt.Dc(29,mr,1,0,"app-cargando",13),tt.Sb(),tt.Sb(),tt.Sb(),tt.Sb()),2&t&&(tt.Cb(12),tt.lc("ngModel",e.params.campos),tt.Cb(1),tt.lc("ngForOf",e.campos),tt.Cb(2),tt.lc("ngModel",e.params.fdel),tt.Cb(2),tt.lc("ngModel",e.params.fal),tt.Cb(4),tt.lc("ngModel",e.params.fecha),tt.Cb(1),tt.lc("ngForOf",e.fechas),tt.Cb(4),tt.lc("ngModel",e.params.orden),tt.Cb(1),tt.lc("ngForOf",e.orden),tt.Cb(1),tt.lc("configuracion",e.configBotones),tt.Cb(1),tt.lc("ngIf",e.cargando))},directives:[y.a,y.h,y.c,m.r,m.l,m.m,T.b,T.f,O.a,m.p,m.k,m.n,d.l,k.b,m.c,di.a,d.m,j.m,Le.a],styles:[""]}),pr),hr=((fr=function(){function t(e){c(this,t),this.http=e,this.moduleUrl="cajacorte",this.srvcErrHndl=new ct.a}return s(t,[{key:"buscar",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.http.get("".concat(it.b.urlAppRestaurante,"/").concat(this.moduleUrl,"/buscar?").concat(lt.stringify(t))).pipe(Object(rt.a)(it.b.reintentos),Object(st.a)(this.srvcErrHndl.errorHandler))}},{key:"getCajaCorteTipo",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.http.get("".concat(it.b.urlCatalogos,"/get_caja_corte_tipo?").concat(lt.stringify(t))).pipe(Object(rt.a)(it.b.reintentos),Object(st.a)(this.srvcErrHndl.errorHandler))}},{key:"getCajaCorteNominacion",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.http.get("".concat(it.b.urlCatalogos,"/get_caja_corte_nominacion?").concat(lt.stringify(t))).pipe(Object(rt.a)(it.b.reintentos),Object(st.a)(this.srvcErrHndl.errorHandler))}},{key:"guardar",value:function(t){return this.http.post("".concat(it.b.urlAppRestaurante,"/").concat(this.moduleUrl,"/guardar"),t).pipe(Object(rt.a)(it.b.reintentos),Object(st.a)(this.srvcErrHndl.errorHandler))}},{key:"anularCorte",value:function(t){return this.http.post("".concat(it.b.urlAppRestaurante,"/").concat(this.moduleUrl,"/anular_caja"),t).pipe(Object(rt.a)(it.b.reintentos),Object(st.a)(this.srvcErrHndl.errorHandler))}},{key:"anularDetalle",value:function(t){return this.http.post("".concat(it.b.urlAppRestaurante,"/").concat(this.moduleUrl,"/anular_caja_detalle"),t).pipe(Object(rt.a)(it.b.reintentos),Object(st.a)(this.srvcErrHndl.errorHandler))}}]),t}()).\u0275fac=function(t){return new(t||fr)(tt.Xb(b.b))},fr.\u0275prov=tt.Jb({token:fr,factory:fr.\u0275fac,providedIn:"root"}),fr);function vr(t,e){if(1&t){var a=tt.Ub();tt.Tb(0,"td",7),tt.Tb(1,"mat-list"),tt.Tb(2,"mat-list-item"),tt.Tb(3,"mat-icon",8),tt.bc("click",function(){tt.xc(a);var t=e.$implicit;return tt.fc().anularCaja(t)}),tt.Fc(4,"close"),tt.Sb(),tt.Tb(5,"h5",9),tt.Fc(6),tt.Sb(),tt.Tb(7,"span",9),tt.Fc(8),tt.Sb(),tt.Tb(9,"span",9),tt.Fc(10),tt.Sb(),tt.Tb(11,"button",10),tt.bc("click",function(){tt.xc(a);var t=e.$implicit;return tt.fc().getCajacorte(t)}),tt.Tb(12,"mat-icon"),tt.Fc(13,"arrow_right_alt"),tt.Sb(),tt.Sb(),tt.Sb(),tt.Sb(),tt.Sb()}if(2&t){var n=e.$implicit;tt.Cb(6),tt.Gc(n.descripcion),tt.Cb(2),tt.Gc(n.creacion),tt.Cb(2),tt.Hc("Total: ",n.total,"")}}function Sr(t,e){1&t&&tt.Ob(0,"tr",11)}var Cr,Tr=function(){return[5,10,20]},kr=((Cr=function(){function t(e,a){var n=this;c(this,t),this.ccorteSrvc=e,this._snackBar=a,this.displayedColumns=["ccGeneral"],this.getCajacorteEv=new tt.o,this.getCajascortes=function(){n.ccorteSrvc.buscar().subscribe(function(t){n.listacc=t,n.dataSource=new x.l(n.listacc),n.dataSource.paginator=n.paginator})},this.anularCaja=function(t){confirm("\xbfSi anula este corte, se anular\xe1 tambi\xe9n las nominaciones.?")&&n.ccorteSrvc.anularCorte(t).subscribe(function(t){t.exito&&n.getCajascortes(),n._snackBar.open("".concat(t.mensaje),"Corte de caja",{duration:3e3})})},this.getCajacorte=function(t){n.getCajacorteEv.emit(t)}}return s(t,[{key:"ngOnInit",value:function(){this.getCajascortes()}},{key:"filtrar",value:function(t){this.dataSource.filter=t.trim().toLowerCase()}}]),t}()).\u0275fac=function(t){return new(t||Cr)(tt.Nb(hr),tt.Nb(P.b))},Cr.\u0275cmp=tt.Hb({type:Cr,selectors:[["app-cajacorte-lista"]],viewQuery:function(t,e){var a;1&t&&tt.Kc(A.a,3),2&t&&tt.sc(a=tt.cc())&&(e.paginator=a.first)},outputs:{getCajacorteEv:"getCajacorteEv"},decls:9,vars:4,consts:[[1,"mat-elevation-z4","fullWidth"],["matInput","","placeholder","Buscar...",3,"keyup"],["mat-table","",3,"dataSource"],["matColumnDef","ccGeneral"],["mat-cell","",4,"matCellDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["showFirstLastButtons","",3,"pageSizeOptions"],["mat-cell",""],["mat-list-icon","",1,"anulaicon",3,"click"],["mat-line",""],["mat-icon-button","","type","button","color","accent",3,"click"],["mat-row",""]],template:function(t,e){1&t&&(tt.Tb(0,"mat-card",0),tt.Tb(1,"mat-card-content"),tt.Tb(2,"mat-form-field"),tt.Tb(3,"input",1),tt.bc("keyup",function(t){return e.filtrar(t.target.value)}),tt.Sb(),tt.Sb(),tt.Tb(4,"table",2),tt.Rb(5,3),tt.Dc(6,vr,14,3,"td",4),tt.Qb(),tt.Dc(7,Sr,1,0,"tr",5),tt.Sb(),tt.Ob(8,"mat-paginator",6),tt.Sb(),tt.Sb()),2&t&&(tt.Cb(4),tt.lc("dataSource",e.dataSource),tt.Cb(3),tt.lc("matRowDefColumns",e.displayedColumns),tt.Cb(1),tt.lc("pageSizeOptions",tt.nc(3,Tr)))},directives:[y.a,y.c,T.b,k.b,x.k,x.c,x.b,x.j,A.a,x.a,S.a,S.c,C.a,S.b,j.j,E.a,x.i],styles:[".anulaicon[_ngcontent-%COMP%]{cursor:pointer}"]}),Cr);function yr(t,e){if(1&t&&(tt.Tb(0,"mat-option",16),tt.Fc(1),tt.Sb()),2&t){var a=e.$implicit;tt.lc("value",a.caja_corte_tipo),tt.Cb(1),tt.Hc(" ",a.descripcion," ")}}function Mr(t,e){if(1&t&&(tt.Tb(0,"mat-option",16),tt.Fc(1),tt.Sb()),2&t){var a=e.$implicit;tt.lc("value",a.caja_corte_nominacion),tt.Cb(1),tt.Hc(" ",a.nombre," ")}}function Fr(t,e){if(1&t){var a=tt.Ub();tt.Tb(0,"mat-grid-list",11),tt.Tb(1,"mat-grid-tile"),tt.Fc(2),tt.Sb(),tt.Tb(3,"mat-grid-tile"),tt.Fc(4),tt.Sb(),tt.Tb(5,"mat-grid-tile"),tt.Fc(6),tt.Sb(),tt.Tb(7,"mat-grid-tile"),tt.Tb(8,"mat-icon",17),tt.bc("click",function(){tt.xc(a);var t=e.$implicit;return tt.fc().anularCajaDetalle(t)}),tt.Fc(9,"close"),tt.Sb(),tt.Sb(),tt.Sb()}if(2&t){var n=e.$implicit;tt.Cb(2),tt.Gc(n.nombre),tt.Cb(2),tt.Gc(n.cantidad),tt.Cb(2),tt.Gc(n.total)}}function xr(t,e){if(1&t){var a=tt.Ub();tt.Tb(0,"button",18),tt.bc("click",function(){return tt.xc(a),tt.fc().reseteGeneral()}),tt.Tb(1,"mat-icon"),tt.Fc(2,"add"),tt.Sb(),tt.Sb()}}var Or,Dr,Er=((Or=function(){function t(e,a){var n=this;c(this,t),this._snackBar=e,this.cajacorteSrvc=a,this.cajacorteSavedEv=new tt.o,this.ccorteTipo=[],this.ccorteNomi=[],this.detalle={caja_corte_detalle:0,caja_corte:0,cantidad:0,total:0,anulado:0,caja_corte_nominacion:0,nombre:null},this.getCajaCorteTipo=function(){n.cajacorteSrvc.getCajaCorteTipo().subscribe(function(t){n.ccorteTipo=t})},this.getCajaCorteNominacion=function(){n.cajacorteSrvc.getCajaCorteNominacion().subscribe(function(t){n.ccorteNomi=t})},this.setTotal=function(){if(n.detalle.caja_corte_nominacion){var t=n.ccorteNomi.filter(function(t){return t.caja_corte_nominacion==n.detalle.caja_corte_nominacion})[0];n.detalle.total=1==t.calcula?n.detalle.cantidad*t.valor:n.detalle.cantidad}},this.setNamenomi=function(){var t=n.ccorteNomi.filter(function(t){return t.caja_corte_nominacion==n.detalle.caja_corte_nominacion})[0];console.log(t,n.detalle.caja_corte_nominacion),n.detalle.nombre=t.nombre},this.setNameTipo=function(){var t=n.ccorteTipo.filter(function(t){return t.caja_corte_tipo==n.ccorte.caja_corte_tipo})[0];console.log(t,n.ccorte.caja_corte_tipo),n.ccorte.descripcion=t.descripcion},this.reseteGeneral=function(){return n.ccorte={caja_corte:0,creacion:null,usuario:0,turno:0,confirmado:null,anulado:0,caja_corte_tipo:0,descripcion:null,detalle:[]}},this.resetDetalle=function(){return n.detalle={caja_corte_detalle:0,caja_corte:0,cantidad:0,total:0,anulado:0,caja_corte_nominacion:0,nombre:null}},this.agregarDetalle=function(){n.detalle.caja_corte_nominacion&&n.detalle.cantidad&&n.detalle.total?(n.ccorte.detalle.push(n.detalle),n.resetDetalle()):n._snackBar.open("Complete los datos de nominaciones","Corte de caja",{duration:3e3})},this.guardar=function(){if(confirm("\xbfEst\xe1 seguro?")){if(0==n.ccorte.detalle.length)return n._snackBar.open("Por favor agregue las nominaciones","Corte de caja",{duration:3e3}),!1;if(!n.ccorte.caja_corte_tipo)return n._snackBar.open("Seleccione el tipo de corte de caja.","Corte de caja",{duration:3e3}),!1;n.cajacorteSrvc.guardar(n.ccorte).subscribe(function(t){t.exito&&(n.cajacorteSavedEv.emit(),n.reseteGeneral()),n._snackBar.open("".concat(t.mensaje),"Corte de caja",{duration:3e3})})}},this.anularCajaDetalle=function(t){if(confirm("\xbfEst\xe1 seguro.?"))if(t.caja_corte_detalle)n.cajacorteSrvc.anularDetalle(t).subscribe(function(e){if(e.exito){var a=n.ccorte.detalle.indexOf(t);n.ccorte.detalle.splice(a,1)}n._snackBar.open("".concat(e.mensaje),"Corte de caja",{duration:3e3})});else{var e=n.ccorte.detalle.indexOf(t);n.ccorte.detalle.splice(e,1)}}}return s(t,[{key:"ngOnInit",value:function(){this.getCajaCorteTipo(),this.getCajaCorteNominacion()}}]),t}()).\u0275fac=function(t){return new(t||Or)(tt.Nb(P.b),tt.Nb(hr))},Or.\u0275cmp=tt.Hb({type:Or,selectors:[["app-cajacorte-form"]],inputs:{ccorte:"ccorte"},outputs:{cajacorteSavedEv:"cajacorteSavedEv"},decls:49,vars:9,consts:[[1,"mat-elevation-z4","fullWidth"],["novalidate","",3,"ngSubmit"],["frmcc","ngForm"],[1,"fullWidth"],["name","tipo","required","",3,"ngModel","ngModelChange","selectionChange"],[3,"value",4,"ngFor","ngForOf"],[1,"example-container"],["name","nominacion",3,"ngModel","ngModelChange","selectionChange"],["matInput","","type","number","step","0.01","name","cantidad",3,"ngModel","ngModelChange","blur"],["matInput","","type","number","step","0.01","name","total","readonly","",3,"ngModel","ngModelChange"],["mat-icon-button","","type","button","color","accent","title","Agregar el detalle",3,"click"],["cols","4","rowHeight","7:1"],["cols","4","rowHeight","7:1",4,"ngFor","ngForOf"],["align","end"],["mat-icon-button","","type","button","color","accent",3,"click",4,"ngIf"],["mat-icon-button","","type","submit","color","accent","title","Guardar corte de caja",3,"disabled"],[3,"value"],["mat-list-icon","",1,"anulacion",3,"click"],["mat-icon-button","","type","button","color","accent",3,"click"]],template:function(t,e){if(1&t){var a=tt.Ub();tt.Tb(0,"mat-card",0),tt.Tb(1,"mat-card-title"),tt.Tb(2,"h5"),tt.Fc(3,"Corte de caja"),tt.Sb(),tt.Sb(),tt.Tb(4,"mat-card-content"),tt.Tb(5,"form",1,2),tt.bc("ngSubmit",function(){return tt.xc(a),tt.tc(6).form.valid&&e.guardar()}),tt.Tb(7,"mat-form-field",3),tt.Tb(8,"mat-label"),tt.Fc(9,"Tipo de Corte"),tt.Sb(),tt.Tb(10,"mat-select",4),tt.bc("ngModelChange",function(t){return e.ccorte.caja_corte_tipo=t})("selectionChange",function(){return e.setNameTipo()}),tt.Dc(11,yr,2,2,"mat-option",5),tt.Sb(),tt.Sb(),tt.Tb(12,"p"),tt.Fc(13,"Agregar nominaciones"),tt.Sb(),tt.Tb(14,"div",6),tt.Tb(15,"mat-form-field"),tt.Tb(16,"mat-label"),tt.Fc(17,"Nominaci\xf3n:"),tt.Sb(),tt.Tb(18,"mat-select",7),tt.bc("ngModelChange",function(t){return e.detalle.caja_corte_nominacion=t})("selectionChange",function(){return e.setNamenomi()}),tt.Dc(19,Mr,2,2,"mat-option",5),tt.Sb(),tt.Sb(),tt.Tb(20,"mat-form-field"),tt.Tb(21,"mat-label"),tt.Fc(22,"Cantidad:"),tt.Sb(),tt.Tb(23,"input",8),tt.bc("ngModelChange",function(t){return e.detalle.cantidad=t})("blur",function(){return e.setTotal()}),tt.Sb(),tt.Sb(),tt.Tb(24,"mat-form-field"),tt.Tb(25,"mat-label"),tt.Fc(26,"Total:"),tt.Sb(),tt.Tb(27,"input",9),tt.bc("ngModelChange",function(t){return e.detalle.total=t}),tt.Sb(),tt.Sb(),tt.Tb(28,"button",10),tt.bc("click",function(){return e.agregarDetalle()}),tt.Tb(29,"mat-icon"),tt.Fc(30,"add"),tt.Sb(),tt.Sb(),tt.Sb(),tt.Tb(31,"mat-grid-list",11),tt.Tb(32,"mat-grid-tile"),tt.Tb(33,"b"),tt.Fc(34,"Nominaci\xf3n"),tt.Sb(),tt.Sb(),tt.Tb(35,"mat-grid-tile"),tt.Tb(36,"b"),tt.Fc(37,"Cantidad"),tt.Sb(),tt.Sb(),tt.Tb(38,"mat-grid-tile"),tt.Tb(39,"b"),tt.Fc(40,"Total"),tt.Sb(),tt.Sb(),tt.Ob(41,"mat-grid-tile"),tt.Sb(),tt.Dc(42,Fr,10,3,"mat-grid-list",12),tt.Ob(43,"hr"),tt.Tb(44,"div",13),tt.Dc(45,xr,3,0,"button",14),tt.Tb(46,"button",15),tt.Tb(47,"mat-icon"),tt.Fc(48,"save"),tt.Sb(),tt.Sb(),tt.Sb(),tt.Sb(),tt.Sb(),tt.Sb()}if(2&t){var n=tt.tc(6);tt.Cb(10),tt.lc("ngModel",e.ccorte.caja_corte_tipo),tt.Cb(1),tt.lc("ngForOf",e.ccorteTipo),tt.Cb(7),tt.lc("ngModel",e.detalle.caja_corte_nominacion),tt.Cb(1),tt.lc("ngForOf",e.ccorteNomi),tt.Cb(4),tt.lc("ngModel",e.detalle.cantidad),tt.Cb(4),tt.lc("ngModel",e.detalle.total),tt.Cb(15),tt.lc("ngForOf",e.ccorte.detalle),tt.Cb(3),tt.lc("ngIf",e.ccorte.caja_corte),tt.Cb(1),tt.lc("disabled",!n.form.valid)}},directives:[y.a,y.h,y.c,m.r,m.l,m.m,T.b,T.f,O.a,m.p,m.k,m.n,d.l,k.b,m.o,m.c,E.a,C.a,w.a,w.c,d.m,j.m,S.b],styles:[".example-container[_ngcontent-%COMP%]   .mat-form-field[_ngcontent-%COMP%] + .mat-form-field[_ngcontent-%COMP%]{margin-left:8px}mat-grid-tile[_ngcontent-%COMP%]{text-align:left}.anulacion[_ngcontent-%COMP%]{cursor:pointer}"]}),Or),Pr=["lstCortecaja"],_r=((Dr=function(){function t(){var e=this;c(this,t),this.editarCajaCorte=function(t){return e.ccorte=t},this.actualizaLista=function(){return e.lstCajacorteComponent.getCajascortes()},this.ccorte={caja_corte:0,creacion:null,usuario:0,turno:0,confirmado:null,anulado:0,caja_corte_tipo:0,descripcion:null,detalle:[]}}return s(t,[{key:"ngOnInit",value:function(){}}]),t}()).\u0275fac=function(t){return new(t||Dr)},Dr.\u0275cmp=tt.Hb({type:Dr,selectors:[["app-cajacorte"]],viewQuery:function(t,e){var a;1&t&&tt.Kc(Pr,1),2&t&&tt.sc(a=tt.cc())&&(e.lstCajacorteComponent=a.first)},decls:7,vars:1,consts:[[1,"row"],[1,"col","m5","s12"],[3,"getCajacorteEv"],["lstCortecaja",""],[1,"col","m7","s12"],[3,"ccorte","cajacorteSavedEv"],["frmCortecaja",""]],template:function(t,e){1&t&&(tt.Tb(0,"div",0),tt.Tb(1,"div",1),tt.Tb(2,"app-cajacorte-lista",2,3),tt.bc("getCajacorteEv",function(t){return e.editarCajaCorte(t)}),tt.Sb(),tt.Sb(),tt.Tb(4,"div",4),tt.Tb(5,"app-cajacorte-form",5,6),tt.bc("cajacorteSavedEv",function(){return e.actualizaLista()}),tt.Sb(),tt.Sb(),tt.Sb()),2&t&&(tt.Cb(5),tt.lc("ccorte",e.ccorte))},directives:[kr,Er],styles:[""]}),Dr),Ir=function(){return{standalone:!0}};function wr(t,e){if(1&t){var a=tt.Ub();tt.Tb(0,"form"),tt.Tb(1,"mat-form-field",6),tt.Tb(2,"input",7),tt.bc("ngModelChange",function(t){return tt.xc(a),tt.fc().datos.tiempo=t}),tt.Sb(),tt.Sb(),tt.Sb()}if(2&t){var n=tt.fc();tt.Cb(2),tt.lc("ngModel",n.datos.tiempo)("ngModelOptions",tt.nc(2,Ir))}}var Ar,Nr=function t(e,a,n,o,i,r){c(this,t),this.title=e,this.message=a,this.lblBtnConfirm=n,this.lblBtnDeny=o,this.datos=i,this.showTimer=r},Rr=((Ar=function(){function t(e,a){c(this,t),this.dialogRef=e,this.data=a,this.title=a.title,this.message=a.message,this.lblBtnConfirm=a.lblBtnConfirm,this.lblBtnDeny=a.lblBtnDeny,this.datos={respuesta:!1,tiempo:"00:00"}}return s(t,[{key:"ngOnInit",value:function(){}},{key:"onConfirm",value:function(t){this.datos.respuesta=!0,this.datos.tiempo=t.tiempo,this.dialogRef.close(this.datos)}},{key:"onDismiss",value:function(){this.datos.respuesta=!1,this.dialogRef.close(this.datos)}}]),t}()).\u0275fac=function(t){return new(t||Ar)(tt.Nb(N.f),tt.Nb(N.a))},Ar.\u0275cmp=tt.Hb({type:Ar,selectors:[["app-dialog-cocina"]],decls:11,vars:5,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[4,"ngIf"],["mat-dialog-actions","","align","center"],["mat-raised-button","",1,"btnConfig",3,"click"],["mat-raised-button","","color","accent",1,"btnConfig",3,"click"],[1,"fullWidth"],["type","number","matInput","","placeholder","Minutos","min","0","max","59","step","1",3,"ngModel","ngModelOptions","ngModelChange"]],template:function(t,e){1&t&&(tt.Tb(0,"h1",0),tt.Fc(1),tt.Sb(),tt.Tb(2,"div",1),tt.Tb(3,"p"),tt.Fc(4),tt.Sb(),tt.Sb(),tt.Dc(5,wr,3,3,"form",2),tt.Tb(6,"div",3),tt.Tb(7,"button",4),tt.bc("click",function(){return e.onDismiss()}),tt.Fc(8),tt.Sb(),tt.Tb(9,"button",5),tt.bc("click",function(){return e.onConfirm(e.datos)}),tt.Fc(10),tt.Sb(),tt.Sb()),2&t&&(tt.Cb(1),tt.Hc(" ",e.title," "),tt.Cb(3),tt.Gc(e.message),tt.Cb(1),tt.lc("ngIf",e.data.showTimer),tt.Cb(3),tt.Gc(e.lblBtnDeny),tt.Cb(2),tt.Gc(e.lblBtnConfirm))},directives:[N.g,N.d,d.m,N.c,E.a,m.r,m.l,m.m,T.b,m.o,k.b,m.c,m.k,m.n],styles:[""]}),Ar);function Ur(t,e){1&t&&tt.Ob(0,"br")}function jr(t,e){if(1&t&&(tt.Rb(0),tt.Tb(1,"span"),tt.Fc(2),tt.Sb(),tt.Ob(3,"br"),tt.Qb()),2&t){var a=e.$implicit;tt.Cb(2),tt.Gc(a.trim())}}function Br(t,e){1&t&&tt.Ob(0,"br")}function Hr(t,e){if(1&t&&(tt.Tb(0,"span"),tt.Tb(1,"strong"),tt.Fc(2,"Notas:"),tt.Sb(),tt.Fc(3),tt.Sb()),2&t){var a=tt.fc().$implicit;tt.Cb(3),tt.Hc(" ",a.notas," ")}}function Lr(t,e){if(1&t&&(tt.Tb(0,"tr"),tt.Tb(1,"td"),tt.Fc(2),tt.Dc(3,Ur,1,0,"br",11),tt.Dc(4,jr,4,1,"ng-container",8),tt.Dc(5,Br,1,0,"br",11),tt.Dc(6,Hr,4,1,"span",11),tt.Sb(),tt.Sb()),2&t){var a=e.$implicit;tt.Cb(2),tt.Ic(" ",a.cantidad," ",a.articulo.descripcion," "),tt.Cb(1),tt.lc("ngIf",a.detalle.length>0),tt.Cb(1),tt.lc("ngForOf",a.detalle),tt.Cb(1),tt.lc("ngIf",!!a.notas&&a.notas.length>0&&!a.detalle),tt.Cb(1),tt.lc("ngIf",!!a.notas&&a.notas.length>0)}}function qr(t,e){if(1&t&&(tt.Tb(0,"table"),tt.Dc(1,Lr,7,6,"tr",8),tt.Sb()),2&t){var a=tt.fc().$implicit;tt.Cb(1),tt.lc("ngForOf",a.productos)}}function $r(t,e){if(1&t&&(tt.Rb(0),tt.Dc(1,qr,2,1,"table",11),tt.Qb()),2&t){var a=e.$implicit;tt.Cb(1),tt.lc("ngIf",a.productos.length>0)}}function zr(t,e){if(1&t){var a=tt.Ub();tt.Tb(0,"div",6),tt.Tb(1,"mat-card",7),tt.Tb(2,"mat-card-header"),tt.Tb(3,"mat-card-title"),tt.Fc(4),tt.Sb(),tt.Tb(5,"mat-card-subtitle"),tt.Fc(6),tt.Ob(7,"br"),tt.Fc(8),tt.Sb(),tt.Sb(),tt.Tb(9,"mat-card-content"),tt.Dc(10,$r,2,1,"ng-container",8),tt.Sb(),tt.Tb(11,"mat-card-actions",9),tt.Tb(12,"button",10),tt.bc("click",function(){tt.xc(a);var t=e.$implicit;return tt.fc().setCocinado(t,1)}),tt.Fc(13,"Vista"),tt.Sb(),tt.Sb(),tt.Sb(),tt.Sb()}if(2&t){var n=e.$implicit;tt.Cb(4),tt.Ic("Comanda #",n.comanda," - ",n.numero,""),tt.Cb(2),tt.Ic(" Area ",n.mesa.area.nombre," - Mesa #",n.mesa.etiqueta||n.mesa.numero,""),tt.Cb(2),tt.Ic(" Atiende: ",n.mesero.nombres," ",n.mesero.apellidos," "),tt.Cb(2),tt.lc("ngForOf",n.cuentas)}}function Gr(t,e){1&t&&tt.Ob(0,"br")}function Wr(t,e){if(1&t&&(tt.Rb(0),tt.Tb(1,"span"),tt.Fc(2),tt.Sb(),tt.Ob(3,"br"),tt.Qb()),2&t){var a=e.$implicit;tt.Cb(2),tt.Gc(a.trim())}}function Vr(t,e){1&t&&tt.Ob(0,"br")}function Kr(t,e){if(1&t&&(tt.Tb(0,"span"),tt.Tb(1,"strong"),tt.Fc(2,"Notas:"),tt.Sb(),tt.Fc(3),tt.Sb()),2&t){var a=tt.fc().$implicit;tt.Cb(3),tt.Hc(" ",a.notas," ")}}function Jr(t,e){if(1&t&&(tt.Tb(0,"tr"),tt.Tb(1,"td"),tt.Fc(2),tt.Dc(3,Gr,1,0,"br",11),tt.Dc(4,Wr,4,1,"ng-container",8),tt.Dc(5,Vr,1,0,"br",11),tt.Dc(6,Kr,4,1,"span",11),tt.Sb(),tt.Sb()),2&t){var a=e.$implicit;tt.Cb(2),tt.Ic(" ",a.cantidad," ",a.articulo.descripcion," "),tt.Cb(1),tt.lc("ngIf",a.detalle.length>0),tt.Cb(1),tt.lc("ngForOf",a.detalle),tt.Cb(1),tt.lc("ngIf",!!a.notas&&a.notas.length>0&&!a.detalle),tt.Cb(1),tt.lc("ngIf",!!a.notas&&a.notas.length>0)}}function Qr(t,e){if(1&t&&(tt.Tb(0,"table"),tt.Dc(1,Jr,7,6,"tr",8),tt.Sb()),2&t){var a=tt.fc().$implicit;tt.Cb(1),tt.lc("ngForOf",a.productos)}}function Xr(t,e){if(1&t&&(tt.Rb(0),tt.Dc(1,Qr,2,1,"table",11),tt.Qb()),2&t){var a=e.$implicit;tt.Cb(1),tt.lc("ngIf",a.productos.length>0)}}var Yr=function(t){return{"text-danger":t}};function Zr(t,e){if(1&t){var a=tt.Ub();tt.Tb(0,"div",6),tt.Tb(1,"mat-card",7),tt.Tb(2,"mat-card-header"),tt.Tb(3,"mat-card-title"),tt.Fc(4),tt.Sb(),tt.Tb(5,"mat-card-subtitle"),tt.Fc(6),tt.Ob(7,"br"),tt.Fc(8),tt.Sb(),tt.Sb(),tt.Tb(9,"mat-card-content"),tt.Tb(10,"div",12),tt.Tb(11,"h6",13),tt.Fc(12),tt.gc(13,"date"),tt.Sb(),tt.Sb(),tt.Dc(14,Xr,2,1,"ng-container",8),tt.Sb(),tt.Tb(15,"mat-card-actions",9),tt.Tb(16,"button",10),tt.bc("click",function(){tt.xc(a);var t=e.$implicit;return tt.fc().setCocinado(t)}),tt.Fc(17,"Cocinado"),tt.Sb(),tt.Sb(),tt.Sb(),tt.Sb()}if(2&t){var n=e.$implicit,o=tt.fc();tt.Cb(4),tt.Ic("Comanda #",n.comanda," - ",n.numero,""),tt.Cb(2),tt.Ic(" Area ",n.mesa.area.nombre," - Mesa #",n.mesa.etiqueta||n.mesa.numero,""),tt.Cb(2),tt.Ic(" Atiende: ",n.mesero.nombres," ",n.mesero.apellidos," "),tt.Cb(3),tt.lc("ngClass",tt.oc(12,Yr,o.comparaFecha(n))),tt.Cb(1),tt.Hc(" ",tt.ic(13,9,n.tiempo_transcurrido,"HH:mm:ss")," "),tt.Cb(2),tt.lc("ngForOf",n.cuentas)}}var ts,es,as,ns=[{path:"mantareas",component:Wt,canActivate:[ot.a]},{path:"tranareas",component:uo,canActivate:[ot.a]},{path:"turno",component:ri,canActivate:[ot.a]},{path:"rptvtascat",component:Ni,canActivate:[ot.a]},{path:"rptturnos",component:Bi,canActivate:[ot.a]},{path:"rptpropinas",component:$i,canActivate:[ot.a]},{path:"rptcaja",component:Ac,canActivate:[ot.a]},{path:"rptfactura",component:Uc,canActivate:[ot.a]},{path:"cmdonline",component:kc,canActivate:[ot.a]},{path:"tipoturno",component:Kc,canActivate:[ot.a]},{path:"propina",component:sr,canActivate:[ot.a]},{path:"autoconsulta",component:gr,canActivate:[ot.a]},{path:"cajacorte",component:_r,canActivate:[ot.a]},{path:"trancocina",component:(ts=function(){function t(e,a,n,o,i,r){var s=this;c(this,t),this.ls=e,this.comandaSrvc=a,this.socket=n,this.dns=o,this.snackBar=i,this.dialog=r,this.lstComandasCocina=[],this.lstComandasCocinaEnProceso=[],this.notificarUsuario=function(){var t={icon:"assets/img/minilogo.png",body:"Se recibi\xf3 una nueva orden a las ".concat(Ee().format(it.b.dateTimeFormat),"."),dir:"auto"};s.dns.createNotification("Rest-Touch Pro",1e4,t)},this.loadComandasCocina=function(){return s.comandaSrvc.getComandasCocina().subscribe(function(t){s.lstComandasCocina=t.pendientes,s.lstComandasCocinaEnProceso=t.enproceso,s.setTiempo()})},this.setTiempo=function(){if(s.lstComandasCocinaEnProceso)for(var t=0;t<s.lstComandasCocinaEnProceso.length;t++){var e=s.lstComandasCocinaEnProceso[t],a=6e4,n=36e5,o=864e5,i=new Date(e.fecha_proceso);s.lstComandasCocinaEnProceso[t].inicio_proceso=i,e.inicio=i;var c=i.getTime(),r=(i=new Date).getTime()-c;r-=Math.floor(r/o)*o;var l=Math.floor(r/n);r-=l*n;var u=Math.floor(r/a);r-=u*a;var d=Math.floor(r/1e3),b=new Date;if(b.setHours(l),b.setMinutes(u),b.setSeconds(d),s.lstComandasCocinaEnProceso[t].tiempo_transcurrido=b,e.tiempo_preparacion){var m=e.tiempo_preparacion.split(":");e.inicio.setHours(e.inicio.getHours()+ +m[0]),e.inicio.setMinutes(e.inicio.getMinutes()+ +m[1]),s.lstComandasCocinaEnProceso[t].fin_proceso=e.inicio}else s.lstComandasCocinaEnProceso[t].fin_proceso=i}},this.comparaFecha=function(t){return new Date>t.fin_proceso},this.setCocinado=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;s.dialog.open(Rr,{maxWidth:"400px",data:new Nr("Cocina","\xbfSeguro de marcar como '".concat(1==+e?"vista":"cocinada","' la comanda #").concat(t.comanda,"?"),"S\xed","No",{respuesta:!1,tiempo:""},1==+e)}).afterClosed().subscribe(function(a){a&&a.respuesta&&a.tiempo&&s.comandaSrvc.setComandaCocinada(+t.comanda,{numero:+t.numero,estatus:e,tiempo:a.tiempo}).subscribe(function(t){t.exito?s.snackBar.open(t.mensaje,"Cocina",{duration:3e3}):s.snackBar.open("ERROR: ".concat(t.mensaje),"Cocina",{duration:7e3}),s.loadComandasCocina()})})}}return s(t,[{key:"ngOnInit",value:function(){var t=this;this.ls.get(it.b.usrTokenVar).sede_uuid&&(this.socket.emit("joinRestaurant",this.ls.get(it.b.usrTokenVar).sede_uuid),this.socket.on("refrescar:listaCocina",function(){t.loadComandasCocina(),t.notificarUsuario()}),setInterval(function(){t.setTiempo()},1e3)),this.loadComandasCocina()}}]),t}(),ts.\u0275fac=function(t){return new(t||ts)(tt.Nb(dt.a),tt.Nb(Se),tt.Nb(Ue.a),tt.Nb(Gi.a),tt.Nb(P.b),tt.Nb(N.b))},ts.\u0275cmp=tt.Hb({type:ts,selectors:[["app-tran-cocina"]],decls:13,vars:2,consts:[["fxLayout","row","fxLayout.xs","column","fxFlexFill",""],["fxFlex","50%","fxFlex.xs","100%",1,"bordeRght"],["fxLayout","row wrap","fxLayoutGap","10px grid","fxFlexFill","","fxLayoutAlign","start start",1,"divContenedor"],["fxFlex","100%","fxLayoutAlign","center start"],["fxFlex","33%","fxFlex.xs","100%","fxFlex.sm","100%","fxFlex.md","50%",4,"ngFor","ngForOf"],["fxFlex","50%","fxFlex.xs","100%",1,"bordeLft"],["fxFlex","33%","fxFlex.xs","100%","fxFlex.sm","100%","fxFlex.md","50%"],[1,"mat-elevation-z4"],[4,"ngFor","ngForOf"],["align","end"],["mat-raised-button","","color","accent","type","button",3,"click"],[4,"ngIf"],["align","center"],[3,"ngClass"]],template:function(t,e){1&t&&(tt.Tb(0,"div",0),tt.Tb(1,"div",1),tt.Tb(2,"div",2),tt.Tb(3,"div",3),tt.Tb(4,"h4"),tt.Fc(5,"Pendientes"),tt.Sb(),tt.Sb(),tt.Dc(6,zr,14,7,"div",4),tt.Sb(),tt.Sb(),tt.Tb(7,"div",5),tt.Tb(8,"div",2),tt.Tb(9,"div",3),tt.Tb(10,"h4"),tt.Fc(11,"En Proceso"),tt.Sb(),tt.Sb(),tt.Dc(12,Zr,18,14,"div",4),tt.Sb(),tt.Sb(),tt.Sb()),2&t&&(tt.Cb(6),tt.lc("ngForOf",e.lstComandasCocina),tt.Cb(6),tt.lc("ngForOf",e.lstComandasCocinaEnProceso))},directives:[ra.c,ra.e,ra.a,ra.d,ra.b,d.l,y.a,y.d,y.h,y.g,y.c,y.b,E.a,d.m,d.k,Ft.a],pipes:[d.e],styles:[".divContenedor[_ngcontent-%COMP%]{margin-left:5px!important}.bordeRght[_ngcontent-%COMP%]{border-right:1.5px solid #000}.bordeLft[_ngcontent-%COMP%]{border-left:1.5px solid #000}.text-danger[_ngcontent-%COMP%]{color:#dc143c}.item[_ngcontent-%COMP%]{display:block;height:auto;white-space:nowrap;word-wrap:break-word}"]}),ts),canActivate:[ot.a]},{path:"**",redirectTo:"/admin/dashboard",pathMatch:"full"}],os=((as=function t(){c(this,t)}).\u0275mod=tt.Lb({type:as}),as.\u0275inj=tt.Kb({factory:function(t){return new(t||as)},imports:[[nt.d.forChild(ns)],nt.d]}),as),is=((es=function t(){c(this,t)}).\u0275mod=tt.Lb({type:es}),es.\u0275inj=tt.Kb({factory:function(t){return new(t||es)},providers:[j.l],imports:[[d.c,os,b.c,m.e,at,f.a,p.WmsModule,g.PosModule,h.CallcenterModule,v.a,S.d,C.b,T.d,k.c,y.f,M.b,F.c,x.m,O.b,D.b,E.b,P.c,_.b,I.d,w.b,A.b,N.e,R.d,U.a,j.l,z.c,B.b,H.a,L.c,q.c,$.b]]}),es)}}])}();