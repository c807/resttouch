(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{"3e6T":function(t,e,o){"use strict";o.d(e,"a",function(){return d});var i=o("sKxO"),n=o("R5jZ"),a=o("un/a"),c=o("JIr8"),r=o("Qyje"),s=o("fXoL"),l=o("tk/3");let d=(()=>{class t{constructor(t){this.http=t,this.srvcErrHndl=new n.a}get(t={}){return this.http.get(`${i.b.urlCatalogos}/get_tipo_movimiento?${r.stringify(t)}`).pipe(Object(a.a)(i.b.reintentos),Object(c.a)(this.srvcErrHndl.errorHandler))}}return t.\u0275fac=function(e){return new(e||t)(s.Xb(l.b))},t.\u0275prov=s.Jb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},FHMA:function(t,e,o){"use strict";o.d(e,"a",function(){return d});var i=o("tk/3"),n=o("sKxO"),a=o("R5jZ"),c=o("un/a"),r=o("JIr8"),s=o("fXoL"),l=o("FY0D");let d=(()=>{class t{constructor(t,e){this.http=t,this.ls=e,this.usrToken=null,this.httpOptions={responseType:"blob"},this.srvcErrHndl=new a.a,this.usrToken=this.ls.get(n.b.usrTokenVar)?this.ls.get(n.b.usrTokenVar).token:null,this.httpOptions.headers=new i.d({Authorization:this.usrToken,Accept:"application/pdf"})}getReporteCaja(t){return this.http.post(`${n.b.urlAppRestaurante}/reporte/caja`,t,this.httpOptions).pipe(Object(c.a)(n.b.reintentos),Object(r.a)(this.srvcErrHndl.errorHandler))}getReporteExistencia(t){return this.http.post(`${n.b.urlWms}/reporte/existencia`,t,this.httpOptions).pipe(Object(c.a)(n.b.reintentos),Object(r.a)(this.srvcErrHndl.errorHandler))}getReporteValorizado(t){return this.http.post(`${n.b.urlWms}/reporte/valorizado`,t,this.httpOptions).pipe(Object(c.a)(n.b.reintentos),Object(r.a)(this.srvcErrHndl.errorHandler))}imprimirInventarioFisico(t,e){return this.httpOptions.params=e,this.http.get(`${n.b.urlWms}/fisico/imprimir/${t}`,this.httpOptions).pipe(Object(c.a)(n.b.reintentos),Object(r.a)(this.srvcErrHndl.errorHandler))}imprimirReceta(t){return this.http.get(`${n.b.urlMantenimientos}/articulo/imprimir_receta/${t}`,this.httpOptions).pipe(Object(c.a)(n.b.reintentos),Object(r.a)(this.srvcErrHndl.errorHandler))}getReporteKardex(t){return this.http.post(`${n.b.urlWms}/reporte/kardex`,t,this.httpOptions).pipe(Object(c.a)(n.b.reintentos),Object(r.a)(this.srvcErrHndl.errorHandler))}getReporteFactura(t){return this.httpOptions.params=t,this.http.get(`${n.b.urlAppRestaurante}/reporte/factura`,this.httpOptions).pipe(Object(c.a)(n.b.reintentos),Object(r.a)(this.srvcErrHndl.errorHandler))}getReportePropina(t){return this.httpOptions.params=t,this.http.get(`${n.b.urlAppRestaurante}/reporte/distribucion_propina`,this.httpOptions).pipe(Object(c.a)(n.b.reintentos),Object(r.a)(this.srvcErrHndl.errorHandler))}getComanda(t){return this.http.get(`${n.b.urlAppRestaurante}/comanda/imprimir/${t}/1`,this.httpOptions).pipe(Object(c.a)(n.b.reintentos),Object(r.a)(this.srvcErrHndl.errorHandler))}}return t.\u0275fac=function(e){return new(e||t)(s.Xb(i.b),s.Xb(l.a))},t.\u0275prov=s.Jb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},TOq3:function(t,e,o){"use strict";o.d(e,"a",function(){return n});var i=o("fXoL");let n=(()=>{class t{constructor(){this.configuracion={w:150,h:150,align:"center",size:100}}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=i.Hb({type:t,selectors:[["app-cargando"]],inputs:{configuracion:"configuracion"},decls:2,vars:7,consts:[[3,"align"],["id","imgCargando","src","/assets/img/loading.gif","alt","Cargando..."]],template:function(t,e){1&t&&(i.Tb(0,"div",0),i.Ob(1,"img",1),i.Sb()),2&t&&(i.Ac("width",e.configuracion.size,"%"),i.lc("align",e.configuracion.align),i.Cb(1),i.Ac("width",e.configuracion.w,"px")("height",e.configuracion.h,"px"))},styles:[""]}),t})()},vtFA:function(t,e,o){"use strict";o.r(e),o.d(e,"WmsModule",function(){return pa});var i=o("ofXK"),n=o("tk/3"),a=o("3Pt+"),c=o("YUcS"),r=o("PCNd"),s=o("MutI"),l=o("NFeN"),d=o("kmnG"),b=o("qFsG"),u=o("Wp6s"),g=o("f0Cb"),m=o("wZkO"),p=o("+0xr"),f=o("d3UM"),h=o("bSwM"),S=o("bTqV"),v=o("dNgK"),C=o("/t3+"),T=o("STbY"),M=o("zkoq"),D=o("M9IT"),I=o("0IaG"),F=o("XhcP"),x=o("8yBR"),_=o("/1cH"),O=o("A5z7"),y=o("uM5D"),k=o("tyNb"),E=o("0T/Q"),w=o("sKxO"),A=o("wd/R"),B=o("fXoL"),$=o("FY0D"),R=o("R5jZ"),H=o("un/a"),P=o("JIr8"),N=o("Qyje");let U=(()=>{class t{constructor(t){this.http=t,this.ingresoUrl="ingreso",this.documentoUrl="documento",this.srvcErrHndl=new R.a}get(t={}){return this.http.get(`${w.b.urlWms}/${this.ingresoUrl}/buscar_ingreso?${N.stringify(t)}`).pipe(Object(H.a)(w.b.reintentos),Object(P.a)(this.srvcErrHndl.errorHandler))}save(t){return this.http.post(`${w.b.urlWms}/${this.ingresoUrl}/guardar${+t.ingreso>0?"/"+t.ingreso:""}`,t).pipe(Object(H.a)(w.b.reintentos),Object(P.a)(this.srvcErrHndl.errorHandler))}getDetalle(t,e={}){return this.http.get(`${w.b.urlWms}/${this.ingresoUrl}/buscar_detalle/${t}?${N.stringify(e)}`).pipe(Object(H.a)(w.b.reintentos),Object(P.a)(this.srvcErrHndl.errorHandler))}saveDetalle(t){return this.http.post(`${w.b.urlWms}/${this.ingresoUrl}/guardar_detalle/${t.ingreso}${+t.ingreso_detalle>0?"/"+t.ingreso_detalle:""}`,t).pipe(Object(H.a)(w.b.reintentos),Object(P.a)(this.srvcErrHndl.errorHandler))}getDocumento(t={}){return this.http.get(`${w.b.urlWms}/${this.documentoUrl}/buscar?${N.stringify(t)}`).pipe(Object(H.a)(w.b.reintentos),Object(P.a)(this.srvcErrHndl.errorHandler))}saveDocumento(t){return this.http.post(`${w.b.urlWms}/${this.documentoUrl}/guardar${+t.documento>0?"/"+t.documento:""}`,t).pipe(Object(H.a)(w.b.reintentos),Object(P.a)(this.srvcErrHndl.errorHandler))}enviarDocumentoAConta(t){return this.http.get(`${w.b.urlWms}/${this.documentoUrl}/enviar/${t}`).pipe(Object(H.a)(w.b.reintentos),Object(P.a)(this.srvcErrHndl.errorHandler))}}return t.\u0275fac=function(e){return new(e||t)(B.Xb(n.b))},t.\u0275prov=B.Jb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var G=o("FKr1");function z(t,e){if(1&t){const t=B.Ub();B.Tb(0,"mat-list-item",8),B.bc("click",function(){B.xc(t);const o=e.$implicit;return B.fc().getIngreso(o)}),B.Tb(1,"mat-icon",9),B.Fc(2,"trending_up"),B.Sb(),B.Tb(3,"h5",10),B.Fc(4),B.Sb(),B.Ob(5,"br"),B.Tb(6,"p",10),B.Fc(7),B.gc(8,"date"),B.Ob(9,"br"),B.Fc(10),B.Ob(11,"br"),B.Sb(),B.Tb(12,"p",10),B.Fc(13),B.Sb(),B.Sb()}if(2&t){const t=e.$implicit;B.Cb(4),B.Hc("No. ",t.ingreso,""),B.Cb(3),B.Hc(" Fecha: ",B.ic(8,4,t.fecha,"dd/MM/yyyy"),""),B.Cb(3),B.Hc(" Bodega: ",t.bodega.descripcion,""),B.Cb(3),B.Hc(" Proveedor: ",t.proveedor.razon_social," ")}}const q=function(){return{standalone:!0}};let j=(()=>{class t{constructor(t){this.ingresoSrvc=t,this.getIngresoEv=new B.o,this.length=0,this.pageSize=5,this.pageSizeOptions=[5,10,15],this.pageIndex=0,this.txtFiltro="",this.params={_fdel:A().startOf("month").format(w.b.dbDateFormat),_fal:A().endOf("month").format(w.b.dbDateFormat)},this.loadIngresos=()=>{this.ingresoSrvc.get(this.params).subscribe(t=>{t&&(this.lstIngresos=t,this.applyFilter())})},this.getIngreso=t=>{this.getIngresoEv.emit({ingreso:t.ingreso,tipo_movimiento:t.tipo_movimiento.tipo_movimiento,fecha:t.fecha,bodega_origen:t.bodega_origen&&t.bodega_origen.bodega?t.bodega_origen.bodega:null,bodega:t.bodega.bodega,usuario:t.usuario.usuario,comentario:t.comentario,proveedor:t.proveedor.proveedor})},this.pageChange=t=>{this.pageSize=t.pageSize,this.pageIndex=t.pageIndex,this.applyFilter()}}ngOnInit(){this.loadIngresos()}applyFilter(){if(this.txtFiltro.length>0){const t=Object(w.c)(this.lstIngresos,this.txtFiltro);this.length=t.length,this.lstIngresosPaged=Object(w.f)(t,this.pageSize,this.pageIndex+1)}else this.length=this.lstIngresos.length,this.lstIngresosPaged=Object(w.f)(this.lstIngresos,this.pageSize,this.pageIndex+1)}}return t.\u0275fac=function(e){return new(e||t)(B.Nb(U))},t.\u0275cmp=B.Hb({type:t,selectors:[["app-lista-ingreso"]],outputs:{getIngresoEv:"getIngresoEv"},decls:13,vars:13,consts:[[1,"mat-elevation-z4","fullWidth",2,"height","100% important"],[1,"fullWidth"],["matInput","","type","date","placeholder","Del",3,"ngModel","ngModelOptions","ngModelChange"],["matInput","","type","date","placeholder","Al",3,"ngModel","ngModelOptions","ngModelChange"],["mat-raised-button","","type","button","color","accent",3,"click"],["matInput","","placeholder","Buscar...",3,"ngModel","ngModelOptions","keyup","ngModelChange"],[3,"click",4,"ngFor","ngForOf"],["showFirstLastButtons","",3,"length","pageSize","pageSizeOptions","page"],[3,"click"],["mat-list-icon",""],["mat-line",""]],template:function(t,e){1&t&&(B.Tb(0,"mat-card",0),B.Tb(1,"mat-card-content"),B.Tb(2,"mat-form-field",1),B.Tb(3,"input",2),B.bc("ngModelChange",function(t){return e.params._fdel=t}),B.Sb(),B.Sb(),B.Tb(4,"mat-form-field",1),B.Tb(5,"input",3),B.bc("ngModelChange",function(t){return e.params._fal=t}),B.Sb(),B.Sb(),B.Tb(6,"button",4),B.bc("click",function(){return e.loadIngresos()}),B.Fc(7," Buscar "),B.Sb(),B.Tb(8,"mat-form-field",1),B.Tb(9,"input",5),B.bc("keyup",function(){return e.applyFilter()})("ngModelChange",function(t){return e.txtFiltro=t}),B.Sb(),B.Sb(),B.Tb(10,"mat-nav-list"),B.Dc(11,z,14,7,"mat-list-item",6),B.Sb(),B.Tb(12,"mat-paginator",7),B.bc("page",function(t){return e.pageChange(t)}),B.Sb(),B.Sb(),B.Sb()),2&t&&(B.Cb(3),B.lc("ngModel",e.params._fdel)("ngModelOptions",B.nc(10,q)),B.Cb(2),B.lc("ngModel",e.params._fal)("ngModelOptions",B.nc(11,q)),B.Cb(4),B.lc("ngModel",e.txtFiltro)("ngModelOptions",B.nc(12,q)),B.Cb(2),B.lc("ngForOf",e.lstIngresosPaged),B.Cb(1),B.lc("length",e.length)("pageSize",e.pageSize)("pageSizeOptions",e.pageSizeOptions))},directives:[u.a,u.c,d.b,b.b,a.c,a.k,a.n,S.a,s.e,i.l,D.a,s.c,l.a,s.b,G.j],pipes:[i.e],styles:[".fullWidth[_ngcontent-%COMP%], table[_ngcontent-%COMP%]{width:100%!important}"]}),t})();var W=o("IJgu"),L=o("50cD"),V=o("3e6T"),K=o("u5dX"),Q=o("NGYs"),J=o("C5NV"),X=o("yZ4O"),Y=o("DVqU");function Z(t,e){if(1&t){const t=B.Ub();B.Tb(0,"button",7),B.bc("click",function(){return B.xc(t),B.fc().showIngresoForm=!0}),B.Tb(1,"mat-icon",8),B.Fc(2,"expand_more"),B.Sb(),B.Sb()}}function tt(t,e){if(1&t){const t=B.Ub();B.Tb(0,"button",7),B.bc("click",function(){return B.xc(t),B.fc().showIngresoForm=!1}),B.Tb(1,"mat-icon",8),B.Fc(2,"expand_less"),B.Sb(),B.Sb()}}function et(t,e){if(1&t&&(B.Tb(0,"mat-option",20),B.Fc(1),B.Sb()),2&t){const t=e.$implicit;B.lc("value",t.tipo_movimiento),B.Cb(1),B.Hc(" ",t.descripcion," ")}}function ot(t,e){if(1&t){const t=B.Ub();B.Tb(0,"mat-form-field",12),B.Tb(1,"mat-label"),B.Fc(2,"Tipo de movimiento"),B.Sb(),B.Tb(3,"mat-select",18),B.bc("ngModelChange",function(e){return B.xc(t),B.fc(2).ingreso.tipo_movimiento=e}),B.Dc(4,et,2,2,"mat-option",19),B.Sb(),B.Sb()}if(2&t){const t=B.fc(2);B.Cb(3),B.lc("ngModel",t.ingreso.tipo_movimiento),B.Cb(1),B.lc("ngForOf",t.tiposMovimiento)}}function it(t,e){if(1&t&&(B.Tb(0,"mat-option",20),B.Fc(1),B.Sb()),2&t){const t=e.$implicit;B.lc("value",t.bodega),B.Cb(1),B.Hc(" ",t.descripcion," ")}}function nt(t,e){if(1&t){const t=B.Ub();B.Tb(0,"mat-form-field",12),B.Tb(1,"mat-label"),B.Fc(2,"Bodega"),B.Sb(),B.Tb(3,"mat-select",21),B.bc("ngModelChange",function(e){return B.xc(t),B.fc(2).ingreso.bodega=e}),B.Dc(4,it,2,2,"mat-option",19),B.Sb(),B.Sb()}if(2&t){const t=B.fc(2);B.Cb(3),B.lc("ngModel",t.ingreso.bodega),B.Cb(1),B.lc("ngForOf",t.bodegas)}}function at(t,e){if(1&t&&(B.Tb(0,"mat-option",20),B.Fc(1),B.Sb()),2&t){const t=e.$implicit;B.lc("value",t.bodega),B.Cb(1),B.Hc(" ",t.descripcion," ")}}function ct(t,e){if(1&t){const t=B.Ub();B.Tb(0,"button",24),B.bc("click",function(){return B.xc(t),B.fc(3).ingreso.bodega_origen=void 0}),B.Tb(1,"mat-icon",8),B.Fc(2,"close"),B.Sb(),B.Sb()}}function rt(t,e){if(1&t){const t=B.Ub();B.Tb(0,"mat-form-field",12),B.Tb(1,"mat-label"),B.Fc(2,"Bodega de origen"),B.Sb(),B.Tb(3,"mat-select",22),B.bc("ngModelChange",function(e){return B.xc(t),B.fc(2).ingreso.bodega_origen=e}),B.Dc(4,at,2,2,"mat-option",19),B.Sb(),B.Dc(5,ct,3,0,"button",23),B.Sb()}if(2&t){const t=B.fc(2);B.Cb(3),B.lc("ngModel",t.ingreso.bodega_origen),B.Cb(1),B.lc("ngForOf",t.bodegas),B.Cb(1),B.lc("ngIf",t.ingreso.bodega_origen)}}function st(t,e){if(1&t&&(B.Tb(0,"mat-option",20),B.Fc(1),B.Sb()),2&t){const t=e.$implicit;B.lc("value",t),B.Cb(1),B.Ic(" (",t.nit,") ",t.razon_social," ")}}const lt=function(){return{standalone:!0}};function dt(t,e){if(1&t){const t=B.Ub();B.Tb(0,"mat-form-field",12),B.Tb(1,"mat-label"),B.Fc(2,"Proveedor"),B.Sb(),B.Tb(3,"input",25),B.bc("ngModelChange",function(e){return B.xc(t),B.fc(2).txtProveedorSelected=e})("keyup",function(){B.xc(t);const e=B.fc(2);return e.filtrarProveedores(e.txtProveedorSelected)}),B.Sb(),B.Tb(4,"mat-autocomplete",26,27),B.Dc(6,st,2,3,"mat-option",19),B.Sb(),B.Sb()}if(2&t){const t=B.tc(5),e=B.fc(2);B.Cb(3),B.lc("ngModel",e.txtProveedorSelected)("ngModelOptions",B.nc(5,lt))("matAutocomplete",t),B.Cb(1),B.lc("displayWith",e.displayProveedor),B.Cb(2),B.lc("ngForOf",e.filteredProveedores)}}function bt(t,e){if(1&t&&(B.Tb(0,"button",28),B.Fc(1," Guardar "),B.Sb()),2&t){B.fc();const t=B.tc(1),e=B.fc();B.lc("disabled",!t.form.valid||e.bloqueoBotones||1==+e.documento.enviado)}}function ut(t,e){if(1&t){const t=B.Ub();B.Tb(0,"button",29),B.bc("click",function(){return B.xc(t),B.fc(2).resetIngreso()}),B.Fc(1," Nuevo "),B.Sb()}}function gt(t,e){if(1&t){const t=B.Ub();B.Tb(0,"form",9,10),B.bc("ngSubmit",function(){B.xc(t);const e=B.tc(1),o=B.fc();return e.form.valid&&o.onSubmit()}),B.Dc(2,ot,5,2,"mat-form-field",11),B.Tb(3,"mat-form-field",12),B.Tb(4,"input",13),B.bc("ngModelChange",function(e){return B.xc(t),B.fc().ingreso.fecha=e}),B.Sb(),B.Sb(),B.Dc(5,nt,5,2,"mat-form-field",11),B.Dc(6,rt,6,3,"mat-form-field",11),B.Dc(7,dt,7,6,"mat-form-field",11),B.Tb(8,"mat-form-field",12),B.Tb(9,"input",14),B.bc("ngModelChange",function(e){return B.xc(t),B.fc().ingreso.comentario=e}),B.Sb(),B.Sb(),B.Tb(10,"div",15),B.Dc(11,bt,2,1,"button",16),B.Dc(12,ut,2,0,"button",17),B.Sb(),B.Sb()}if(2&t){const t=B.fc();B.Cb(2),B.lc("ngIf",t.saveToDB),B.Cb(2),B.lc("ngModel",t.ingreso.fecha),B.Cb(1),B.lc("ngIf",t.bodega),B.Cb(1),B.lc("ngIf",t.saveToDB),B.Cb(1),B.lc("ngIf",t.saveToDB),B.Cb(2),B.lc("ngModel",t.ingreso.comentario),B.Cb(2),B.lc("ngIf",t.saveToDB),B.Cb(1),B.lc("ngIf",t.ingreso.ingreso)}}function mt(t,e){1&t&&B.Ob(0,"hr")}function pt(t,e){if(1&t){const t=B.Ub();B.Tb(0,"button",7),B.bc("click",function(){return B.xc(t),B.fc(2).showDetalleIngresoForm=!0}),B.Tb(1,"mat-icon",8),B.Fc(2,"expand_more"),B.Sb(),B.Sb()}}function ft(t,e){if(1&t){const t=B.Ub();B.Tb(0,"button",7),B.bc("click",function(){return B.xc(t),B.fc(2).showDetalleIngresoForm=!1}),B.Tb(1,"mat-icon",8),B.Fc(2,"expand_less"),B.Sb(),B.Sb()}}function ht(t,e){if(1&t&&(B.Tb(0,"mat-option",20),B.Fc(1),B.Sb()),2&t){const t=e.$implicit;B.lc("value",t),B.Cb(1),B.Hc(" ",t.descripcion," ")}}function St(t,e){if(1&t&&(B.Tb(0,"mat-option",20),B.Fc(1),B.Sb()),2&t){const t=e.$implicit;B.lc("value",t.presentacion),B.Cb(1),B.Hc(" ",t.descripcion," ")}}function vt(t,e){if(1&t){const t=B.Ub();B.Tb(0,"mat-form-field",12),B.Tb(1,"mat-label"),B.Fc(2,"Presentaci\xf3n"),B.Sb(),B.Tb(3,"mat-select",38),B.bc("ngModelChange",function(e){return B.xc(t),B.fc(3).detalleIngreso.presentacion=e}),B.Dc(4,St,2,2,"mat-option",19),B.Sb(),B.Sb()}if(2&t){const t=B.fc(3);B.Cb(3),B.lc("ngModel",t.detalleIngreso.presentacion),B.Cb(1),B.lc("ngForOf",t.fltrPresentaciones)}}function Ct(t,e){if(1&t){const t=B.Ub();B.Tb(0,"mat-form-field",12),B.Tb(1,"input",39),B.bc("ngModelChange",function(e){return B.xc(t),B.fc(3).detalleIngreso.cantidad_utilizada=e}),B.Sb(),B.Sb()}if(2&t){const t=B.fc(3);B.Cb(1),B.lc("ngModel",t.detalleIngreso.cantidad_utilizada)}}function Tt(t,e){if(1&t){const t=B.Ub();B.Tb(0,"mat-form-field",12),B.Tb(1,"input",40),B.bc("ngModelChange",function(e){return B.xc(t),B.fc(3).detalleIngreso.precio_unitario=e})("change",function(){B.xc(t);const e=B.fc(3);return e.detalleIngreso.precio_total=+e.detalleIngreso.precio_unitario*+e.detalleIngreso.cantidad}),B.Sb(),B.Sb()}if(2&t){const t=B.fc(3);B.Cb(1),B.lc("ngModel",t.detalleIngreso.precio_unitario)}}function Mt(t,e){if(1&t&&(B.Tb(0,"button",28),B.Fc(1," Guardar "),B.Sb()),2&t){B.fc();const t=B.tc(1),e=B.fc(2);B.lc("disabled",!t.form.valid||e.bloqueoBotones||1==+e.documento.enviado||+e.detalleIngreso.cantidad<1)}}const Dt=function(){return[2,3]};function It(t,e){if(1&t){const t=B.Ub();B.Tb(0,"button",41),B.bc("click",function(){return B.xc(t),B.fc(3).addToDetail()}),B.Fc(1," Guardar producci\xf3n "),B.Sb()}if(2&t){B.fc();const t=B.tc(1),e=B.fc(2);B.lc("disabled",!e.detalleIngreso.articulo||!t.form.valid||B.nc(1,Dt).indexOf(+e.ingreso.estatus_movimiento)>=0||+e.detalleIngreso.cantidad<1)}}function Ft(t,e){if(1&t){const t=B.Ub();B.Tb(0,"button",29),B.bc("click",function(){return B.xc(t),B.fc(3).resetDetalleIngreso()}),B.Fc(1," Nuevo "),B.Sb()}}function xt(t,e){if(1&t){const t=B.Ub();B.Tb(0,"form",9,32),B.bc("ngSubmit",function(){B.xc(t);const e=B.tc(1),o=B.fc(2);return e.form.valid&&o.onSubmitDetail()}),B.Tb(2,"mat-form-field",12),B.Tb(3,"mat-label"),B.Fc(4,"Art\xedculo"),B.Sb(),B.Tb(5,"input",33),B.bc("ngModelChange",function(e){return B.xc(t),B.fc(2).txtArticuloSelected=e})("keyup",function(){B.xc(t);const e=B.fc(2);return e.filtrarArticulos(e.txtArticuloSelected)}),B.Sb(),B.Tb(6,"mat-autocomplete",34,35),B.bc("optionSelected",function(){return B.xc(t),B.fc(2).setPresentaciones()}),B.Dc(8,ht,2,2,"mat-option",19),B.Sb(),B.Sb(),B.Dc(9,vt,5,2,"mat-form-field",11),B.Dc(10,Ct,2,1,"mat-form-field",11),B.Tb(11,"mat-form-field",12),B.Tb(12,"input",36),B.bc("ngModelChange",function(e){return B.xc(t),B.fc(2).detalleIngreso.cantidad=e})("change",function(){B.xc(t);const e=B.fc(2);return e.detalleIngreso.precio_total=+e.detalleIngreso.precio_unitario*+e.detalleIngreso.cantidad}),B.Sb(),B.Sb(),B.Dc(13,Tt,2,1,"mat-form-field",11),B.Tb(14,"div",15),B.Dc(15,Mt,2,1,"button",16),B.Dc(16,It,2,2,"button",37),B.Dc(17,Ft,2,0,"button",17),B.Sb(),B.Sb()}if(2&t){const t=B.tc(7),e=B.fc(2);B.Cb(5),B.lc("ngModel",e.txtArticuloSelected)("ngModelOptions",B.nc(12,lt))("matAutocomplete",t),B.Cb(1),B.lc("displayWith",e.displayArticulo),B.Cb(2),B.lc("ngForOf",e.filteredArticulos),B.Cb(1),B.lc("ngIf",e.saveToDB),B.Cb(1),B.lc("ngIf",!e.bodega),B.Cb(2),B.lc("ngModel",e.detalleIngreso.cantidad),B.Cb(1),B.lc("ngIf",e.saveToDB),B.Cb(2),B.lc("ngIf",e.saveToDB),B.Cb(1),B.lc("ngIf",!e.saveToDB),B.Cb(1),B.lc("ngIf",e.detalleIngreso.ingreso_detalle)}}function _t(t,e){1&t&&B.Ob(0,"hr")}function Ot(t,e){1&t&&(B.Tb(0,"th",56),B.Fc(1,"Art\xedculo"),B.Sb())}function yt(t,e){if(1&t&&(B.Tb(0,"td",57),B.Fc(1),B.Sb()),2&t){const t=e.$implicit,o=B.fc(3);B.Cb(1),B.Hc(" ",o.saveToDB?t.articulo.descripcion:o.getDescripcionArticulo(t.articulo),"")}}function kt(t,e){1&t&&(B.Tb(0,"th",56),B.Fc(1,"Presentaci\xf3n"),B.Sb())}function Et(t,e){if(1&t&&(B.Tb(0,"td",57),B.Fc(1),B.Sb()),2&t){const t=e.$implicit,o=B.fc(3);B.Cb(1),B.Hc(" ",o.saveToDB?t.presentacion.descripcion:o.getDescripcionPresentacion(t.presentacion)," ")}}function wt(t,e){1&t&&(B.Tb(0,"th",58),B.Fc(1,"Cantidad a Utilizar"),B.Sb())}function At(t,e){if(1&t&&(B.Tb(0,"td",59),B.Fc(1),B.gc(2,"number"),B.Sb()),2&t){const t=e.$implicit;B.Cb(1),B.Hc("",B.ic(2,1,t.cantidad_utilizada,"1.2-2")," ")}}function Bt(t,e){1&t&&(B.Tb(0,"th",58),B.Fc(1,"Cantidad"),B.Sb())}function $t(t,e){if(1&t&&(B.Tb(0,"td",59),B.Fc(1),B.gc(2,"number"),B.Sb()),2&t){const t=e.$implicit;B.Cb(1),B.Hc("",B.ic(2,1,t.cantidad,"1.2-2")," ")}}function Rt(t,e){1&t&&(B.Tb(0,"th",58),B.Fc(1,"Costo Unitario Con IVA"),B.Sb())}function Ht(t,e){if(1&t&&(B.Tb(0,"td",59),B.Fc(1),B.gc(2,"number"),B.Sb()),2&t){const t=e.$implicit;B.Cb(1),B.Hc("",B.ic(2,1,t.precio_unitario,"1.2-2")," ")}}function Pt(t,e){1&t&&(B.Tb(0,"th",58),B.Fc(1,"Costo Total con IVA"),B.Sb())}function Nt(t,e){if(1&t&&(B.Tb(0,"td",59),B.Fc(1),B.gc(2,"number"),B.Sb()),2&t){const t=e.$implicit;B.Cb(1),B.Gc(B.ic(2,1,t.precio_total,"1.2-2"))}}function Ut(t,e){1&t&&(B.Tb(0,"th",56),B.Fc(1,"\xa0"),B.Sb())}function Gt(t,e){if(1&t){const t=B.Ub();B.Tb(0,"button",41),B.bc("click",function(){B.xc(t);const e=B.fc().$implicit;return B.fc(3).getDetalleIngreso(e.ingreso,e.ingreso_detalle)}),B.Fc(1," Editar "),B.Sb()}if(2&t){const t=B.fc(4);B.lc("disabled",t.bloqueoBotones||1==+t.documento.enviado)}}function zt(t,e){if(1&t){const t=B.Ub();B.Tb(0,"button",41),B.bc("click",function(){B.xc(t);const e=B.fc().$implicit;return B.fc(3).editFromDetail(e.articulo)}),B.Fc(1," Editar "),B.Sb()}if(2&t){const t=B.fc(4);B.lc("disabled",B.nc(1,Dt).indexOf(+t.ingreso.estatus_movimiento)>=0||t.bloqueoBotones)}}function qt(t,e){if(1&t){const t=B.Ub();B.Tb(0,"button",41),B.bc("click",function(){B.xc(t);const e=B.fc().$implicit;return B.fc(3).removeFromDetail(e.articulo)}),B.Fc(1," Eliminar "),B.Sb()}if(2&t){const t=B.fc(4);B.lc("disabled",B.nc(1,Dt).indexOf(+t.ingreso.estatus_movimiento)>=0||t.bloqueoBotones)}}function jt(t,e){if(1&t&&(B.Tb(0,"td",57),B.Dc(1,Gt,2,1,"button",37),B.Dc(2,zt,2,2,"button",37),B.Dc(3,qt,2,2,"button",37),B.Sb()),2&t){const t=B.fc(3);B.Cb(1),B.lc("ngIf",t.saveToDB),B.Cb(1),B.lc("ngIf",!t.saveToDB),B.Cb(1),B.lc("ngIf",!t.saveToDB)}}function Wt(t,e){1&t&&B.Ob(0,"td",57)}function Lt(t,e){1&t&&B.Ob(0,"tr",60)}function Vt(t,e){1&t&&B.Ob(0,"tr",61)}function Kt(t,e){if(1&t&&(B.Tb(0,"table",42),B.Rb(1,43),B.Dc(2,Ot,2,0,"th",44),B.Dc(3,yt,2,1,"td",45),B.Qb(),B.Rb(4,46),B.Dc(5,kt,2,0,"th",44),B.Dc(6,Et,2,1,"td",45),B.Qb(),B.Rb(7,47),B.Dc(8,wt,2,0,"th",48),B.Dc(9,At,3,4,"td",49),B.Qb(),B.Rb(10,50),B.Dc(11,Bt,2,0,"th",48),B.Dc(12,$t,3,4,"td",49),B.Qb(),B.Rb(13,51),B.Dc(14,Rt,2,0,"th",48),B.Dc(15,Ht,3,4,"td",49),B.Qb(),B.Rb(16,52),B.Dc(17,Pt,2,0,"th",48),B.Dc(18,Nt,3,4,"td",49),B.Qb(),B.Rb(19,53),B.Dc(20,Ut,2,0,"th",44),B.Dc(21,jt,4,3,"td",45),B.Dc(22,Wt,1,0,"td",45),B.Qb(),B.Dc(23,Lt,1,0,"tr",54),B.Dc(24,Vt,1,0,"tr",55),B.Sb()),2&t){const t=B.fc(2);B.lc("dataSource",t.dataSource),B.Cb(23),B.lc("matHeaderRowDef",t.displayedColumns),B.Cb(1),B.lc("matRowDefColumns",t.displayedColumns)}}function Qt(t,e){if(1&t){const t=B.Ub();B.Tb(0,"mat-card",1),B.Tb(1,"mat-card-title"),B.Tb(2,"h4"),B.Fc(3),B.Dc(4,pt,3,0,"button",2),B.Dc(5,ft,3,0,"button",2),B.Sb(),B.Sb(),B.Tb(6,"mat-card-content"),B.Dc(7,xt,18,13,"form",3),B.Dc(8,_t,1,0,"hr",4),B.Tb(9,"mat-form-field",12),B.Tb(10,"input",30),B.bc("keyup",function(e){return B.xc(t),B.fc().applyFilter(e.target.value)}),B.Sb(),B.Sb(),B.Dc(11,Kt,25,3,"table",31),B.Sb(),B.Sb()}if(2&t){const t=B.fc();B.Cb(3),B.Ic(" Detalle del ingreso ",t.saveToDB?"No.":""," ",t.ingreso.ingreso," "),B.Cb(1),B.lc("ngIf",!t.showDetalleIngresoForm),B.Cb(1),B.lc("ngIf",t.showDetalleIngresoForm),B.Cb(2),B.lc("ngIf",t.showDetalleIngresoForm),B.Cb(1),B.lc("ngIf",t.detallesIngreso.length>0),B.Cb(3),B.lc("ngIf",t.detallesIngreso.length>0)}}function Jt(t,e){if(1&t){const t=B.Ub();B.Tb(0,"button",7),B.bc("click",function(){return B.xc(t),B.fc(2).showDocumentoForm=!0}),B.Tb(1,"mat-icon",8),B.Fc(2,"expand_more"),B.Sb(),B.Sb()}}function Xt(t,e){if(1&t){const t=B.Ub();B.Tb(0,"button",7),B.bc("click",function(){return B.xc(t),B.fc(2).showDocumentoForm=!1}),B.Tb(1,"mat-icon",8),B.Fc(2,"expand_less"),B.Sb(),B.Sb()}}function Yt(t,e){if(1&t&&(B.Tb(0,"mat-option",20),B.Fc(1),B.Sb()),2&t){const t=e.$implicit;B.lc("value",t.documento_tipo),B.Cb(1),B.Hc(" ",t.descripcion," ")}}function Zt(t,e){if(1&t){const t=B.Ub();B.Tb(0,"mat-form-field",12),B.Tb(1,"mat-label"),B.Fc(2,"Tipo de documento"),B.Sb(),B.Tb(3,"mat-select",68),B.bc("ngModelChange",function(e){return B.xc(t),B.fc(3).documento.documento_tipo=e}),B.Dc(4,Yt,2,2,"mat-option",19),B.Sb(),B.Sb()}if(2&t){const t=B.fc(3);B.Cb(3),B.lc("ngModel",t.documento.documento_tipo)("disabled",1==+t.documento.enviado),B.Cb(1),B.lc("ngForOf",t.documentosTipo)}}function te(t,e){if(1&t&&(B.Tb(0,"mat-option",20),B.Fc(1),B.Sb()),2&t){const t=e.$implicit;B.lc("value",t.tipo_compra_venta),B.Cb(1),B.Hc(" ",t.descripcion," ")}}function ee(t,e){if(1&t){const t=B.Ub();B.Tb(0,"mat-form-field",12),B.Tb(1,"mat-label"),B.Fc(2,"Tipo de compra"),B.Sb(),B.Tb(3,"mat-select",69),B.bc("ngModelChange",function(e){return B.xc(t),B.fc(3).documento.tipo_compra_venta=e}),B.Dc(4,te,2,2,"mat-option",19),B.Sb(),B.Sb()}if(2&t){const t=B.fc(3);B.Cb(3),B.lc("ngModel",t.documento.tipo_compra_venta)("disabled",1==+t.documento.enviado),B.Cb(1),B.lc("ngForOf",t.tiposCompraVenta)}}function oe(t,e){if(1&t&&(B.Tb(0,"button",28),B.Fc(1," Guardar detalle "),B.Sb()),2&t){B.fc();const t=B.tc(1),e=B.fc(2);B.lc("disabled",!t.form.valid||e.bloqueoBotones||1==+e.documento.enviado)}}function ie(t,e){if(1&t){const t=B.Ub();B.Tb(0,"button",70),B.bc("click",function(){return B.xc(t),B.fc(3).enviarAConta()}),B.Fc(1," Enviar a contabilidad "),B.Sb()}if(2&t){B.fc();const t=B.tc(1),e=B.fc(2);B.lc("disabled",!t.form.valid||e.bloqueoBotones||1==+e.documento.enviado)}}function ne(t,e){if(1&t){const t=B.Ub();B.Tb(0,"form",9,63),B.bc("ngSubmit",function(){B.xc(t);const e=B.tc(1),o=B.fc(2);return e.form.valid&&o.submitDocumento()}),B.Dc(2,Zt,5,3,"mat-form-field",11),B.Tb(3,"mat-form-field",12),B.Tb(4,"input",64),B.bc("ngModelChange",function(e){return B.xc(t),B.fc(2).documento.serie=e}),B.Sb(),B.Sb(),B.Tb(5,"mat-form-field",12),B.Tb(6,"input",65),B.bc("ngModelChange",function(e){return B.xc(t),B.fc(2).documento.numero=e}),B.Sb(),B.Sb(),B.Tb(7,"mat-form-field",12),B.Tb(8,"input",66),B.bc("ngModelChange",function(e){return B.xc(t),B.fc(2).documento.fecha=e}),B.Sb(),B.Sb(),B.Dc(9,ee,5,3,"mat-form-field",11),B.Tb(10,"div",15),B.Dc(11,oe,2,1,"button",16),B.Dc(12,ie,2,1,"button",67),B.Sb(),B.Sb()}if(2&t){const t=B.fc(2);B.Cb(2),B.lc("ngIf",t.saveToDB),B.Cb(2),B.lc("ngModel",t.documento.serie)("disabled",1==+t.documento.enviado),B.Cb(2),B.lc("ngModel",t.documento.numero)("disabled",1==+t.documento.enviado),B.Cb(2),B.lc("ngModel",t.documento.fecha)("disabled",1==+t.documento.enviado),B.Cb(1),B.lc("ngIf",t.saveToDB),B.Cb(2),B.lc("ngIf",t.saveToDB),B.Cb(1),B.lc("ngIf",t.saveToDB&&+t.documento.documento>0&&0==+t.documento.enviado)}}function ae(t,e){if(1&t&&(B.Tb(0,"mat-tab",62),B.Tb(1,"mat-card",1),B.Tb(2,"mat-card-title"),B.Tb(3,"h4"),B.Fc(4),B.Dc(5,Jt,3,0,"button",2),B.Dc(6,Xt,3,0,"button",2),B.Sb(),B.Sb(),B.Tb(7,"mat-card-content"),B.Dc(8,ne,13,10,"form",3),B.Sb(),B.Sb(),B.Sb()),2&t){const t=B.fc();B.Cb(4),B.Hc(" Documento del ingreso",t.ingreso.ingreso?" No. "+t.ingreso.ingreso:""," "),B.Cb(1),B.lc("ngIf",!t.showDocumentoForm),B.Cb(1),B.lc("ngIf",t.showDocumentoForm),B.Cb(2),B.lc("ngIf",t.showDocumentoForm)}}let ce=(()=>{class t{constructor(t,e,o,i,n,a,c,r,s,l,d){this.dialog=t,this.snackBar=e,this.ls=o,this.ingresoSrvc=i,this.proveedorSrvc=n,this.tipoMovimientoSrvc=a,this.bodegaSrvc=c,this.articuloSrvc=r,this.presentacinSrvc=s,this.documentoTipoSrvc=l,this.tipoCompraVentaSrvc=d,this.saveToDB=!0,this.bodega=!0,this.produccion=!1,this.ingresoSavedEv=new B.o,this.showIngresoForm=!0,this.showDetalleIngresoForm=!0,this.showDocumentoForm=!0,this.detallesIngreso=[],this.displayedColumns=["articulo","presentacion","cantidad","costo_unitario","costo_total","deleteItem"],this.tiposMovimiento=[],this.proveedores=[],this.filteredProveedores=[],this.bodegas=[],this.articulos=[],this.filteredArticulos=[],this.presentaciones=[],this.fltrPresentaciones=[],this.esMovil=!1,this.bloqueoBotones=!1,this.txtArticuloSelected=void 0,this.txtProveedorSelected=void 0,this.documentosTipo=[],this.tiposCompraVenta=[],this.loadTiposMovimiento=()=>{this.tipoMovimientoSrvc.get({ingreso:1}).subscribe(t=>{t&&(this.tiposMovimiento=t)})},this.loadProveedores=()=>{this.proveedorSrvc.get().subscribe(t=>{t&&(this.proveedores=t)})},this.loadBodegas=()=>{this.bodegaSrvc.get({sede:+this.ls.get(w.b.usrTokenVar).sede||0}).subscribe(t=>{t&&(this.bodegas=t)})},this.loadPresentaciones=()=>{this.presentacinSrvc.get().subscribe(t=>{t&&(this.presentaciones=t)})},this.loadDocumentosTipo=()=>{this.documentoTipoSrvc.get().subscribe(t=>{t&&(this.documentosTipo=t)})},this.loadTiposCompraVenta=()=>{this.tipoCompraVentaSrvc.get().subscribe(t=>{t&&(this.tiposCompraVenta=t)})},this.removeFromDetail=t=>{const e=this.detallesIngreso.findIndex(e=>+e.articulo==+t);e>=0&&(this.detallesIngreso.splice(e,1),this.updateTableDataSource())},this.resetIngreso=()=>{this.ingreso={ingreso:null,tipo_movimiento:null,fecha:A().format(w.b.dbDateFormat),bodega:null,usuario:this.ls.get(w.b.usrTokenVar).idusr||0,comentario:null,proveedor:null,estatus_movimiento:1},this.resetDetalleIngreso(),this.detallesIngreso=[],this.resetDocumento(),this.updateTableDataSource(),this.txtProveedorSelected=void 0},this.onSubmit=()=>{this.bloqueoBotones=!0,this.ingresoSrvc.save(this.ingreso).subscribe(t=>{this.resetIngreso(),t.exito&&(this.ingreso=t.ingreso,this.setProveedor(+this.ingreso.proveedor)),this.ingresoSavedEv.emit(),this.bloqueoBotones=!1})},this.loadArticulos=()=>{var t={};this.produccion&&(t={produccion:1}),this.articuloSrvc.getArticulosIngreso(t).subscribe(t=>{t&&(this.articulos=t)})},this.resetDetalleIngreso=()=>{this.detalleIngreso={ingreso_detalle:null,ingreso:this.ingreso.ingreso?this.ingreso.ingreso:null,articulo:null,cantidad:null,precio_unitario:null,precio_total:null,presentacion:0},this.txtArticuloSelected=void 0},this.loadDetalleIngreso=(t=+this.ingreso.ingreso)=>{this.ingresoSrvc.getDetalle(t,{ingreso:t}).subscribe(t=>{t&&(this.detallesIngreso=t,this.updateTableDataSource())})},this.getDetalleIngreso=(t=+this.ingreso.ingreso,e)=>{this.ingresoSrvc.getDetalle(t,{ingreso_detalle:e}).subscribe(t=>{t&&(this.detalleIngreso={ingreso_detalle:t[0].ingreso_detalle,ingreso:t[0].ingreso,articulo:t[0].articulo.articulo,cantidad:+t[0].cantidad,precio_unitario:+t[0].precio_unitario,precio_total:+t[0].precio_total,presentacion:t[0].presentacion.presentacion},this.setPresentaciones(),this.txtArticuloSelected=t[0].articulo,this.showDetalleIngresoForm=!0)})},this.onSubmitDetail=()=>{this.bloqueoBotones=!0,this.detalleIngreso.ingreso=this.ingreso.ingreso,this.detalleIngreso.precio_total=+this.detalleIngreso.cantidad*+this.detalleIngreso.precio_unitario,+this.detalleIngreso.cantidad<1&&(this.detalleIngreso.cantidad=1),this.ingresoSrvc.saveDetalle(this.detalleIngreso).subscribe(t=>{t&&(this.loadDetalleIngreso(),this.resetDetalleIngreso()),this.bloqueoBotones=!1})},this.agregaADetalle=()=>{var t,e=this.detallesIngreso.findIndex(t=>+t.articulo==+this.detalleIngreso.articulo);e>-1&&this.detallesIngreso.splice(e,1),t=this.articulos.filter(t=>+t.articulo==this.detalleIngreso.articulo),this.detalleIngreso.presentacion=t[0].presentacion_reporte,+this.detalleIngreso.cantidad<1&&(this.detalleIngreso.cantidad=1),this.detallesIngreso.push(this.detalleIngreso),this.resetDetalleIngreso(),this.updateTableDataSource()},this.addToDetail=()=>{this.detalleIngreso.cantidad>0?this.produccion||this.detalleIngreso.cantidad_utilizada>0?this.agregaADetalle():this.snackBar.open("ERROR: La cantidad a utilizar debe ser mayor a 0","Egreso",{duration:3e3}):this.snackBar.open("ERROR: La cantidad debe ser mayor a 0","Egreso",{duration:3e3})},this.editFromDetail=t=>{var e=this.detallesIngreso.filter(e=>+e.articulo==+t)[0];this.detalleIngreso={ingreso_detalle:e.ingreso_detalle,ingreso:e.ingreso,articulo:e.articulo,cantidad:+e.cantidad<1?1:e.cantidad,precio_unitario:e.precio_unitario,precio_total:e.precio_total,presentacion:e.presentacion,cantidad_utilizada:e.cantidad_utilizada},this.setPresentaciones(),this.txtArticuloSelected=this.articulos.filter(t=>+t.articulo==this.detalleIngreso.articulo)[0]},this.getDescripcionArticulo=t=>this.articulos.find(e=>+e.articulo==+t).descripcion||"",this.getDescripcionPresentacion=t=>this.presentaciones.find(e=>+e.presentacion==+t).descripcion||"",this.updateTableDataSource=()=>{this.dataSource=new p.l(this.detallesIngreso),this.dataSource.filterPredicate=(t,e)=>t.articulo.descripcion.toLowerCase().includes(e)},this.eliminarArticulo=t=>{this.detallesIngreso.splice(this.detallesIngreso.findIndex(e=>e.ingreso_detalle===t.ingreso_detalle),1),this.updateTableDataSource()},this.filtrarArticulos=t=>{if(t&&"string"==typeof t){const e=t.toLowerCase();this.filteredArticulos=this.articulos.filter(t=>t.descripcion.toLowerCase().includes(e))}else this.filteredArticulos=this.articulos},this.displayArticulo=t=>{if(t)return this.detalleIngreso.articulo=t.articulo,t.descripcion},this.filtrarProveedores=t=>{if(t&&"string"==typeof t){const e=t.toLowerCase();this.filteredProveedores=this.proveedores.filter(t=>t.razon_social.toLowerCase().includes(e)||t.nit.toLowerCase().includes(e))}else this.filteredProveedores=this.proveedores},this.displayProveedor=t=>{if(t)return this.ingreso.proveedor=t.proveedor,`(${t.nit}) ${t.razon_social}`},this.setPresentaciones=()=>{this.fltrPresentaciones=[];const t=this.articulos.findIndex(t=>+t.articulo==+this.detalleIngreso.articulo),e=this.articulos[t];this.fltrPresentaciones=this.presentaciones.filter(t=>+t.medida.medida==+e.presentacion.medida)},this.setProveedor=t=>this.txtProveedorSelected=this.proveedores.find(e=>+e.proveedor===t),this.applyFilter=t=>{this.dataSource.filter=t.toLocaleLowerCase()},this.resetDocumento=()=>this.documento={documento:null,ingreso:null,documento_tipo:null,serie:null,numero:null,fecha:null,tipo_compra_venta:null,enviado:0},this.setDocumentoIngreso=t=>{this.documento={documento:+t.documento,ingreso:+t.ingreso,documento_tipo:t.documento_tipo.documento_tipo,serie:t.serie,numero:t.numero,fecha:t.fecha,tipo_compra_venta:t.tipo_compra_venta.tipo_compra_venta,enviado:t.enviado}},this.loadDocumento=(t=this.ingreso.ingreso||null)=>{t&&this.ingresoSrvc.getDocumento({ingreso:t}).subscribe(t=>{t&&t.length>0?this.setDocumentoIngreso(t[0]):this.resetDocumento()})},this.submitDocumento=()=>{this.documento.ingreso=this.ingreso.ingreso,this.ingresoSrvc.saveDocumento(this.documento).subscribe(t=>{t.exito?(this.setDocumentoIngreso(t.documento),this.snackBar.open("Documento guardado con \xe9xito.","Ingreso",{duration:3e3})):this.snackBar.open(`ERROR: ${t.mensaje}`,"Ingreso",{duration:7e3})})},this.enviarAConta=()=>{var t;+(null===(t=this.documento)||void 0===t?void 0:t.documento)>0&&this.dialog.open(W.a,{maxWidth:"400px",data:new W.b("Env\xedo a contabilidad","Una vez enviado a contabilidad no podr\xe1 modificar el ingreso ni el documento. \xbfDesea continuar?","S\xed","No")}).afterClosed().subscribe(t=>{t&&this.ingresoSrvc.enviarDocumentoAConta(this.documento.documento).subscribe(t=>{t.exito?(this.documento=t.documento,this.snackBar.open("Documento enviado a contabilidad.","Ingreso",{duration:3e3})):this.snackBar.open(`ERROR: ${t.mensaje}`,"Ingreso",{duration:7e3})})})}}ngOnInit(){this.esMovil=this.ls.get(w.b.usrTokenVar).enmovil||!1,this.resetIngreso(),this.loadTiposMovimiento(),this.loadProveedores(),this.loadBodegas(),this.loadArticulos(),this.loadPresentaciones(),this.loadDocumentosTipo(),this.loadTiposCompraVenta(),this.bodega||(this.displayedColumns=["cantidad_utilizada","articulo","presentacion","cantidad","deleteItem"]),this.produccion&&(this.displayedColumns=["articulo","presentacion","cantidad","deleteItem"])}}return t.\u0275fac=function(e){return new(e||t)(B.Nb(I.b),B.Nb(v.b),B.Nb($.a),B.Nb(U),B.Nb(L.a),B.Nb(V.a),B.Nb(K.a),B.Nb(Q.a),B.Nb(J.a),B.Nb(X.a),B.Nb(Y.a))},t.\u0275cmp=B.Hb({type:t,selectors:[["app-form-ingreso"]],inputs:{ingreso:"ingreso",saveToDB:"saveToDB",bodega:"bodega",produccion:"produccion"},outputs:{ingresoSavedEv:"ingresoSavedEv"},decls:13,vars:7,consts:[["label","Ingreso"],[1,"mat-elevation-z4","fullWidth"],["mat-icon-button","","type","button","color","accent",3,"click",4,"ngIf"],["novalidate","",3,"ngSubmit",4,"ngIf"],[4,"ngIf"],["class","mat-elevation-z4 fullWidth",4,"ngIf"],["label","Documento",4,"ngIf"],["mat-icon-button","","type","button","color","accent",3,"click"],[1,"iconFontSize"],["novalidate","",3,"ngSubmit"],["frmIngreso","ngForm"],["class","fullWidth",4,"ngIf"],[1,"fullWidth"],["matInput","","type","date","placeholder","Fecha","name","fecha","required","",3,"ngModel","ngModelChange"],["matInput","","placeholder","Comentarios","name","comentario",3,"ngModel","ngModelChange"],["align","end"],["mat-raised-button","","type","submit","color","accent","class","btnAccion",3,"disabled",4,"ngIf"],["mat-raised-button","","type","button","color","accent",3,"click",4,"ngIf"],["name","tipo_movimiento","required","",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["name","bodega","required","",3,"ngModel","ngModelChange"],["name","bodega_origen",3,"ngModel","ngModelChange"],["type","button","mat-button","","matSuffix","","mat-icon-button","","aria-label","Clear",3,"click",4,"ngIf"],["type","button","mat-button","","matSuffix","","mat-icon-button","","aria-label","Clear",3,"click"],["type","text","placeholder","Proveedor","matInput","","required","",3,"ngModel","ngModelOptions","matAutocomplete","ngModelChange","keyup"],[3,"displayWith"],["autoProveedores","matAutocomplete"],["mat-raised-button","","type","submit","color","accent",1,"btnAccion",3,"disabled"],["mat-raised-button","","type","button","color","accent",3,"click"],["matInput","","placeholder","Buscar",3,"keyup"],["mat-table","","class","mat-elevation-z4 full-width",3,"dataSource",4,"ngIf"],["frmDetalleIngreso","ngForm"],["type","text","placeholder","Art\xedculo","matInput","","required","",3,"ngModel","ngModelOptions","matAutocomplete","ngModelChange","keyup"],[3,"displayWith","optionSelected"],["autoArticulos","matAutocomplete"],["matInput","","placeholder","Cantidad","name","cantidad","type","number","step","0.01","min","1","required","",3,"ngModel","ngModelChange","change"],["mat-raised-button","","type","button","color","accent",3,"disabled","click",4,"ngIf"],["name","presentacion","required","",3,"ngModel","ngModelChange"],["matInput","","placeholder","Cantidad a Utilizar","name","cantidad_utilizada","required","",3,"ngModel","ngModelChange"],["matInput","","placeholder","Costo unitario Con IVA","name","precio_unitario","type","number","step","0.01","required","",3,"ngModel","ngModelChange","change"],["mat-raised-button","","type","button","color","accent",3,"disabled","click"],["mat-table","",1,"mat-elevation-z4","full-width",3,"dataSource"],["matColumnDef","articulo"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","","class","text-wrap",4,"matCellDef"],["matColumnDef","presentacion"],["matColumnDef","cantidad_utilizada"],["mat-header-cell","","class","text-right",4,"matHeaderCellDef"],["mat-cell","","class","text-right",4,"matCellDef"],["matColumnDef","cantidad"],["matColumnDef","costo_unitario"],["matColumnDef","costo_total"],["matColumnDef","deleteItem"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell","",1,"text-wrap"],["mat-header-cell","",1,"text-right"],["mat-cell","",1,"text-right"],["mat-header-row",""],["mat-row",""],["label","Documento"],["frmDocumento","ngForm"],["matInput","","type","text","placeholder","Serie","name","serie","minlength","1","maxlength","50","required","",3,"ngModel","disabled","ngModelChange"],["matInput","","type","text","placeholder","N\xfamero","name","numero","minlength","1","maxlength","50","required","",3,"ngModel","disabled","ngModelChange"],["matInput","","type","date","placeholder","Fecha","name","fecha","required","",3,"ngModel","disabled","ngModelChange"],["mat-raised-button","","type","button","color","accent","class","btnAccion",3,"disabled","click",4,"ngIf"],["name","documento_tipo","required","",3,"ngModel","disabled","ngModelChange"],["name","tipo_compra_venta","required","",3,"ngModel","disabled","ngModelChange"],["mat-raised-button","","type","button","color","accent",1,"btnAccion",3,"disabled","click"]],template:function(t,e){1&t&&(B.Tb(0,"mat-tab-group"),B.Tb(1,"mat-tab",0),B.Tb(2,"mat-card",1),B.Tb(3,"mat-card-title"),B.Tb(4,"h4"),B.Fc(5),B.Dc(6,Z,3,0,"button",2),B.Dc(7,tt,3,0,"button",2),B.Sb(),B.Sb(),B.Tb(8,"mat-card-content"),B.Dc(9,gt,13,8,"form",3),B.Sb(),B.Sb(),B.Dc(10,mt,1,0,"hr",4),B.Dc(11,Qt,12,7,"mat-card",5),B.Sb(),B.Dc(12,ae,9,4,"mat-tab",6),B.Sb()),2&t&&(B.Cb(5),B.Hc(" Ingreso",e.ingreso.ingreso?" No. "+e.ingreso.ingreso:""," "),B.Cb(1),B.lc("ngIf",!e.showIngresoForm),B.Cb(1),B.lc("ngIf",e.showIngresoForm),B.Cb(2),B.lc("ngIf",e.showIngresoForm),B.Cb(1),B.lc("ngIf",e.ingreso.ingreso||!e.saveToDB),B.Cb(1),B.lc("ngIf",e.ingreso.ingreso||!e.saveToDB),B.Cb(1),B.lc("ngIf",+e.ingreso.ingreso>0))},directives:[m.b,m.a,u.a,u.h,i.m,u.c,S.a,l.a,a.r,a.l,a.m,d.b,b.b,a.c,a.p,a.k,a.n,d.f,f.a,i.l,G.m,d.g,_.c,_.a,a.o,p.k,p.c,p.e,p.b,p.g,p.j,p.d,p.a,p.f,p.i,a.g,a.f],pipes:[i.f],styles:[".full-width[_ngcontent-%COMP%]{width:100%}.iconFontSize[_ngcontent-%COMP%]{font-size:24pt}"]}),t})();const re=["lstIngreso"],se=["frmIngreso"];let le=(()=>{class t{constructor(t){this.ls=t,this.breakpoint=2,this.onWindowResize=t=>{this.breakpoint=t.target.innerWidth<=360?1:2},this.setIngreso=t=>{this.ingreso=t,this.frmIngreso.setProveedor(+this.ingreso.proveedor),this.frmIngreso.loadDetalleIngreso(+this.ingreso.ingreso),this.frmIngreso.resetDetalleIngreso(),this.frmIngreso.loadDocumento(this.ingreso.ingreso)},this.refreshIngresoList=()=>{this.lstIngresoComponent.loadIngresos()},this.ingreso={ingreso:null,tipo_movimiento:null,fecha:A().format(w.b.dbDateFormat),bodega:null,usuario:this.ls.get(w.b.usrTokenVar).idusr||0,comentario:null,proveedor:null}}ngOnInit(){this.breakpoint=window.innerWidth<=360?1:2}}return t.\u0275fac=function(e){return new(e||t)(B.Nb($.a))},t.\u0275cmp=B.Hb({type:t,selectors:[["app-ingreso"]],viewQuery:function(t,e){if(1&t&&(B.Kc(re,1),B.Kc(se,1)),2&t){let t;B.sc(t=B.cc())&&(e.lstIngresoComponent=t.first),B.sc(t=B.cc())&&(e.frmIngreso=t.first)}},decls:7,vars:1,consts:[[1,"row"],[1,"col","m5","s12"],[3,"getIngresoEv"],["lstIngreso",""],[1,"col","m7","s12"],[3,"ingreso","ingresoSavedEv"],["frmIngreso",""]],template:function(t,e){1&t&&(B.Tb(0,"div",0),B.Tb(1,"div",1),B.Tb(2,"app-lista-ingreso",2,3),B.bc("getIngresoEv",function(t){return e.setIngreso(t)}),B.Sb(),B.Sb(),B.Tb(4,"div",4),B.Tb(5,"app-form-ingreso",5,6),B.bc("ingresoSavedEv",function(){return e.refreshIngresoList()}),B.Sb(),B.Sb(),B.Sb()),2&t&&(B.Cb(5),B.lc("ingreso",e.ingreso))},directives:[j,ce],styles:[""]}),t})(),de=(()=>{class t{constructor(t){this.http=t,this.egresoUrl="egreso",this.srvcErrHndl=new R.a}get(t={}){return this.http.get(`${w.b.urlWms}/${this.egresoUrl}/buscar_egreso?${N.stringify(t)}`).pipe(Object(H.a)(w.b.reintentos),Object(P.a)(this.srvcErrHndl.errorHandler))}save(t){return this.http.post(`${w.b.urlWms}/${this.egresoUrl}/guardar${+t.egreso>0?"/"+t.egreso:""}`,t).pipe(Object(H.a)(w.b.reintentos),Object(P.a)(this.srvcErrHndl.errorHandler))}getDetalle(t,e={}){return this.http.get(`${w.b.urlWms}/${this.egresoUrl}/buscar_detalle/${t}?${N.stringify(e)}`).pipe(Object(H.a)(w.b.reintentos),Object(P.a)(this.srvcErrHndl.errorHandler))}saveDetalle(t){return this.http.post(`${w.b.urlWms}/${this.egresoUrl}/guardar_detalle/${t.egreso}${+t.egreso_detalle>0?"/"+t.egreso_detalle:""}`,t).pipe(Object(H.a)(w.b.reintentos),Object(P.a)(this.srvcErrHndl.errorHandler))}}return t.\u0275fac=function(e){return new(e||t)(B.Xb(n.b))},t.\u0275prov=B.Jb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();const be=function(){return{standalone:!0}};function ue(t,e){if(1&t){const t=B.Ub();B.Tb(0,"input",9),B.bc("input",function(){return B.xc(t),B.fc().applyFilter()})("ngModelChange",function(e){return B.xc(t),B.fc().txtFiltro=e}),B.Sb()}if(2&t){const t=B.fc();B.lc("matKeyboard",t.keyboardLayout)("ngModel",t.txtFiltro)("ngModelOptions",B.nc(3,be))}}function ge(t,e){if(1&t){const t=B.Ub();B.Tb(0,"input",10),B.bc("keyup",function(){return B.xc(t),B.fc().applyFilter()})("ngModelChange",function(e){return B.xc(t),B.fc().txtFiltro=e}),B.Sb()}if(2&t){const t=B.fc();B.lc("ngModel",t.txtFiltro)("ngModelOptions",B.nc(2,be))}}function me(t,e){if(1&t&&(B.Tb(0,"span",13),B.Fc(1),B.Sb()),2&t){const t=B.fc().$implicit;B.Cb(1),B.Hc("Comanda: #",t.idcomandafox,"")}}function pe(t,e){if(1&t){const t=B.Ub();B.Tb(0,"mat-list-item",11),B.bc("click",function(){B.xc(t);const o=e.$implicit;return B.fc().getEgreso(o)}),B.Tb(1,"mat-icon",12),B.Fc(2,"trending_down"),B.Sb(),B.Tb(3,"h5",13),B.Fc(4),B.Sb(),B.Ob(5,"br"),B.Tb(6,"p",13),B.Fc(7),B.gc(8,"date"),B.Ob(9,"br"),B.Fc(10),B.Ob(11,"br"),B.Sb(),B.Dc(12,me,2,1,"span",14),B.Sb()}if(2&t){const t=e.$implicit;B.Cb(4),B.Hc("No. ",t.egreso,""),B.Cb(3),B.Hc(" Fecha: ",B.ic(8,4,t.fecha,"dd/MM/yyyy"),""),B.Cb(3),B.Hc(" Bodega: ",t.bodega.descripcion,""),B.Cb(2),B.lc("ngIf",!!t.idcomandafox)}}let fe=(()=>{class t{constructor(t,e){this.egresoSrvc=t,this.ls=e,this.getEgresoEv=new B.o,this.length=0,this.pageSize=5,this.pageSizeOptions=[5,10,15],this.pageIndex=0,this.txtFiltro="",this.keyboardLayout=w.b.IDIOMA_TECLADO,this.esMovil=!1,this.params={_fdel:A().startOf("month").format(w.b.dbDateFormat),_fal:A().endOf("month").format(w.b.dbDateFormat)},this.loadEgresos=()=>{this.egresoSrvc.get(this.params).subscribe(t=>{t&&(this.lstEgresos=t,this.applyFilter())})},this.getEgreso=t=>{this.getEgresoEv.emit({egreso:t.egreso,tipo_movimiento:t.tipo_movimiento.tipo_movimiento,bodega:t.bodega.bodega,fecha:t.fecha,usuario:t.usuario.usuario,estatus_movimiento:t.estatus_movimiento||1,traslado:t.traslado||0,idcomandafox:t.idcomandafox})},this.pageChange=t=>{this.pageSize=t.pageSize,this.pageIndex=t.pageIndex,this.applyFilter()}}ngOnInit(){this.esMovil=this.ls.get(w.b.usrTokenVar).enmovil||!1,this.loadEgresos()}applyFilter(){if(this.txtFiltro.length>0){const t=Object(w.c)(this.lstEgresos,this.txtFiltro);this.length=t.length,this.lstEgresosPaged=Object(w.f)(t,this.pageSize,this.pageIndex+1)}else this.length=this.lstEgresos.length,this.lstEgresosPaged=Object(w.f)(this.lstEgresos,this.pageSize,this.pageIndex+1)}}return t.\u0275fac=function(e){return new(e||t)(B.Nb(de),B.Nb($.a))},t.\u0275cmp=B.Hb({type:t,selectors:[["app-lista-egreso"]],outputs:{getEgresoEv:"getEgresoEv"},decls:14,vars:12,consts:[[1,"mat-elevation-z4","fullWidth"],[1,"fullWidth"],["matInput","","type","date","placeholder","Del",3,"ngModel","ngModelOptions","ngModelChange"],["matInput","","type","date","placeholder","Al",3,"ngModel","ngModelOptions","ngModelChange"],["mat-raised-button","","type","button","color","accent",3,"click"],["matInput","","placeholder","Buscar...",3,"matKeyboard","ngModel","ngModelOptions","input","ngModelChange",4,"ngIf"],["matInput","","placeholder","Buscar...",3,"ngModel","ngModelOptions","keyup","ngModelChange",4,"ngIf"],[3,"click",4,"ngFor","ngForOf"],["showFirstLastButtons","",3,"length","pageSize","pageSizeOptions","page"],["matInput","","placeholder","Buscar...",3,"matKeyboard","ngModel","ngModelOptions","input","ngModelChange"],["matInput","","placeholder","Buscar...",3,"ngModel","ngModelOptions","keyup","ngModelChange"],[3,"click"],["mat-list-icon",""],["mat-line",""],["mat-line","",4,"ngIf"]],template:function(t,e){1&t&&(B.Tb(0,"mat-card",0),B.Tb(1,"mat-card-content"),B.Tb(2,"mat-form-field",1),B.Tb(3,"input",2),B.bc("ngModelChange",function(t){return e.params._fdel=t}),B.Sb(),B.Sb(),B.Tb(4,"mat-form-field",1),B.Tb(5,"input",3),B.bc("ngModelChange",function(t){return e.params._fal=t}),B.Sb(),B.Sb(),B.Tb(6,"button",4),B.bc("click",function(){return e.loadEgresos()}),B.Fc(7," Buscar "),B.Sb(),B.Tb(8,"mat-form-field",1),B.Dc(9,ue,1,4,"input",5),B.Dc(10,ge,1,3,"input",6),B.Sb(),B.Tb(11,"mat-nav-list"),B.Dc(12,pe,13,7,"mat-list-item",7),B.Sb(),B.Tb(13,"mat-paginator",8),B.bc("page",function(t){return e.pageChange(t)}),B.Sb(),B.Sb(),B.Sb()),2&t&&(B.Cb(3),B.lc("ngModel",e.params._fdel)("ngModelOptions",B.nc(10,be)),B.Cb(2),B.lc("ngModel",e.params._fal)("ngModelOptions",B.nc(11,be)),B.Cb(4),B.lc("ngIf",!e.esMovil),B.Cb(1),B.lc("ngIf",e.esMovil),B.Cb(2),B.lc("ngForOf",e.lstEgresosPaged),B.Cb(1),B.lc("length",e.length)("pageSize",e.pageSize)("pageSizeOptions",e.pageSizeOptions))},directives:[u.a,u.c,d.b,b.b,a.c,a.k,a.n,S.a,i.m,s.e,i.l,D.a,y.a,s.c,l.a,s.b,G.j],pipes:[i.e],styles:[".fullWidth[_ngcontent-%COMP%], table[_ngcontent-%COMP%]{width:100%!important}"]}),t})(),he=(()=>{class t{constructor(t){this.http=t,this.conversorUrl="conversor",this.srvcErrHndl=new R.a}transformar(t){return this.http.post(`${w.b.urlWms}/${this.conversorUrl}/transformar`,t).pipe(Object(H.a)(w.b.reintentos),Object(P.a)(this.srvcErrHndl.errorHandler))}producir(t){return this.http.post(`${w.b.urlWms}/${this.conversorUrl}/producir`,t).pipe(Object(H.a)(w.b.reintentos),Object(P.a)(this.srvcErrHndl.errorHandler))}}return t.\u0275fac=function(e){return new(e||t)(B.Xb(n.b))},t.\u0275prov=B.Jb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function Se(t,e){if(1&t){const t=B.Ub();B.Tb(0,"button",5),B.bc("click",function(){return B.xc(t),B.fc().showEgresoForm=!0}),B.Tb(1,"mat-icon",6),B.Fc(2,"expand_more"),B.Sb(),B.Sb()}}function ve(t,e){if(1&t){const t=B.Ub();B.Tb(0,"button",5),B.bc("click",function(){return B.xc(t),B.fc().showEgresoForm=!1}),B.Tb(1,"mat-icon",6),B.Fc(2,"expand_less"),B.Sb(),B.Sb()}}function Ce(t,e){if(1&t&&(B.Tb(0,"mat-option",20),B.Fc(1),B.Sb()),2&t){const t=e.$implicit;B.lc("value",t.tipo_movimiento),B.Cb(1),B.Hc(" ",t.descripcion," ")}}function Te(t,e){if(1&t){const t=B.Ub();B.Tb(0,"mat-form-field",10),B.Tb(1,"mat-label"),B.Fc(2,"Tipo de movimiento"),B.Sb(),B.Tb(3,"mat-select",19),B.bc("ngModelChange",function(e){return B.xc(t),B.fc(2).egreso.tipo_movimiento=e}),B.Dc(4,Ce,2,2,"mat-option",13),B.Sb(),B.Sb()}if(2&t){const t=B.fc(2);B.Cb(3),B.lc("ngModel",t.egreso.tipo_movimiento),B.Cb(1),B.lc("ngForOf",t.tiposMovimiento)}}function Me(t,e){if(1&t&&(B.Tb(0,"mat-option",20),B.Fc(1),B.Sb()),2&t){const t=e.$implicit;B.lc("value",t.bodega),B.Cb(1),B.Hc(" ",t.descripcion," ")}}function De(t,e){if(1&t){const t=B.Ub();B.Tb(0,"mat-checkbox",21),B.bc("ngModelChange",function(e){return B.xc(t),+(B.fc(2).egreso.traslado=e)}),B.Fc(1,"\xbfEs traslado entre bodegas de la misma sede? "),B.Sb()}if(2&t){const t=B.fc(2);B.lc("ngModel",+t.egreso.traslado)}}function Ie(t,e){if(1&t&&(B.Tb(0,"mat-option",20),B.Fc(1),B.Sb()),2&t){const t=e.$implicit;B.lc("value",t.bodega),B.Cb(1),B.Hc(" ",t.descripcion," ")}}function Fe(t,e){if(1&t){const t=B.Ub();B.Tb(0,"mat-form-field",10),B.Tb(1,"mat-label"),B.Fc(2,"Bodega destino"),B.Sb(),B.Tb(3,"mat-select",22),B.bc("ngModelChange",function(e){return B.xc(t),B.fc(2).egreso.bodega_destino=e}),B.Dc(4,Ie,2,2,"mat-option",13),B.Sb(),B.Sb()}if(2&t){const t=B.fc(2);B.Cb(3),B.lc("ngModel",t.egreso.bodega_destino)("required",1==+t.egreso.traslado),B.Cb(1),B.lc("ngForOf",t.bodegas)}}function xe(t,e){if(1&t&&(B.Tb(0,"mat-option",20),B.Fc(1),B.Sb()),2&t){const t=e.$implicit;B.lc("value",t.tipo_movimiento),B.Cb(1),B.Hc(" ",t.descripcion," ")}}function _e(t,e){if(1&t){const t=B.Ub();B.Tb(0,"mat-form-field",10),B.Tb(1,"mat-label"),B.Fc(2,"Tipo de movimiento destino"),B.Sb(),B.Tb(3,"mat-select",23),B.bc("ngModelChange",function(e){return B.xc(t),B.fc(2).egreso.tipo_movimiento_destino=e}),B.Dc(4,xe,2,2,"mat-option",13),B.Sb(),B.Sb()}if(2&t){const t=B.fc(2);B.Cb(3),B.lc("ngModel",t.egreso.tipo_movimiento_destino)("required",1==+t.egreso.traslado),B.Cb(1),B.lc("ngForOf",t.tiposMovimientoIngreso)}}function Oe(t,e){if(1&t&&(B.Tb(0,"span"),B.Ob(1,"br"),B.Tb(2,"strong"),B.Fc(3),B.Sb(),B.Sb()),2&t){const t=B.fc(2);B.Cb(3),B.Hc("Comanda: #",t.egreso.idcomandafox,"")}}const ye=function(){return[2,3]};function ke(t,e){if(1&t&&(B.Tb(0,"button",24),B.Fc(1," Guardar "),B.Sb()),2&t){B.fc();const t=B.tc(1),e=B.fc();B.lc("disabled",!t.form.valid||B.nc(1,ye).indexOf(+e.egreso.estatus_movimiento)>=0||e.bloqueoBotones)}}function Ee(t,e){if(1&t){const t=B.Ub();B.Tb(0,"button",25),B.bc("click",function(){return B.xc(t),B.fc(2).confirmarEgreso()}),B.Fc(1," Confirmar "),B.Sb()}if(2&t){B.fc();const t=B.tc(1),e=B.fc();B.lc("disabled",!t.form.valid||B.nc(1,ye).indexOf(+e.egreso.estatus_movimiento)>=0)}}function we(t,e){if(1&t){const t=B.Ub();B.Tb(0,"button",26),B.bc("click",function(){return B.xc(t),B.fc(2).resetEgreso()}),B.Fc(1," Nuevo "),B.Sb()}}function Ae(t,e){if(1&t){const t=B.Ub();B.Tb(0,"form",7,8),B.bc("ngSubmit",function(){B.xc(t);const e=B.tc(1),o=B.fc();return e.form.valid&&o.onSubmit()}),B.Dc(2,Te,5,2,"mat-form-field",9),B.Tb(3,"mat-form-field",10),B.Tb(4,"input",11),B.bc("ngModelChange",function(e){return B.xc(t),B.fc().egreso.fecha=e}),B.Sb(),B.Sb(),B.Tb(5,"mat-form-field",10),B.Tb(6,"mat-label"),B.Fc(7,"Bodega"),B.Sb(),B.Tb(8,"mat-select",12),B.bc("ngModelChange",function(e){return B.xc(t),B.fc().egreso.bodega=e}),B.Dc(9,Me,2,2,"mat-option",13),B.Sb(),B.Sb(),B.Dc(10,De,2,1,"mat-checkbox",14),B.Dc(11,Fe,5,3,"mat-form-field",9),B.Dc(12,_e,5,3,"mat-form-field",9),B.Dc(13,Oe,4,1,"span",3),B.Tb(14,"div",15),B.Dc(15,ke,2,2,"button",16),B.Dc(16,Ee,2,2,"button",17),B.Dc(17,we,2,0,"button",18),B.Sb(),B.Sb()}if(2&t){const t=B.fc();B.Cb(2),B.lc("ngIf",t.saveToDB),B.Cb(2),B.lc("ngModel",t.egreso.fecha),B.Cb(4),B.lc("ngModel",t.egreso.bodega),B.Cb(1),B.lc("ngForOf",t.bodegas),B.Cb(1),B.lc("ngIf",t.saveToDB),B.Cb(1),B.lc("ngIf",1==+t.egreso.traslado&&B.nc(11,ye).indexOf(+t.egreso.estatus_movimiento)<0),B.Cb(1),B.lc("ngIf",1==+t.egreso.traslado&&B.nc(12,ye).indexOf(+t.egreso.estatus_movimiento)<0),B.Cb(1),B.lc("ngIf",!!t.egreso.idcomandafox),B.Cb(2),B.lc("ngIf",t.saveToDB),B.Cb(1),B.lc("ngIf",t.egreso.egreso&&t.detallesEgreso.length>0),B.Cb(1),B.lc("ngIf",t.egreso.egreso)}}function Be(t,e){1&t&&B.Ob(0,"hr")}function $e(t,e){if(1&t){const t=B.Ub();B.Tb(0,"button",5),B.bc("click",function(){return B.xc(t),B.fc(2).showDetalleEgresoForm=!0}),B.Tb(1,"mat-icon",6),B.Fc(2,"expand_more"),B.Sb(),B.Sb()}}function Re(t,e){if(1&t){const t=B.Ub();B.Tb(0,"button",5),B.bc("click",function(){return B.xc(t),B.fc(2).showDetalleEgresoForm=!1}),B.Tb(1,"mat-icon",6),B.Fc(2,"expand_less"),B.Sb(),B.Sb()}}function He(t,e){if(1&t&&(B.Tb(0,"mat-option",20),B.Fc(1),B.Sb()),2&t){const t=e.$implicit;B.lc("value",t),B.Cb(1),B.Hc(" ",t.descripcion," ")}}function Pe(t,e){if(1&t&&(B.Tb(0,"mat-option",20),B.Fc(1),B.Sb()),2&t){const t=e.$implicit;B.lc("value",t.presentacion),B.Cb(1),B.Hc(" ",t.descripcion," ")}}function Ne(t,e){if(1&t&&(B.Tb(0,"button",24),B.Fc(1," Guardar "),B.Sb()),2&t){B.fc();const t=B.tc(1),e=B.fc(2);B.lc("disabled",!t.form.valid||B.nc(1,ye).indexOf(+e.egreso.estatus_movimiento)>=0||e.bloqueoBotones)}}function Ue(t,e){if(1&t){const t=B.Ub();B.Tb(0,"button",37),B.bc("click",function(){return B.xc(t),B.fc(3).addToDetail()}),B.Fc(1," Guardar "),B.Sb()}if(2&t){B.fc();const t=B.tc(1),e=B.fc(2);B.lc("disabled",!e.egreso.bodega||!t.form.valid||B.nc(1,ye).indexOf(+e.egreso.estatus_movimiento)>=0)}}function Ge(t,e){if(1&t){const t=B.Ub();B.Tb(0,"button",26),B.bc("click",function(){return B.xc(t),B.fc(3).resetDetalleEgreso()}),B.Fc(1," Nuevo "),B.Sb()}}const ze=function(){return{standalone:!0}};function qe(t,e){if(1&t){const t=B.Ub();B.Tb(0,"form",7,30),B.bc("ngSubmit",function(){B.xc(t);const e=B.tc(1),o=B.fc(2);return e.form.valid&&o.onSubmitDetail()}),B.Tb(2,"mat-form-field",10),B.Tb(3,"mat-label"),B.Fc(4,"Art\xedculo"),B.Sb(),B.Tb(5,"input",31),B.bc("ngModelChange",function(e){return B.xc(t),B.fc(2).txtArticuloSelected=e})("keyup",function(){B.xc(t);const e=B.fc(2);return e.filtrarArticulos(e.txtArticuloSelected)}),B.Sb(),B.Tb(6,"mat-autocomplete",32,33),B.bc("optionSelected",function(){return B.xc(t),B.fc(2).setPresentaciones()}),B.Dc(8,He,2,2,"mat-option",13),B.Sb(),B.Sb(),B.Tb(9,"mat-form-field",10),B.Tb(10,"mat-label"),B.Fc(11,"Presentaci\xf3n"),B.Sb(),B.Tb(12,"mat-select",34),B.bc("ngModelChange",function(e){return B.xc(t),B.fc(2).detalleEgreso.presentacion=e}),B.Dc(13,Pe,2,2,"mat-option",13),B.Sb(),B.Sb(),B.Tb(14,"mat-form-field",10),B.Tb(15,"input",35),B.bc("ngModelChange",function(e){return B.xc(t),B.fc(2).detalleEgreso.cantidad=e})("change",function(){B.xc(t);const e=B.fc(2);return e.detalleEgreso.precio_total=+e.detalleEgreso.precio_unitario*+e.detalleEgreso.cantidad}),B.Sb(),B.Sb(),B.Tb(16,"div",15),B.Dc(17,Ne,2,2,"button",16),B.Dc(18,Ue,2,2,"button",36),B.Dc(19,Ge,2,0,"button",18),B.Sb(),B.Sb()}if(2&t){const t=B.tc(7),e=B.fc(2);B.Cb(5),B.lc("ngModel",e.txtArticuloSelected)("ngModelOptions",B.nc(11,ze))("matAutocomplete",t),B.Cb(1),B.lc("displayWith",e.displayArticulo),B.Cb(2),B.lc("ngForOf",e.filteredArticulos),B.Cb(4),B.lc("ngModel",e.detalleEgreso.presentacion),B.Cb(1),B.lc("ngForOf",e.fltrPresentaciones),B.Cb(2),B.lc("ngModel",e.detalleEgreso.cantidad),B.Cb(2),B.lc("ngIf",e.saveToDB),B.Cb(1),B.lc("ngIf",!e.saveToDB),B.Cb(1),B.lc("ngIf",e.detalleEgreso.egreso_detalle)}}function je(t,e){1&t&&B.Ob(0,"hr")}function We(t,e){if(1&t){const t=B.Ub();B.Tb(0,"input",38),B.bc("input",function(e){return B.xc(t),B.fc(2).applyFilter(e.target.value)}),B.Sb()}if(2&t){const t=B.fc(2);B.lc("matKeyboard",t.keyboardLayout)}}function Le(t,e){if(1&t){const t=B.Ub();B.Tb(0,"input",39),B.bc("keyup",function(e){return B.xc(t),B.fc(2).applyFilter(e.target.value)}),B.Sb()}}function Ve(t,e){1&t&&(B.Tb(0,"th",53),B.Fc(1,"Art\xedculo"),B.Sb())}function Ke(t,e){if(1&t&&(B.Tb(0,"td",54),B.Fc(1),B.Sb()),2&t){const t=e.$implicit,o=B.fc(3);B.Cb(1),B.Hc(" ",o.saveToDB?t.articulo.descripcion:o.getDescripcionArticulo(t.articulo),"")}}function Qe(t,e){1&t&&(B.Tb(0,"th",53),B.Fc(1,"Presentaci\xf3n"),B.Sb())}function Je(t,e){if(1&t&&(B.Tb(0,"td",54),B.Fc(1),B.Sb()),2&t){const t=e.$implicit,o=B.fc(3);B.Cb(1),B.Hc(" ",o.saveToDB?t.presentacion.descripcion:o.getDescripcionPresentacion(t.presentacion)," ")}}function Xe(t,e){1&t&&(B.Tb(0,"th",55),B.Fc(1,"Cantidad"),B.Sb())}function Ye(t,e){if(1&t&&(B.Tb(0,"td",56),B.Fc(1),B.gc(2,"number"),B.Sb()),2&t){const t=e.$implicit;B.Cb(1),B.Gc(B.ic(2,1,t.cantidad,"1.2-2"))}}function Ze(t,e){1&t&&(B.Tb(0,"th",55),B.Fc(1,"Costo Unitario"),B.Sb())}function to(t,e){if(1&t&&(B.Tb(0,"td",56),B.Fc(1),B.gc(2,"number"),B.Sb()),2&t){const t=e.$implicit;B.Cb(1),B.Hc("",B.ic(2,1,t.precio_unitario,"1.2-2")," ")}}function eo(t,e){1&t&&(B.Tb(0,"th",55),B.Fc(1,"Costo Total"),B.Sb())}function oo(t,e){if(1&t&&(B.Tb(0,"td",56),B.Fc(1),B.gc(2,"number"),B.Sb()),2&t){const t=e.$implicit;B.Cb(1),B.Gc(B.ic(2,1,t.precio_total,"1.2-2"))}}function io(t,e){1&t&&(B.Tb(0,"th",53),B.Fc(1,"\xa0"),B.Sb())}function no(t,e){if(1&t){const t=B.Ub();B.Tb(0,"button",25),B.bc("click",function(){B.xc(t);const e=B.fc().$implicit;return B.fc(3).getDetalleEgreso(e.egreso,e.egreso_detalle)}),B.Fc(1," Editar "),B.Sb()}if(2&t){const t=B.fc(4);B.lc("disabled",B.nc(1,ye).indexOf(+t.egreso.estatus_movimiento)>=0||t.bloqueoBotones)}}function ao(t,e){if(1&t){const t=B.Ub();B.Tb(0,"button",37),B.bc("click",function(){B.xc(t);const e=B.fc().$implicit;return B.fc(3).editFromDetail(e.articulo)}),B.Fc(1," Editar "),B.Sb()}if(2&t){const t=B.fc(4);B.lc("disabled",B.nc(1,ye).indexOf(+t.egreso.estatus_movimiento)>=0||t.bloqueoBotones)}}function co(t,e){if(1&t){const t=B.Ub();B.Tb(0,"button",37),B.bc("click",function(){B.xc(t);const e=B.fc().$implicit;return B.fc(3).removeFromDetail(e.articulo)}),B.Fc(1," Eliminar "),B.Sb()}if(2&t){const t=B.fc(4);B.lc("disabled",B.nc(1,ye).indexOf(+t.egreso.estatus_movimiento)>=0||t.bloqueoBotones)}}function ro(t,e){if(1&t&&(B.Tb(0,"td",54),B.Dc(1,no,2,2,"button",17),B.Dc(2,ao,2,2,"button",36),B.Dc(3,co,2,2,"button",36),B.Sb()),2&t){const t=B.fc(3);B.Cb(1),B.lc("ngIf",t.saveToDB),B.Cb(1),B.lc("ngIf",!t.saveToDB),B.Cb(1),B.lc("ngIf",!t.saveToDB)}}function so(t,e){1&t&&B.Ob(0,"tr",57)}function lo(t,e){1&t&&B.Ob(0,"tr",58)}function bo(t,e){if(1&t&&(B.Tb(0,"table",40),B.Rb(1,41),B.Dc(2,Ve,2,0,"th",42),B.Dc(3,Ke,2,1,"td",43),B.Qb(),B.Rb(4,44),B.Dc(5,Qe,2,0,"th",42),B.Dc(6,Je,2,1,"td",43),B.Qb(),B.Rb(7,45),B.Dc(8,Xe,2,0,"th",46),B.Dc(9,Ye,3,4,"td",47),B.Qb(),B.Rb(10,48),B.Dc(11,Ze,2,0,"th",46),B.Dc(12,to,3,4,"td",47),B.Qb(),B.Rb(13,49),B.Dc(14,eo,2,0,"th",46),B.Dc(15,oo,3,4,"td",47),B.Qb(),B.Rb(16,50),B.Dc(17,io,2,0,"th",42),B.Dc(18,ro,4,3,"td",43),B.Qb(),B.Dc(19,so,1,0,"tr",51),B.Dc(20,lo,1,0,"tr",52),B.Sb()),2&t){const t=B.fc(2);B.lc("dataSource",t.dataSource),B.Cb(19),B.lc("matHeaderRowDef",t.displayedColumns),B.Cb(1),B.lc("matRowDefColumns",t.displayedColumns)}}function uo(t,e){if(1&t&&(B.Tb(0,"mat-card",0),B.Tb(1,"mat-card-title"),B.Tb(2,"h4"),B.Fc(3),B.Dc(4,$e,3,0,"button",1),B.Dc(5,Re,3,0,"button",1),B.Sb(),B.Sb(),B.Tb(6,"mat-card-content"),B.Dc(7,qe,20,12,"form",2),B.Dc(8,je,1,0,"hr",3),B.Tb(9,"mat-form-field",10),B.Dc(10,We,1,1,"input",27),B.Dc(11,Le,1,0,"input",28),B.Sb(),B.Dc(12,bo,21,3,"table",29),B.Sb(),B.Sb()),2&t){const t=B.fc();B.Cb(3),B.Ic(" Detalle del egreso ",t.saveToDB?"No.":""," ",t.egreso.egreso," "),B.Cb(1),B.lc("ngIf",!t.showDetalleEgresoForm),B.Cb(1),B.lc("ngIf",t.showDetalleEgresoForm),B.Cb(2),B.lc("ngIf",t.showDetalleEgresoForm),B.Cb(1),B.lc("ngIf",t.detallesEgreso.length>0),B.Cb(2),B.lc("ngIf",!t.esMovil),B.Cb(1),B.lc("ngIf",t.esMovil),B.Cb(1),B.lc("ngIf",t.detallesEgreso.length>0)}}function go(t,e){1&t&&B.Ob(0,"hr")}function mo(t,e){if(1&t){const t=B.Ub();B.Tb(0,"button",5),B.bc("click",function(){return B.xc(t),B.fc(2).showDetalleEgresoForm=!0}),B.Tb(1,"mat-icon",6),B.Fc(2,"expand_more"),B.Sb(),B.Sb()}}function po(t,e){if(1&t){const t=B.Ub();B.Tb(0,"button",5),B.bc("click",function(){return B.xc(t),B.fc(2).showDetalleEgresoForm=!1}),B.Tb(1,"mat-icon",6),B.Fc(2,"expand_less"),B.Sb(),B.Sb()}}function fo(t,e){if(1&t&&(B.Tb(0,"mat-option",20),B.Fc(1),B.Sb()),2&t){const t=e.$implicit;B.lc("value",t),B.Cb(1),B.Hc(" ",t.descripcion," ")}}function ho(t,e){if(1&t){const t=B.Ub();B.Tb(0,"button",37),B.bc("click",function(){return B.xc(t),B.fc(3).addToDetailMerma()}),B.Fc(1," Guardar "),B.Sb()}if(2&t){B.fc();const t=B.tc(1),e=B.fc(2);B.lc("disabled",!e.detalleMerma.articulo||!t.form.valid||B.nc(1,ye).indexOf(+e.egreso.estatus_movimiento)>=0)}}function So(t,e){if(1&t){const t=B.Ub();B.Tb(0,"form",7,59),B.bc("ngSubmit",function(){B.xc(t);const e=B.tc(1),o=B.fc(2);return e.form.valid&&o.onSubmitDetail()}),B.Tb(2,"mat-form-field",10),B.Tb(3,"mat-label"),B.Fc(4,"Art\xedculo"),B.Sb(),B.Tb(5,"input",31),B.bc("ngModelChange",function(e){return B.xc(t),B.fc(2).txtArticuloSelectedM=e})("keyup",function(){B.xc(t);const e=B.fc(2);return e.filtrarArticulos(e.txtArticuloSelectedM)}),B.Sb(),B.Tb(6,"mat-autocomplete",32,33),B.bc("optionSelected",function(){return B.xc(t),B.fc(2).setPresentacionesMerma()}),B.Dc(8,fo,2,2,"mat-option",13),B.Sb(),B.Sb(),B.Tb(9,"mat-form-field",10),B.Tb(10,"input",60),B.bc("ngModelChange",function(e){return B.xc(t),B.fc(2).detalleMerma.cantidad_utilizada=e}),B.Sb(),B.Sb(),B.Tb(11,"mat-form-field",10),B.Tb(12,"input",61),B.bc("ngModelChange",function(e){return B.xc(t),B.fc(2).detalleMerma.cantidad=e}),B.Sb(),B.Sb(),B.Tb(13,"div",15),B.Dc(14,ho,2,2,"button",36),B.Sb(),B.Sb()}if(2&t){const t=B.tc(7),e=B.fc(2);B.Cb(5),B.lc("ngModel",e.txtArticuloSelectedM)("ngModelOptions",B.nc(8,ze))("matAutocomplete",t),B.Cb(1),B.lc("displayWith",e.displayArticuloMerma),B.Cb(2),B.lc("ngForOf",e.filteredArticulos),B.Cb(2),B.lc("ngModel",e.detalleMerma.cantidad_utilizada),B.Cb(2),B.lc("ngModel",e.detalleMerma.cantidad),B.Cb(2),B.lc("ngIf",!e.saveToDB)}}function vo(t,e){1&t&&B.Ob(0,"hr")}function Co(t,e){1&t&&(B.Tb(0,"th",53),B.Fc(1,"Art\xedculo"),B.Sb())}function To(t,e){if(1&t&&(B.Tb(0,"td",54),B.Fc(1),B.Sb()),2&t){const t=e.$implicit,o=B.fc(3);B.Cb(1),B.Hc(" ",o.saveToDB?t.articulo.descripcion:o.getDescripcionArticulo(t.articulo),"")}}function Mo(t,e){1&t&&(B.Tb(0,"th",53),B.Fc(1,"Presentaci\xf3n"),B.Sb())}function Do(t,e){if(1&t&&(B.Tb(0,"td",54),B.Fc(1),B.Sb()),2&t){const t=e.$implicit,o=B.fc(3);B.Cb(1),B.Hc(" ",o.saveToDB?t.presentacion.descripcion:o.getDescripcionPresentacion(t.presentacion)," ")}}function Io(t,e){1&t&&(B.Tb(0,"th",55),B.Fc(1,"Cantidad a Utilizar"),B.Sb())}function Fo(t,e){if(1&t&&(B.Tb(0,"td",56),B.Fc(1),B.gc(2,"number"),B.Sb()),2&t){const t=e.$implicit;B.Cb(1),B.Gc(B.ic(2,1,t.cantidad_utilizada,"1.2-2"))}}function xo(t,e){1&t&&(B.Tb(0,"th",55),B.Fc(1,"Cantidad"),B.Sb())}function _o(t,e){if(1&t&&(B.Tb(0,"td",56),B.Fc(1),B.gc(2,"number"),B.Sb()),2&t){const t=e.$implicit;B.Cb(1),B.Gc(B.ic(2,1,t.cantidad,"1.2-2"))}}function Oo(t,e){1&t&&(B.Tb(0,"th",53),B.Fc(1,"\xa0"),B.Sb())}function yo(t,e){if(1&t){const t=B.Ub();B.Tb(0,"button",25),B.bc("click",function(){B.xc(t);const e=B.fc().$implicit;return B.fc(3).getDetalleEgreso(e.egreso,e.egreso_detalle)}),B.Fc(1," Editar "),B.Sb()}if(2&t){const t=B.fc(4);B.lc("disabled",B.nc(1,ye).indexOf(+t.egreso.estatus_movimiento)>=0||t.bloqueoBotones)}}function ko(t,e){if(1&t){const t=B.Ub();B.Tb(0,"button",37),B.bc("click",function(){B.xc(t);const e=B.fc().$implicit;return B.fc(3).editFromDetailMerma(e.articulo)}),B.Fc(1," Editar "),B.Sb()}if(2&t){const t=B.fc(4);B.lc("disabled",B.nc(1,ye).indexOf(+t.egreso.estatus_movimiento)>=0||t.bloqueoBotones)}}function Eo(t,e){if(1&t){const t=B.Ub();B.Tb(0,"button",37),B.bc("click",function(){B.xc(t);const e=B.fc().$implicit;return B.fc(3).removeFromDetailMerma(e.articulo)}),B.Fc(1," Eliminar "),B.Sb()}if(2&t){const t=B.fc(4);B.lc("disabled",B.nc(1,ye).indexOf(+t.egreso.estatus_movimiento)>=0||t.bloqueoBotones)}}function wo(t,e){if(1&t&&(B.Tb(0,"td",54),B.Dc(1,yo,2,2,"button",17),B.Dc(2,ko,2,2,"button",36),B.Dc(3,Eo,2,2,"button",36),B.Sb()),2&t){const t=B.fc(3);B.Cb(1),B.lc("ngIf",t.saveToDB),B.Cb(1),B.lc("ngIf",!t.saveToDB),B.Cb(1),B.lc("ngIf",!t.saveToDB)}}function Ao(t,e){1&t&&B.Ob(0,"tr",57)}function Bo(t,e){1&t&&B.Ob(0,"tr",58)}function $o(t,e){if(1&t&&(B.Tb(0,"table",40),B.Rb(1,41),B.Dc(2,Co,2,0,"th",42),B.Dc(3,To,2,1,"td",43),B.Qb(),B.Rb(4,44),B.Dc(5,Mo,2,0,"th",42),B.Dc(6,Do,2,1,"td",43),B.Qb(),B.Rb(7,62),B.Dc(8,Io,2,0,"th",46),B.Dc(9,Fo,3,4,"td",47),B.Qb(),B.Rb(10,45),B.Dc(11,xo,2,0,"th",46),B.Dc(12,_o,3,4,"td",47),B.Qb(),B.Rb(13,50),B.Dc(14,Oo,2,0,"th",42),B.Dc(15,wo,4,3,"td",43),B.Qb(),B.Dc(16,Ao,1,0,"tr",51),B.Dc(17,Bo,1,0,"tr",52),B.Sb()),2&t){const t=B.fc(2);B.lc("dataSource",t.dataSourceM),B.Cb(16),B.lc("matHeaderRowDef",t.displayedColumnsM),B.Cb(1),B.lc("matRowDefColumns",t.displayedColumnsM)}}function Ro(t,e){if(1&t&&(B.Tb(0,"mat-card",0),B.Tb(1,"mat-card-title"),B.Tb(2,"h4"),B.Fc(3),B.Dc(4,mo,3,0,"button",1),B.Dc(5,po,3,0,"button",1),B.Sb(),B.Sb(),B.Tb(6,"mat-card-content"),B.Dc(7,So,15,9,"form",2),B.Dc(8,vo,1,0,"hr",3),B.Dc(9,$o,18,3,"table",29),B.Sb(),B.Sb()),2&t){const t=B.fc();B.Cb(3),B.Ic(" Merma ",t.saveToDB?"No.":""," ",t.egreso.egreso," "),B.Cb(1),B.lc("ngIf",!t.showDetalleEgresoForm),B.Cb(1),B.lc("ngIf",t.showDetalleEgresoForm),B.Cb(2),B.lc("ngIf",t.showDetalleEgresoForm),B.Cb(1),B.lc("ngIf",t.detallesMerma.length>0),B.Cb(1),B.lc("ngIf",t.detallesMerma.length>0)}}let Ho=(()=>{class t{constructor(t,e,o,i,n,a,c,r,s){this.snackBar=t,this.ls=e,this.egresoSrvc=o,this.tipoMovimientoSrvc=i,this.bodegaSrvc=n,this.articuloSrvc=a,this.proveedorSrvc=c,this.transformacionSrvc=r,this.presentacionSrvc=s,this.saveToDB=!0,this.egresoSavedEv=new B.o,this.showEgresoForm=!0,this.showDetalleEgresoForm=!0,this.detallesEgreso=[],this.detallesMerma=[],this.displayedColumns=["articulo","presentacion","cantidad","precio_unitario","precio_total","editItem"],this.displayedColumnsM=["cantidad_utilizada","articulo","presentacion","cantidad","editItem"],this.tiposMovimiento=[],this.tiposMovimientoIngreso=[],this.bodegas=[],this.articulos=[],this.filteredArticulos=[],this.proveedores=[],this.filteredProveedores=[],this.presentaciones=[],this.fltrPresentaciones=[],this.fltrPresentacionesMerma=[],this.keyboardLayout=w.b.IDIOMA_TECLADO,this.esMovil=!1,this.bloqueoBotones=!1,this.txtArticuloSelected=void 0,this.txtArticuloSelectedM=void 0,this.txtProveedorSelected=void 0,this.loadTiposMovimiento=(t=!0)=>{this.tipoMovimientoSrvc.get(t?{egreso:1}:{ingreso:1}).subscribe(e=>{e&&(t?this.tiposMovimiento=e:this.tiposMovimientoIngreso=e)})},this.loadBodegas=()=>{this.bodegaSrvc.get({sede:this.ls.get(w.b.usrTokenVar).sede||0}).subscribe(t=>{t&&(this.bodegas=t)})},this.loadProveedores=()=>{this.proveedorSrvc.get().subscribe(t=>{t&&(this.proveedores=t)})},this.loadPresentaciones=()=>{this.presentacionSrvc.get().subscribe(t=>{t&&(this.presentaciones=t)})},this.resetEgreso=()=>{this.egreso={egreso:null,tipo_movimiento:null,bodega:null,fecha:A().format(w.b.dbDateFormat),usuario:this.ls.get(w.b.usrTokenVar).idusr||0,estatus_movimiento:1,traslado:0},this.resetDetalleEgreso(),this.updateTableDataSource(),this.resetDetalleMerma(),this.updateTableDataSourceM()},this.onSubmit=()=>{this.bloqueoBotones=!0,this.egresoSrvc.save(this.egreso).subscribe(t=>{t.exito&&(this.egresoSavedEv.emit(),this.resetEgreso(),this.egreso={egreso:t.egreso.egreso,tipo_movimiento:t.egreso.tipo_movimiento,fecha:t.egreso.fecha,bodega:t.egreso.bodega,creacion:t.egreso.creacion,usuario:t.egreso.usuario,estatus_movimiento:t.egreso.estatus_movimiento,traslado:t.egreso.traslado},this.loadDetalleEgreso(this.egreso.egreso)),this.bloqueoBotones=!1})},this.confirmarEgreso=()=>{this.egreso.estatus_movimiento=2,this.onSubmit()},this.loadArticulos=()=>{this.articuloSrvc.getArticulosIngreso().subscribe(t=>{t&&(this.articulos=t)})},this.resetDetalleEgreso=()=>{this.detalleEgreso={egreso_detalle:null,egreso:this.egreso.egreso?this.egreso.egreso:null,articulo:null,cantidad:null,precio_unitario:null,precio_total:null,presentacion:0},this.txtArticuloSelected=void 0},this.resetDetalleMerma=()=>{this.detalleMerma={egreso_detalle:null,egreso:this.egreso.egreso?this.egreso.egreso:null,articulo:null,cantidad:null,precio_unitario:null,precio_total:null,presentacion:0},this.txtArticuloSelectedM=void 0},this.loadDetalleEgreso=(t=+this.egreso.egreso)=>{this.egresoSrvc.getDetalle(t,{egreso:t}).subscribe(t=>{t&&(this.detallesEgreso=t,this.updateTableDataSource())})},this.getDetalleEgreso=(t=+this.egreso.egreso,e)=>{this.egresoSrvc.getDetalle(t,{egreso_detalle:e}).subscribe(t=>{t&&(this.detalleEgreso={egreso_detalle:t[0].egreso_detalle,egreso:t[0].egreso,articulo:t[0].articulo.articulo,cantidad:+t[0].cantidad,precio_unitario:+t[0].precio_unitario,precio_total:+t[0].precio_total,presentacion:t[0].presentacion.presentacion},this.setPresentaciones(),this.saveToDB||this.setPresentacionesMerma(),this.txtArticuloSelected=t[0].articulo,this.showDetalleEgresoForm=!0)})},this.onSubmitDetail=()=>{this.bloqueoBotones=!0,this.detalleEgreso.egreso=this.egreso.egreso,this.egresoSrvc.saveDetalle(this.detalleEgreso).subscribe(t=>{t.exito?(this.loadDetalleEgreso(),this.resetDetalleEgreso(),this.snackBar.open("Egreso guardado con \xe9xito...","Egreso",{duration:3e3})):this.snackBar.open(`ERROR: ${t.mensaje}`,"Egreso",{duration:3e3}),this.bloqueoBotones=!1})},this.addToDetail=()=>{this.detalleEgreso.cantidad>0?(this.detallesEgreso.splice(this.detallesEgreso.findIndex(t=>+t.articulo==+this.detalleEgreso.articulo),1),this.detallesEgreso.push(this.detalleEgreso),this.resetDetalleEgreso(),this.updateTableDataSource()):this.snackBar.open("ERROR: La cantidad debe ser mayor a 0","Egreso",{duration:3e3})},this.addToDetailMerma=()=>{if(this.detalleMerma.cantidad>0&&this.detalleMerma.cantidad_utilizada>0){var t,e=this.detallesMerma.findIndex(t=>+t.articulo==+this.detalleMerma.articulo);e>-1&&this.detallesMerma.splice(e,1),t=this.articulos.filter(t=>+t.articulo==this.detalleMerma.articulo),this.detalleMerma.presentacion=t[0].presentacion_reporte,this.detallesMerma.push(this.detalleMerma),this.txtArticuloSelectedM=void 0,this.resetDetalleMerma(),this.updateTableDataSourceM()}else this.detalleMerma.cantidad<=0?this.snackBar.open("ERROR: La cantidad debe ser mayor a 0","Egreso",{duration:3e3}):this.detalleMerma.cantidad_utilizada<=0&&this.snackBar.open("ERROR: La cantidad a utilizar debe ser mayor a 0","Egreso",{duration:3e3})},this.editFromDetail=t=>{var e=this.detallesEgreso.filter(e=>+e.articulo==+t)[0];this.detalleEgreso={egreso_detalle:e.egreso_detalle,egreso:e.egreso_detalle,articulo:e.articulo,cantidad:e.cantidad,precio_unitario:e.precio_unitario,precio_total:e.precio_unitario,presentacion:e.presentacion},this.setPresentaciones(!0),this.txtArticuloSelected=this.articulos.filter(t=>+t.articulo==this.detalleEgreso.articulo)[0]},this.editFromDetailMerma=t=>{var e=this.detallesMerma.filter(e=>+e.articulo==+t)[0];this.detalleMerma={egreso_detalle:e.egreso_detalle,egreso:e.egreso_detalle,articulo:e.articulo,cantidad:e.cantidad,precio_unitario:e.precio_unitario,precio_total:e.precio_unitario,presentacion:e.presentacion,cantidad_utilizada:e.cantidad_utilizada},this.setPresentacionesMerma(),this.txtArticuloSelectedM=this.articulos.filter(t=>+t.articulo==this.detalleMerma.articulo)[0]},this.removeFromDetailMerma=t=>this.detallesMerma.splice(this.detallesMerma.findIndex(e=>+e.articulo==+t),1),this.removeFromDetail=t=>this.detallesEgreso.splice(this.detallesEgreso.findIndex(e=>+e.articulo==+t),1),this.getDescripcionArticulo=t=>this.articulos.find(e=>+e.articulo==+t).descripcion||"",this.getDescripcionPresentacion=t=>this.presentaciones.find(e=>+e.presentacion==+t).descripcion||"",this.updateTableDataSource=()=>{this.dataSource=new p.l(this.detallesEgreso),this.dataSource.filterPredicate=(t,e)=>t.articulo.descripcion.toLowerCase().includes(e)},this.updateTableDataSourceM=()=>{this.dataSourceM=new p.l(this.detallesMerma)},this.filtrarArticulos=t=>{if(t&&"string"==typeof t){const e=t.toLowerCase();this.filteredArticulos=this.articulos.filter(t=>t.descripcion.toLowerCase().includes(e))}else this.filteredArticulos=this.articulos},this.setPresentaciones=(t=!1)=>{this.fltrPresentaciones=[];const e=this.articulos.findIndex(t=>+t.articulo==+this.detalleEgreso.articulo),o=this.articulos[e];this.fltrPresentaciones=this.presentaciones.filter(t=>+t.medida.medida==+o.presentacion.medida),t||(this.detalleEgreso.presentacion=null)},this.setPresentacionesMerma=()=>{this.fltrPresentacionesMerma=[];const t=this.articulos.findIndex(t=>+t.articulo==+this.detalleMerma.articulo),e=this.articulos[t];this.fltrPresentacionesMerma=this.presentaciones.filter(t=>+t.medida.medida==+e.presentacion.medida)},this.displayArticulo=t=>{if(t)return this.detalleEgreso.articulo=t.articulo,t.descripcion},this.displayArticuloMerma=t=>{if(t)return this.detalleMerma.articulo=t.articulo,t.descripcion},this.filtrarProveedores=t=>{if(t&&"string"==typeof t){const e=t.toLowerCase();this.filteredProveedores=this.proveedores.filter(t=>t.razon_social.toLowerCase().includes(e)||t.nit.toLowerCase().includes(e))}else this.filteredProveedores=this.proveedores},this.displayProveedor=t=>{if(t)return this.egreso.proveedor=t.proveedor,`(${t.nit}) ${t.razon_social}`},this.applyFilter=t=>{this.dataSource.filter=t}}ngOnInit(){this.esMovil=this.ls.get(w.b.usrTokenVar).enmovil||!1,this.resetEgreso(),this.loadTiposMovimiento(),this.loadTiposMovimiento(!1),this.loadBodegas(),this.loadArticulos(),this.loadProveedores(),this.loadPresentaciones(),this.saveToDB||(this.displayedColumns=["articulo","presentacion","cantidad","editItem"])}}return t.\u0275fac=function(e){return new(e||t)(B.Nb(v.b),B.Nb($.a),B.Nb(de),B.Nb(V.a),B.Nb(K.a),B.Nb(Q.a),B.Nb(L.a),B.Nb(he),B.Nb(J.a))},t.\u0275cmp=B.Hb({type:t,selectors:[["app-form-egreso"]],inputs:{egreso:"egreso",saveToDB:"saveToDB"},outputs:{egresoSavedEv:"egresoSavedEv"},decls:12,vars:8,consts:[[1,"mat-elevation-z4","fullWidth"],["mat-icon-button","","type","button","color","accent",3,"click",4,"ngIf"],["novalidate","",3,"ngSubmit",4,"ngIf"],[4,"ngIf"],["class","mat-elevation-z4 fullWidth",4,"ngIf"],["mat-icon-button","","type","button","color","accent",3,"click"],[1,"iconFontSize"],["novalidate","",3,"ngSubmit"],["frmEgreso","ngForm"],["class","fullWidth",4,"ngIf"],[1,"fullWidth"],["matInput","","type","date","placeholder","Fecha","name","fecha","required","",3,"ngModel","ngModelChange"],["name","bodega","required","",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["name","traslado","class","fullWidth",3,"ngModel","ngModelChange",4,"ngIf"],["align","end"],["mat-raised-button","","type","submit","color","accent","class","btnAccion",3,"disabled",4,"ngIf"],["mat-raised-button","","type","button","color","accent","class","btnAccion",3,"disabled","click",4,"ngIf"],["mat-raised-button","","type","button","color","accent",3,"click",4,"ngIf"],["name","tipo_movimiento","required","",3,"ngModel","ngModelChange"],[3,"value"],["name","traslado",1,"fullWidth",3,"ngModel","ngModelChange"],["name","bodega_destino",3,"ngModel","required","ngModelChange"],["name","tipo_movimiento_destino",3,"ngModel","required","ngModelChange"],["mat-raised-button","","type","submit","color","accent",1,"btnAccion",3,"disabled"],["mat-raised-button","","type","button","color","accent",1,"btnAccion",3,"disabled","click"],["mat-raised-button","","type","button","color","accent",3,"click"],["matInput","","placeholder","Buscar",3,"matKeyboard","input",4,"ngIf"],["matInput","","placeholder","Buscar",3,"keyup",4,"ngIf"],["mat-table","","class","mat-elevation-z4 full-width",3,"dataSource",4,"ngIf"],["frmDetalleEgreso","ngForm"],["type","text","placeholder","Art\xedculo","matInput","","required","",3,"ngModel","ngModelOptions","matAutocomplete","ngModelChange","keyup"],[3,"displayWith","optionSelected"],["autoArticulos","matAutocomplete"],["name","presentacion","required","",3,"ngModel","ngModelChange"],["matInput","","placeholder","Cantidad","name","cantidad","type","number","step","0.01","required","",3,"ngModel","ngModelChange","change"],["mat-raised-button","","type","button","color","accent",3,"disabled","click",4,"ngIf"],["mat-raised-button","","type","button","color","accent",3,"disabled","click"],["matInput","","placeholder","Buscar",3,"matKeyboard","input"],["matInput","","placeholder","Buscar",3,"keyup"],["mat-table","",1,"mat-elevation-z4","full-width",3,"dataSource"],["matColumnDef","articulo"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","","class","text-wrap",4,"matCellDef"],["matColumnDef","presentacion"],["matColumnDef","cantidad"],["mat-header-cell","","class","text-right",4,"matHeaderCellDef"],["mat-cell","","class","text-right",4,"matCellDef"],["matColumnDef","precio_unitario"],["matColumnDef","precio_total"],["matColumnDef","editItem"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell","",1,"text-wrap"],["mat-header-cell","",1,"text-right"],["mat-cell","",1,"text-right"],["mat-header-row",""],["mat-row",""],["frmMerma","ngForm"],["type","number","step","0.01","matInput","","placeholder","Cantidad a Utilizar","name","cantidad_utilizar","required","",3,"ngModel","ngModelChange"],["matInput","","placeholder","Cantidad","name","cantidad","type","number","step","0.01","required","",3,"ngModel","ngModelChange"],["matColumnDef","cantidad_utilizada"]],template:function(t,e){1&t&&(B.Tb(0,"mat-card",0),B.Tb(1,"mat-card-title"),B.Tb(2,"h4"),B.Fc(3),B.Dc(4,Se,3,0,"button",1),B.Dc(5,ve,3,0,"button",1),B.Sb(),B.Sb(),B.Tb(6,"mat-card-content"),B.Dc(7,Ae,18,13,"form",2),B.Sb(),B.Sb(),B.Dc(8,Be,1,0,"hr",3),B.Dc(9,uo,13,9,"mat-card",4),B.Dc(10,go,1,0,"hr",3),B.Dc(11,Ro,10,7,"mat-card",4)),2&t&&(B.Cb(3),B.Hc(" Egreso",e.egreso.egreso?" No. "+e.egreso.egreso:""," "),B.Cb(1),B.lc("ngIf",!e.showEgresoForm),B.Cb(1),B.lc("ngIf",e.showEgresoForm),B.Cb(2),B.lc("ngIf",e.showEgresoForm),B.Cb(1),B.lc("ngIf",e.egreso.egreso||!e.saveToDB),B.Cb(1),B.lc("ngIf",e.egreso.egreso||!e.saveToDB),B.Cb(1),B.lc("ngIf",e.egreso.egreso||!e.saveToDB),B.Cb(1),B.lc("ngIf",!e.saveToDB))},directives:[u.a,u.h,i.m,u.c,S.a,l.a,a.r,a.l,a.m,d.b,b.b,a.c,a.p,a.k,a.n,d.f,f.a,i.l,G.m,h.a,_.c,_.a,a.o,y.a,p.k,p.c,p.e,p.b,p.g,p.j,p.d,p.a,p.f,p.i],pipes:[i.f],styles:[".full-width[_ngcontent-%COMP%]{width:100%}.iconFontSize[_ngcontent-%COMP%]{font-size:24pt}"]}),t})();const Po=["lstEgreso"],No=["frmEgreso"];let Uo=(()=>{class t{constructor(t){this.ls=t,this.setEgreso=t=>{this.egreso=t,this.frmEgreso.resetDetalleEgreso(),this.frmEgreso.loadDetalleEgreso(+this.egreso.egreso)},this.refreshEgresoList=()=>{this.lstEgresoComponent.loadEgresos()},this.egreso={egreso:null,tipo_movimiento:null,bodega:null,fecha:A().format(w.b.dbDateFormat),usuario:this.ls.get(w.b.usrTokenVar).idusr||0,estatus_movimiento:1,traslado:0}}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)(B.Nb($.a))},t.\u0275cmp=B.Hb({type:t,selectors:[["app-egreso"]],viewQuery:function(t,e){if(1&t&&(B.Kc(Po,1),B.Kc(No,1)),2&t){let t;B.sc(t=B.cc())&&(e.lstEgresoComponent=t.first),B.sc(t=B.cc())&&(e.frmEgreso=t.first)}},decls:7,vars:1,consts:[[1,"row"],[1,"col","m5","s12"],[3,"getEgresoEv"],["lstEgreso",""],[1,"col","m7","s12"],[3,"egreso","egresoSavedEv"],["frmEgreso",""]],template:function(t,e){1&t&&(B.Tb(0,"div",0),B.Tb(1,"div",1),B.Tb(2,"app-lista-egreso",2,3),B.bc("getEgresoEv",function(t){return e.setEgreso(t)}),B.Sb(),B.Sb(),B.Tb(4,"div",4),B.Tb(5,"app-form-egreso",5,6),B.bc("egresoSavedEv",function(){return e.refreshEgresoList()}),B.Sb(),B.Sb(),B.Sb()),2&t&&(B.Cb(5),B.lc("egreso",e.egreso))},directives:[fe,Ho],styles:[""]}),t})();var Go=o("quSY");function zo(t,e){if(1&t){const t=B.Ub();B.Tb(0,"input",10),B.bc("ngModelChange",function(e){return B.xc(t),B.fc().categoria.descripcion=e}),B.Sb()}if(2&t){const t=B.fc();B.lc("matKeyboard",t.keyboardLayout)("ngModel",t.categoria.descripcion)}}function qo(t,e){if(1&t){const t=B.Ub();B.Tb(0,"input",11),B.bc("ngModelChange",function(e){return B.xc(t),B.fc().categoria.descripcion=e}),B.Sb()}if(2&t){const t=B.fc();B.lc("ngModel",t.categoria.descripcion)}}function jo(t,e){if(1&t){const t=B.Ub();B.Tb(0,"mat-chip",12),B.bc("click",function(){B.xc(t);const o=e.$implicit;return B.fc().categoria=o}),B.Fc(1),B.Sb()}if(2&t){const t=e.$implicit;B.Cb(1),B.Hc(" ",t.descripcion," ")}}let Wo=(()=>{class t{constructor(t,e,o){this.snackBar=t,this.ls=e,this.articuloSrvc=o,this.categoriaGrupoSvd=new B.o,this.onChangeSubCategoriaEv=new B.o,this.categorias=[],this.categoriasGruposPadre=[],this.categoriasGrupos=[],this.editCategoriaMode=!1,this.editSubCategoriaMode=!1,this.showCategoriasForm=!0,this.keyboardLayout=w.b.IDIOMA_TECLADO,this.esMovil=!1,this.impresoras=[],this.resetCategoria=()=>{this.categoria={categoria:null,sede:this.ls.get(w.b.usrTokenVar).sede||0,descripcion:null},this.resetCategoriaGrupo(),this.editCategoriaMode=!1},this.resetCategoriaGrupo=()=>{this.categoriaGrupo={categoria_grupo:null,categoria:this.categoria.categoria,categoria_grupo_grupo:null,descripcion:null,receta:0,impresora:null,descuento:0,antecesores:null},this.editSubCategoriaMode=!1},this.loadCategorias=()=>{this.articuloSrvc.getCategorias({sede:+this.ls.get(w.b.usrTokenVar).sede||0}).subscribe(t=>{t&&(this.categorias=t)})},this.onCategoriaSelected=t=>this.loadSubCategorias(+t.value.categoria),this.loadSubCategorias=t=>{this.articuloSrvc.getCategoriasGrupos({categoria:+t}).subscribe(t=>{t&&(this.categoriasGruposPadre=this.articuloSrvc.adaptCategoriaGrupoResponse(t),this.categoriasGrupos=this.categoriasGruposPadre)})},this.loadImpresoras=()=>{this.articuloSrvc.getImpresoras({sede:+this.ls.get(w.b.usrTokenVar).sede||0}).subscribe(t=>{t&&(this.impresoras=t)})},this.onSubCategoriaPadreSelected=t=>this.loadSubCategoriasSubcategorias(+t.value),this.loadSubCategoriasSubcategorias=t=>{this.articuloSrvc.getCategoriasGrupos({categoria_grupo_grupo:t}).subscribe(t=>{t&&(this.categoriasGrupos=this.articuloSrvc.adaptCategoriaGrupoResponse(t))})},this.onSubmitCategoria=()=>{this.articuloSrvc.saveCategoria(this.categoria).subscribe(t=>{t.exito?(this.editCategoriaMode=!1,this.resetCategoria(),this.loadCategorias(),this.categoriaGrupoSvd.emit(),this.snackBar.open("Grabada con \xe9xito.","Categor\xeda",{duration:5e3})):this.snackBar.open(`ERROR: ${t.mensaje}`,"Categor\xeda",{duration:5e3})})},this.onSubCategoriaSelected=t=>this.onChangeSubCategoriaEv.emit(+t.value.categoria_grupo),this.onSubmitSubCategoria=()=>{this.articuloSrvc.saveCategoriaGrupo(this.categoriaGrupo).subscribe(t=>{t.exito?(this.resetCategoriaGrupo(),this.loadSubCategorias(+this.categoria.categoria),this.snackBar.open("Grabada con \xe9xito.","Sub - Categor\xeda",{duration:5e3})):this.snackBar.open(`ERROR: ${t.mensaje}`,"Sub - Categor\xeda",{duration:5e3})})}}ngOnInit(){this.esMovil=this.ls.get(w.b.usrTokenVar).enmovil||!1,this.resetCategoria(),this.loadCategorias(),this.loadImpresoras()}}return t.\u0275fac=function(e){return new(e||t)(B.Nb(v.b),B.Nb($.a),B.Nb(Q.a))},t.\u0275cmp=B.Hb({type:t,selectors:[["app-categoria-producto"]],outputs:{categoriaGrupoSvd:"categoriaGrupoSvd",onChangeSubCategoriaEv:"onChangeSubCategoriaEv"},decls:18,vars:4,consts:[[1,"mat-elevation-z4"],["novalidate",""],["frmCategoria","ngForm"],[1,"fullWidth"],["type","text","matInput","","placeholder","Descripci\xf3n de la categor\xeda","name","descripcion","minlength","1","maxlength","150","required","",3,"matKeyboard","ngModel","ngModelChange",4,"ngIf"],["type","text","matInput","","placeholder","Descripci\xf3n de la categor\xeda","name","descripcion","minlength","1","maxlength","150","required","",3,"ngModel","ngModelChange",4,"ngIf"],["align","end"],["mat-raised-button","","type","button","color","accent",1,"btnAccion",3,"disabled","click"],["mat-raised-button","","type","button","color","warn",3,"click"],["color","accent","selected","",3,"click",4,"ngFor","ngForOf"],["type","text","matInput","","placeholder","Descripci\xf3n de la categor\xeda","name","descripcion","minlength","1","maxlength","150","required","",3,"matKeyboard","ngModel","ngModelChange"],["type","text","matInput","","placeholder","Descripci\xf3n de la categor\xeda","name","descripcion","minlength","1","maxlength","150","required","",3,"ngModel","ngModelChange"],["color","accent","selected","",3,"click"]],template:function(t,e){if(1&t&&(B.Tb(0,"mat-card",0),B.Tb(1,"mat-card-title"),B.Tb(2,"h4"),B.Fc(3,"Categor\xedas"),B.Sb(),B.Sb(),B.Tb(4,"mat-card-content"),B.Tb(5,"form",1,2),B.Tb(7,"mat-form-field",3),B.Dc(8,zo,1,2,"input",4),B.Dc(9,qo,1,1,"input",5),B.Sb(),B.Tb(10,"div",6),B.Tb(11,"button",7),B.bc("click",function(){return e.onSubmitCategoria()}),B.Fc(12," Guardar "),B.Sb(),B.Tb(13,"button",8),B.bc("click",function(){return e.resetCategoria()}),B.Fc(14," Cancelar "),B.Sb(),B.Sb(),B.Sb(),B.Ob(15,"hr"),B.Tb(16,"mat-chip-list"),B.Dc(17,jo,2,1,"mat-chip",9),B.Sb(),B.Sb(),B.Sb()),2&t){const t=B.tc(6);B.Cb(8),B.lc("ngIf",!e.esMovil),B.Cb(1),B.lc("ngIf",e.esMovil),B.Cb(2),B.lc("disabled",!t.form.valid),B.Cb(6),B.lc("ngForOf",e.categorias)}},directives:[u.a,u.h,u.c,a.r,a.l,a.m,d.b,i.m,S.a,O.b,i.l,b.b,y.a,a.c,a.g,a.f,a.p,a.k,a.n,O.a],styles:[".fullWidth[_ngcontent-%COMP%]{width:100%}.iconFontSize[_ngcontent-%COMP%]{font-size:18pt}"]}),t})();function Lo(t,e){if(1&t&&(B.Tb(0,"mat-option",19),B.Fc(1),B.Sb()),2&t){const t=e.$implicit;B.lc("value",t.categoria),B.Cb(1),B.Hc(" ",t.descripcion," ")}}function Vo(t,e){if(1&t){const t=B.Ub();B.Tb(0,"input",20),B.bc("ngModelChange",function(e){return B.xc(t),B.fc().categoriaGrupo.descripcion=e}),B.Sb()}if(2&t){const t=B.fc();B.lc("matKeyboard",t.keyboardLayout)("ngModel",t.categoriaGrupo.descripcion)}}function Ko(t,e){if(1&t){const t=B.Ub();B.Tb(0,"input",21),B.bc("ngModelChange",function(e){return B.xc(t),B.fc().categoriaGrupo.descripcion=e}),B.Sb()}if(2&t){const t=B.fc();B.lc("ngModel",t.categoriaGrupo.descripcion)}}function Qo(t,e){if(1&t&&(B.Tb(0,"mat-option",19),B.Fc(1),B.Sb()),2&t){const t=e.$implicit;B.lc("value",t.impresora),B.Cb(1),B.Hc(" ",t.nombre," ")}}function Jo(t,e){if(1&t&&(B.Tb(0,"mat-option",19),B.Fc(1),B.Sb()),2&t){const t=e.$implicit;B.lc("value",t.bodega),B.Cb(1),B.Hc(" ",t.descripcion," ")}}function Xo(t,e){if(1&t){const t=B.Ub();B.Tb(0,"input",22),B.bc("ngModelChange",function(e){return B.xc(t),B.fc().categoriaGrupo.cuenta_contable=e}),B.Sb()}if(2&t){const t=B.fc();B.lc("matKeyboard",t.keyboardLayout)("ngModel",t.categoriaGrupo.cuenta_contable)}}function Yo(t,e){if(1&t){const t=B.Ub();B.Tb(0,"input",23),B.bc("ngModelChange",function(e){return B.xc(t),B.fc().categoriaGrupo.cuenta_contable=e}),B.Sb()}if(2&t){const t=B.fc();B.lc("ngModel",t.categoriaGrupo.cuenta_contable)}}function Zo(t,e){if(1&t&&(B.Tb(0,"mat-option",24),B.Fc(1),B.Sb()),2&t){const t=e.$implicit,o=B.fc();B.lc("value",t.categoria_grupo)("disabled",+t.categoria_grupo==+o.categoriaGrupo.categoria_grupo),B.Cb(1),B.Hc(" ",t.descripcion," ")}}function ti(t,e){if(1&t){const t=B.Ub();B.Tb(0,"mat-chip",25),B.bc("click",function(){B.xc(t);const o=e.$implicit,i=B.fc();return i.categoria=o,i.loadSubCategorias(o.categoria)}),B.Fc(1),B.Sb()}if(2&t){const t=e.$implicit;B.Cb(1),B.Hc(" ",t.descripcion," ")}}function ei(t,e){if(1&t){const t=B.Ub();B.Tb(0,"mat-chip",26),B.bc("click",function(){B.xc(t);const o=e.$implicit;return B.fc().setCatGrp(o)}),B.Fc(1),B.Sb()}if(2&t){const t=e.$implicit;B.Cb(1),B.Hc(" ",t.descripcion," ")}}let oi=(()=>{class t{constructor(t,e,o,i){this.snackBar=t,this.articuloSrvc=e,this.bodegaSrvc=o,this.ls=i,this.categorias=[],this.impresoras=[],this.categoriasGruposPadre=[],this.categoriasGrupos=[],this.keyboardLayout=w.b.IDIOMA_TECLADO,this.esMovil=!1,this.bodegas=[],this.loadCategorias=()=>{this.articuloSrvc.getCategorias({sede:+this.ls.get(w.b.usrTokenVar).sede||0}).subscribe(t=>{t&&(this.categorias=t)})},this.loadImpresoras=()=>{this.articuloSrvc.getImpresoras({sede:+this.ls.get(w.b.usrTokenVar).sede||0}).subscribe(t=>{t&&(this.impresoras=t)})},this.loadBodegas=()=>{this.bodegaSrvc.get({sede:this.ls.get(w.b.usrTokenVar).sede||0}).subscribe(t=>{t&&(this.bodegas=t)})},this.loadSubCategorias=t=>{this.resetCategoriaGrupo(),this.categoriaGrupo.categoria=t,this.articuloSrvc.getCategoriasGrupos({categoria:+t}).subscribe(t=>{t&&(this.categoriasGruposPadre=this.articuloSrvc.adaptCategoriaGrupoResponse(t),this.categoriasGrupos=JSON.parse(JSON.stringify(this.categoriasGruposPadre)))})},this.resetCategoriaGrupo=()=>{this.categoriaGrupo={categoria_grupo:null,categoria:null,categoria_grupo_grupo:null,descripcion:null,receta:0,impresora:null,descuento:0,antecesores:null}},this.onSubmitSubCategoria=()=>{this.articuloSrvc.saveCategoriaGrupo(this.categoriaGrupo).subscribe(t=>{t.exito?(this.loadSubCategorias(+this.categoriaGrupo.categoria),this.resetCategoriaGrupo(),this.snackBar.open("Grabada con \xe9xito.","Sub - Categor\xeda",{duration:5e3})):this.snackBar.open(`ERROR: ${t.mensaje}`,"Sub - Categor\xeda",{duration:5e3})})},this.setCatGrp=t=>{this.categoriaGrupo=t},this.resetCategoriaGrupo()}ngOnInit(){this.esMovil=this.ls.get(w.b.usrTokenVar).enmovil||!1,this.loadCategorias(),this.loadImpresoras(),this.loadBodegas()}}return t.\u0275fac=function(e){return new(e||t)(B.Nb(v.b),B.Nb(Q.a),B.Nb(K.a),B.Nb($.a))},t.\u0275cmp=B.Hb({type:t,selectors:[["app-sub-categoria-producto"]],decls:43,vars:15,consts:[[1,"mat-elevation-z4"],["novalidate",""],["frmCategoriaGrupo","ngForm"],[1,"fullWidth"],["name","categoria","required","",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["type","text","matInput","","placeholder","Descripci\xf3n de la sub - categor\xeda","name","descripcion","minlength","1","maxlength","45","required","",3,"matKeyboard","ngModel","ngModelChange",4,"ngIf"],["type","text","matInput","","placeholder","Descripci\xf3n de la sub - categor\xeda","name","descripcion","minlength","1","maxlength","45","required","",3,"ngModel","ngModelChange",4,"ngIf"],["name","impresora","required","",3,"ngModel","ngModelChange"],["name","bodega","required","",3,"ngModel","ngModelChange"],["type","text","matInput","","placeholder","Cuenta contable (si aplica)","name","cuenta_contable","minlength","0","maxlength","10",3,"matKeyboard","ngModel","ngModelChange",4,"ngIf"],["type","text","matInput","","placeholder","Cuenta contable (si aplica)","name","cuenta_contable","minlength","0","maxlength","10",3,"ngModel","ngModelChange",4,"ngIf"],["name","categoriaGrupoPadre",3,"ngModel","ngModelChange"],[3,"value","disabled",4,"ngFor","ngForOf"],["align","end"],["mat-raised-button","","type","button","color","accent",1,"btnAccion",3,"disabled","click"],["mat-raised-button","","type","button","color","warn",3,"click"],["color","accent","selected","",3,"click",4,"ngFor","ngForOf"],["color","warn","selected","",3,"click",4,"ngFor","ngForOf"],[3,"value"],["type","text","matInput","","placeholder","Descripci\xf3n de la sub - categor\xeda","name","descripcion","minlength","1","maxlength","45","required","",3,"matKeyboard","ngModel","ngModelChange"],["type","text","matInput","","placeholder","Descripci\xf3n de la sub - categor\xeda","name","descripcion","minlength","1","maxlength","45","required","",3,"ngModel","ngModelChange"],["type","text","matInput","","placeholder","Cuenta contable (si aplica)","name","cuenta_contable","minlength","0","maxlength","10",3,"matKeyboard","ngModel","ngModelChange"],["type","text","matInput","","placeholder","Cuenta contable (si aplica)","name","cuenta_contable","minlength","0","maxlength","10",3,"ngModel","ngModelChange"],[3,"value","disabled"],["color","accent","selected","",3,"click"],["color","warn","selected","",3,"click"]],template:function(t,e){if(1&t&&(B.Tb(0,"mat-card",0),B.Tb(1,"mat-card-title"),B.Tb(2,"h4"),B.Fc(3,"Sub - categor\xedas"),B.Sb(),B.Sb(),B.Tb(4,"mat-card-content"),B.Tb(5,"form",1,2),B.Tb(7,"mat-form-field",3),B.Tb(8,"mat-label"),B.Fc(9,"Categor\xeda"),B.Sb(),B.Tb(10,"mat-select",4),B.bc("ngModelChange",function(t){return e.categoriaGrupo.categoria=t}),B.Dc(11,Lo,2,2,"mat-option",5),B.Sb(),B.Sb(),B.Tb(12,"mat-form-field",3),B.Dc(13,Vo,1,2,"input",6),B.Dc(14,Ko,1,1,"input",7),B.Sb(),B.Tb(15,"mat-form-field",3),B.Tb(16,"mat-label"),B.Fc(17,"Impresora:"),B.Sb(),B.Tb(18,"mat-select",8),B.bc("ngModelChange",function(t){return e.categoriaGrupo.impresora=t}),B.Dc(19,Qo,2,2,"mat-option",5),B.Sb(),B.Sb(),B.Tb(20,"mat-form-field",3),B.Tb(21,"mat-label"),B.Fc(22,"Sacar de la bodega:"),B.Sb(),B.Tb(23,"mat-select",9),B.bc("ngModelChange",function(t){return e.categoriaGrupo.bodega=t}),B.Dc(24,Jo,2,2,"mat-option",5),B.Sb(),B.Sb(),B.Tb(25,"mat-form-field",3),B.Dc(26,Xo,1,2,"input",10),B.Dc(27,Yo,1,1,"input",11),B.Sb(),B.Tb(28,"mat-form-field",3),B.Tb(29,"mat-label"),B.Fc(30,"Anidar dentro de"),B.Sb(),B.Tb(31,"mat-select",12),B.bc("ngModelChange",function(t){return e.categoriaGrupo.categoria_grupo_grupo=t}),B.Dc(32,Zo,2,3,"mat-option",13),B.Sb(),B.Sb(),B.Tb(33,"div",14),B.Tb(34,"button",15),B.bc("click",function(){return e.onSubmitSubCategoria()}),B.Fc(35," Guardar "),B.Sb(),B.Tb(36,"button",16),B.bc("click",function(){return e.resetCategoriaGrupo()}),B.Fc(37," Cancelar "),B.Sb(),B.Sb(),B.Sb(),B.Ob(38,"hr"),B.Tb(39,"mat-chip-list"),B.Dc(40,ti,2,1,"mat-chip",17),B.Sb(),B.Tb(41,"mat-chip-list"),B.Dc(42,ei,2,1,"mat-chip",18),B.Sb(),B.Sb(),B.Sb()),2&t){const t=B.tc(6);B.Cb(10),B.lc("ngModel",e.categoriaGrupo.categoria),B.Cb(1),B.lc("ngForOf",e.categorias),B.Cb(2),B.lc("ngIf",!e.esMovil),B.Cb(1),B.lc("ngIf",e.esMovil),B.Cb(4),B.lc("ngModel",e.categoriaGrupo.impresora),B.Cb(1),B.lc("ngForOf",e.impresoras),B.Cb(4),B.lc("ngModel",e.categoriaGrupo.bodega),B.Cb(1),B.lc("ngForOf",e.bodegas),B.Cb(2),B.lc("ngIf",!e.esMovil),B.Cb(1),B.lc("ngIf",e.esMovil),B.Cb(4),B.lc("ngModel",e.categoriaGrupo.categoria_grupo_grupo),B.Cb(1),B.lc("ngForOf",e.categoriasGruposPadre),B.Cb(2),B.lc("disabled",!t.form.valid),B.Cb(6),B.lc("ngForOf",e.categorias),B.Cb(2),B.lc("ngForOf",e.categoriasGrupos)}},directives:[u.a,u.h,u.c,a.r,a.l,a.m,d.b,d.f,f.a,a.p,a.k,a.n,i.l,i.m,S.a,O.b,G.m,b.b,y.a,a.c,a.g,a.f,O.a],styles:[""]}),t})();var ii=o("XiUz"),ni=o("Iab2"),ai=o("IHy4"),ci=o("TOq3");function ri(t,e){if(1&t&&(B.Tb(0,"mat-option",11),B.Fc(1),B.Sb()),2&t){const t=e.$implicit,o=B.fc();B.lc("value",t.sede)("disabled",+t.sede==+o.miSede),B.Cb(1),B.Hc(" ",t.nombre," ")}}function si(t,e){1&t&&B.Ob(0,"app-cargando")}let li=(()=>{class t{constructor(t,e,o,i,n){this.sedeSrvc=t,this.ls=e,this.snackBar=o,this.dialog=i,this.articuloSrvc=n,this.articulo=null,this.cargando=!1,this.sedes=[],this.params={},this.miSede=0,this.loadSedes=()=>{this.sedeSrvc.get().subscribe(t=>{t&&(this.sedes=t)})},this.onSubmit=()=>{this.dialog.open(W.a,{maxWidth:"400px",data:new W.b("Replicar art\xedculos","Este proceso replicar\xe1 TODOS los art\xedculos a las sedes seleccionadas. \xbfDesea continuar?","S\xed","No")}).afterClosed().subscribe(t=>{if(t){this.cargando=!0;const t={sedes:[],articulo:null};this.params.sede.forEach(e=>t.sedes.push({sede:+e})),this.articulo&&(t.articulo=+this.articulo.articulo),this.articuloSrvc.replicaArticulosEnSedes(t).subscribe(t=>{t.exito?this.snackBar.open(t.mensaje,"Replicar art\xedculos",{duration:3e3}):this.snackBar.open(`ERROR: ${t.mensaje}`,"Replicar art\xedculos",{duration:7e3}),this.params={},this.cargando=!1})}})}}ngOnInit(){this.miSede=this.ls.get(w.b.usrTokenVar).sede||0,this.loadSedes()}}return t.\u0275fac=function(e){return new(e||t)(B.Nb(ai.a),B.Nb($.a),B.Nb(v.b),B.Nb(I.b),B.Nb(Q.a))},t.\u0275cmp=B.Hb({type:t,selectors:[["app-replicar-asedes"]],inputs:{articulo:"articulo"},decls:18,vars:5,consts:[[1,"row"],[1,"col","m12","s12"],[1,"mat-elevation-z4","fullWidth"],["novalidate","",3,"ngSubmit"],["frmReplicaArticulosSedes","ngForm"],[2,"width","90%"],["name","sede","multiple","","required","",3,"ngModel","ngModelChange"],[3,"value","disabled",4,"ngFor","ngForOf"],["align","end"],["mat-raised-button","","type","submit","color","accent",1,"btnAccion",3,"disabled"],[4,"ngIf"],[3,"value","disabled"]],template:function(t,e){if(1&t){const t=B.Ub();B.Tb(0,"div",0),B.Tb(1,"div",1),B.Tb(2,"mat-card",2),B.Tb(3,"mat-card-title"),B.Tb(4,"h4"),B.Fc(5),B.Sb(),B.Sb(),B.Tb(6,"mat-card-content"),B.Tb(7,"form",3,4),B.bc("ngSubmit",function(){return B.xc(t),B.tc(8).form.valid&&e.onSubmit()}),B.Tb(9,"mat-form-field",5),B.Tb(10,"mat-label"),B.Fc(11,"Sede"),B.Sb(),B.Tb(12,"mat-select",6),B.bc("ngModelChange",function(t){return e.params.sede=t}),B.Dc(13,ri,2,3,"mat-option",7),B.Sb(),B.Sb(),B.Tb(14,"div",8),B.Tb(15,"button",9),B.Fc(16," Replicar "),B.Sb(),B.Sb(),B.Sb(),B.Dc(17,si,1,0,"app-cargando",10),B.Sb(),B.Sb(),B.Sb(),B.Sb()}if(2&t){const t=B.tc(8);B.Cb(5),B.Hc("Replicar ",(null==e.articulo?null:e.articulo.descripcion)||"TODOS los art\xedculos"," a las sedes"),B.Cb(7),B.lc("ngModel",e.params.sede),B.Cb(1),B.lc("ngForOf",e.sedes),B.Cb(2),B.lc("disabled",!t.form.valid||e.cargando),B.Cb(2),B.lc("ngIf",e.cargando)}},directives:[u.a,u.h,u.c,a.r,a.l,a.m,d.b,d.f,f.a,a.p,a.k,a.n,i.l,S.a,i.m,G.m,ci.a],styles:[""]}),t})(),di=(()=>{class t{constructor(t,e){this.dialogRef=t,this.data=e,this.articulo=null}ngOnInit(){this.data.articulo&&(this.articulo=this.data.articulo)}}return t.\u0275fac=function(e){return new(e||t)(B.Nb(I.f),B.Nb(I.a))},t.\u0275cmp=B.Hb({type:t,selectors:[["app-replicar-a-sedes-dialog"]],decls:5,vars:1,consts:[["mat-dialog-content",""],[3,"articulo"],["mat-dialog-actions","","align","end"],["mat-raised-button","","type","button","color","accent",3,"click"]],template:function(t,e){1&t&&(B.Tb(0,"div",0),B.Ob(1,"app-replicar-asedes",1),B.Sb(),B.Tb(2,"div",2),B.Tb(3,"button",3),B.bc("click",function(){return e.dialogRef.close()}),B.Fc(4," Terminar "),B.Sb(),B.Sb()),2&t&&(B.Cb(1),B.lc("articulo",e.articulo))},directives:[I.d,li,I.c,S.a],styles:[""]}),t})();var bi=o("pJXi"),ui=o("1wH6"),gi=o("FHMA");let mi=(()=>{class t{transform(t,e=25,o=!1,i="..."){return o&&(e=t.substr(0,e).lastIndexOf(" ")),t.length>e?t.substr(0,e)+i:t}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275pipe=B.Mb({name:"truncar",type:t,pure:!0}),t})();function pi(t,e){if(1&t){const t=B.Ub();B.Tb(0,"button",5),B.bc("click",function(){return B.xc(t),B.fc().showArticuloForm=!0}),B.Tb(1,"mat-icon",6),B.Fc(2,"expand_more"),B.Sb(),B.Sb()}}function fi(t,e){if(1&t){const t=B.Ub();B.Tb(0,"button",5),B.bc("click",function(){return B.xc(t),B.fc().showArticuloForm=!1}),B.Tb(1,"mat-icon",6),B.Fc(2,"expand_less"),B.Sb(),B.Sb()}}function hi(t,e){1&t&&(B.Tb(0,"mat-hint",38),B.Tb(1,"strong"),B.Fc(2,"Por favor seleccione un categor\xeda."),B.Sb(),B.Sb())}function Si(t,e){1&t&&B.Ob(0,"br")}function vi(t,e){1&t&&(B.Tb(0,"mat-hint",38),B.Tb(1,"strong"),B.Fc(2,"Por favor seleccione un sub-categor\xeda."),B.Sb(),B.Sb())}function Ci(t,e){if(1&t&&(B.Tb(0,"mat-chip",39),B.Fc(1),B.Sb()),2&t){const t=B.fc(2);B.Cb(1),B.Hc(" ",t.categoria.descripcion," ")}}function Ti(t,e){if(1&t&&(B.Tb(0,"mat-chip",40),B.Fc(1),B.Sb()),2&t){const t=B.fc(2);B.Cb(1),B.Hc(" ",t.subcategoria.descripcion," ")}}function Mi(t,e){if(1&t){const t=B.Ub();B.Tb(0,"input",41),B.bc("ngModelChange",function(e){return B.xc(t),B.fc(2).articulo.descripcion=e}),B.Sb()}if(2&t){const t=B.fc(2);B.lc("matKeyboard",t.keyboardLayout)("ngModel",t.articulo.descripcion)}}function Di(t,e){if(1&t){const t=B.Ub();B.Tb(0,"input",42),B.bc("ngModelChange",function(e){return B.xc(t),B.fc(2).articulo.descripcion=e}),B.Sb()}if(2&t){const t=B.fc(2);B.lc("ngModel",t.articulo.descripcion)}}function Ii(t,e){if(1&t&&(B.Tb(0,"mat-option",43),B.Fc(1),B.Sb()),2&t){const t=e.$implicit;B.lc("value",t.presentacion),B.Cb(1),B.Hc(" ",t.descripcion," ")}}function Fi(t,e){if(1&t&&(B.Tb(0,"mat-option",43),B.Fc(1),B.Sb()),2&t){const t=e.$implicit;B.lc("value",t.presentacion),B.Cb(1),B.Hc(" ",t.descripcion," ")}}function xi(t,e){if(1&t){const t=B.Ub();B.Tb(0,"input",44),B.bc("ngModelChange",function(e){return B.xc(t),B.fc(2).articulo.codigo=e}),B.Sb()}if(2&t){const t=B.fc(2);B.lc("matKeyboard",t.keyboardLayout)("ngModel",t.articulo.codigo)}}function _i(t,e){if(1&t){const t=B.Ub();B.Tb(0,"input",45),B.bc("ngModelChange",function(e){return B.xc(t),B.fc(2).articulo.codigo=e}),B.Sb()}if(2&t){const t=B.fc(2);B.lc("ngModel",t.articulo.codigo)}}function Oi(t,e){if(1&t){const t=B.Ub();B.Tb(0,"input",46),B.bc("ngModelChange",function(e){return B.xc(t),B.fc(2).articulo.shopify_id=e}),B.Sb()}if(2&t){const t=B.fc(2);B.lc("matKeyboard",t.keyboardLayout)("ngModel",t.articulo.shopify_id)}}function yi(t,e){if(1&t){const t=B.Ub();B.Tb(0,"input",47),B.bc("ngModelChange",function(e){return B.xc(t),B.fc(2).articulo.shopify_id=e}),B.Sb()}if(2&t){const t=B.fc(2);B.lc("ngModel",t.articulo.shopify_id)}}function ki(t,e){if(1&t&&(B.Tb(0,"mat-option",43),B.Fc(1),B.gc(2,"number"),B.Sb()),2&t){const t=e.$implicit;B.lc("value",t.impuesto_especial),B.Cb(1),B.Ic(" ",t.descripcion," (",B.ic(2,3,t.porcentaje,"1.2-2"),"%) ")}}function Ei(t,e){if(1&t){const t=B.Ub();B.Tb(0,"mat-form-field",15),B.Tb(1,"input",48),B.bc("ngModelChange",function(e){return B.xc(t),B.fc(2).articulo.rendimiento=e}),B.Sb(),B.Sb()}if(2&t){const t=B.fc(2);B.Cb(1),B.lc("ngModel",t.articulo.rendimiento)}}function wi(t,e){if(1&t){const t=B.Ub();B.Tb(0,"mat-form-field",15),B.Tb(1,"input",49),B.bc("ngModelChange",function(e){return B.xc(t),B.fc(2).articulo.cantidad_minima=e}),B.Sb(),B.Sb()}if(2&t){const t=B.fc(2);B.Cb(1),B.lc("ngModel",t.articulo.cantidad_minima)}}function Ai(t,e){if(1&t){const t=B.Ub();B.Tb(0,"mat-form-field",15),B.Tb(1,"input",50),B.bc("ngModelChange",function(e){return B.xc(t),B.fc(2).articulo.cantidad_maxima=e}),B.Sb(),B.Sb()}if(2&t){const t=B.fc(2);B.Cb(1),B.lc("ngModel",t.articulo.cantidad_maxima)}}function Bi(t,e){if(1&t){const t=B.Ub();B.Tb(0,"button",51),B.bc("click",function(){return B.xc(t),B.fc(2).replicarASedes()}),B.Fc(1," Replicar a sedes "),B.Sb()}}function $i(t,e){if(1&t){const t=B.Ub();B.Tb(0,"button",52),B.bc("click",function(){return B.xc(t),B.fc(2).resetArticulo()}),B.Fc(1," Nuevo "),B.Sb()}}function Ri(t,e){if(1&t){const t=B.Ub();B.Tb(0,"form",7,8),B.bc("ngSubmit",function(){B.xc(t);const e=B.tc(1),o=B.fc();return e.form.valid&&o.onSubmit()}),B.Dc(2,hi,3,0,"mat-hint",9),B.Dc(3,Si,1,0,"br",3),B.Dc(4,vi,3,0,"mat-hint",9),B.Tb(5,"mat-chip-list"),B.Dc(6,Ci,2,1,"mat-chip",10),B.Dc(7,Ti,2,1,"mat-chip",11),B.Sb(),B.Tb(8,"mat-form-field",12),B.Dc(9,Mi,1,2,"input",13),B.Dc(10,Di,1,1,"input",14),B.Sb(),B.Tb(11,"mat-form-field",15),B.Tb(12,"input",16),B.bc("ngModelChange",function(e){return B.xc(t),B.fc().articulo.precio=e}),B.Sb(),B.Sb(),B.Tb(13,"mat-form-field",15),B.Tb(14,"mat-label"),B.Fc(15,"Presentaci\xf3n Venta"),B.Sb(),B.Tb(16,"mat-select",17),B.bc("ngModelChange",function(e){return B.xc(t),B.fc().articulo.presentacion=e}),B.Dc(17,Ii,2,2,"mat-option",18),B.Sb(),B.Sb(),B.Tb(18,"mat-form-field",15),B.Tb(19,"mat-label"),B.Fc(20,"Presentaci\xf3n Reportes"),B.Sb(),B.Tb(21,"mat-select",19),B.bc("ngModelChange",function(e){return B.xc(t),B.fc().articulo.presentacion_reporte=e}),B.Dc(22,Fi,2,2,"mat-option",18),B.Sb(),B.Sb(),B.Tb(23,"mat-form-field",15),B.Dc(24,xi,1,2,"input",20),B.Dc(25,_i,1,1,"input",21),B.Sb(),B.Tb(26,"mat-form-field",15),B.Dc(27,Oi,1,2,"input",22),B.Dc(28,yi,1,1,"input",23),B.Sb(),B.Tb(29,"mat-form-field",15),B.Tb(30,"mat-label"),B.Fc(31,"Impuesto Especial"),B.Sb(),B.Tb(32,"mat-select",24),B.bc("ngModelChange",function(e){return B.xc(t),B.fc().articulo.impuesto_especial=e}),B.Dc(33,ki,3,6,"mat-option",18),B.Sb(),B.Sb(),B.Dc(34,Ei,2,1,"mat-form-field",25),B.Dc(35,wi,2,1,"mat-form-field",25),B.Dc(36,Ai,2,1,"mat-form-field",25),B.Tb(37,"div",26),B.Tb(38,"div",27),B.Tb(39,"mat-checkbox",28),B.bc("ngModelChange",function(e){return B.xc(t),+(B.fc().articulo.produccion=e)}),B.Fc(40,"\xbfEs producci\xf3n?"),B.Sb(),B.Sb(),B.Tb(41,"div",27),B.Tb(42,"mat-checkbox",29),B.bc("ngModelChange",function(e){return B.xc(t),+(B.fc().articulo.mostrar_pos=e)}),B.Fc(43,"Mostrar en POS"),B.Sb(),B.Sb(),B.Tb(44,"div",27),B.Tb(45,"mat-checkbox",30),B.bc("ngModelChange",function(e){return B.xc(t),+(B.fc().articulo.combo=e)})("change",function(){return B.xc(t),B.fc().setOpcMultOff()}),B.Fc(46,"Combo"),B.Sb(),B.Sb(),B.Tb(47,"div",27),B.Tb(48,"mat-checkbox",31),B.bc("ngModelChange",function(e){return B.xc(t),+(B.fc().articulo.multiple=e)})("change",function(){return B.xc(t),B.fc().setComboOff()}),B.Fc(49,"Opci\xf3n m\xfaltiple"),B.Sb(),B.Sb(),B.Sb(),B.Tb(50,"div",26),B.Tb(51,"div",27),B.Tb(52,"mat-checkbox",32),B.bc("ngModelChange",function(e){return B.xc(t),+(B.fc().articulo.mostrar_inventario=e)}),B.Fc(53,"Mostrar en Inventario"),B.Sb(),B.Sb(),B.Tb(54,"div",27),B.Tb(55,"mat-checkbox",33),B.bc("ngModelChange",function(e){return B.xc(t),+(B.fc().articulo.esreceta=e)}),B.Fc(56,"Es receta"),B.Sb(),B.Sb(),B.Sb(),B.Tb(57,"div",34),B.Tb(58,"button",35),B.Fc(59," Guardar "),B.Sb(),B.Dc(60,Bi,2,0,"button",36),B.Dc(61,$i,2,0,"button",37),B.Sb(),B.Sb()}if(2&t){const t=B.tc(1),e=B.fc();B.Cb(2),B.lc("ngIf",!e.categoria||!e.categoria.descripcion),B.Cb(1),B.lc("ngIf",!e.categoria||!e.categoria.descripcion),B.Cb(1),B.lc("ngIf",!e.subcategoria||!e.subcategoria.descripcion),B.Cb(2),B.lc("ngIf",e.categoria),B.Cb(1),B.lc("ngIf",e.subcategoria),B.Cb(2),B.lc("ngIf",!e.esMovil),B.Cb(1),B.lc("ngIf",e.esMovil),B.Cb(2),B.lc("ngModel",e.articulo.precio),B.Cb(4),B.lc("ngModel",e.articulo.presentacion),B.Cb(1),B.lc("ngForOf",e.presentaciones),B.Cb(4),B.lc("ngModel",e.articulo.presentacion_reporte),B.Cb(1),B.lc("ngForOf",e.presentacionesFiltered),B.Cb(2),B.lc("ngIf",!e.esMovil),B.Cb(1),B.lc("ngIf",e.esMovil),B.Cb(2),B.lc("ngIf",!e.esMovil),B.Cb(1),B.lc("ngIf",e.esMovil),B.Cb(4),B.lc("ngModel",e.articulo.impuesto_especial),B.Cb(1),B.lc("ngForOf",e.impuestosEspeciales),B.Cb(1),B.lc("ngIf",1==+e.articulo.produccion),B.Cb(1),B.lc("ngIf",1==+e.articulo.multiple||+e.articulo.combo),B.Cb(1),B.lc("ngIf",1==+e.articulo.multiple||+e.articulo.combo),B.Cb(3),B.lc("ngModel",+e.articulo.produccion),B.Cb(3),B.lc("ngModel",+e.articulo.mostrar_pos),B.Cb(3),B.lc("ngModel",+e.articulo.combo),B.Cb(3),B.lc("ngModel",+e.articulo.multiple),B.Cb(4),B.lc("ngModel",+e.articulo.mostrar_inventario),B.Cb(3),B.lc("ngModel",+e.articulo.esreceta),B.Cb(3),B.lc("disabled",!t.form.valid||!e.articulo.categoria_grupo),B.Cb(2),B.lc("ngIf",e.articulo.articulo),B.Cb(1),B.lc("ngIf",e.articulo.articulo)}}function Hi(t,e){1&t&&B.Ob(0,"hr")}function Pi(t,e){if(1&t){const t=B.Ub();B.Tb(0,"button",5),B.bc("click",function(){return B.xc(t),B.fc(2).showDetalleForm=!0}),B.Tb(1,"mat-icon",6),B.Fc(2,"expand_more"),B.Sb(),B.Sb()}}function Ni(t,e){if(1&t){const t=B.Ub();B.Tb(0,"button",5),B.bc("click",function(){return B.xc(t),B.fc(2).showDetalleForm=!1}),B.Tb(1,"mat-icon",6),B.Fc(2,"expand_less"),B.Sb(),B.Sb()}}function Ui(t,e){if(1&t&&(B.Tb(0,"mat-option",43),B.Fc(1),B.Sb()),2&t){const t=e.$implicit;B.lc("value",t),B.Cb(1),B.Ic(" ",t.descripcion,"",t.subcategoria&&t.subcategoria.descripcion?" ("+t.subcategoria.descripcion+")":""," ")}}function Gi(t,e){if(1&t){const t=B.Ub();B.Tb(0,"mat-form-field",15),B.Tb(1,"input",63),B.bc("ngModelChange",function(e){return B.xc(t),B.fc(3).receta.precio=e}),B.Sb(),B.Sb()}if(2&t){const t=B.fc(3);B.Cb(1),B.lc("ngModel",t.receta.precio)}}function zi(t,e){if(1&t&&(B.Tb(0,"mat-option",43),B.Fc(1),B.Sb()),2&t){const t=e.$implicit;B.lc("value",t.medida),B.Cb(1),B.Hc(" ",t.descripcion," ")}}function qi(t,e){if(1&t){const t=B.Ub();B.Tb(0,"button",52),B.bc("click",function(){return B.xc(t),B.fc(3).resetReceta()}),B.Fc(1," Nuevo "),B.Sb()}}function ji(t,e){if(1&t){const t=B.Ub();B.Tb(0,"button",52),B.bc("click",function(){return B.xc(t),B.fc(3).imprimirReceta()}),B.Fc(1," Imprimir "),B.Sb()}}const Wi=function(){return{standalone:!0}};function Li(t,e){if(1&t){const t=B.Ub();B.Tb(0,"form",7,55),B.bc("ngSubmit",function(){B.xc(t);const e=B.tc(1),o=B.fc(2);return e.form.valid&&o.onSubmitDetail()}),B.Tb(2,"mat-form-field",15),B.Tb(3,"mat-label"),B.Fc(4,"Art\xedculo"),B.Sb(),B.Tb(5,"input",56),B.bc("ngModelChange",function(e){return B.xc(t),B.fc(2).txtArticuloSelected=e})("keyup",function(){B.xc(t);const e=B.fc(2);return e.filtrarArticulos(e.txtArticuloSelected)}),B.Sb(),B.Tb(6,"mat-autocomplete",57,58),B.Dc(8,Ui,2,3,"mat-option",18),B.Sb(),B.Sb(),B.Tb(9,"mat-form-field",15),B.Tb(10,"input",59),B.bc("ngModelChange",function(e){return B.xc(t),B.fc(2).receta.cantidad=e}),B.Sb(),B.Sb(),B.Dc(11,Gi,2,1,"mat-form-field",25),B.Tb(12,"mat-form-field",15),B.Tb(13,"mat-label"),B.Fc(14,"Unidad de medida"),B.Sb(),B.Tb(15,"mat-select",60),B.bc("ngModelChange",function(e){return B.xc(t),B.fc(2).receta.medida=e}),B.Dc(16,zi,2,2,"mat-option",18),B.Sb(),B.Sb(),B.Tb(17,"div",26),B.Tb(18,"div",27),B.Tb(19,"mat-checkbox",61),B.bc("ngModelChange",function(e){return B.xc(t),+(B.fc(2).receta.racionable=e)}),B.Fc(20,"\xbfEs racionable?"),B.Sb(),B.Sb(),B.Tb(21,"div",27),B.Tb(22,"mat-checkbox",62),B.bc("ngModelChange",function(e){return B.xc(t),+(B.fc(2).receta.precio_extra=e)}),B.Fc(23," Precio Extra "),B.Sb(),B.Sb(),B.Sb(),B.Tb(24,"div",34),B.Tb(25,"button",35),B.Fc(26," Guardar "),B.Sb(),B.Dc(27,qi,2,0,"button",37),B.Dc(28,ji,2,0,"button",37),B.Sb(),B.Sb()}if(2&t){const t=B.tc(1),e=B.tc(7),o=B.fc(2);B.Cb(5),B.lc("ngModel",o.txtArticuloSelected)("ngModelOptions",B.nc(14,Wi))("matAutocomplete",e),B.Cb(1),B.lc("displayWith",o.displayArticulo),B.Cb(2),B.lc("ngForOf",o.filteredArticulos),B.Cb(2),B.lc("ngModel",o.receta.cantidad),B.Cb(1),B.lc("ngIf",o.receta.precio_extra&&o.receta.precio_extra>0),B.Cb(4),B.lc("ngModel",o.receta.medida),B.Cb(1),B.lc("ngForOf",o.medidas),B.Cb(3),B.lc("ngModel",+o.receta.racionable),B.Cb(3),B.lc("ngModel",+o.receta.precio_extra),B.Cb(3),B.lc("disabled",!t.form.valid),B.Cb(2),B.lc("ngIf",o.receta.articulo_detalle),B.Cb(1),B.lc("ngIf",o.recetas.length>0)}}function Vi(t,e){1&t&&B.Ob(0,"hr")}function Ki(t,e){1&t&&(B.Tb(0,"th",76),B.Fc(1,"Art\xedculo"),B.Sb())}function Qi(t,e){if(1&t&&(B.Tb(0,"td",77),B.Fc(1),B.Sb()),2&t){const t=e.$implicit;B.Cb(1),B.Gc(t.articulo.descripcion)}}function Ji(t,e){1&t&&(B.Tb(0,"th",78),B.Fc(1,"Cantidad"),B.Sb())}function Xi(t,e){if(1&t&&(B.Tb(0,"td",79),B.Fc(1),B.gc(2,"number"),B.Sb()),2&t){const t=e.$implicit;B.Cb(1),B.Gc(B.ic(2,1,t.cantidad,"1.2-2"))}}function Yi(t,e){1&t&&(B.Tb(0,"th",78),B.Fc(1,"Unida de medida"),B.Sb())}function Zi(t,e){if(1&t&&(B.Tb(0,"td",79),B.Fc(1),B.Sb()),2&t){const t=e.$implicit;B.Cb(1),B.Gc(t.medida.descripcion)}}function tn(t,e){1&t&&(B.Tb(0,"th",78),B.Fc(1,"Precio"),B.Sb())}function en(t,e){if(1&t&&(B.Tb(0,"td",79),B.Fc(1),B.gc(2,"number"),B.Sb()),2&t){const t=e.$implicit;B.Cb(1),B.Gc(B.ic(2,1,t.precio,"1.2-2"))}}function on(t,e){1&t&&(B.Tb(0,"th",76),B.Fc(1,"\xa0"),B.Sb())}function nn(t,e){if(1&t){const t=B.Ub();B.Tb(0,"td",77),B.Tb(1,"button",51),B.bc("click",function(){B.xc(t);const o=e.$implicit;return B.fc(3).getReceta(o.receta,o.articulo_detalle)}),B.Fc(2," Editar "),B.Sb(),B.Tb(3,"button",52),B.bc("click",function(){B.xc(t);const o=e.$implicit;return B.fc(3).eliminaReceta(o)}),B.Fc(4," Eliminar "),B.Sb(),B.Sb()}}function an(t,e){1&t&&B.Ob(0,"tr",80)}function cn(t,e){1&t&&B.Ob(0,"tr",81)}function rn(t,e){if(1&t&&(B.Tb(0,"table",64),B.Rb(1,65),B.Dc(2,Ki,2,0,"th",66),B.Dc(3,Qi,2,1,"td",67),B.Qb(),B.Rb(4,68),B.Dc(5,Ji,2,0,"th",69),B.Dc(6,Xi,3,4,"td",70),B.Qb(),B.Rb(7,71),B.Dc(8,Yi,2,0,"th",69),B.Dc(9,Zi,2,1,"td",70),B.Qb(),B.Rb(10,72),B.Dc(11,tn,2,0,"th",69),B.Dc(12,en,3,4,"td",70),B.Qb(),B.Rb(13,73),B.Dc(14,on,2,0,"th",66),B.Dc(15,nn,5,0,"td",67),B.Qb(),B.Dc(16,an,1,0,"tr",74),B.Dc(17,cn,1,0,"tr",75),B.Sb()),2&t){const t=B.fc(2);B.lc("dataSource",t.dataSource),B.Cb(16),B.lc("matHeaderRowDef",t.displayedColumns),B.Cb(1),B.lc("matRowDefColumns",t.displayedColumns)}}function sn(t,e){if(1&t){const t=B.Ub();B.Tb(0,"mat-card",0),B.Tb(1,"mat-card-title"),B.Tb(2,"h4"),B.Fc(3),B.gc(4,"truncar"),B.Dc(5,Pi,3,0,"button",1),B.Dc(6,Ni,3,0,"button",1),B.Sb(),B.Sb(),B.Tb(7,"mat-card-content"),B.Dc(8,Li,29,15,"form",2),B.Dc(9,Vi,1,0,"hr",3),B.Tb(10,"mat-form-field",15),B.Tb(11,"input",53),B.bc("keyup",function(e){return B.xc(t),B.fc().applyFilter(e.target.value)}),B.Sb(),B.Sb(),B.Dc(12,rn,18,3,"table",54),B.Sb(),B.Sb()}if(2&t){const t=B.fc();B.Cb(3),B.Hc(" Detalle del art\xedculo ",B.ic(4,6,t.articulo.descripcion,35)," "),B.Cb(2),B.lc("ngIf",!t.showDetalleForm),B.Cb(1),B.lc("ngIf",t.showDetalleForm),B.Cb(2),B.lc("ngIf",t.showDetalleForm),B.Cb(1),B.lc("ngIf",t.recetas.length>0),B.Cb(3),B.lc("ngIf",t.recetas.length>0)}}let ln=(()=>{class t{constructor(t,e,o,i,n,a,c,r){this.dialog=t,this.snackBar=e,this.ls=o,this.articuloSrvc=i,this.medidaSrvc=n,this.presentacionSrvc=a,this.impuestoEspecialSrvc=c,this.rptSrvc=r,this.categoria=null,this.subcategoria=null,this.articuloSvd=new B.o,this.titulo="Receta",this.showArticuloForm=!0,this.medidas=[],this.medidasFull=[],this.presentaciones=[],this.presentacionesFiltered=[],this.articulos=[],this.filteredArticulos=[],this.recetas=[],this.impuestosEspeciales=[],this.showDetalleForm=!0,this.displayedColumns=["articulo","cantidad","medida","precio","editItem"],this.keyboardLayout=w.b.IDIOMA_TECLADO,this.esMovil=!1,this.txtArticuloSelected=void 0,this.endSubs=new Go.a,this.resetArticulo=()=>{this.articulo={articulo:null,categoria_grupo:this.articulo.categoria_grupo,presentacion:null,descripcion:null,precio:null,bien_servicio:"B",produccion:0,mostrar_pos:1,presentacion_reporte:null,impuesto_especial:null,shopify_id:null,multiple:0,cantidad_minima:1,cantidad_maxima:1,combo:0,rendimiento:0,mostrar_inventario:0},this.recetas=[],this.resetReceta(),this.presentacionesFiltered=JSON.parse(JSON.stringify(this.presentaciones))},this.setArticuloCategoriaGrupo=t=>this.articulo.categoria_grupo=+t,this.onSubmit=()=>{this.endSubs.add(this.articuloSrvc.saveArticulo(this.articulo).subscribe(t=>{t.exito?(this.articuloSvd.emit(),this.resetArticulo(),this.articulo=t.articulo,this.loadRecetas(this.articulo.articulo),this.loadArticulos(),this.filtrarPresentaciones(this.articulo),this.snackBar.open("Art\xedculo guardado con \xe9xito...","Art\xedculo",{duration:3e3})):this.snackBar.open(`ERROR: ${t.mensaje}`,"Articulo",{duration:3e3})}))},this.loadMedidas=()=>{this.endSubs.add(this.medidaSrvc.get().subscribe(t=>{t&&(this.medidasFull=t)}))},this.loadPresentaciones=()=>{this.endSubs.add(this.presentacionSrvc.get().subscribe(t=>{t&&(this.presentaciones=t,this.filtrarPresentaciones())}))},this.filtrarPresentaciones=(t=null)=>{this.presentaciones&&this.presentaciones.length>0&&((null==t?void 0:t.articulo)?this.endSubs.add(this.articuloSrvc.tieneMovimientos(t.articulo).subscribe(e=>{if(e.exito)if(e.tiene_movimientos){const e=this.presentaciones.find(e=>+e.presentacion==+t.presentacion_reporte);this.presentacionesFiltered=this.presentaciones.filter(t=>+t.medida.medida==+e.medida.medida)}else this.presentacionesFiltered=JSON.parse(JSON.stringify(this.presentaciones));else this.snackBar.open(`ERROR: ${e.mensaje}`,"Art\xedculo",{duration:7e3})})):this.presentacionesFiltered=JSON.parse(JSON.stringify(this.presentaciones)))},this.loadArticulos=()=>{this.endSubs.add(this.articuloSrvc.getArticulos().subscribe(t=>{t&&(this.articulos=t)}))},this.loadImpuestosEspeciales=()=>{this.endSubs.add(this.impuestoEspecialSrvc.get().subscribe(t=>{t&&(this.impuestosEspeciales=t)}))},this.displayArticulo=t=>{if(t)return this.receta.articulo=t.articulo,this.filtrarMedidas(t),t.descripcion;this.medidas=[]},this.filtrarMedidas=t=>{const e=this.presentaciones.find(e=>+e.presentacion==+t.presentacion_reporte);this.medidas=e?this.medidasFull.filter(t=>+t.medida==+e.medida.medida):[]},this.filtrarArticulos=t=>{if(t&&"string"==typeof t){const e=t.toLowerCase();this.filteredArticulos=this.articulos.filter(t=>t.descripcion.toLowerCase().includes(e))}else this.filteredArticulos=JSON.parse(JSON.stringify(this.articulos))},this.resetReceta=()=>{this.receta={articulo_detalle:null,receta:this.articulo.articulo||0,racionable:0,articulo:null,cantidad:1,medida:null,anulado:0,precio_extra:0,precio:0},this.txtArticuloSelected=void 0,this.updateTableDataSource()},this.loadRecetas=(t=+this.articulo.articulo)=>{this.endSubs.add(this.articuloSrvc.getArticuloDetalle(+t,{receta:+t}).subscribe(t=>{t&&(this.recetas=t,this.updateTableDataSource())}))},this.getReceta=(t=+this.articulo.articulo,e)=>{this.endSubs.add(this.articuloSrvc.getArticuloDetalle(t,{articulo_detalle:e}).subscribe(t=>{t&&(this.receta={articulo_detalle:t[0].articulo_detalle,receta:t[0].receta.articulo,racionable:t[0].articulo.articulo,articulo:t[0].articulo.articulo,cantidad:+t[0].cantidad,medida:t[0].medida.medida,anulado:t[0].anulado||0,precio_extra:t[0].precio_extra||0,precio:+t[0].precio},this.txtArticuloSelected=t[0].articulo,this.showDetalleForm=!0)}))},this.eliminaReceta=t=>{const e=this.dialog.open(W.a,{maxWidth:"400px",data:new W.b("Eliminar detalle",`\xbfDesea eliminar '${t.cantidad} de ${t.articulo.descripcion}' de la receta?`,"S\xed","No")});this.endSubs.add(e.afterClosed().subscribe(e=>{e&&(t.anulado=1,t.articulo=t.articulo.articulo,this.endSubs.add(this.articuloSrvc.saveArticuloDetalle(t).subscribe(t=>{this.loadRecetas(),this.resetReceta()})))}))},this.onSubmitDetail=()=>{this.receta.receta=this.articulo.articulo,this.endSubs.add(this.articuloSrvc.saveArticuloDetalle(this.receta).subscribe(t=>{t&&(t.exito?(this.loadRecetas(),this.resetReceta()):this.snackBar.open(`ERROR: ${t.mensaje}`,"Art\xedculo",{duration:3e3}))}))},this.imprimirReceta=()=>{this.endSubs.add(this.rptSrvc.imprimirReceta(this.articulo.articulo).subscribe(t=>{if(t){const e=new Blob([t],{type:"application/pdf"});Object(ni.saveAs)(e,`${this.titulo}_${this.articulo.descripcion}.pdf`)}else this.snackBar.open("No se pudo generar el reporte...",this.titulo,{duration:3e3})}))},this.updateTableDataSource=()=>{this.dataSource=new p.l(this.recetas),this.dataSource.filterPredicate=(t,e)=>t.articulo.descripcion.toLowerCase().includes(e)},this.replicarASedes=()=>{const t=this.dialog.open(di,{width:"50%",data:{articulo:this.articulo}});this.endSubs.add(t.afterClosed().subscribe(t=>{}))},this.applyFilter=t=>{this.dataSource.filter=t.toLocaleLowerCase()},this.setOpcMultOff=()=>{1==+this.articulo.combo&&(this.articulo.multiple=0)},this.setComboOff=()=>{1==+this.articulo.multiple&&(this.articulo.combo=0)}}ngOnInit(){this.esMovil=this.ls.get(w.b.usrTokenVar).enmovil||!1,this.resetArticulo(),this.loadMedidas(),this.loadArticulos(),this.loadPresentaciones(),this.loadImpuestosEspeciales()}ngOnDestroy(){this.endSubs.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(B.Nb(I.b),B.Nb(v.b),B.Nb($.a),B.Nb(Q.a),B.Nb(bi.a),B.Nb(J.a),B.Nb(ui.a),B.Nb(gi.a))},t.\u0275cmp=B.Hb({type:t,selectors:[["app-form-producto"]],inputs:{articulo:"articulo",categoria:"categoria",subcategoria:"subcategoria"},outputs:{articuloSvd:"articuloSvd"},decls:11,vars:9,consts:[[1,"mat-elevation-z4","fullWidth"],["mat-icon-button","","type","button","color","accent",3,"click",4,"ngIf"],["novalidate","",3,"ngSubmit",4,"ngIf"],[4,"ngIf"],["class","mat-elevation-z4 fullWidth",4,"ngIf"],["mat-icon-button","","type","button","color","accent",3,"click"],[1,"iconFontSize"],["novalidate","",3,"ngSubmit"],["frmArticulo","ngForm"],["align","start",4,"ngIf"],["color","accent","class","catSubCat","selected","",4,"ngIf"],["color","warn","class","catSubCat","selected","",4,"ngIf"],[1,"fullWidth",2,"margin-top","10px"],["matInput","","type","text","placeholder","Descripci\xf3n","name","descripcion","minlength","1","maxlength","250","required","",3,"matKeyboard","ngModel","ngModelChange",4,"ngIf"],["matInput","","type","text","placeholder","Descripci\xf3n","name","descripcion","minlength","1","maxlength","250","required","",3,"ngModel","ngModelChange",4,"ngIf"],[1,"fullWidth"],["matInput","","type","number","placeholder","Precio","name","precio","required","",3,"ngModel","ngModelChange"],["name","presentacion","required","",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["name","presentacion_reporte","required","",3,"ngModel","ngModelChange"],["matInput","","type","text","placeholder","C\xf3digo","name","codigo","minlength","1","maxlength","25","required","",3,"matKeyboard","ngModel","ngModelChange",4,"ngIf"],["matInput","","type","text","placeholder","C\xf3digo","name","codigo","minlength","1","maxlength","25","required","",3,"ngModel","ngModelChange",4,"ngIf"],["matInput","","type","text","placeholder","Shopify ID","name","shopify_id","minlength","1","maxlength","25",3,"matKeyboard","ngModel","ngModelChange",4,"ngIf"],["matInput","","type","text","placeholder","Shopify ID","name","shopify_id","minlength","1","maxlength","25",3,"ngModel","ngModelChange",4,"ngIf"],["name","impuesto_especial",3,"ngModel","ngModelChange"],["class","fullWidth",4,"ngIf"],[1,"row"],[1,"col","m3","s3"],["name","produccion",1,"example-margin",3,"ngModel","ngModelChange"],["name","mostrar_pos",1,"example-margin",3,"ngModel","ngModelChange"],["name","combo",1,"example-margin",3,"ngModel","ngModelChange","change"],["name","multiple",1,"example-margin",3,"ngModel","ngModelChange","change"],["name","mostrar_inventario",1,"example-margin",3,"ngModel","ngModelChange"],["name","esreceta",1,"example-margin",3,"ngModel","ngModelChange"],["align","end"],["mat-raised-button","","type","submit","color","accent",1,"btnAccion",3,"disabled"],["mat-raised-button","","type","button","color","accent","class","btnAccion",3,"click",4,"ngIf"],["mat-raised-button","","type","button","color","accent",3,"click",4,"ngIf"],["align","start"],["color","accent","selected","",1,"catSubCat"],["color","warn","selected","",1,"catSubCat"],["matInput","","type","text","placeholder","Descripci\xf3n","name","descripcion","minlength","1","maxlength","250","required","",3,"matKeyboard","ngModel","ngModelChange"],["matInput","","type","text","placeholder","Descripci\xf3n","name","descripcion","minlength","1","maxlength","250","required","",3,"ngModel","ngModelChange"],[3,"value"],["matInput","","type","text","placeholder","C\xf3digo","name","codigo","minlength","1","maxlength","25","required","",3,"matKeyboard","ngModel","ngModelChange"],["matInput","","type","text","placeholder","C\xf3digo","name","codigo","minlength","1","maxlength","25","required","",3,"ngModel","ngModelChange"],["matInput","","type","text","placeholder","Shopify ID","name","shopify_id","minlength","1","maxlength","25",3,"matKeyboard","ngModel","ngModelChange"],["matInput","","type","text","placeholder","Shopify ID","name","shopify_id","minlength","1","maxlength","25",3,"ngModel","ngModelChange"],["matInput","","type","number","step","0.05","placeholder","Rendimiento","name","rendimiento","required","",3,"ngModel","ngModelChange"],["matInput","","type","number","step","1","placeholder","Cantidad minima","name","minima","required","",3,"ngModel","ngModelChange"],["matInput","","type","number","step","1","placeholder","Cantidad maxima","name","maxima","required","",3,"ngModel","ngModelChange"],["mat-raised-button","","type","button","color","accent",1,"btnAccion",3,"click"],["mat-raised-button","","type","button","color","accent",3,"click"],["matInput","","placeholder","Buscar",3,"keyup"],["mat-table","","class","mat-elevation-z4 full-width",3,"dataSource",4,"ngIf"],["frmDetalleArticulo","ngForm"],["type","text","placeholder","Art\xedculo","matInput","","required","",3,"ngModel","ngModelOptions","matAutocomplete","ngModelChange","keyup"],[3,"displayWith"],["autoArticulos","matAutocomplete"],["matInput","","placeholder","Cantidad","type","number","step","0.01","name","cantidad","required","",3,"ngModel","ngModelChange"],["name","medida","required","",3,"ngModel","ngModelChange"],["name","racionable",1,"fullWidth",3,"ngModel","ngModelChange"],["name","extra",1,"fullWidth",3,"ngModel","ngModelChange"],["matInput","","placeholder","Precio","name","precio","required","",3,"ngModel","ngModelChange"],["mat-table","",1,"mat-elevation-z4","full-width",3,"dataSource"],["matColumnDef","articulo"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","","class","text-wrap",4,"matCellDef"],["matColumnDef","cantidad"],["mat-header-cell","","class","text-right",4,"matHeaderCellDef"],["mat-cell","","class","text-right",4,"matCellDef"],["matColumnDef","medida"],["matColumnDef","precio"],["matColumnDef","editItem"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell","",1,"text-wrap"],["mat-header-cell","",1,"text-right"],["mat-cell","",1,"text-right"],["mat-header-row",""],["mat-row",""]],template:function(t,e){1&t&&(B.Tb(0,"mat-card",0),B.Tb(1,"mat-card-title"),B.Tb(2,"h4"),B.Fc(3),B.gc(4,"truncar"),B.Dc(5,pi,3,0,"button",1),B.Dc(6,fi,3,0,"button",1),B.Sb(),B.Sb(),B.Tb(7,"mat-card-content"),B.Dc(8,Ri,62,30,"form",2),B.Sb(),B.Sb(),B.Dc(9,Hi,1,0,"hr",3),B.Dc(10,sn,13,9,"mat-card",4)),2&t&&(B.Cb(3),B.Hc(" Art\xedculo ",e.articulo.articulo?B.ic(4,6,e.articulo.descripcion,35):""," "),B.Cb(2),B.lc("ngIf",!e.showArticuloForm),B.Cb(1),B.lc("ngIf",e.showArticuloForm),B.Cb(2),B.lc("ngIf",e.showArticuloForm),B.Cb(1),B.lc("ngIf",e.articulo.articulo),B.Cb(1),B.lc("ngIf",e.articulo.articulo))},directives:[u.a,u.h,i.m,u.c,S.a,l.a,a.r,a.l,a.m,O.b,d.b,b.b,a.o,a.c,a.p,a.k,a.n,d.f,f.a,i.l,h.a,d.e,O.a,y.a,a.g,a.f,G.m,_.c,_.a,p.k,p.c,p.e,p.b,p.g,p.j,p.d,p.a,p.f,p.i],pipes:[mi,i.f],styles:[".full-width[_ngcontent-%COMP%]{width:100%}.iconFontSize[_ngcontent-%COMP%]{font-size:24pt}.catSubCat[_ngcontent-%COMP%]{margin-bottom:10px}"]}),t})();const dn=["frmProducto"],bn=["frmSubcategoria"];function un(t,e){if(1&t){const t=B.Ub();B.Tb(0,"mat-chip",17),B.bc("click",function(){B.xc(t);const o=e.$implicit,i=B.fc();return!i.cargando&&i.selectCategoria(o)}),B.Fc(1),B.Sb()}if(2&t){const t=e.$implicit;B.Cb(1),B.Hc(" ",t.descripcion," ")}}function gn(t,e){if(1&t){const t=B.Ub();B.Tb(0,"mat-chip",20),B.bc("click",function(){B.xc(t);const o=e.$implicit,i=B.fc(2);return!i.cargando&&i.selectSubcat(o)}),B.Fc(1),B.Sb()}if(2&t){const t=e.$implicit;B.Cb(1),B.Hc(" ",t.descripcion," ")}}function mn(t,e){if(1&t&&(B.Tb(0,"mat-chip-list",18),B.Dc(1,gn,2,1,"mat-chip",19),B.Sb()),2&t){const t=e.$implicit;B.Cb(1),B.lc("ngForOf",t)}}function pn(t,e){if(1&t){const t=B.Ub();B.Tb(0,"button",21),B.bc("click",function(){B.xc(t);const o=e.$implicit;return B.fc().setArticulo(o)}),B.Fc(1),B.gc(2,"truncar"),B.Sb()}if(2&t){const t=e.$implicit;B.Cb(1),B.Gc(B.ic(2,1,t.descripcion,35))}}const fn=function(){return{standalone:!0}};let hn=(()=>{class t{constructor(t,e){this.articuloSrvc=t,this.ls=e,this.categorias=[],this.categoriasGrupos=[],this.listasCategoriasGrupo=[],this.articulos=[],this.articulosFull=[],this.txtFiltro="",this.cargando=!1,this.endSubs=new Go.a,this.setArticulo=t=>{this.endSubs.add(this.articuloSrvc.getArticulo({articulo:t.articulo}).subscribe(t=>{if(t&&t.length>0){const e=t[0];this.articulo={articulo:+e.articulo,categoria_grupo:+e.categoria_grupo.categoria_grupo,presentacion:e.presentacion.presentacion,descripcion:e.descripcion,precio:+e.precio,codigo:e.codigo,produccion:e.produccion,presentacion_reporte:e.presentacion_reporte.presentacion,mostrar_pos:e.mostrar_pos,impuesto_especial:e.impuesto_especial,shopify_id:e.shopify_id,multiple:e.multiple,cantidad_minima:e.cantidad_minima,cantidad_maxima:e.cantidad_maxima,combo:e.combo,rendimiento:e.rendimiento,mostrar_inventario:e.mostrar_inventario,esreceta:e.esreceta},this.categoria=this.categorias.find(t=>+t.categoria==+e.categoria_grupo.categoria),this.categoriaGrupo={categoria_grupo:+e.categoria_grupo.categoria_grupo,categoria:+e.categoria_grupo.categoria,categoria_grupo_grupo:+e.categoria_grupo.categoria_grupo_grupo,descripcion:e.categoria_grupo.descripcion,receta:+e.categoria_grupo.receta,impresora:+e.categoria_grupo.impresora,descuento:+e.categoria_grupo.descuento},this.frmProductoComponent.loadRecetas(+this.articulo.articulo),this.frmProductoComponent.resetReceta(),this.frmProductoComponent.filtrarPresentaciones(this.articulo)}}))},this.setArticuloCategoriaGrupo=t=>{this.articulo.categoria_grupo=+t,this.frmProductoComponent.setArticuloCategoriaGrupo(+t)},this.refreshArticuloList=t=>{this.loadArticulos()},this.loadCategorias=()=>{this.endSubs.add(this.articuloSrvc.getCategorias({sede:+this.ls.get(w.b.usrTokenVar).sede||0}).subscribe(t=>{t&&(this.categorias=t)}))},this.loadSubCategorias=(t,e=null)=>{this.cargando=!0;const o={categoria:+t,categoria_grupo_grupo:null};e?(this.frmProductoComponent.articulo.categoria_grupo=e,o.categoria_grupo_grupo=e):delete o.categoria_grupo_grupo,this.endSubs.add(this.articuloSrvc.getCategoriasGrupos(o).subscribe(t=>{t&&t.length>0?(e||(this.frmProductoComponent.articulo.categoria_grupo=null,this.listasCategoriasGrupo=[]),this.listasCategoriasGrupo.push(this.articuloSrvc.adaptCategoriaGrupoResponse(t))):e&&this.loadArticulos(e),this.cargando=!1}))},this.loadArticulos=(t=null)=>{const e={categoria_grupo:null};t?e.categoria_grupo=t:delete e.categoria_grupo,this.endSubs.add(this.articuloSrvc.getArticulos(e).subscribe(t=>{t&&(this.articulosFull=t,this.articulos=JSON.parse(JSON.stringify(this.articulosFull)),this.applyFilter())}))},this.reloadCategoriasInSubcategoriasArticulos=()=>{this.loadCategorias(),this.frmSubcategoria.loadCategorias()},this.verTodos=()=>{this.categoria=null,this.categoriaGrupo=null,this.frmProductoComponent.resetArticulo(),this.categoriasGrupos=[],this.listasCategoriasGrupo=[],this.loadArticulos()},this.selectCategoria=t=>{this.categoria=t,this.categoriaGrupo=null,this.frmProductoComponent.resetArticulo(),this.articulos=[],this.loadSubCategorias(t.categoria)},this.selectSubcat=t=>{this.categoriaGrupo=t,this.loadSubCategorias(this.categoria.categoria,t.categoria_grupo)},this.articulo={articulo:null,categoria_grupo:null,presentacion:null,descripcion:null,precio:null,bien_servicio:"B",produccion:0,presentacion_reporte:null,mostrar_pos:0,impuesto_especial:null,rendimiento:1,mostrar_inventario:0}}ngOnInit(){this.loadCategorias(),this.loadArticulos()}ngOnDestroy(){this.endSubs.unsubscribe()}applyFilter(){this.articulos=this.txtFiltro.length>0?Object(w.c)(this.articulosFull,this.txtFiltro):JSON.parse(JSON.stringify(this.articulosFull))}}return t.\u0275fac=function(e){return new(e||t)(B.Nb(Q.a),B.Nb($.a))},t.\u0275cmp=B.Hb({type:t,selectors:[["app-producto"]],viewQuery:function(t,e){if(1&t&&(B.Kc(dn,1),B.Kc(bn,1)),2&t){let t;B.sc(t=B.cc())&&(e.frmProductoComponent=t.first),B.sc(t=B.cc())&&(e.frmSubcategoria=t.first)}},decls:22,vars:9,consts:[["label","Categor\xedas"],[3,"categoriaGrupoSvd","onChangeSubCategoriaEv"],["label","Sub-categor\xedas"],["frmSubcategoria",""],["label","Art\xedculos"],["fxLayout","row wrap","fxLayout.xs","column","fxLayoutAlign","start start"],["fxFlex","100%"],["color","primary","selected","",3,"click"],["color","accent","selected","",3,"click",4,"ngFor","ngForOf"],["class","divSubCategorias",4,"ngFor","ngForOf"],["fxFlex","40%","fxFlex.xs","100%","fxFlex.sm","100%","fxLayout","row wrap","fxLayoutGap","8px grid","fxLayoutAlign","start start",1,"divArticulos"],[1,"fullWidth"],["matInput","","placeholder","Buscar...",3,"ngModel","ngModelOptions","keyup","ngModelChange"],["mat-list-item","","class","accion-comanda mat-elevation-z4",3,"click",4,"ngFor","ngForOf"],["fxFlex","60%","fxFlex.xs","100%","fxFlex.sm","100%",1,"divArticulos"],[3,"categoria","subcategoria","articulo","articuloSvd"],["frmProducto",""],["color","accent","selected","",3,"click"],[1,"divSubCategorias"],["color","warn","selected","",3,"click",4,"ngFor","ngForOf"],["color","warn","selected","",3,"click"],["mat-list-item","",1,"accion-comanda","mat-elevation-z4",3,"click"]],template:function(t,e){1&t&&(B.Tb(0,"mat-tab-group"),B.Tb(1,"mat-tab",0),B.Tb(2,"app-categoria-producto",1),B.bc("categoriaGrupoSvd",function(){return e.reloadCategoriasInSubcategoriasArticulos()})("onChangeSubCategoriaEv",function(t){return e.setArticuloCategoriaGrupo(t)}),B.Sb(),B.Sb(),B.Tb(3,"mat-tab",2),B.Ob(4,"app-sub-categoria-producto",null,3),B.Sb(),B.Tb(6,"mat-tab",4),B.Tb(7,"div",5),B.Tb(8,"div",6),B.Tb(9,"mat-chip-list"),B.Tb(10,"mat-chip",7),B.bc("click",function(){return e.verTodos()}),B.Fc(11," Ver todos "),B.Sb(),B.Dc(12,un,2,1,"mat-chip",8),B.Sb(),B.Dc(13,mn,2,1,"mat-chip-list",9),B.Sb(),B.Tb(14,"div",10),B.Tb(15,"mat-form-field",11),B.Tb(16,"input",12),B.bc("keyup",function(){return e.applyFilter()})("ngModelChange",function(t){return e.txtFiltro=t}),B.Sb(),B.Sb(),B.Tb(17,"mat-action-list"),B.Dc(18,pn,3,4,"button",13),B.Sb(),B.Sb(),B.Tb(19,"div",14),B.Tb(20,"app-form-producto",15,16),B.bc("articuloSvd",function(t){return e.refreshArticuloList(t)}),B.Sb(),B.Sb(),B.Sb(),B.Sb(),B.Sb()),2&t&&(B.Cb(12),B.lc("ngForOf",e.categorias),B.Cb(1),B.lc("ngForOf",e.listasCategoriasGrupo),B.Cb(3),B.lc("ngModel",e.txtFiltro)("ngModelOptions",B.nc(8,fn)),B.Cb(2),B.lc("ngForOf",e.articulos),B.Cb(2),B.lc("categoria",e.categoria)("subcategoria",e.categoriaGrupo)("articulo",e.articulo))},directives:[m.b,m.a,Wo,oi,ii.c,ii.b,ii.a,O.b,O.a,i.l,ii.d,d.b,b.b,a.c,a.k,a.n,s.a,ln,s.c],pipes:[mi],styles:[".divArticulos[_ngcontent-%COMP%]{padding:3px 8px;overflow-y:auto;margin:0;height:85vh}.divArticulos[_ngcontent-%COMP%] > mat-card[_ngcontent-%COMP%]{width:200px;max-height:95px}.divSubCategorias[_ngcontent-%COMP%]{padding-top:3px;padding-bottom:3px}.accion-comanda[_ngcontent-%COMP%]{background-color:#fff;margin:10px 0}"]}),t})();const Sn=["frmEgreso"],vn=["frmIngreso"];let Cn=(()=>{class t{constructor(t,e,o){this.ls=t,this._snackBar=e,this.transformacionSrvc=o,this.mermaDetalle=[],this.showMerma=!0,this.bloqueoBotones=!1,this.transformar=()=>{this.bloqueoBotones=!0,this.egreso=this.frmEgreso.egreso,this.ingreso=this.frmIngreso.ingreso,this.transformacion={egreso:{tipo_movimiento:this.egreso.tipo_movimiento,fecha:this.egreso.fecha,proveedor:this.ingreso.proveedor,bodega:this.egreso.bodega,usuario:this.egreso.usuario,estatus_movimiento:this.egreso.estatus_movimiento,bodega_destino:this.egreso.bodega_destino,tipo_movimiento_destino:this.egreso.tipo_movimiento_destino,detalle:[]},ingreso:{tipo_movimiento:this.ingreso.tipo_movimiento,fecha:this.ingreso.fecha,proveedor:this.ingreso.proveedor,bodega:this.ingreso.bodega,usuario:this.ingreso.usuario,bodega_origen:this.ingreso.bodega_origen,comentario:this.ingreso.comentario,detalle:[]},merma:[]},this.frmEgreso.detallesMerma.forEach(t=>this.transformacion.merma.push({articulo:t.articulo,cantidad:t.cantidad,precio_unitario:t.precio_unitario,precio_total:t.precio_total,presentacion:t.presentacion,cantidad_utilizada:t.cantidad_utilizada})),this.frmEgreso.detallesEgreso.forEach(t=>this.transformacion.egreso.detalle.push({articulo:t.articulo,cantidad:t.cantidad,precio_unitario:t.precio_unitario,precio_total:t.precio_total,presentacion:t.presentacion})),this.frmIngreso.detallesIngreso.forEach(t=>this.transformacion.ingreso.detalle.push({articulo:t.articulo,cantidad:t.cantidad,precio_unitario:t.precio_unitario,precio_total:t.precio_total,presentacion:t.presentacion,cantidad_utilizada:t.cantidad_utilizada})),this.transformacion.egreso&&this.transformacion.egreso.detalle&&this.transformacion.egreso.detalle.length>0&&this.transformacion.ingreso&&this.transformacion.ingreso.detalle&&this.transformacion.ingreso.detalle.length>0?this.transformacionSrvc.transformar(this.transformacion).subscribe(t=>{this.bloqueoBotones=!1,t.exito?(this.frmEgreso.resetEgreso(),this.frmEgreso.detallesEgreso=[],this.frmEgreso.resetDetalleMerma(),this.frmEgreso.detallesMerma=[],this.frmIngreso.resetIngreso(),this.frmIngreso.detallesIngreso=[],this._snackBar.open("Transformaci\xf3n generada con \xe9xito...","Transformaci\xf3n",{duration:5e3})):this._snackBar.open(`ERROR: ${t.mensaje}`,"Transformaci\xf3n",{duration:3e3})}):(this.bloqueoBotones=!1,this._snackBar.open("Faltan datos necesario. Favor complete los datos e intente de nuevo.","Transformaci\xf3n",{duration:3e3}))}}ngOnInit(){this.egreso={egreso:null,tipo_movimiento:null,bodega:null,fecha:A().format(w.b.dbDateFormat),usuario:this.ls.get(w.b.usrTokenVar).idusr||0,estatus_movimiento:1,traslado:0},this.ingreso={ingreso:null,tipo_movimiento:null,fecha:A().format(w.b.dbDateFormat),bodega:null,usuario:this.ls.get(w.b.usrTokenVar).idusr||0,comentario:null,proveedor:null}}doSomething(){}}return t.\u0275fac=function(e){return new(e||t)(B.Nb($.a),B.Nb(v.b),B.Nb(he))},t.\u0275cmp=B.Hb({type:t,selectors:[["app-transformacion"]],viewQuery:function(t,e){if(1&t&&(B.Kc(Sn,1),B.Kc(vn,1)),2&t){let t;B.sc(t=B.cc())&&(e.frmEgreso=t.first),B.sc(t=B.cc())&&(e.frmIngreso=t.first)}},decls:15,vars:6,consts:[[1,"row"],[1,"col","m12","s12",2,"padding-bottom","5px !important"],["align","end"],["mat-raised-button","","type","button","color","accent",3,"disabled","click"],[2,"font-size","18pt"],[1,"col","m6","s12"],[3,"egreso","saveToDB","egresoChange","egresoSavedEv"],["frmEgreso",""],[3,"bodega","ingreso","saveToDB","ingresoChange","ingresoSavedEv"],["frmIngreso",""]],template:function(t,e){1&t&&(B.Tb(0,"div",0),B.Tb(1,"div",1),B.Tb(2,"div",2),B.Tb(3,"button",3),B.bc("click",function(){return e.transformar()}),B.Tb(4,"mat-icon",4),B.Fc(5,"transform"),B.Sb(),B.Fc(6,"\xa0Transformar "),B.Sb(),B.Sb(),B.Sb(),B.Sb(),B.Tb(7,"div",0),B.Tb(8,"div",5),B.Tb(9,"app-form-egreso",6,7),B.bc("egresoChange",function(t){return e.egreso=t})("egresoSavedEv",function(){return e.doSomething()}),B.Sb(),B.Sb(),B.Tb(11,"div",5),B.Tb(12,"app-form-ingreso",8,9),B.bc("ingresoChange",function(t){return e.ingreso=t})("ingresoSavedEv",function(){return e.doSomething()}),B.Sb(),B.Sb(),B.Sb(),B.Ob(14,"div",0)),2&t&&(B.Cb(3),B.lc("disabled",e.bloqueoBotones),B.Cb(6),B.lc("egreso",e.egreso)("saveToDB",!1),B.Cb(3),B.lc("bodega",!1)("ingreso",e.ingreso)("saveToDB",!1))},directives:[S.a,l.a,Ho,ce],styles:[""]}),t})();var Tn=o("2qVp"),Mn=o("NU9O");function Dn(t,e){if(1&t&&(B.Tb(0,"mat-option",13),B.Fc(1),B.Sb()),2&t){const t=e.$implicit;B.lc("value",t.sede.sede),B.Cb(1),B.Hc(" ",t.sede.nombre," ")}}function In(t,e){if(1&t&&(B.Tb(0,"mat-option",13),B.Fc(1),B.Sb()),2&t){const t=e.$implicit;B.lc("value",t.bodega),B.Cb(1),B.Hc(" ",t.descripcion," ")}}function Fn(t,e){1&t&&B.Ob(0,"app-cargando")}const xn=function(){return{standalone:!0}};let _n=(()=>{class t{constructor(t,e,o,i){this.snackBar=t,this.pdfServicio=e,this.sedeSrvc=o,this.bodegaSrvc=i,this.bodegas=[],this.sedes=[],this.params={},this.titulo="Existencias",this.cargando=!1,this.configBotones={showPdf:!0,showHtml:!1,showExcel:!0},this.endSubs=new Go.a,this.getSede=(t={})=>{this.endSubs.add(this.sedeSrvc.getSedes(t).subscribe(t=>{this.sedes=t}))},this.getBodega=(t={})=>{this.endSubs.add(this.bodegaSrvc.get(t).subscribe(t=>{this.bodegas=t}))},this.onSedesSelected=t=>{this.getBodega({sede:this.params.sede})},this.resetParams=()=>{this.params={fecha:A().format(w.b.dbDateFormat)},this.cargando=!1}}ngOnInit(){this.params.fecha=A().format(w.b.dbDateFormat),this.getSede()}ngOnDestroy(){this.endSubs.unsubscribe()}onSubmit(t=0){this.params.sede&&this.params.bodega&&this.params.sede.length>0&&this.params.bodega.length>0&&this.params.fecha&&A(this.params.fecha).isValid()?(this.params._excel=t,this.cargando=!0,this.endSubs.add(this.pdfServicio.getReporteExistencia(this.params).subscribe(e=>{if(this.cargando=!1,e){const o=new Blob([e],{type:0==+t?"application/pdf":"application/vnd.ms-excel"});Object(ni.saveAs)(o,`${this.titulo}_${A().format(w.b.dateTimeFormatRptName)}.${0==+t?"pdf":"xls"}`)}else this.snackBar.open("No se pudo generar el reporte...",this.titulo,{duration:3e3})}))):this.snackBar.open("Por favor ingrese todos los par\xe1metros.","Existencias",{duration:7e3})}}return t.\u0275fac=function(e){return new(e||t)(B.Nb(v.b),B.Nb(gi.a),B.Nb(Tn.a),B.Nb(K.a))},t.\u0275cmp=B.Hb({type:t,selectors:[["app-existencias"]],decls:24,vars:9,consts:[[1,"row"],[1,"col","m12","s12"],[1,"mat-elevation-z4","fullWidth"],["novalidate",""],["frmRptExistencias","ngForm"],[1,"fullWidth"],["name","sede","multiple","","required","",3,"ngModel","ngModelChange","selectionChange"],[3,"value",4,"ngFor","ngForOf"],["name","bodega","multiple","","required","",3,"ngModel","ngModelChange"],["matInput","","type","date","placeholder","Al","required","",3,"ngModel","ngModelOptions","ngModelChange"],["align","end"],[3,"configuracion","excelClick","pdfClick","resetParamsClick"],[4,"ngIf"],[3,"value"]],template:function(t,e){1&t&&(B.Tb(0,"div",0),B.Tb(1,"div",1),B.Tb(2,"mat-card",2),B.Tb(3,"mat-card-title"),B.Tb(4,"h4"),B.Fc(5,"Reporte de existencias"),B.Sb(),B.Sb(),B.Tb(6,"mat-card-content"),B.Tb(7,"form",3,4),B.Tb(9,"mat-form-field",5),B.Tb(10,"mat-label"),B.Fc(11,"Sede"),B.Sb(),B.Tb(12,"mat-select",6),B.bc("ngModelChange",function(t){return e.params.sede=t})("selectionChange",function(t){return e.onSedesSelected(t)}),B.Dc(13,Dn,2,2,"mat-option",7),B.Sb(),B.Sb(),B.Tb(14,"mat-form-field",5),B.Tb(15,"mat-label"),B.Fc(16,"Bodega"),B.Sb(),B.Tb(17,"mat-select",8),B.bc("ngModelChange",function(t){return e.params.bodega=t}),B.Dc(18,In,2,2,"mat-option",7),B.Sb(),B.Sb(),B.Tb(19,"mat-form-field",5),B.Tb(20,"input",9),B.bc("ngModelChange",function(t){return e.params.fecha=t}),B.Sb(),B.Sb(),B.Tb(21,"div",10),B.Tb(22,"app-rpt-botones",11),B.bc("excelClick",function(){return e.onSubmit(1)})("pdfClick",function(){return e.onSubmit()})("resetParamsClick",function(){return e.resetParams()}),B.Sb(),B.Sb(),B.Sb(),B.Dc(23,Fn,1,0,"app-cargando",12),B.Sb(),B.Sb(),B.Sb(),B.Sb()),2&t&&(B.Cb(12),B.lc("ngModel",e.params.sede),B.Cb(1),B.lc("ngForOf",e.sedes),B.Cb(4),B.lc("ngModel",e.params.bodega),B.Cb(1),B.lc("ngForOf",e.bodegas),B.Cb(2),B.lc("ngModel",e.params.fecha)("ngModelOptions",B.nc(8,xn)),B.Cb(2),B.lc("configuracion",e.configBotones),B.Cb(1),B.lc("ngIf",e.cargando))},directives:[u.a,u.h,u.c,a.r,a.l,a.m,d.b,d.f,f.a,a.p,a.k,a.n,i.l,b.b,a.c,Mn.a,i.m,G.m,ci.a],styles:[""]}),t})();function On(t,e){if(1&t&&(B.Tb(0,"mat-option",16),B.Fc(1),B.Sb()),2&t){const t=e.$implicit;B.lc("value",t),B.Cb(1),B.Hc(" ",t.descripcion," ")}}function yn(t,e){if(1&t&&(B.Tb(0,"mat-option",16),B.Fc(1),B.Sb()),2&t){const t=e.$implicit;B.lc("value",t.sede.sede),B.Cb(1),B.Hc(" ",t.sede.nombre," ")}}function kn(t,e){if(1&t&&(B.Tb(0,"mat-option",16),B.Fc(1),B.Sb()),2&t){const t=e.$implicit;B.lc("value",t.bodega),B.Cb(1),B.Hc(" ",t.descripcion," ")}}function En(t,e){1&t&&B.Ob(0,"app-cargando")}const wn=function(){return{standalone:!0}};let An=(()=>{class t{constructor(t,e,o,i,n){this.snackBar=t,this.pdfServicio=e,this.sedeSrvc=o,this.bodegaSrvc=i,this.articuloSrvc=n,this.bodegas=[],this.sedes=[],this.articulos=[],this.filteredArticulos=[],this.txtArticuloSelected=void 0,this.params={},this.titulo="Kardex",this.cargando=!1,this.configBotones={showPdf:!0,showHtml:!1,showExcel:!0},this.getDescripcionArticulo=t=>this.articulos.find(e=>+e.articulo==+t).descripcion||"",this.filtrarArticulos=t=>{if(t&&"string"==typeof t){const e=t.toLowerCase();this.filteredArticulos=this.articulos.filter(t=>t.descripcion.toLowerCase().includes(e))}else this.filteredArticulos=this.articulos},this.displayArticulo=t=>{if(t)return this.params.articulo=t.articulo,t.descripcion},this.getSede=(t={})=>{this.sedeSrvc.getSedes(t).subscribe(t=>{this.sedes=t})},this.getArticulo=(t={})=>{this.articuloSrvc.getArticulosIngreso(t).subscribe(t=>{this.articulos=t})},this.getBodega=(t={})=>{this.bodegaSrvc.get(t).subscribe(t=>{this.bodegas=t})},this.excelClick=()=>{this.params._excel=1,this.cargando=!0,this.pdfServicio.getReporteKardex(this.params).subscribe(t=>{if(this.cargando=!1,t){const e=new Blob([t],{type:"application/vnd.ms-excel"});Object(ni.saveAs)(e,`${this.titulo}_${A().format(w.b.dateTimeFormatRptName)}.xls`)}else this.snackBar.open("No se pudo generar el reporte...",this.titulo,{duration:3e3})})},this.onSedesSelected=t=>{this.getBodega({sede:this.params.sede})},this.resetParams=()=>{this.params={},this.cargando=!1}}ngOnInit(){this.getSede(),this.getArticulo(),this.txtArticuloSelected=void 0,this.params.fdel=A().format(w.b.dbDateFormat),this.params.fal=A().format(w.b.dbDateFormat)}onSubmit(){this.params._excel=0,this.pdfServicio.getReporteKardex(this.params).subscribe(t=>{if(t){const e=new Blob([t],{type:"application/pdf"});Object(ni.saveAs)(e,`${this.titulo}_${A().format(w.b.dateTimeFormatRptName)}.pdf`)}else this.snackBar.open("No se pudo generar el reporte...",this.titulo,{duration:3e3})})}}return t.\u0275fac=function(e){return new(e||t)(B.Nb(v.b),B.Nb(gi.a),B.Nb(Tn.a),B.Nb(K.a),B.Nb(Q.a))},t.\u0275cmp=B.Hb({type:t,selectors:[["app-kardex"]],decls:32,vars:18,consts:[[1,"row"],[1,"col","m12","s12"],[1,"mat-elevation-z4","fullWidth"],["novalidate",""],[1,"fullWidth"],["type","text","placeholder","Art\xedculo","matInput","","required","",3,"ngModel","ngModelOptions","matAutocomplete","ngModelChange","keyup"],[3,"displayWith"],["autoArticulos","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],["name","sede","multiple","",3,"ngModel","ngModelChange","selectionChange"],["name","bodega","multiple","",3,"ngModel","ngModelChange"],["matInput","","type","date","placeholder","Del","required","",3,"ngModel","ngModelOptions","ngModelChange"],["matInput","","type","date","placeholder","Al","required","",3,"ngModel","ngModelOptions","ngModelChange"],["align","end"],[3,"configuracion","excelClick","pdfClick","resetParamsClick"],[4,"ngIf"],[3,"value"]],template:function(t,e){if(1&t&&(B.Tb(0,"div",0),B.Tb(1,"div",1),B.Tb(2,"mat-card",2),B.Tb(3,"mat-card-title"),B.Tb(4,"h4"),B.Fc(5,"Kardex"),B.Sb(),B.Sb(),B.Tb(6,"mat-card-content"),B.Tb(7,"form",3),B.Tb(8,"mat-form-field",4),B.Tb(9,"mat-label"),B.Fc(10,"Art\xedculo"),B.Sb(),B.Tb(11,"input",5),B.bc("ngModelChange",function(t){return e.txtArticuloSelected=t})("keyup",function(){return e.filtrarArticulos(e.txtArticuloSelected)}),B.Sb(),B.Tb(12,"mat-autocomplete",6,7),B.Dc(14,On,2,2,"mat-option",8),B.Sb(),B.Sb(),B.Tb(15,"mat-form-field",4),B.Tb(16,"mat-label"),B.Fc(17,"Sede"),B.Sb(),B.Tb(18,"mat-select",9),B.bc("ngModelChange",function(t){return e.params.sede=t})("selectionChange",function(t){return e.onSedesSelected(t)}),B.Dc(19,yn,2,2,"mat-option",8),B.Sb(),B.Sb(),B.Tb(20,"mat-form-field",4),B.Tb(21,"mat-label"),B.Fc(22,"Bodega"),B.Sb(),B.Tb(23,"mat-select",10),B.bc("ngModelChange",function(t){return e.params.bodega=t}),B.Dc(24,kn,2,2,"mat-option",8),B.Sb(),B.Sb(),B.Tb(25,"mat-form-field",4),B.Tb(26,"input",11),B.bc("ngModelChange",function(t){return e.params.fdel=t}),B.Sb(),B.Sb(),B.Tb(27,"mat-form-field",4),B.Tb(28,"input",12),B.bc("ngModelChange",function(t){return e.params.fal=t}),B.Sb(),B.Sb(),B.Tb(29,"div",13),B.Tb(30,"app-rpt-botones",14),B.bc("excelClick",function(){return e.excelClick()})("pdfClick",function(){return e.onSubmit()})("resetParamsClick",function(){return e.resetParams()}),B.Sb(),B.Sb(),B.Sb(),B.Dc(31,En,1,0,"app-cargando",15),B.Sb(),B.Sb(),B.Sb(),B.Sb()),2&t){const t=B.tc(13);B.Cb(11),B.lc("ngModel",e.txtArticuloSelected)("ngModelOptions",B.nc(15,wn))("matAutocomplete",t),B.Cb(1),B.lc("displayWith",e.displayArticulo),B.Cb(2),B.lc("ngForOf",e.filteredArticulos),B.Cb(4),B.lc("ngModel",e.params.sede),B.Cb(1),B.lc("ngForOf",e.sedes),B.Cb(4),B.lc("ngModel",e.params.bodega),B.Cb(1),B.lc("ngForOf",e.bodegas),B.Cb(2),B.lc("ngModel",e.params.fdel)("ngModelOptions",B.nc(16,wn)),B.Cb(2),B.lc("ngModel",e.params.fal)("ngModelOptions",B.nc(17,wn)),B.Cb(2),B.lc("configuracion",e.configBotones),B.Cb(1),B.lc("ngIf",e.cargando)}},directives:[u.a,u.h,u.c,a.r,a.l,a.m,d.b,d.f,b.b,a.c,_.c,a.p,a.k,a.n,_.a,i.l,f.a,Mn.a,i.m,G.m,ci.a],styles:[""]}),t})();const Bn=["frmIngreso"];let $n=(()=>{class t{constructor(t,e,o){this.ls=t,this.snackBar=e,this.transformacionSrvc=o,this.bloqueoBotones=!1,this.transformar=()=>{this.bloqueoBotones=!0,this.ingreso=this.frmIngreso.ingreso,this.produccion={tipo_movimiento:this.ingreso.tipo_movimiento,fecha:this.ingreso.fecha,proveedor:this.ingreso.proveedor,bodega:this.ingreso.bodega,usuario:this.ingreso.usuario,bodega_origen:this.ingreso.bodega_origen,comentario:this.ingreso.comentario,detalle:[]},this.frmIngreso.detallesIngreso.forEach(t=>this.produccion.detalle.push({articulo:t.articulo,cantidad:t.cantidad,precio_unitario:t.precio_unitario,precio_total:t.precio_total,presentacion:t.presentacion})),this.produccion&&this.produccion.detalle&&this.produccion.detalle.length>0?this.transformacionSrvc.producir(this.produccion).subscribe(t=>{this.bloqueoBotones=!1,t.exito?(this.frmIngreso.resetIngreso(),this.frmIngreso.detallesIngreso=[],this.snackBar.open("Producto generado con \xe9xito...","Producci\xf3n",{duration:5e3})):this.snackBar.open(`ERROR: ${t.mensaje}`,"Producci\xf3n",{duration:3e3})}):(this.bloqueoBotones=!1,this.snackBar.open("Faltan datos necesario. Favor complete los datos e intente de nuevo.","Transformaci\xf3n",{duration:3e3}))},this.doSomething=()=>{}}ngOnInit(){this.ingreso={ingreso:null,tipo_movimiento:null,fecha:A().format(w.b.dbDateFormat),bodega:null,usuario:this.ls.get(w.b.usrTokenVar).idusr||0,comentario:null,proveedor:null}}}return t.\u0275fac=function(e){return new(e||t)(B.Nb($.a),B.Nb(v.b),B.Nb(he))},t.\u0275cmp=B.Hb({type:t,selectors:[["app-produccion"]],viewQuery:function(t,e){if(1&t&&B.Kc(Bn,1),2&t){let t;B.sc(t=B.cc())&&(e.frmIngreso=t.first)}},decls:11,vars:4,consts:[[1,"row"],[1,"col","m12","s12",2,"padding-bottom","5px !important"],["align","end"],["mat-raised-button","","type","button","color","accent",3,"disabled","click"],[2,"font-size","18pt"],[1,"col","m12","s12"],[3,"produccion","ingreso","saveToDB","ingresoChange","ingresoSavedEv"],["frmIngreso",""]],template:function(t,e){1&t&&(B.Tb(0,"div",0),B.Tb(1,"div",1),B.Tb(2,"div",2),B.Tb(3,"button",3),B.bc("click",function(){return e.transformar()}),B.Tb(4,"mat-icon",4),B.Fc(5,"transform"),B.Sb(),B.Fc(6,"\xa0Producir "),B.Sb(),B.Sb(),B.Sb(),B.Sb(),B.Tb(7,"div",0),B.Tb(8,"div",5),B.Tb(9,"app-form-ingreso",6,7),B.bc("ingresoChange",function(t){return e.ingreso=t})("ingresoSavedEv",function(){return e.doSomething()}),B.Sb(),B.Sb(),B.Sb()),2&t&&(B.Cb(3),B.lc("disabled",e.bloqueoBotones),B.Cb(6),B.lc("produccion",!0)("ingreso",e.ingreso)("saveToDB",!1))},directives:[S.a,l.a,ce],styles:[""]}),t})();function Rn(t,e){if(1&t&&(B.Tb(0,"mat-option",13),B.Fc(1),B.Sb()),2&t){const t=e.$implicit;B.lc("value",t.sede.sede),B.Cb(1),B.Hc(" ",t.sede.nombre," ")}}function Hn(t,e){if(1&t&&(B.Tb(0,"mat-option",13),B.Fc(1),B.Sb()),2&t){const t=e.$implicit;B.lc("value",t.bodega),B.Cb(1),B.Hc(" ",t.descripcion," ")}}function Pn(t,e){1&t&&B.Ob(0,"app-cargando")}const Nn=function(){return{standalone:!0}};let Un=(()=>{class t{constructor(t,e,o,i){this.snackBar=t,this.pdfServicio=e,this.sedeSrvc=o,this.bodegaSrvc=i,this.bodegas=[],this.sedes=[],this.params={},this.titulo="Valorizado",this.cargando=!1,this.configBotones={showPdf:!0,showHtml:!1,showExcel:!0},this.endSubs=new Go.a,this.getSede=(t={})=>{this.endSubs.add(this.sedeSrvc.getSedes(t).subscribe(t=>{this.sedes=t}))},this.getBodega=(t={})=>{this.endSubs.add(this.bodegaSrvc.get(t).subscribe(t=>{this.bodegas=t}))},this.onSedesSelected=t=>{this.getBodega({sede:this.params.sede})},this.resetParams=()=>{this.params={fecha:A().format(w.b.dbDateFormat)},this.cargando=!1}}ngOnInit(){this.params.fecha=A().format(w.b.dbDateFormat),this.getSede(),this.getBodega()}ngOnDestroy(){this.endSubs.unsubscribe()}onSubmit(t=0){this.params.sede&&this.params.bodega&&this.params.sede.length>0&&this.params.bodega.length>0&&this.params.fecha&&A(this.params.fecha).isValid()?(this.params._excel=t,this.cargando=!0,this.endSubs.add(this.pdfServicio.getReporteValorizado(this.params).subscribe(e=>{if(this.cargando=!1,e){const o=new Blob([e],{type:0==+t?"application/pdf":"application/vnd.ms-excel"});Object(ni.saveAs)(o,`${this.titulo}_${A().format(w.b.dateTimeFormatRptName)}.${0==+t?"pdf":"xls"}`)}else this.snackBar.open("No se pudo generar el reporte...",this.titulo,{duration:3e3})}))):this.snackBar.open("Por favor ingrese todos los par\xe1metros.","Inventario Valorizado",{duration:7e3})}}return t.\u0275fac=function(e){return new(e||t)(B.Nb(v.b),B.Nb(gi.a),B.Nb(Tn.a),B.Nb(K.a))},t.\u0275cmp=B.Hb({type:t,selectors:[["app-valorizado"]],decls:24,vars:9,consts:[[1,"row"],[1,"col","m12","s12"],[1,"mat-elevation-z4","fullWidth"],["novalidate",""],["frmRptValorizado","ngForm"],[1,"fullWidth"],["name","sede","multiple","","required","",3,"ngModel","ngModelChange","selectionChange"],[3,"value",4,"ngFor","ngForOf"],["name","bodega","multiple","","required","",3,"ngModel","ngModelChange"],["matInput","","type","date","placeholder","Al","required","",3,"ngModel","ngModelOptions","ngModelChange"],["align","end"],[3,"configuracion","excelClick","pdfClick","resetParamsClick"],[4,"ngIf"],[3,"value"]],template:function(t,e){1&t&&(B.Tb(0,"div",0),B.Tb(1,"div",1),B.Tb(2,"mat-card",2),B.Tb(3,"mat-card-title"),B.Tb(4,"h4"),B.Fc(5,"Inventario Valorizado"),B.Sb(),B.Sb(),B.Tb(6,"mat-card-content"),B.Tb(7,"form",3,4),B.Tb(9,"mat-form-field",5),B.Tb(10,"mat-label"),B.Fc(11,"Sede"),B.Sb(),B.Tb(12,"mat-select",6),B.bc("ngModelChange",function(t){return e.params.sede=t})("selectionChange",function(t){return e.onSedesSelected(t)}),B.Dc(13,Rn,2,2,"mat-option",7),B.Sb(),B.Sb(),B.Tb(14,"mat-form-field",5),B.Tb(15,"mat-label"),B.Fc(16,"Bodega"),B.Sb(),B.Tb(17,"mat-select",8),B.bc("ngModelChange",function(t){return e.params.bodega=t}),B.Dc(18,Hn,2,2,"mat-option",7),B.Sb(),B.Sb(),B.Tb(19,"mat-form-field",5),B.Tb(20,"input",9),B.bc("ngModelChange",function(t){return e.params.fecha=t}),B.Sb(),B.Sb(),B.Tb(21,"div",10),B.Tb(22,"app-rpt-botones",11),B.bc("excelClick",function(){return e.onSubmit(1)})("pdfClick",function(){return e.onSubmit()})("resetParamsClick",function(){return e.resetParams()}),B.Sb(),B.Sb(),B.Sb(),B.Dc(23,Pn,1,0,"app-cargando",12),B.Sb(),B.Sb(),B.Sb(),B.Sb()),2&t&&(B.Cb(12),B.lc("ngModel",e.params.sede),B.Cb(1),B.lc("ngForOf",e.sedes),B.Cb(4),B.lc("ngModel",e.params.bodega),B.Cb(1),B.lc("ngForOf",e.bodegas),B.Cb(2),B.lc("ngModel",e.params.fecha)("ngModelOptions",B.nc(8,Nn)),B.Cb(2),B.lc("configuracion",e.configBotones),B.Cb(1),B.lc("ngIf",e.cargando))},directives:[u.a,u.h,u.c,a.r,a.l,a.m,d.b,d.f,f.a,a.p,a.k,a.n,i.l,b.b,a.c,Mn.a,i.m,G.m,ci.a],styles:[""]}),t})(),Gn=(()=>{class t{constructor(t){this.http=t,this.fisicoUrl="fisico",this.srvcErrHndl=new R.a}generarInventarioFisico(t){return this.http.post(`${w.b.urlWms}/${this.fisicoUrl}/generar`,t).pipe(Object(H.a)(w.b.reintentos),Object(P.a)(this.srvcErrHndl.errorHandler))}confirmar(t){return this.http.post(`${w.b.urlWms}/${this.fisicoUrl}/confirmar/${+t.inventario_fisico>0?"/"+t.inventario_fisico:""}`,{}).pipe(Object(H.a)(w.b.reintentos),Object(P.a)(this.srvcErrHndl.errorHandler))}getDetalle(t,e={}){return this.http.get(`${w.b.urlWms}/${this.fisicoUrl}/buscar_detalle/${t}?${N.stringify(e)}`).pipe(Object(H.a)(w.b.reintentos),Object(P.a)(this.srvcErrHndl.errorHandler))}saveDetalle(t){return this.http.post(`${w.b.urlWms}/${this.fisicoUrl}/actualizar/`,t).pipe(Object(H.a)(w.b.reintentos),Object(P.a)(this.srvcErrHndl.errorHandler))}}return t.\u0275fac=function(e){return new(e||t)(B.Xb(n.b))},t.\u0275prov=B.Jb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function zn(t,e){1&t&&(B.Tb(0,"mat-icon",8),B.Fc(1,"expand_more"),B.Sb())}function qn(t,e){1&t&&(B.Tb(0,"mat-icon",8),B.Fc(1,"expand_less"),B.Sb())}function jn(t,e){if(1&t&&(B.Tb(0,"mat-option",21),B.Fc(1),B.Sb()),2&t){const t=e.$implicit;B.lc("value",t.bodega),B.Cb(1),B.Hc(" ",t.descripcion," ")}}function Wn(t,e){if(1&t&&(B.Tb(0,"mat-option",21),B.Fc(1),B.Sb()),2&t){const t=e.$implicit;B.lc("value",t.sede),B.Cb(1),B.Hc(" ",t.nombre," ")}}function Ln(t,e){if(1&t&&(B.Tb(0,"mat-option",21),B.Fc(1),B.Sb()),2&t){const t=e.$implicit;B.lc("value",t),B.Cb(1),B.Hc(" ",t.descripcion," ")}}function Vn(t,e){if(1&t&&(B.Tb(0,"mat-option",21),B.Fc(1),B.Sb()),2&t){const t=e.$implicit;B.lc("value",t.categoria_grupo),B.Cb(1),B.Hc(" ",t.descripcion," ")}}function Kn(t,e){1&t&&B.Ob(0,"app-cargando")}const Qn=function(){return{standalone:!0}};function Jn(t,e){if(1&t){const t=B.Ub();B.Tb(0,"mat-card-content"),B.Tb(1,"form",9,10),B.bc("ngSubmit",function(){B.xc(t);const e=B.tc(2),o=B.fc();return e.form.valid&&o.onSubmit()}),B.Tb(3,"mat-form-field",11),B.Tb(4,"mat-label"),B.Fc(5,"Bodega"),B.Sb(),B.Tb(6,"mat-select",12),B.bc("ngModelChange",function(e){return B.xc(t),B.fc().params.bodega=e}),B.Dc(7,jn,2,2,"mat-option",13),B.Sb(),B.Sb(),B.Tb(8,"mat-form-field",11),B.Tb(9,"mat-label"),B.Fc(10,"Sede"),B.Sb(),B.Tb(11,"mat-select",14),B.bc("ngModelChange",function(e){return B.xc(t),B.fc().params.sede=e}),B.Dc(12,Wn,2,2,"mat-option",13),B.Sb(),B.Sb(),B.Tb(13,"mat-form-field",11),B.Tb(14,"mat-label"),B.Fc(15,"Categor\xeda"),B.Sb(),B.Tb(16,"mat-select",15),B.bc("selectionChange",function(e){return B.xc(t),B.fc().onCategoriaSelected(e)}),B.Dc(17,Ln,2,2,"mat-option",13),B.Sb(),B.Sb(),B.Tb(18,"mat-form-field",11),B.Tb(19,"mat-label"),B.Fc(20,"Sub-categor\xeda"),B.Sb(),B.Tb(21,"mat-select",16),B.bc("ngModelChange",function(e){return B.xc(t),B.fc().params.categoria_grupo_grupo=e}),B.Dc(22,Vn,2,2,"mat-option",13),B.Sb(),B.Sb(),B.Tb(23,"mat-form-field",11),B.Tb(24,"input",17),B.bc("ngModelChange",function(e){return B.xc(t),B.fc().params.fecha=e}),B.Sb(),B.Sb(),B.Tb(25,"mat-checkbox",18),B.bc("ngModelChange",function(e){return B.xc(t),+(B.fc().params._excel=e)}),B.Fc(26,"Generar en Excel "),B.Sb(),B.Tb(27,"div",19),B.Tb(28,"button",20),B.Fc(29,"GENERAR"),B.Sb(),B.Sb(),B.Sb(),B.Dc(30,Kn,1,0,"app-cargando",7),B.Sb()}if(2&t){const t=B.tc(2),e=B.fc();B.Cb(6),B.lc("ngModel",e.params.bodega),B.Cb(1),B.lc("ngForOf",e.bodegas),B.Cb(4),B.lc("ngModel",e.params.sede),B.Cb(1),B.lc("ngForOf",e.sedes),B.Cb(5),B.lc("ngForOf",e.categorias),B.Cb(4),B.lc("ngModel",e.params.categoria_grupo_grupo),B.Cb(1),B.lc("ngForOf",e.categoriasGruposPadre),B.Cb(2),B.lc("ngModel",e.params.fecha)("ngModelOptions",B.nc(12,Qn)),B.Cb(1),B.lc("ngModel",+e.params._excel),B.Cb(3),B.lc("disabled",!t.form.valid),B.Cb(2),B.lc("ngIf",e.cargando)}}let Xn=(()=>{class t{constructor(t,e,o,i,n,a,c){this.snackBar=t,this.pdfServicio=e,this.sedeSrvc=o,this.bodegaSrvc=i,this.articuloSrvc=n,this.fisicoSrvc=a,this.ls=c,this.bodegas=[],this.sedes=[],this.params={},this.categorias=[],this.categoriasGruposPadre=[],this.categoriasGrupos=[],this.titulo="Fisico",this.cargando=!1,this.showReporte=!0,this.getSede=(t={})=>{this.sedeSrvc.get(t).subscribe(t=>{this.sedes=t})},this.getBodega=(t={})=>{this.bodegaSrvc.get(t).subscribe(t=>{this.bodegas=t})},this.loadCategorias=()=>{this.articuloSrvc.getCategorias({sede:+this.ls.get(w.b.usrTokenVar).sede||0}).subscribe(t=>{t&&(this.categorias=t)})},this.onCategoriaSelected=t=>this.loadSubCategorias(+t.value.categoria),this.loadSubCategorias=t=>{this.articuloSrvc.getCategoriasGrupos({categoria:+t}).subscribe(t=>{t&&(this.categoriasGruposPadre=this.articuloSrvc.adaptCategoriaGrupoResponse(t),this.categoriasGrupos=this.categoriasGruposPadre)})},this.onSubCategoriaPadreSelected=t=>this.loadSubCategoriasSubcategorias(+t.value),this.loadSubCategoriasSubcategorias=t=>{this.articuloSrvc.getCategoriasGrupos({categoria_grupo_grupo:t}).subscribe(t=>{t&&(this.categoriasGrupos=this.articuloSrvc.adaptCategoriaGrupoResponse(t))})}}ngOnInit(){this.getSede(),this.getBodega(),this.loadCategorias(),this.params.fecha=A().format(w.b.dbDateFormat)}onSubmit(){this.cargando=!0,this.fisicoSrvc.generarInventarioFisico(this.params).subscribe(t=>{this.cargando=!1,console.log(t),t.exito?this.pdfServicio.imprimirInventarioFisico(t.inventario,this.params).subscribe(t=>{if(this.params._excel){const e=new Blob([t],{type:"application/vnd.ms-excel"});Object(ni.saveAs)(e,`${this.titulo}.xls`)}else{const e=new Blob([t],{type:"application/pdf"});Object(ni.saveAs)(e,`${this.titulo}.pdf`)}}):this.snackBar.open("No se pudo generar el reporte... "+t.mensaje,this.titulo,{duration:3e3})})}}return t.\u0275fac=function(e){return new(e||t)(B.Nb(v.b),B.Nb(gi.a),B.Nb(ai.a),B.Nb(K.a),B.Nb(Q.a),B.Nb(Gn),B.Nb($.a))},t.\u0275cmp=B.Hb({type:t,selectors:[["app-reporte"]],decls:13,vars:3,consts:[[1,"row"],[1,"col","m12","s12"],[1,"mat-elevation-z4","fullWidth"],[1,"col"],[1,"col",2,"float","right"],["mat-button","","type","button","color","accent",3,"click"],["class","iconFontSize",4,"ngIf"],[4,"ngIf"],[1,"iconFontSize"],["novalidate","",3,"ngSubmit"],["frmFisicoReporte","ngForm"],[1,"fullWidth"],["name","bodega","required","",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["name","sede","required","",3,"ngModel","ngModelChange"],["name","categoria",3,"selectionChange"],["name","categoriaGrupoPadre",3,"ngModel","ngModelChange"],["matInput","","type","date","placeholder","Fecha","readonly","","required","",3,"ngModel","ngModelOptions","ngModelChange"],["name","excel",1,"fullWidth",3,"ngModel","ngModelChange"],["align","end"],["mat-button","","color","accent","type","submit",3,"disabled"],[3,"value"]],template:function(t,e){1&t&&(B.Tb(0,"div",0),B.Tb(1,"div",1),B.Tb(2,"mat-card",2),B.Tb(3,"mat-card-title"),B.Tb(4,"div",0),B.Tb(5,"div",3),B.Tb(6,"h4"),B.Fc(7,"Inventario F\xedsico"),B.Sb(),B.Sb(),B.Tb(8,"div",4),B.Tb(9,"button",5),B.bc("click",function(){return e.showReporte=!e.showReporte}),B.Dc(10,zn,2,0,"mat-icon",6),B.Dc(11,qn,2,0,"mat-icon",6),B.Sb(),B.Sb(),B.Sb(),B.Sb(),B.Dc(12,Jn,31,13,"mat-card-content",7),B.Sb(),B.Sb(),B.Sb()),2&t&&(B.Cb(10),B.lc("ngIf",e.showReporte),B.Cb(1),B.lc("ngIf",!e.showReporte),B.Cb(1),B.lc("ngIf",e.showReporte))},directives:[u.a,u.h,S.a,i.m,l.a,u.c,a.r,a.l,a.m,d.b,d.f,f.a,a.p,a.k,a.n,i.l,b.b,a.c,h.a,G.m,ci.a],styles:[""]}),t})();function Yn(t,e){1&t&&(B.Tb(0,"mat-icon",9),B.Fc(1,"expand_more"),B.Sb())}function Zn(t,e){1&t&&(B.Tb(0,"mat-icon",9),B.Fc(1,"expand_less"),B.Sb())}function ta(t,e){1&t&&B.Ob(0,"app-cargando")}function ea(t,e){if(1&t){const t=B.Ub();B.Tb(0,"mat-card-content"),B.Tb(1,"form",10),B.bc("ngSubmit",function(){return B.xc(t),B.fc().buscar()}),B.Tb(2,"mat-form-field",11),B.Tb(3,"input",12),B.bc("ngModelChange",function(e){return B.xc(t),B.fc().params.numero=e}),B.Sb(),B.Tb(4,"button",13),B.Fc(5,"Buscar"),B.Sb(),B.Sb(),B.Sb(),B.Dc(6,ta,1,0,"app-cargando",7),B.Sb()}if(2&t){const t=B.fc();B.Cb(3),B.lc("ngModel",t.params.numero),B.Cb(3),B.lc("ngIf",t.cargando)}}const oa=function(){return{standalone:!0}};function ia(t,e){if(1&t&&(B.Tb(0,"tr"),B.Tb(1,"td",24),B.Fc(2),B.Sb(),B.Tb(3,"td",24),B.Tb(4,"mat-form-field"),B.Tb(5,"input",25),B.bc("ngModelChange",function(t){return e.$implicit.existencia_sistema=t}),B.Sb(),B.Sb(),B.Sb(),B.Tb(6,"td",24),B.Tb(7,"mat-form-field",11),B.Tb(8,"input",26),B.bc("ngModelChange",function(t){return e.$implicit.existencia_fisica=t}),B.Sb(),B.Sb(),B.Sb(),B.Sb()),2&t){const t=e.$implicit;B.Cb(2),B.Hc(" ",t.narticulo," "),B.Cb(3),B.lc("ngModel",t.existencia_sistema)("ngModelOptions",B.nc(5,oa)),B.Cb(3),B.lc("ngModel",t.existencia_fisica)("ngModelOptions",B.nc(6,oa))}}function na(t,e){if(1&t&&(B.Rb(0),B.Tb(1,"tr"),B.Tb(2,"th",23),B.Fc(3),B.Sb(),B.Sb(),B.Dc(4,ia,9,7,"tr",17),B.Qb()),2&t){const t=e.$implicit;B.Cb(3),B.Gc(t.descripcion),B.Cb(1),B.lc("ngForOf",t.datos)}}function aa(t,e){if(1&t&&(B.Rb(0),B.Tb(1,"tr"),B.Tb(2,"th",22),B.Tb(3,"mat-label"),B.Fc(4),B.Sb(),B.Sb(),B.Sb(),B.Dc(5,na,5,2,"ng-container",17),B.Qb()),2&t){const t=e.$implicit;B.Cb(4),B.Gc(t.descripcion),B.Cb(1),B.lc("ngForOf",t.datos)}}function ca(t,e){1&t&&(B.Tb(0,"button",27),B.Fc(1,"Guardar"),B.Sb())}function ra(t,e){if(1&t){const t=B.Ub();B.Tb(0,"button",20),B.bc("click",function(){return B.xc(t),B.fc(2).confirmar()}),B.Fc(1,"Confirmar"),B.Sb()}}function sa(t,e){1&t&&B.Ob(0,"app-cargando")}function la(t,e){if(1&t){const t=B.Ub();B.Tb(0,"div",0),B.Tb(1,"div",1),B.Tb(2,"mat-card",2),B.Ob(3,"mat-card-title"),B.Tb(4,"mat-card-content"),B.Tb(5,"form",14,15),B.bc("ngSubmit",function(){B.xc(t);const e=B.tc(6),o=B.fc();return e.form.valid&&o.actualizar()}),B.Tb(7,"table",16),B.Dc(8,aa,6,2,"ng-container",17),B.Sb(),B.Tb(9,"div",18),B.Dc(10,ca,2,0,"button",19),B.Tb(11,"button",20),B.bc("click",function(){return B.xc(t),B.fc().imprimir()}),B.Fc(12,"PDF"),B.Sb(),B.Tb(13,"button",20),B.bc("click",function(){return B.xc(t),B.fc().imprimirXls()}),B.Fc(14,"Excel"),B.Sb(),B.Dc(15,ra,2,0,"button",21),B.Sb(),B.Sb(),B.Dc(16,sa,1,0,"app-cargando",7),B.Sb(),B.Sb(),B.Sb(),B.Sb()}if(2&t){const t=B.fc();B.Cb(8),B.lc("ngForOf",t.articulos),B.Cb(2),B.lc("ngIf",0==t.inventario.confirmado),B.Cb(5),B.lc("ngIf",0==t.inventario.confirmado),B.Cb(1),B.lc("ngIf",t.cargando)}}let da=(()=>{class t{constructor(t,e,o,i){this.snackBar=t,this.pdfServicio=e,this.fisicoSrvc=o,this.dialog=i,this.showForm=!0,this.params={},this.cargando=!1,this.articulos=[],this.inventario={},this.titulo="Inventario_Fisico",this.resetDatos=()=>{this.articulos=[],this.inventario={inventario_fisico:0,sede:null,usuario:null,categoria_grupo:null,fhcreacion:null,fecha:null,notas:null,confirmado:0}},this.buscar=()=>{(""+this.params.numero).length<19?(this.resetDatos(),this.fisicoSrvc.getDetalle(this.params.numero).subscribe(t=>{t&&t.exito?(this.articulos=t.detalle,this.inventario=t.inventario):this.snackBar.open(`ERROR: ${t.mensaje}`,"Inventario",{duration:3e3})})):this.snackBar.open("ERROR: El texto sobrepasa la longitud permitida","Inventario",{duration:3e3})},this.actualizar=()=>{this.fisicoSrvc.saveDetalle(this.articulos).subscribe(t=>{this.snackBar.open(t.exito?"Datos actualizados exitosamente":`ERROR: ${t.mensaje}`,"Inventario",{duration:3e3})})},this.confirmar=()=>{this.dialog.open(W.a,{maxWidth:"400px",data:new W.b("Confirmar Inventario Fisico","No podr\xe1 modificar los datos ingresados. \xbfDesea continuar?","S\xed","No")}).afterClosed().subscribe(t=>{t&&this.fisicoSrvc.confirmar(this.inventario).subscribe(t=>{t.exito?(this.inventario=t.inventario,this.snackBar.open("Inventario confirmado exitosamente","Inventario",{duration:3e3})):this.snackBar.open(`ERROR: ${t.mensaje}`,"Inventario",{duration:3e3})})})},this.imprimir=()=>{this.pdfServicio.imprimirInventarioFisico(this.inventario.inventario_fisico,{existencia_fisica:!0}).subscribe(t=>{const e=new Blob([t],{type:"application/pdf"});Object(ni.saveAs)(e,`${this.titulo}.pdf`)})},this.imprimirXls=()=>{this.pdfServicio.imprimirInventarioFisico(this.inventario.inventario_fisico,{existencia_fisica:!0,_excel:!0}).subscribe(t=>{const e=new Blob([t],{type:"application/vnd.ms-excel"});Object(ni.saveAs)(e,`${this.titulo}.xls`)})}}ngOnInit(){this.resetDatos()}}return t.\u0275fac=function(e){return new(e||t)(B.Nb(v.b),B.Nb(gi.a),B.Nb(Gn),B.Nb(I.b))},t.\u0275cmp=B.Hb({type:t,selectors:[["app-form-inventario-fisico"]],decls:14,vars:4,consts:[[1,"row"],[1,"col","m12","s12"],[1,"mat-elevation-z4","fullWidth"],[1,"col"],[1,"col",2,"float","right"],["mat-button","","type","button","color","accent",3,"click"],["class","iconFontSize",4,"ngIf"],[4,"ngIf"],["class","row",4,"ngIf"],[1,"iconFontSize"],["novalidate","",3,"ngSubmit"],[1,"fullWidth"],["matInput","","type","number","maxlength","17","max","17","placeholder","N\xfamero","name","numero","required","",3,"ngModel","ngModelChange"],["mat-raised-button","","matSuffix","","color","accent","type","submit"],["novalidate","","autocomplete","off",3,"ngSubmit"],["frmConteoFisico","ngForm"],[1,"tbl"],[4,"ngFor","ngForOf"],["align","end"],["mat-button","","color","accent","type","submit",4,"ngIf"],["mat-button","","color","accent","type","button",3,"click"],["mat-button","","color","accent","type","button",3,"click",4,"ngIf"],["colspan","2",1,"brdTSingleBSingle"],["colspan","3",1,"brdTSingleBSingle"],[1,"brdTSingleBSingle"],["matInput","","type","number","step","0.01","placeholder","Existencia Sistema","disabled","",2,"color","black","-webkit-text-fill-color","black",3,"ngModel","ngModelOptions","ngModelChange"],["matInput","","type","number","step","0.01","placeholder","Cantidad","required","",3,"ngModel","ngModelOptions","ngModelChange"],["mat-button","","color","accent","type","submit"]],template:function(t,e){1&t&&(B.Tb(0,"div",0),B.Tb(1,"div",1),B.Tb(2,"mat-card",2),B.Tb(3,"mat-card-title"),B.Tb(4,"div",0),B.Tb(5,"div",3),B.Tb(6,"h4"),B.Fc(7,"Ingreso Inventario F\xedsico"),B.Sb(),B.Sb(),B.Tb(8,"div",4),B.Tb(9,"button",5),B.bc("click",function(){return e.showForm=!e.showForm}),B.Dc(10,Yn,2,0,"mat-icon",6),B.Dc(11,Zn,2,0,"mat-icon",6),B.Sb(),B.Sb(),B.Sb(),B.Sb(),B.Dc(12,ea,7,2,"mat-card-content",7),B.Sb(),B.Sb(),B.Sb(),B.Dc(13,la,17,4,"div",8)),2&t&&(B.Cb(10),B.lc("ngIf",e.showForm),B.Cb(1),B.lc("ngIf",!e.showForm),B.Cb(1),B.lc("ngIf",e.showForm),B.Cb(1),B.lc("ngIf",e.articulos.length>0))},directives:[u.a,u.h,S.a,i.m,l.a,u.c,a.r,a.l,a.m,d.b,b.b,a.o,a.c,a.f,a.p,a.k,a.n,d.g,ci.a,i.l,d.f],styles:[""]}),t})();const ba=["rptInventario"],ua=["frmInventario"],ga=[{path:"ingresos",component:le,canActivate:[E.a]},{path:"egresos",component:Uo,canActivate:[E.a]},{path:"articulos",component:hn,canActivate:[E.a]},{path:"transformaciones",component:Cn,canActivate:[E.a]},{path:"rptexistencia",component:_n,canActivate:[E.a]},{path:"rptkardex",component:An,canActivate:[E.a]},{path:"produccion",component:$n,canActivate:[E.a]},{path:"rptvalorizado",component:Un,canActivate:[E.a]},{path:"fisico",component:(()=>{class t{constructor(){}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=B.Hb({type:t,selectors:[["app-fisico"]],viewQuery:function(t,e){if(1&t&&(B.Kc(ba,1),B.Kc(ua,1)),2&t){let t;B.sc(t=B.cc())&&(e.rptInventarioComponent=t.first),B.sc(t=B.cc())&&(e.frmInventarioComponent=t.first)}},decls:6,vars:0,consts:[[1,"row"],[1,"col","s12","m12"]],template:function(t,e){1&t&&(B.Tb(0,"div",0),B.Tb(1,"div",1),B.Ob(2,"app-reporte"),B.Sb(),B.Sb(),B.Tb(3,"div",0),B.Tb(4,"div",1),B.Ob(5,"app-form-inventario-fisico"),B.Sb(),B.Sb())},directives:[Xn,da],styles:[""]}),t})(),canActivate:[E.a]},{path:"replicar_articulos_sedes",component:li,canActivate:[E.a]},{path:"**",redirectTo:"/admin/dashboard",pathMatch:"full"}];let ma=(()=>{class t{}return t.\u0275mod=B.Lb({type:t}),t.\u0275inj=B.Kb({factory:function(e){return new(e||t)},imports:[[k.d.forChild(ga)],k.d]}),t})(),pa=(()=>{class t{}return t.\u0275mod=B.Lb({type:t}),t.\u0275inj=B.Kb({factory:function(e){return new(e||t)},providers:[],imports:[[i.c,ma,c.a,r.a,n.c,a.e,y.b,s.d,l.b,d.d,b.c,u.f,g.b,m.c,p.m,f.b,h.b,S.b,v.c,C.b,T.d,M.b,D.b,I.e,F.d,x.c,_.b,O.c]]}),t})()}}]);