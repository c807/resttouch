(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{k2MF:function(t,e,a){"use strict";a.r(e),a.d(e,"RestauranteModule",function(){return qs});var o=a("ofXK"),n=a("tk/3"),i=a("3Pt+"),s=a("PCNd"),c=a("vtFA"),r=a("qodq"),l=a("Kr0P"),d=a("YUcS"),u=a("MutI"),b=a("NFeN"),m=a("kmnG"),h=a("qFsG"),p=a("Wp6s"),f=a("f0Cb"),g=a("wZkO"),S=a("+0xr"),C=a("d3UM"),T=a("bSwM"),v=a("bTqV"),M=a("dNgK"),F=a("/t3+"),x=a("STbY"),k=a("zkoq"),O=a("M9IT"),D=a("0IaG"),E=a("XhcP"),P=a("iadO"),_=a("FKr1"),y=a("5+WD"),I=a("TU8p"),w=a("A5z7"),A=a("2ChS"),N=a("uM5D"),R=a("JbvS"),U=a("XNiG"),$=a("Cfvw"),B=a("xgIS"),j=a("5+tZ"),H=a("lJxs"),L=a("pLZG"),q=a("Kj3r"),z=a("/uUt"),G=a("1G5W"),W=a("fXoL");let V=(()=>{class t{constructor(t){this.elementRef=t,this.debounce=0,this.skipStart=0,this.onDelete=new W.o,this.onDetected=new W.o,this.destroy$=new U.a}ngAfterViewInit(){const t={};Object($.a)(["keydown","keyup"]).pipe(Object(j.a)(t=>Object(B.a)(this.elementRef.nativeElement,t)),Object(H.a)(e=>{switch(e.type){case"keydown":t[e.which]=e.timeStamp;break;case"keyup":Object.assign(e,{duration:(e.timeStamp-t[e.which])/1e3})}return e}),Object(L.a)(t=>(8!==t.keyCode&&"Backspace"!==t.code&&8!==t.which||this.onDelete.emit({event:t,value:t.target.value,type:"delete"}),t.target.value.length>this.skipStart)),Object(q.a)(this.debounce),Object(z.a)()).pipe(Object(G.a)(this.destroy$)).subscribe(t=>{t.duration>.02?this.onDetected.emit({event:t,value:t.target.value,time:t.duration,type:"keyboard"}):t.duration<=.02&&this.onDetected.emit({event:t,value:t.target.value,time:t.duration,type:"scanner"})})}ngOnDestroy(){this.destroy$.next(!0),this.destroy$.complete()}}return t.\u0275fac=function(e){return new(e||t)(W.Nb(W.l))},t.\u0275dir=W.Ib({type:t,selectors:[["","ngxBarCodePut",""]],inputs:{debounce:"debounce",skipStart:"skipStart"},outputs:{onDelete:"onDelete",onDetected:"onDetected"}}),t})(),K=(()=>{class t{}return t.\u0275mod=W.Lb({type:t}),t.\u0275inj=W.Kb({factory:function(e){return new(e||t)}}),t})();var J=a("tyNb"),Q=a("0T/Q"),X=a("sKxO"),Y=a("R5jZ"),Z=a("un/a"),tt=a("JIr8"),et=a("Qyje");let at=(()=>{class t{constructor(t){this.http=t,this.moduleUrl="area",this.srvcErrHndl=new Y.a}get(t={}){return this.http.get(`${X.b.urlMantenimientos}/${this.moduleUrl}/get_areas?${et.stringify(t)}`).pipe(Object(Z.a)(X.b.reintentos),Object(tt.a)(this.srvcErrHndl.errorHandler))}save(t){return this.http.post(`${X.b.urlMantenimientos}/${this.moduleUrl}/guardar${t.area?"/"+t.area:""}`,t).pipe(Object(Z.a)(X.b.reintentos),Object(tt.a)(this.srvcErrHndl.errorHandler))}}return t.\u0275fac=function(e){return new(e||t)(W.Xb(n.b))},t.\u0275prov=W.Jb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var ot=a("FY0D");function nt(t,e){if(1&t){const t=W.Ub();W.Tb(0,"mat-list-item",5),W.bc("click",function(){W.xc(t);const a=e.$implicit;return W.fc().getEntidad(a.area)}),W.Tb(1,"mat-icon",6),W.Fc(2,"settings"),W.Sb(),W.Tb(3,"h5",7),W.Fc(4),W.Sb(),W.Sb()}if(2&t){const t=e.$implicit;W.Cb(4),W.Gc(t.nombre)}}const it=function(){return{standalone:!0}};let st=(()=>{class t{constructor(t,e){this.areaSrvc=t,this.ls=e,this.getEntidadEv=new W.o,this.length=0,this.pageSize=5,this.pageSizeOptions=[5,10,15],this.pageIndex=0,this.txtFiltro="",this.loadEntidades=()=>{this.areaSrvc.get({sede:this.ls.get(X.b.usrTokenVar).sede||0,debaja:1}).subscribe(t=>{t&&t.length>0&&(this.lstEntidades=t,this.applyFilter())})},this.getEntidad=t=>{this.areaSrvc.get({area:t,debaja:1}).subscribe(t=>{t&&t.length>0&&this.getEntidadEv.emit(t[0])})},this.pageChange=t=>{this.pageSize=t.pageSize,this.pageIndex=t.pageIndex,this.applyFilter()}}ngOnInit(){this.loadEntidades()}applyFilter(){if(this.txtFiltro.length>0){const t=Object(X.c)(this.lstEntidades,this.txtFiltro);this.length=t.length,this.lstEntidadesPaged=Object(X.f)(t,this.pageSize,this.pageIndex+1)}else this.length=this.lstEntidades.length,this.lstEntidadesPaged=Object(X.f)(this.lstEntidades,this.pageSize,this.pageIndex+1)}}return t.\u0275fac=function(e){return new(e||t)(W.Nb(at),W.Nb(ot.a))},t.\u0275cmp=W.Hb({type:t,selectors:[["app-lista-area"]],outputs:{getEntidadEv:"getEntidadEv"},decls:7,vars:7,consts:[[1,"mat-elevation-z4","fullWidth"],[1,"fullWidth"],["matInput","","placeholder","Buscar...",3,"ngModel","ngModelOptions","keyup","ngModelChange"],["matRipple","",3,"click",4,"ngFor","ngForOf"],["showFirstLastButtons","",3,"length","pageSize","pageSizeOptions","page"],["matRipple","",3,"click"],["mat-list-icon",""],["mat-line",""]],template:function(t,e){1&t&&(W.Tb(0,"mat-card",0),W.Tb(1,"mat-card-content"),W.Tb(2,"mat-form-field",1),W.Tb(3,"input",2),W.bc("keyup",function(){return e.applyFilter()})("ngModelChange",function(t){return e.txtFiltro=t}),W.Sb(),W.Sb(),W.Tb(4,"mat-nav-list"),W.Dc(5,nt,5,1,"mat-list-item",3),W.Sb(),W.Tb(6,"mat-paginator",4),W.bc("page",function(t){return e.pageChange(t)}),W.Sb(),W.Sb(),W.Sb()),2&t&&(W.Cb(3),W.lc("ngModel",e.txtFiltro)("ngModelOptions",W.nc(6,it)),W.Cb(2),W.lc("ngForOf",e.lstEntidadesPaged),W.Cb(1),W.lc("length",e.length)("pageSize",e.pageSize)("pageSizeOptions",e.pageSizeOptions))},directives:[p.a,p.c,m.b,h.b,i.c,i.k,i.n,u.e,o.l,O.a,u.c,b.a,u.b,_.j],styles:[".fullWidth[_ngcontent-%COMP%], table[_ngcontent-%COMP%]{width:100%!important}"]}),t})(),ct=(()=>{class t{constructor(t){this.http=t,this.moduleUrl="mesa",this.srvcErrHndl=new Y.a}get(t={}){return this.http.get(`${X.b.urlMantenimientos}/${this.moduleUrl}/buscar?${et.stringify(t)}`).pipe(Object(Z.a)(X.b.reintentos),Object(tt.a)(this.srvcErrHndl.errorHandler))}save(t){return this.http.post(`${X.b.urlMantenimientos}/mesa/guardar${t.mesa?"/"+t.mesa:""}`,t).pipe(Object(Z.a)(X.b.reintentos),Object(tt.a)(this.srvcErrHndl.errorHandler))}getDisponibles(){return this.http.get(`${X.b.urlMantenimientos}/area/get_mesas_disponibles?`).pipe(Object(Z.a)(X.b.reintentos),Object(tt.a)(this.srvcErrHndl.errorHandler))}}return t.\u0275fac=function(e){return new(e||t)(W.Xb(n.b))},t.\u0275prov=W.Jb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var rt=a("qMXL");function lt(t,e){if(1&t&&(W.Tb(0,"mat-option",12),W.Fc(1),W.Sb()),2&t){const t=e.$implicit;W.lc("value",t.impresora),W.Cb(1),W.Hc(" ",t.nombre," ")}}function dt(t,e){if(1&t){const t=W.Ub();W.Tb(0,"mat-form-field",4),W.Tb(1,"mat-label"),W.Fc(2,"Impresora"),W.Sb(),W.Tb(3,"mat-select",10),W.bc("ngModelChange",function(e){return W.xc(t),W.fc().mesa.impresora=e}),W.Dc(4,lt,2,2,"mat-option",11),W.Sb(),W.Sb()}if(2&t){const t=W.fc();W.Cb(3),W.lc("ngModel",t.mesa.impresora),W.Cb(1),W.lc("ngForOf",t.impresoras)}}let ut=(()=>{class t{constructor(t,e,a,o,n){this.mesaSrvc=t,this.impresoraSrvc=e,this.snackBar=a,this.dialogRef=o,this.data=n,this.impresoras=[],this.mesa={},this.loadImpresoras=()=>this.impresoraSrvc.get().subscribe(t=>this.impresoras=t),this.cancelar=()=>this.dialogRef.close(!1),this.guardarConfiguracion=()=>{this.mesaSrvc.save(this.mesa).subscribe(t=>{t.exito?this.snackBar.open(t.mesa?`Mesa #${t.mesa.numero} actualizada...`:`Mesa #${this.mesa.numero} actualizada...`,"Configuraci\xf3n de mesa",{duration:3e3}):this.snackBar.open(`ERROR:${t.mensaje}.`,"Configuraci\xf3n de mesa",{duration:7e3}),this.dialogRef.close(!0)})}}ngOnInit(){this.mesa=this.data.mesa,this.loadImpresoras()}}return t.\u0275fac=function(e){return new(e||t)(W.Nb(ct),W.Nb(rt.a),W.Nb(M.b),W.Nb(D.f),W.Nb(D.a))},t.\u0275cmp=W.Hb({type:t,selectors:[["app-configura-mesa"]],decls:13,vars:4,consts:[["mat-dialog-title",""],["mat-dialog-content",""],["novalidate",""],["frmConfigMesa","ngForm"],[1,"fullWidth"],["type","text","matInput","","placeholder","Etiqueta","name","etiqueta","maxlength","3",3,"ngModel","ngModelChange"],["class","fullWidth",4,"ngIf"],["mat-dialog-actions","","align","end"],["mat-raised-button","","color","warn",3,"click"],["mat-raised-button","","color","accent",3,"disabled","click"],["name","impresora",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(t,e){if(1&t&&(W.Tb(0,"h1",0),W.Fc(1),W.Sb(),W.Tb(2,"div",1),W.Tb(3,"form",2,3),W.Tb(5,"mat-form-field",4),W.Tb(6,"input",5),W.bc("ngModelChange",function(t){return e.mesa.etiqueta=t}),W.Sb(),W.Sb(),W.Dc(7,dt,5,2,"mat-form-field",6),W.Sb(),W.Sb(),W.Tb(8,"div",7),W.Tb(9,"button",8),W.bc("click",function(){return e.cancelar()}),W.Fc(10," Cancelar "),W.Sb(),W.Tb(11,"button",9),W.bc("click",function(){return e.guardarConfiguracion()}),W.Fc(12," Guardar "),W.Sb(),W.Sb()),2&t){const t=W.tc(4);W.Cb(1),W.Hc("Configuraci\xf3n de mesa ",e.mesa.numero,""),W.Cb(5),W.lc("ngModel",e.mesa.etiqueta),W.Cb(1),W.lc("ngIf",1==+e.mesa.esmostrador),W.Cb(4),W.lc("disabled",!t.form.valid)}},directives:[D.g,D.d,i.r,i.l,i.m,m.b,h.b,i.c,i.f,i.k,i.n,o.m,D.c,v.a,m.f,C.a,o.l,_.m],styles:[""]}),t})();var bt=a("IJgu"),mt=a("znSr");const ht=["divMesa"],pt=function(t,e,a,o,n){return{disponible:t,ocupada:e,debaja:a,"call-center-ocupado":o,"call-center-disponible":n}};let ft=(()=>{class t{constructor(t,e){this.snackBar=t,this.mesaSrvc=e,this.configuracion={mesa:0,area:0,numero:0,posx:0,posy:0,tamanio:48,estatus:1,ancho:null,alto:null,esmostrador:0,vertical:0,etiqueta:null,escallcenter:0},this.dontAllowDrag=!0,this.isDisabled=!1,this.onClickMesa=new W.o,this.moviendoMesa=new W.o,this.urlImage="/assets/img/mesas/",this.ngAfterViewInit=()=>this.objMesa=this.divMesa.nativeElement,this.clickMesa=()=>this.onClickMesa.emit({mesaSelected:this.configuracion}),this.getAncho=()=>this.configuracion.ancho&&+this.configuracion.ancho>0?this.configuracion.ancho:this.configuracion.tamanio,this.getAlto=()=>this.configuracion.alto&&+this.configuracion.alto>0?this.configuracion.alto:this.configuracion.tamanio,this.dragEnded=t=>{this.dontAllowDrag=!0;const e=t.source.element.nativeElement,a=e.offsetParent.scrollHeight,o=t.distance,n={mesa:this.configuracion.mesa,area:this.configuracion.area,numero:this.configuracion.numero,posx:Math.abs(100*(e.offsetLeft+o.x)/e.offsetParent.scrollWidth),posy:Math.abs(100*(e.offsetTop+o.y)/a),tamanio:this.configuracion.tamanio,estatus:this.configuracion.estatus};this.mesaSrvc.save(n).subscribe(t=>{t.exito?t.mesa?(this.configuracion.mesa=t.mesa.mesa,this.snackBar.open(`Mesa #${t.mesa.numero} actualizada...`,"Dise\xf1o de \xe1rea",{duration:3e3})):this.snackBar.open(`Mesa #${this.configuracion.numero} actualizada...`,"Dise\xf1o de \xe1rea",{duration:3e3}):this.snackBar.open(`ERROR:${t.mensaje}.`,"Dise\xf1o de \xe1rea",{duration:3e3}),this.dontAllowDrag=!1,this.moviendoMesa.emit(!1)})},this.dragStarted=t=>{this.moviendoMesa.emit(!0)}}ngOnInit(){this.urlImage+=0==+this.configuracion.esmostrador?"table_03.svg":0==+this.configuracion.escallcenter?0==+this.configuracion.vertical?"mostrador_horizontal.svg":"mostrador_vertical.svg":"callcenter.svg"}}return t.\u0275fac=function(e){return new(e||t)(W.Nb(M.b),W.Nb(ct))},t.\u0275cmp=W.Hb({type:t,selectors:[["app-mesa"]],viewQuery:function(t,e){if(1&t&&W.Kc(ht,1),2&t){let t;W.sc(t=W.cc())&&(e.divMesa=t.first)}},inputs:{configuracion:"configuracion",dontAllowDrag:"dontAllowDrag",isDisabled:"isDisabled"},outputs:{onClickMesa:"onClickMesa",moviendoMesa:"moviendoMesa"},decls:4,vars:20,consts:[["cdkDrag","","cdkDragBoundary",".areaPosicionamiento",1,"divMesa","mat-elevation-z6",3,"cdkDragDisabled","ngClass","cdkDragEnded","cdkDragStarted","click"],["divMesa",""]],template:function(t,e){1&t&&(W.Tb(0,"div",0,1),W.bc("cdkDragEnded",function(t){return e.dragEnded(t)})("cdkDragStarted",function(t){return e.dragStarted(t)})("click",function(){return e.clickMesa()}),W.Tb(2,"span"),W.Fc(3),W.Sb(),W.Sb()),2&t&&(W.Ac("width",e.getAncho(),"px")("height",e.getAlto(),"px")("left",e.configuracion.posx,"%")("top",e.configuracion.posy,"%")("background-image","url("+e.urlImage+")"),W.lc("cdkDragDisabled",e.dontAllowDrag)("ngClass",W.rc(14,pt,1==+e.configuracion.estatus&&0==+e.configuracion.debaja,2==+e.configuracion.estatus&&0==+e.configuracion.debaja,1==+e.configuracion.debaja,2==+e.configuracion.estatus&&1==+e.configuracion.escallcenter,1==+e.configuracion.estatus&&1==+e.configuracion.escallcenter)),W.Db("disabled",!!e.isDisabled||null),W.Cb(3),W.Gc(e.configuracion.etiqueta||e.configuracion.numero))},directives:[y.a,o.k,mt.a],styles:[".divMesa[_ngcontent-%COMP%]{background-repeat:no-repeat;background-position:50%;position:absolute;text-align:right;padding-top:0;background-size:90% 90%}span[_ngcontent-%COMP%]{font-size:12pt;font-weight:700;text-shadow:-1px 0 #fff,0 1px #fff,1px 0 #fff,0 -1px #fff}.disponible[_ngcontent-%COMP%]{background-color:#90ee90}.ocupada[_ngcontent-%COMP%]{background-color:#da332d}.debaja[_ngcontent-%COMP%]{background-color:#000}.call-center-ocupado[_ngcontent-%COMP%]{background-color:#da332d;background-image:url(/assets/img/mesas/callcenter_alt.svg)}.call-center-disponible[_ngcontent-%COMP%]{background-color:#90ee90;background-image:url(/assets/img/mesas/callcenter.svg)}"]}),t})();function gt(t,e){if(1&t){const t=W.Ub();W.Tb(0,"app-mesa",11),W.bc("onClickMesa",function(e){W.xc(t);const a=W.fc();return!a.cargando&&a.onClickMesa(e)})("moviendoMesa",function(e){return W.xc(t),W.fc().cargando=e})("contextmenu",function(a){W.xc(t);const o=e.$implicit,n=W.fc();return!n.cargando&&n.onContextMenu(a,o)}),W.Sb()}if(2&t){const t=e.$implicit,a=W.fc();W.lc("configuracion",t)("dontAllowDrag",a.cargando)}}function St(t,e){if(1&t){const t=W.Ub();W.Tb(0,"button",16),W.bc("click",function(){W.xc(t);const e=W.fc().item;return W.fc().configurarMesa(e)}),W.Tb(1,"mat-icon",3),W.Fc(2,"settings"),W.Sb(),W.Fc(3,"Configuracion "),W.Sb()}}function Ct(t,e){if(1&t){const t=W.Ub();W.Tb(0,"button",17),W.bc("click",function(){W.xc(t);const e=W.fc().item;return W.fc().toggleDeBaja(e)}),W.Tb(1,"mat-icon",3),W.Fc(2,"thumb_down"),W.Sb(),W.Fc(3,"Dar de baja "),W.Sb()}if(2&t){const t=W.fc().item;W.lc("disabled",2==+t.estatus)}}function Tt(t,e){if(1&t){const t=W.Ub();W.Tb(0,"button",18),W.bc("click",function(){W.xc(t);const e=W.fc().item;return W.fc().toggleDeBaja(e,0)}),W.Tb(1,"mat-icon",3),W.Fc(2,"thumb_up"),W.Sb(),W.Fc(3,"Habilitar "),W.Sb()}if(2&t){const t=W.fc().item;W.lc("disabled",2==+t.estatus)}}function vt(t,e){if(1&t&&(W.Tb(0,"span",12),W.Fc(1),W.Sb(),W.Ob(2,"mat-divider"),W.Dc(3,St,4,0,"button",13),W.Dc(4,Ct,4,1,"button",14),W.Dc(5,Tt,4,1,"button",15)),2&t){const t=e.item;W.Cb(1),W.Ic("Mesa #",t.numero," (",t.mesa,")"),W.Cb(2),W.lc("ngIf",0==+t.debaja),W.Cb(1),W.lc("ngIf",0==+t.debaja),W.Cb(1),W.lc("ngIf",1==+t.debaja)}}let Mt=(()=>{class t{constructor(t,e,a,o,n){this.snackBar=t,this.mesaSrvc=e,this.dialogRef=a,this.dialog=o,this.data=n,this.mesas=[],this.contextMenuPosition={x:"0px",y:"0px"},this.cargando=!1,this.getNextTableNumber=()=>this.mesas.length>0?this.mesas.reduce((t,e)=>+e.numero>t?+e.numero:t,this.mesas[0].numero?+this.mesas[0].numero:0)+1:1,this.addTable=(t=72,e=72,a=0,o=0,n=0)=>{this.cargando=!0,this.mesas.push({mesa:null,area:this.data.area,numero:this.getNextTableNumber(),posx:1,posy:1,tamanio:72,estatus:1,ancho:t,alto:e,esmostrador:a,vertical:o,escallcenter:n}),this.saveNewMesa(this.mesas[this.mesas.length-1],this.mesas.length-1)},this.addMostrador=(t=!1)=>this.addTable(t?72:144,t?144:72,1,t?1:0),this.addCallCenter=()=>this.addTable(72,72,1,0,1),this.saveNewMesa=(t,e)=>{this.mesaSrvc.save(t).subscribe(t=>{t.exito?t.mesa&&(this.mesas[e]=t.mesa):this.snackBar.open(`ERROR: ${t.mensaje}`,"Mesa",{duration:7e3}),this.cargando=!1})},this.onClickMesa=t=>{},this.terminar=()=>this.dialogRef.close(this.mesas),this.configurarMesa=t=>{this.dialog.open(ut,{width:"50%",data:{mesa:t}}).afterClosed().subscribe(t=>{})},this.toggleDeBaja=(t,e=1)=>{this.dialog.open(bt.a,{maxWidth:"400px",data:new bt.b(0==+t.esmostrador?"Mesa":"Mostrador",`\xbfSeguro que desea ${1===e?"dar de baja":"habilitar"} ${0==+t.esmostrador?"la mesa":"el mostrador"} #${t.numero}?`,"S\xed","No")}).afterClosed().subscribe(a=>{a&&(t.debaja=e,this.mesaSrvc.save(t).subscribe(t=>{if(t.exito){if(t.mesa){const e=this.mesas.findIndex(e=>+e.mesa==+t.mesa.mesa);e>-1&&(this.mesas[e]=t.mesa),this.snackBar.open(t.mensaje,"Mesa",{duration:3e3})}}else this.snackBar.open(`ERROR: ${t.mensaje}`,"Mesa",{duration:7e3})}))})}}ngOnInit(){this.mesas=this.data.mesas}onContextMenu(t,e){t.preventDefault(),this.contextMenuPosition.x=t.clientX+"px",this.contextMenuPosition.y=t.clientY+"px",this.contextMenu.menuData={item:e},this.contextMenu.menu.focusFirstItem("mouse"),this.contextMenu.openMenu()}}return t.\u0275fac=function(e){return new(e||t)(W.Nb(M.b),W.Nb(ct),W.Nb(D.f),W.Nb(D.b),W.Nb(D.a))},t.\u0275cmp=W.Hb({type:t,selectors:[["app-area-designer"]],viewQuery:function(t,e){if(1&t&&W.Kc(x.e,1),2&t){let t;W.sc(t=W.cc())&&(e.contextMenu=t.first)}},decls:27,vars:11,consts:[[1,"diseniador"],["align","center",2,"height","55px"],["mat-raised-button","","type","button","color","accent",1,"btnAccion",3,"disabled","click"],[1,"btnIconSize"],["mat-raised-button","","type","button","color","accent",3,"disabled","click"],[2,"height","5px","width","100%"],["id","divAreaPosicionamiento",1,"areaPosicionamiento"],[3,"configuracion","dontAllowDrag","onClickMesa","moviendoMesa","contextmenu",4,"ngFor","ngForOf"],[2,"visibility","hidden","position","fixed",3,"matMenuTriggerFor"],["contextMenu","matMenu"],["matMenuContent",""],[3,"configuracion","dontAllowDrag","onClickMesa","moviendoMesa","contextmenu"],["mat-menu-item","","disableRipple","true",1,"mesaTitle"],["mat-menu-item","",3,"click",4,"ngIf"],["mat-menu-item","","class","customize",3,"disabled","click",4,"ngIf"],["mat-menu-item","","class","customizeUp",3,"disabled","click",4,"ngIf"],["mat-menu-item","",3,"click"],["mat-menu-item","",1,"customize",3,"disabled","click"],["mat-menu-item","",1,"customizeUp",3,"disabled","click"]],template:function(t,e){if(1&t&&(W.Tb(0,"div",0),W.Tb(1,"div",1),W.Tb(2,"button",2),W.bc("click",function(){return e.addTable()}),W.Tb(3,"mat-icon",3),W.Fc(4,"add"),W.Sb(),W.Fc(5,"\xa0Mesa "),W.Sb(),W.Tb(6,"button",2),W.bc("click",function(){return e.addMostrador()}),W.Tb(7,"mat-icon",3),W.Fc(8,"add"),W.Sb(),W.Fc(9,"\xa0Mostrador "),W.Sb(),W.Tb(10,"button",2),W.bc("click",function(){return e.addMostrador(!0)}),W.Tb(11,"mat-icon",3),W.Fc(12,"add"),W.Sb(),W.Fc(13,"\xa0Mostrador vertical "),W.Sb(),W.Tb(14,"button",2),W.bc("click",function(){return e.addCallCenter()}),W.Tb(15,"mat-icon",3),W.Fc(16,"add"),W.Sb(),W.Fc(17,"\xa0Call center "),W.Sb(),W.Tb(18,"button",4),W.bc("click",function(){return e.terminar()}),W.Fc(19," Terminar "),W.Sb(),W.Sb(),W.Ob(20,"div",5),W.Tb(21,"div",6),W.Dc(22,gt,1,2,"app-mesa",7),W.Sb(),W.Ob(23,"div",8),W.Tb(24,"mat-menu",null,9),W.Dc(26,vt,6,5,"ng-template",10),W.Sb(),W.Sb()),2&t){const t=W.tc(25);W.Cb(2),W.lc("disabled",e.cargando),W.Cb(4),W.lc("disabled",e.cargando),W.Cb(4),W.lc("disabled",e.cargando),W.Cb(4),W.lc("disabled",e.cargando),W.Cb(4),W.lc("disabled",e.cargando),W.Cb(4),W.lc("ngForOf",e.mesas),W.Cb(1),W.Ac("left",e.contextMenuPosition.x)("top",e.contextMenuPosition.y),W.lc("matMenuTriggerFor",t)}},directives:[v.a,b.a,o.l,x.e,x.a,x.b,ft,x.c,f.a,o.m],styles:[".diseniador[_ngcontent-%COMP%]{width:750px;height:650px}.areaPosicionamiento[_ngcontent-%COMP%], .diseniador[_ngcontent-%COMP%]{overflow:hidden!important;padding:0!important}.areaPosicionamiento[_ngcontent-%COMP%]{width:100%;height:600px;background-color:hsla(0,0%,78%,.28627450980392155);position:relative}.btnIconSize[_ngcontent-%COMP%]{font-size:17pt!important}  .customize{background:#ffffe0}  .customizeUp{background:#90ee90}.mesaTitle[_ngcontent-%COMP%]{font-weight:700}"]}),t})();function Ft(t,e){if(1&t){const t=W.Ub();W.Tb(0,"mat-form-field",4),W.Tb(1,"input",13),W.bc("ngModelChange",function(e){return W.xc(t),W.fc().entidad.nombre=e}),W.Sb(),W.Sb()}if(2&t){const t=W.fc();W.Cb(1),W.lc("ngModel",t.entidad.nombre)}}function xt(t,e){if(1&t&&(W.Tb(0,"mat-option",14),W.Fc(1),W.Sb()),2&t){const t=e.$implicit;W.lc("value",t.area),W.Cb(1),W.Hc(" ",t.nombre," ")}}function kt(t,e){if(1&t&&(W.Tb(0,"mat-option",14),W.Fc(1),W.Sb()),2&t){const t=e.$implicit;W.lc("value",t.impresora),W.Cb(1),W.Hc(" ",t.nombre," ")}}function Ot(t,e){if(1&t&&(W.Tb(0,"mat-option",14),W.Fc(1),W.Sb()),2&t){const t=e.$implicit;W.lc("value",t.impresora),W.Cb(1),W.Hc(" ",t.nombre," ")}}function Dt(t,e){if(1&t){const t=W.Ub();W.Tb(0,"button",15),W.bc("click",function(){return W.xc(t),W.fc().openDesigner()}),W.Fc(1," Dise\xf1ar "),W.Sb()}}function Et(t,e){if(1&t){const t=W.Ub();W.Tb(0,"button",16),W.bc("click",function(){return W.xc(t),W.fc().resetEntidad()}),W.Fc(1," Nuevo "),W.Sb()}}let Pt=(()=>{class t{constructor(t,e,a,o,n){this.snackBar=t,this.dialog=e,this.entidadSrvc=a,this.impresoraSrvc=o,this.ls=n,this.entidadSavedEv=new W.o,this.sedeUsr=0,this.lstAreas=[],this.esMovil=!1,this.impresoras=[],this.loadAreas=()=>this.entidadSrvc.get({sede:this.sedeUsr,debaja:1}).subscribe(t=>this.lstAreas=t),this.loadImpresoras=()=>this.impresoraSrvc.get().subscribe(t=>this.impresoras=t),this.resetEntidad=()=>this.entidad={area:null,sede:this.sedeUsr,nombre:null,mesas:[],impresora_factura:null,impresora:null},this.onSubmit=()=>{this.entidadSrvc.save(this.entidad).subscribe(t=>{t.exito?(this.snackBar.open(`${t.mensaje}`,"\xc1rea",{duration:3e3}),this.resetEntidad(),this.loadAreas(),this.entidadSavedEv.emit()):this.snackBar.open(`ERROR: ${t.mensaje}`,"\xc1rea",{duration:3e3})})},this.openDesigner=()=>{this.dialog.open(Mt,{width:"800px",disableClose:!0,data:{area:+this.entidad.area,mesas:this.entidad.mesas||[]}}).afterClosed().subscribe(t=>{t&&(this.entidadSavedEv.emit(),this.entidadSrvc.get({area:+this.entidad.area,debaja:1}).subscribe(t=>{t&&t.length>0&&(this.entidad=t[0])}))})}}ngOnInit(){this.sedeUsr=this.ls.get(X.b.usrTokenVar).sede||0,this.esMovil=this.ls.get(X.b.usrTokenVar).enmovil||!1,this.resetEntidad(),this.loadAreas(),this.loadImpresoras()}}return t.\u0275fac=function(e){return new(e||t)(W.Nb(M.b),W.Nb(D.b),W.Nb(at),W.Nb(rt.a),W.Nb(ot.a))},t.\u0275cmp=W.Hb({type:t,selectors:[["app-form-area"]],inputs:{entidad:"entidad"},outputs:{entidadSavedEv:"entidadSavedEv"},decls:30,vars:11,consts:[[1,"mat-elevation-z4","fullWidth"],["novalidate","",3,"ngSubmit"],["frmEntidad","ngForm"],["class","fullWidth",4,"ngIf"],[1,"fullWidth"],["name","area_padre",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["name","impresora","required","",3,"ngModel","ngModelChange"],["name","impresora_factura",3,"ngModel","ngModelChange"],["align","end"],["mat-raised-button","","type","submit","color","accent",1,"btnAccion",3,"disabled"],["mat-raised-button","","type","button","color","accent","class","btnAccion",3,"click",4,"ngIf"],["mat-raised-button","","type","button","color","accent",3,"click",4,"ngIf"],["type","text","matInput","","placeholder","Nombre","name","nombre","minlength","1","maxlength","100","required","",3,"ngModel","ngModelChange"],[3,"value"],["mat-raised-button","","type","button","color","accent",1,"btnAccion",3,"click"],["mat-raised-button","","type","button","color","accent",3,"click"]],template:function(t,e){if(1&t){const t=W.Ub();W.Tb(0,"mat-card",0),W.Tb(1,"mat-card-title"),W.Tb(2,"h4"),W.Fc(3,"\xc1rea"),W.Sb(),W.Sb(),W.Tb(4,"mat-card-content"),W.Tb(5,"form",1,2),W.bc("ngSubmit",function(){return W.xc(t),W.tc(6).form.valid&&e.onSubmit()}),W.Dc(7,Ft,2,1,"mat-form-field",3),W.Tb(8,"mat-form-field",4),W.Tb(9,"mat-label"),W.Fc(10,"\xc1rea padre"),W.Sb(),W.Tb(11,"mat-select",5),W.bc("ngModelChange",function(t){return e.entidad.area_padre=t}),W.Dc(12,xt,2,2,"mat-option",6),W.Sb(),W.Sb(),W.Tb(13,"mat-form-field",4),W.Tb(14,"mat-label"),W.Fc(15,"Impresora"),W.Sb(),W.Tb(16,"mat-select",7),W.bc("ngModelChange",function(t){return e.entidad.impresora=t}),W.Dc(17,kt,2,2,"mat-option",6),W.Sb(),W.Sb(),W.Tb(18,"mat-form-field",4),W.Tb(19,"mat-label"),W.Fc(20,"Impresora de factura"),W.Sb(),W.Tb(21,"mat-select",8),W.bc("ngModelChange",function(t){return e.entidad.impresora_factura=t}),W.Dc(22,Ot,2,2,"mat-option",6),W.Sb(),W.Sb(),W.Tb(23,"h5"),W.Fc(24),W.Sb(),W.Tb(25,"div",9),W.Tb(26,"button",10),W.Fc(27," Guardar "),W.Sb(),W.Dc(28,Dt,2,0,"button",11),W.Dc(29,Et,2,0,"button",12),W.Sb(),W.Sb(),W.Sb(),W.Sb()}if(2&t){const t=W.tc(6);W.Cb(7),W.lc("ngIf",e.esMovil),W.Cb(4),W.lc("ngModel",e.entidad.area_padre),W.Cb(1),W.lc("ngForOf",e.lstAreas),W.Cb(4),W.lc("ngModel",e.entidad.impresora),W.Cb(1),W.lc("ngForOf",e.impresoras),W.Cb(4),W.lc("ngModel",e.entidad.impresora_factura),W.Cb(1),W.lc("ngForOf",e.impresoras),W.Cb(2),W.Hc("Mesas en el \xe1rea: ",e.entidad.mesas.length,""),W.Cb(2),W.lc("disabled",!t.form.valid),W.Cb(2),W.lc("ngIf",e.entidad.area),W.Cb(1),W.lc("ngIf",e.entidad.area)}},directives:[p.a,p.h,p.c,i.r,i.l,i.m,o.m,m.b,m.f,C.a,i.k,i.n,o.l,i.p,v.a,h.b,i.c,i.g,i.f,_.m],styles:[".full-width[_ngcontent-%COMP%]{width:100%}"]}),t})();const _t=["listaAreas"];let yt=(()=>{class t{constructor(){this.setArea=t=>this.area=t,this.refreshAreaList=()=>{this.lstAreasComponent.loadEntidades()},this.area={area:null,sede:null,nombre:null,impresora:null,impresora_factura:null}}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=W.Hb({type:t,selectors:[["app-area"]],viewQuery:function(t,e){if(1&t&&W.Kc(_t,1),2&t){let t;W.sc(t=W.cc())&&(e.lstAreasComponent=t.first)}},decls:6,vars:1,consts:[[1,"row"],[1,"col","m5","s12"],[3,"getEntidadEv"],["listaAreas",""],[1,"col","m7","s12"],[3,"entidad","entidadSavedEv"]],template:function(t,e){1&t&&(W.Tb(0,"div",0),W.Tb(1,"div",1),W.Tb(2,"app-lista-area",2,3),W.bc("getEntidadEv",function(t){return e.setArea(t)}),W.Sb(),W.Sb(),W.Tb(4,"div",4),W.Tb(5,"app-form-area",5),W.bc("entidadSavedEv",function(){return e.refreshAreaList()}),W.Sb(),W.Sb(),W.Sb()),2&t&&(W.Cb(5),W.lc("entidad",e.area))},directives:[st,Pt],styles:[""]}),t})();var It=a("u01r"),wt=a("M8s9");const At=function(){return{standalone:!0}};function Nt(t,e){if(1&t){const t=W.Ub();W.Tb(0,"input",9),W.bc("input",function(e){return W.xc(t),W.fc().validateKey(e)})("ngModelChange",function(e){return W.xc(t),W.fc().telefonoPedido=e}),W.Sb()}if(2&t){const t=W.fc();W.lc("matKeyboard",t.keyboardLayout)("ngModel",t.telefonoPedido)("ngModelOptions",W.nc(3,At))}}function Rt(t,e){if(1&t){const t=W.Ub();W.Tb(0,"input",10),W.bc("keypress",function(e){return W.xc(t),W.fc().validateKey(e)})("ngModelChange",function(e){return W.xc(t),W.fc().telefonoPedido=e}),W.Sb()}if(2&t){const t=W.fc();W.lc("ngModel",t.telefonoPedido)("ngModelOptions",W.nc(2,At))}}function Ut(t,e){if(1&t){const t=W.Ub();W.Tb(0,"tr"),W.Tb(1,"td"),W.Fc(2),W.Sb(),W.Tb(3,"td",12),W.Tb(4,"button",13),W.bc("click",function(){W.xc(t);const a=e.$implicit;return W.fc(2).seleccionarCliente(a)}),W.Fc(5," Seleccionar "),W.Sb(),W.Sb(),W.Sb()}if(2&t){const t=e.$implicit;W.Cb(2),W.Gc(t.nombre)}}function $t(t,e){if(1&t&&(W.Tb(0,"table"),W.Tb(1,"thead"),W.Tb(2,"tr"),W.Tb(3,"td"),W.Fc(4,"\xbfQui\xe9n est\xe1 llamando?"),W.Sb(),W.Ob(5,"td"),W.Sb(),W.Sb(),W.Tb(6,"tbody"),W.Dc(7,Ut,6,1,"tr",11),W.Sb(),W.Sb()),2&t){const t=W.fc();W.Cb(7),W.lc("ngForOf",t.clientes)}}let Bt=(()=>{class t{constructor(t,e,a,o,n,i){this.dialogRef=t,this.snackBar=e,this.data=a,this.clienteSrvc=o,this.dialog=n,this.ls=i,this.telefonoPedido=null,this.clientes=[],this.keyboardLayout=X.b.IDIOMA_TECLADO,this.esMovil=!1,this.validateKey=t=>{const e=String.fromCharCode(t.keyCode);return!!/[0-9]/.test(e)||(t.preventDefault(),!1)},this.cancelar=()=>this.dialogRef.close(),this.buscar=()=>{this.telefonoPedido=this.telefonoPedido.trim().toUpperCase().replace(/[^0-9]/gi,""),this.telefonoPedido&&this.telefonoPedido.length>=8?this.clienteSrvc.get({telefono:this.telefonoPedido}).subscribe(t=>{t&&t.length>0?this.clientes=t:this.dialog.open(It.a,{width:"50%",disableClose:!0,data:{cliente:{cliente:null,nombre:null,nit:null,telefono:this.telefonoPedido}}}).afterClosed().subscribe(t=>{(null==t?void 0:t.cliente)&&this.dialogRef.close(t)})}):this.snackBar.open("Favor ingresar un n\xfamero de tel\xe9fono v\xe1lido.","Pedido",{duration:5e3})},this.seleccionarCliente=t=>{this.dialogRef.close(t)}}ngOnInit(){this.esMovil=this.ls.get(X.b.usrTokenVar).enmovil||!1}}return t.\u0275fac=function(e){return new(e||t)(W.Nb(D.f),W.Nb(M.b),W.Nb(D.a),W.Nb(wt.a),W.Nb(D.b),W.Nb(ot.a))},t.\u0275cmp=W.Hb({type:t,selectors:[["app-pide-telefono-dialog"]],decls:12,vars:4,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[1,"fullWidth"],["matInput","","type","text","placeholder","Tel\xe9fono","minlength","8","maxlength","25","required","",3,"matKeyboard","ngModel","ngModelOptions","input","ngModelChange",4,"ngIf"],["matInput","","type","text","placeholder","Tel\xe9fono","minlength","8","maxlength","25","required","",3,"ngModel","ngModelOptions","keypress","ngModelChange",4,"ngIf"],[4,"ngIf"],["mat-dialog-actions","","align","end"],["mat-raised-button","","color","warn",3,"click"],["mat-raised-button","","type","button","color","accent",3,"disabled","click"],["matInput","","type","text","placeholder","Tel\xe9fono","minlength","8","maxlength","25","required","",3,"matKeyboard","ngModel","ngModelOptions","input","ngModelChange"],["matInput","","type","text","placeholder","Tel\xe9fono","minlength","8","maxlength","25","required","",3,"ngModel","ngModelOptions","keypress","ngModelChange"],[4,"ngFor","ngForOf"],["align","center",2,"width","15%"],["mat-raised-button","","type","button","color","accent",3,"click"]],template:function(t,e){1&t&&(W.Tb(0,"h1",0),W.Fc(1,"Tel\xe9fono"),W.Sb(),W.Tb(2,"div",1),W.Tb(3,"mat-form-field",2),W.Dc(4,Nt,1,4,"input",3),W.Dc(5,Rt,1,3,"input",4),W.Sb(),W.Dc(6,$t,8,1,"table",5),W.Sb(),W.Tb(7,"div",6),W.Tb(8,"button",7),W.bc("click",function(){return e.cancelar()}),W.Fc(9," Cancelar "),W.Sb(),W.Tb(10,"button",8),W.bc("click",function(){return e.buscar()}),W.Fc(11," Buscar "),W.Sb(),W.Sb()),2&t&&(W.Cb(4),W.lc("ngIf",!e.esMovil),W.Cb(1),W.lc("ngIf",e.esMovil),W.Cb(1),W.lc("ngIf",e.clientes.length>0),W.Cb(4),W.lc("disabled",!(e.telefonoPedido&&e.telefonoPedido.length>=8)))},directives:[D.g,D.d,m.b,o.m,D.c,v.a,h.b,N.a,i.c,i.g,i.f,i.p,i.k,i.n,o.l],styles:[""]}),t})();function jt(t,e){1&t&&(W.Tb(0,"th",12),W.Fc(1,"No."),W.Sb())}function Ht(t,e){if(1&t&&(W.Tb(0,"td",13),W.Tb(1,"span"),W.Fc(2),W.Sb(),W.Sb()),2&t){const t=e.$implicit;W.Cb(2),W.Gc(t.numero)}}function Lt(t,e){1&t&&(W.Tb(0,"th",12),W.Fc(1,"Nombre"),W.Sb())}function qt(t,e){if(1&t){const t=W.Ub();W.Tb(0,"input",19),W.bc("ngModelChange",function(e){return W.xc(t),W.fc().$implicit.nombre=e}),W.Sb()}if(2&t){const t=W.fc().$implicit;W.lc("ngModel",t.nombre)}}function zt(t,e){if(1&t){const t=W.Ub();W.Tb(0,"input",20),W.bc("ngModelChange",function(e){return W.xc(t),W.fc().$implicit.nombre=e}),W.Sb()}if(2&t){const t=W.fc().$implicit,e=W.fc();W.lc("matKeyboard",e.keyboardLayout)("ngModel",t.nombre)}}function Gt(t,e){if(1&t){const t=W.Ub();W.Tb(0,"td",13),W.Tb(1,"mat-form-field",14),W.Dc(2,qt,1,1,"input",15),W.Dc(3,zt,1,2,"input",16),W.Tb(4,"button",17),W.bc("click",function(){W.xc(t);const a=e.$implicit;return W.fc().eliminarFila(a)}),W.Tb(5,"mat-icon",18),W.Fc(6,"close"),W.Sb(),W.Sb(),W.Sb(),W.Sb()}if(2&t){const t=W.fc();W.Cb(2),W.lc("ngIf",t.esMovil),W.Cb(1),W.lc("ngIf",!t.esMovil)}}function Wt(t,e){1&t&&W.Ob(0,"tr",21)}function Vt(t,e){1&t&&W.Ob(0,"tr",22)}let Kt=(()=>{class t{constructor(t,e,a,o){this.dialogRef=t,this.data=e,this.snackBar=a,this.ls=o,this.displayedColumns=["numero","nombre"],this.esMovil=!1,this.terminar=()=>{const t=this.todosConNombre(this.data.cuentas);t<0?this.dialogRef.close(this.data.cuentas):this.snackBar.open(`Favor ingresar nombre a la cuenta #${this.data.cuentas[t].cuenta}...`,"Cuentas",{duration:5e3})},this.setTableDataSource=()=>this.dataSource=new S.l(this.data.cuentas),this.eliminarFila=t=>{const e=this.data.cuentas.findIndex(e=>+e.numero==+t.numero);e>0?(this.data.cuentas.splice(e,1),this.data.cuentas.map((t,e)=>t.numero=e+1),this.dataSource.data=this.data.cuentas):console.log("No se encuentra esta cuenta...")}}ngOnInit(){this.esMovil=this.ls.get(X.b.usrTokenVar).enmovil||!1,this.keyboardLayout=X.b.IDIOMA_TECLADO,this.setTableDataSource();for(let t=0;t<+this.data.comensales-1;t++)this.agregarFila()}todosConNombre(t){for(let e=0;e<t.length;e++)if(!t[e].nombre)return e;return-1}agregarFila(){this.data.cuentas.push({cuenta:0,numero:this.data.cuentas.length+1,nombre:null,productos:[]}),this.dataSource.data=this.data.cuentas}}return t.\u0275fac=function(e){return new(e||t)(W.Nb(D.f),W.Nb(D.a),W.Nb(M.b),W.Nb(ot.a))},t.\u0275cmp=W.Hb({type:t,selectors:[["app-pide-datos-cuentas"]],decls:18,vars:5,consts:[["mat-dialog-title",""],["mat-dialog-content",""],["mat-table","",1,"fullWidth",3,"dataSource"],["tblCuentas",""],["matColumnDef","numero"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","nombre"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-dialog-actions","","align","end"],["mat-raised-button","","color","accent",3,"disabled","click"],["mat-header-cell",""],["mat-cell",""],[1,"fullWidth"],["type","text","matInput","","name","nombre","required","",3,"ngModel","ngModelChange",4,"ngIf"],["type","text","matInput","","name","nombre","required","",3,"matKeyboard","ngModel","ngModelChange",4,"ngIf"],["type","button","mat-button","","matSuffix","","mat-icon-button","",3,"click"],[1,"iconFontSize"],["type","text","matInput","","name","nombre","required","",3,"ngModel","ngModelChange"],["type","text","matInput","","name","nombre","required","",3,"matKeyboard","ngModel","ngModelChange"],["mat-header-row",""],["mat-row",""]],template:function(t,e){1&t&&(W.Tb(0,"h1",0),W.Fc(1,"Ingreso de datos de cuentas"),W.Sb(),W.Tb(2,"div",1),W.Tb(3,"table",2,3),W.Rb(5,4),W.Dc(6,jt,2,0,"th",5),W.Dc(7,Ht,3,1,"td",6),W.Qb(),W.Rb(8,7),W.Dc(9,Lt,2,0,"th",5),W.Dc(10,Gt,7,2,"td",6),W.Qb(),W.Dc(11,Wt,1,0,"tr",8),W.Dc(12,Vt,1,0,"tr",9),W.Sb(),W.Sb(),W.Tb(13,"div",10),W.Tb(14,"button",11),W.bc("click",function(){return e.agregarFila()}),W.Fc(15," Agregar "),W.Sb(),W.Tb(16,"button",11),W.bc("click",function(){return e.terminar()}),W.Fc(17," Terminar "),W.Sb(),W.Sb()),2&t&&(W.Cb(3),W.lc("dataSource",e.dataSource),W.Cb(8),W.lc("matHeaderRowDef",e.displayedColumns),W.Cb(1),W.lc("matRowDefColumns",e.displayedColumns),W.Cb(2),W.lc("disabled",e.data.cuentas.length===+e.data.comensales),W.Cb(2),W.lc("disabled",e.data.cuentas.length!==+e.data.comensales))},directives:[D.g,D.d,S.k,S.c,S.e,S.b,S.g,S.j,D.c,v.a,S.d,S.a,m.b,o.m,m.g,b.a,h.b,i.c,i.p,i.k,i.n,N.a,S.f,S.i],styles:[".fullWidth[_ngcontent-%COMP%]{width:100%}.iconFontSize[_ngcontent-%COMP%]{font-size:34pt!important}"]}),t})();var Jt=a("K9lQ");function Qt(t,e){if(1&t&&(W.Tb(0,"mat-option",13),W.Fc(1),W.Sb()),2&t){const t=e.$implicit;W.lc("value",t.usuario.usuario),W.Cb(1),W.Ic(" ",t.usuario.nombres," ",t.usuario.apellidos," ")}}function Xt(t,e){if(1&t){const t=W.Ub();W.Tb(0,"input",14),W.bc("ngModelChange",function(e){return W.xc(t),W.fc().data.comensales=e}),W.Sb()}if(2&t){const t=W.fc();W.lc("matKeyboard",t.keyboardLayout)("ngModel",t.data.comensales)}}function Yt(t,e){if(1&t){const t=W.Ub();W.Tb(0,"input",15),W.bc("ngModelChange",function(e){return W.xc(t),W.fc().data.comensales=e}),W.Sb()}if(2&t){const t=W.fc();W.lc("ngModel",t.data.comensales)}}let Zt=(()=>{class t{constructor(t,e,a,o,n){this.dialogRef=t,this.data=e,this.dialogDatosCuentas=a,this.usuarioSrvc=o,this.ls=n,this.lstMeseros=[],this.esMovil=!1,this.loadMeseros=()=>{this.usuarioSrvc.getMeserosTurno().subscribe(t=>{t&&(this.lstMeseros=t)})},this.toNumber=t=>+t}ngOnInit(){this.esMovil=this.ls.get(X.b.usrTokenVar).enmovil||!1,this.keyboardLayout=X.b.IDIOMA_TECLADO,this.loadMeseros()}pedirDatosDeCuentas(t){this.dialogDatosCuentas.open(Kt,{width:"50%",disableClose:!0,data:{cuentas:t.cuentas,comensales:this.data.comensales}}).afterClosed().subscribe(e=>{t.cuentas=e,this.dialogRef.close(t)})}terminar(t=null){t?t.dividirCuentasPorSillas?this.pedirDatosDeCuentas(t):this.dialogRef.close(t):this.dialogRef.close()}}return t.\u0275fac=function(e){return new(e||t)(W.Nb(D.f),W.Nb(D.a),W.Nb(D.b),W.Nb(Jt.a),W.Nb(ot.a))},t.\u0275cmp=W.Hb({type:t,selectors:[["app-abrir-mesa"]],decls:22,vars:8,consts:[["mat-dialog-title",""],["novalidate","",3,"ngSubmit"],["frmAbrirMesa","ngForm"],[1,"separatorMargin"],["name","mesero",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["type","text","matInput","","placeholder","# Comensales","name","comensales","required","",3,"matKeyboard","ngModel","ngModelChange",4,"ngIf"],["type","text","matInput","","placeholder","# Comensales","name","comensales","required","",3,"ngModel","ngModelChange",4,"ngIf"],["name","esEvento",1,"separatorMargin",3,"ngModel","ngModelChange"],["name","dividirCuentasPorSillas",1,"separatorMargin",3,"ngModel","disabled","ngModelChange"],["align","end"],["mat-raised-button","","color","secondary",1,"btnAccion",3,"click"],["mat-raised-button","","color","accent",3,"disabled","click"],[3,"value"],["type","text","matInput","","placeholder","# Comensales","name","comensales","required","",3,"matKeyboard","ngModel","ngModelChange"],["type","text","matInput","","placeholder","# Comensales","name","comensales","required","",3,"ngModel","ngModelChange"]],template:function(t,e){if(1&t){const t=W.Ub();W.Tb(0,"h1",0),W.Fc(1,"Abrir mesa"),W.Sb(),W.Tb(2,"mat-dialog-content"),W.Tb(3,"form",1,2),W.bc("ngSubmit",function(){return W.xc(t),W.tc(4).form.valid}),W.Tb(5,"mat-form-field",3),W.Tb(6,"mat-label"),W.Fc(7,"Mesero"),W.Sb(),W.Tb(8,"mat-select",4),W.bc("ngModelChange",function(t){return e.data.mesero=t}),W.Dc(9,Qt,2,3,"mat-option",5),W.Sb(),W.Sb(),W.Tb(10,"mat-form-field",3),W.Dc(11,Xt,1,2,"input",6),W.Dc(12,Yt,1,1,"input",7),W.Sb(),W.Tb(13,"mat-checkbox",8),W.bc("ngModelChange",function(t){return+(e.data.esEvento=t)}),W.Fc(14,"\xbfEs evento?"),W.Sb(),W.Tb(15,"mat-checkbox",9),W.bc("ngModelChange",function(t){return+(e.data.dividirCuentasPorSillas=t)}),W.Fc(16,"\xbfDividir cuentas?"),W.Sb(),W.Sb(),W.Sb(),W.Tb(17,"mat-dialog-actions",10),W.Tb(18,"button",11),W.bc("click",function(){return e.terminar()}),W.Fc(19," Cancelar "),W.Sb(),W.Tb(20,"button",12),W.bc("click",function(){return e.terminar(e.data)}),W.Fc(21," Abrir mesa "),W.Sb(),W.Sb()}if(2&t){const t=W.tc(4);W.Cb(8),W.lc("ngModel",e.data.mesero),W.Cb(1),W.lc("ngForOf",e.lstMeseros),W.Cb(2),W.lc("ngIf",!e.esMovil),W.Cb(1),W.lc("ngIf",e.esMovil),W.Cb(1),W.lc("ngModel",+e.data.esEvento),W.Cb(2),W.lc("ngModel",+e.data.dividirCuentasPorSillas)("disabled",+e.data.comensales<=1),W.Cb(5),W.lc("disabled",!t.form.valid)}},directives:[D.g,D.d,i.r,i.l,i.m,m.b,m.f,C.a,i.k,i.n,o.l,o.m,T.a,D.c,v.a,_.m,h.b,N.a,i.c,i.p],styles:[".contenido[_ngcontent-%COMP%]{height:50%!important}.separatorMargin[_ngcontent-%COMP%]{margin-right:8px}"]}),t})(),te=(()=>{class t{constructor(t){this.http=t,this.moduleUrl="comanda",this.srvcErrHndl=new Y.a}get(t={}){return this.http.get(`${X.b.urlAppRestaurante}/${this.moduleUrl}/buscar?${et.stringify(t)}`).pipe(Object(Z.a)(X.b.reintentos),Object(tt.a)(this.srvcErrHndl.errorHandler))}getComandaDeMesa(t){return this.http.get(`${X.b.urlAppRestaurante}/${this.moduleUrl}/get_comanda/${t}`).pipe(Object(Z.a)(X.b.reintentos),Object(tt.a)(this.srvcErrHndl.errorHandler))}save(t){return this.http.post(`${X.b.urlAppRestaurante}/${this.moduleUrl}/guardar${t.comanda?"/"+t.comanda:""}`,t).pipe(Object(Z.a)(X.b.reintentos),Object(tt.a)(this.srvcErrHndl.errorHandler))}enviarPedido(t,e){return this.http.post(`${X.b.urlAppRestaurante}/callcenter/guardar_pedido/${t}`,e).pipe(Object(Z.a)(X.b.reintentos),Object(tt.a)(this.srvcErrHndl.errorHandler))}saveDetalleCombo(t,e,a){return this.http.post(`${X.b.urlAppRestaurante}/${this.moduleUrl}/guardar_detalle_combo/${t}/${e}`,a).pipe(Object(Z.a)(X.b.reintentos),Object(tt.a)(this.srvcErrHndl.errorHandler))}saveNotasGenerales(t){return this.http.post(`${X.b.urlAppRestaurante}/${this.moduleUrl}/guardar_notas_generales/${t.comanda}`,t).pipe(Object(Z.a)(X.b.reintentos),Object(tt.a)(this.srvcErrHndl.errorHandler))}saveNotasProducto(t){return this.http.post(`${X.b.urlAppRestaurante}/${this.moduleUrl}/guardar_notas_producto/${t.detalle_comanda}`,t).pipe(Object(Z.a)(X.b.reintentos),Object(tt.a)(this.srvcErrHndl.errorHandler))}saveDetalle(t,e,a){return this.http.post(`${X.b.urlAppRestaurante}/${this.moduleUrl}/guardar_detalle/${t}/${e}`,a).pipe(Object(Z.a)(X.b.reintentos),Object(tt.a)(this.srvcErrHndl.errorHandler))}setProductoImpreso(t=0){return this.http.get(`${X.b.urlAppRestaurante}/${this.moduleUrl}/imprimir/${t}`).pipe(Object(Z.a)(X.b.reintentos),Object(tt.a)(this.srvcErrHndl.errorHandler))}cerrarMesa(t){return this.http.post(`${X.b.urlAppRestaurante}/${this.moduleUrl}/cerrar_mesa/${t}`,null).pipe(Object(Z.a)(X.b.reintentos),Object(tt.a)(this.srvcErrHndl.errorHandler))}getComandasOnLIne(){return this.http.get(`${X.b.urlAppRestaurante}/${this.moduleUrl}/get_comanda`).pipe(Object(Z.a)(X.b.reintentos),Object(tt.a)(this.srvcErrHndl.errorHandler))}validaPwdGerenteTurno(t){return this.http.post(`${X.b.urlAppRestaurante}/${this.moduleUrl}/validapwdgerenteturno`,{pwd:t}).pipe(Object(Z.a)(X.b.reintentos),Object(tt.a)(this.srvcErrHndl.errorHandler))}cerrarEstacion(t){return this.http.get(`${X.b.urlAppRestaurante}/${this.moduleUrl}/cerrar_estacion/${t}`).pipe(Object(Z.a)(X.b.reintentos),Object(tt.a)(this.srvcErrHndl.errorHandler))}getCuenta(t){return this.http.get(`${X.b.urlAppRestaurante}/cuenta/get_cuenta/${t}`).pipe(Object(Z.a)(X.b.reintentos),Object(tt.a)(this.srvcErrHndl.errorHandler))}unificarCuentas(t,e){return this.http.get(`${X.b.urlAppRestaurante}/${this.moduleUrl}/unir_cuentas/${t}/${e}`).pipe(Object(Z.a)(X.b.reintentos),Object(tt.a)(this.srvcErrHndl.errorHandler))}trasladarMesa(t,e,a){return this.http.get(`${X.b.urlAppRestaurante}/${this.moduleUrl}/trasladar_mesa/${t}/${e}/${a}`).pipe(Object(Z.a)(X.b.reintentos),Object(tt.a)(this.srvcErrHndl.errorHandler))}getComandasCocina(){return this.http.get(`${X.b.urlAppRestaurante}/${this.moduleUrl}/get_comanda_cocina`).pipe(Object(Z.a)(X.b.reintentos),Object(tt.a)(this.srvcErrHndl.errorHandler))}setComandaCocinada(t,e){return this.http.post(`${X.b.urlAppRestaurante}/${this.moduleUrl}/set_cocinado/${t}`,e).pipe(Object(Z.a)(X.b.reintentos),Object(tt.a)(this.srvcErrHndl.errorHandler))}distribuirCuentas(t){return this.http.post(`${X.b.urlAppRestaurante}/${this.moduleUrl}/distribuir_cuentas`,t).pipe(Object(Z.a)(X.b.reintentos),Object(tt.a)(this.srvcErrHndl.errorHandler))}cancelarPedido(t,e){return this.http.post(`${X.b.urlAppRestaurante}/${this.moduleUrl}/anular_pedido/${t}`,e).pipe(Object(Z.a)(X.b.reintentos),Object(tt.a)(this.srvcErrHndl.errorHandler))}getComandasOnLine_Test(){return[{comanda:37,total:8,usuario:6,sede:1,estatus:1,turno:2,mesa:{mesa:1,area:{area:1,sede:1,area_padre:null,nombre:"Bar"},numero:1,posx:23.8667,posy:18.8333,tamanio:72,estatus:2},cuentas:[{cuenta:31,comanda:37,nombre:"\xdanica",numero:1,propina_monto:.8,propina_porcentaje:10,cerrada:1,productos:[{detalle_cuenta:75,cuenta_cuenta:31,detalle_comanda:79,comanda:37,articulo:{articulo:1,categoria_grupo:21,presentacion:null,descripcion:"Original",precio:8,bien_servicio:"B",existencias:969,impresora:{impresora:1,sede:1,nombre:"EPSON L120 Series",direccion_ip:null,ubicacion:null,bluetooth:0}},cantidad:1,precio:8,impreso:1,total:8,notas:"",numero_cuenta:1}]}]},{comanda:45,total:76,usuario:2,sede:1,estatus:1,turno:2,mesa:{mesa:3,area:{area:1,sede:1,area_padre:null,nombre:"Bar"},numero:3,posx:11.0667,posy:41.5,tamanio:72,estatus:2},cuentas:[{cuenta:39,comanda:45,nombre:"uno",numero:1,propina_monto:.8,propina_porcentaje:10,cerrada:1,productos:[{detalle_cuenta:84,cuenta_cuenta:39,detalle_comanda:88,comanda:45,articulo:{articulo:1,categoria_grupo:21,presentacion:null,descripcion:"Original",precio:8,bien_servicio:"B",existencias:969,impresora:{impresora:1,sede:1,nombre:"EPSON L120 Series",direccion_ip:null,ubicacion:null,bluetooth:0}},cantidad:1,precio:8,impreso:1,total:8,notas:"",numero_cuenta:1},{detalle_cuenta:85,cuenta_cuenta:40,detalle_comanda:89,comanda:45,articulo:{articulo:2,categoria_grupo:21,presentacion:null,descripcion:"Zero",precio:8,bien_servicio:"B",existencias:984,impresora:{impresora:1,sede:1,nombre:"EPSON L120 Series",direccion_ip:null,ubicacion:null,bluetooth:0}},cantidad:1,precio:8,impreso:1,total:8,notas:"",numero_cuenta:1},{detalle_cuenta:86,cuenta_cuenta:40,detalle_comanda:90,comanda:45,articulo:{articulo:6,categoria_grupo:23,presentacion:null,descripcion:"Fettuccine",precio:60,bien_servicio:"B",existencias:995,impresora:{impresora:2,sede:1,nombre:"EPSON L120 Series",direccion_ip:null,ubicacion:null,bluetooth:0}},cantidad:1,precio:60,impreso:1,total:60,notas:"",numero_cuenta:1}]}]}]}}return t.\u0275fac=function(e){return new(e||t)(W.Xb(n.b))},t.\u0275prov=W.Jb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function ee(t,e){if(1&t&&(W.Tb(0,"mat-option",10),W.Fc(1),W.Sb()),2&t){const t=e.$implicit;W.lc("value",t)("disabled",1==+t.cerrada),W.Cb(1),W.Hc(" ",t.nombre," ")}}function ae(t,e){if(1&t&&(W.Tb(0,"mat-option",10),W.Fc(1),W.Sb()),2&t){const t=e.$implicit;W.lc("value",t)("disabled",1==+t.cerrada),W.Cb(1),W.Hc(" ",t.nombre," ")}}let oe=(()=>{class t{constructor(t,e,a,o){this.dialogRef=t,this.comandaSrvc=e,this.snackBar=a,this.data=o}ngOnInit(){}cancelar(){this.dialogRef.close(!1)}unirCuentas(t,e){this.comandaSrvc.unificarCuentas(t.cuenta,e.cuenta).subscribe(t=>{t.exito?(this.snackBar.open(t.mensaje,"Cuentas",{duration:3e3}),this.dialogRef.close(!0)):this.snackBar.open(`ERROR:${t.mensaje}`,"Cuentas",{duration:7e3})})}unirTodas(){}}return t.\u0275fac=function(e){return new(e||t)(W.Nb(D.f),W.Nb(te),W.Nb(M.b),W.Nb(D.a))},t.\u0275cmp=W.Hb({type:t,selectors:[["app-unir-cuenta"]],decls:20,vars:5,consts:[["mat-dialog-title",""],["mat-dialog-content",""],["novalidate",""],["frmUnirCuenta","ngForm"],["name","cuentaDe","required","",3,"ngModel","ngModelChange"],[3,"value","disabled",4,"ngFor","ngForOf"],["name","cuentaA","required","",3,"ngModel","ngModelChange"],["mat-dialog-actions","","align","end"],["mat-raised-button","","color","warn",3,"click"],["mat-raised-button","","type","button","color","accent",3,"disabled","click"],[3,"value","disabled"]],template:function(t,e){if(1&t&&(W.Tb(0,"h1",0),W.Fc(1,"Unir cuentas"),W.Sb(),W.Tb(2,"div",1),W.Tb(3,"form",2,3),W.Tb(5,"mat-form-field"),W.Tb(6,"mat-label"),W.Fc(7,"Unir cuenta de"),W.Sb(),W.Tb(8,"mat-select",4),W.bc("ngModelChange",function(t){return e.cuentaDe=t}),W.Dc(9,ee,2,3,"mat-option",5),W.Sb(),W.Sb(),W.Tb(10,"mat-form-field"),W.Tb(11,"mat-label"),W.Fc(12,"con la cuenta de"),W.Sb(),W.Tb(13,"mat-select",6),W.bc("ngModelChange",function(t){return e.cuentaA=t}),W.Dc(14,ae,2,3,"mat-option",5),W.Sb(),W.Sb(),W.Sb(),W.Sb(),W.Tb(15,"div",7),W.Tb(16,"button",8),W.bc("click",function(){return e.cancelar()}),W.Fc(17," Cancelar "),W.Sb(),W.Tb(18,"button",9),W.bc("click",function(){return e.unirCuentas(e.cuentaDe,e.cuentaA)}),W.Fc(19," Unir cuentas "),W.Sb(),W.Sb()),2&t){const t=W.tc(4);W.Cb(8),W.lc("ngModel",e.cuentaDe),W.Cb(1),W.lc("ngForOf",e.data.mesaEnUso.cuentas),W.Cb(4),W.lc("ngModel",e.cuentaA),W.Cb(1),W.lc("ngForOf",e.data.mesaEnUso.cuentas),W.Cb(4),W.lc("disabled",!t.form.valid||!e.cuentaDe||!e.cuentaA||+e.cuentaDe.numero==+e.cuentaA.numero)}},directives:[D.g,D.d,i.r,i.l,i.m,m.b,m.f,C.a,i.p,i.k,i.n,o.l,D.c,v.a,_.m],styles:[""]}),t})();function ne(t,e){if(1&t&&(W.Tb(0,"mat-option",10),W.Fc(1),W.Sb()),2&t){const t=e.$implicit;W.lc("value",t),W.Cb(1),W.Ic(" ",t.area.nombre," - ",t.etiqueta||t.numero," ")}}let ie=(()=>{class t{constructor(t,e,a,o,n){this.dialogRef=t,this.snackBar=e,this.mesaSrvc=a,this.comandaSrvc=o,this.data=n,this.mesasDisponibles=[],this.loadMesasDisponibles=()=>this.mesaSrvc.getDisponibles().subscribe(t=>this.mesasDisponibles=t),this.cancelar=()=>this.dialogRef.close(!1),this.trasladar=()=>{this.comandaSrvc.trasladarMesa(+this.data.mesaEnUso.comanda,+this.data.mesaEnUso.mesa.mesa,+this.destino.mesa).subscribe(t=>{t.exito?(this.snackBar.open(t.mensaje,"Traslado de mesa",{duration:3e3}),this.dialogRef.close(!0)):this.snackBar.open(`ERROR:${t.mensaje}`,"Traslado de mesa",{duration:7e3})})}}ngOnInit(){this.loadMesasDisponibles()}}return t.\u0275fac=function(e){return new(e||t)(W.Nb(D.f),W.Nb(M.b),W.Nb(ct),W.Nb(te),W.Nb(D.a))},t.\u0275cmp=W.Hb({type:t,selectors:[["app-traslado-mesa"]],decls:15,vars:3,consts:[["mat-dialog-title",""],["mat-dialog-content",""],["novalidate",""],["frmTrasladarMesa","ngForm"],[1,"fullWidth"],["name","destino","required","",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["mat-dialog-actions","","align","end"],["mat-raised-button","","color","warn",3,"click"],["mat-raised-button","","type","button","color","accent",3,"disabled","click"],[3,"value"]],template:function(t,e){if(1&t&&(W.Tb(0,"h1",0),W.Fc(1,"Trasladar a otra mesa"),W.Sb(),W.Tb(2,"div",1),W.Tb(3,"form",2,3),W.Tb(5,"mat-form-field",4),W.Tb(6,"mat-label"),W.Fc(7,"Trasladar a mesa:"),W.Sb(),W.Tb(8,"mat-select",5),W.bc("ngModelChange",function(t){return e.destino=t}),W.Dc(9,ne,2,3,"mat-option",6),W.Sb(),W.Sb(),W.Sb(),W.Sb(),W.Tb(10,"div",7),W.Tb(11,"button",8),W.bc("click",function(){return e.cancelar()}),W.Fc(12," Cancelar "),W.Sb(),W.Tb(13,"button",9),W.bc("click",function(){return e.trasladar()}),W.Fc(14," Trasladar "),W.Sb(),W.Sb()),2&t){const t=W.tc(4);W.Cb(8),W.lc("ngModel",e.destino),W.Cb(1),W.lc("ngForOf",e.mesasDisponibles),W.Cb(4),W.lc("disabled",!t.form.valid)}},directives:[D.g,D.d,i.r,i.l,i.m,m.b,m.f,C.a,i.p,i.k,i.n,o.l,D.c,v.a,_.m],styles:[""]}),t})();var se=a("wd/R");class ce{constructor(t,e,a){this.tipo=t,this.subtitulo=e,this.etiquetaAceptar=a}}let re=(()=>{class t{constructor(t,e,a){this.comandaSrvc=t,this.dialogRef=e,this.data=a,this.pwd=void 0,this.cancelar=()=>this.dialogRef.close(),this.terminar=()=>{switch(+this.data.tipo){case 1:this.validarPwdGerenteTurno()}},this.validarPwdGerenteTurno=()=>{this.comandaSrvc.validaPwdGerenteTurno(this.pwd).subscribe(t=>{this.dialogRef.close(!!t.exito&&t.esgerente)})}}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)(W.Nb(te),W.Nb(D.f),W.Nb(D.a))},t.\u0275cmp=W.Hb({type:t,selectors:[["app-check-password"]],decls:14,vars:4,consts:[["mat-dialog-title",""],["novalidate","",3,"ngSubmit"],["frmValidaPwd","ngForm"],[1,"fullWidth"],["type","password","matInput","","placeholder","Contrase\xf1a","name","pwd","required","",3,"ngModel","ngModelChange"],["align","end"],["mat-raised-button","","color","secondary",1,"btnAccion",3,"click"],["mat-raised-button","","color","accent",3,"disabled","click"]],template:function(t,e){if(1&t){const t=W.Ub();W.Tb(0,"h1",0),W.Fc(1," Validar contrase\xf1a"),W.Ob(2,"br"),W.Fc(3),W.Sb(),W.Tb(4,"mat-dialog-content"),W.Tb(5,"form",1,2),W.bc("ngSubmit",function(){return W.xc(t),W.tc(6).form.valid}),W.Tb(7,"mat-form-field",3),W.Tb(8,"input",4),W.bc("ngModelChange",function(t){return e.pwd=t}),W.Sb(),W.Sb(),W.Sb(),W.Sb(),W.Tb(9,"mat-dialog-actions",5),W.Tb(10,"button",6),W.bc("click",function(){return e.cancelar()}),W.Fc(11," Cancelar "),W.Sb(),W.Tb(12,"button",7),W.bc("click",function(){return e.terminar()}),W.Fc(13),W.Sb(),W.Sb()}if(2&t){const t=W.tc(6);W.Cb(3),W.Hc(" ",e.data.subtitulo||"Gerente de turno","\n"),W.Cb(5),W.lc("ngModel",e.pwd),W.Cb(4),W.lc("disabled",!t.form.valid),W.Cb(1),W.Hc(" ",e.data.etiquetaAceptar||"Validar"," ")}},directives:[D.g,D.d,i.r,i.l,i.m,m.b,h.b,i.c,i.p,i.k,i.n,D.c,v.a],styles:[""]}),t})();var le=a("52Kp"),de=a("quSY"),ue=a("KZK3");let be=(()=>{class t{constructor(t){this.http=t,this.moduleUrl="cuenta",this.srvcErrHndl=new Y.a}save(t){return this.http.post(`${X.b.urlAppRestaurante}/${this.moduleUrl}/cobrar/${t.cuenta}`,t).pipe(Object(Z.a)(X.b.reintentos),Object(tt.a)(this.srvcErrHndl.errorHandler))}}return t.\u0275fac=function(e){return new(e||t)(W.Xb(n.b))},t.\u0275prov=W.Jb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var me=a("KFbY"),he=a("7JkF"),pe=a("IHy4"),fe=a("qXgu"),ge=a("FjVI"),Se=a("TOq3");function Ce(t,e){if(1&t&&(W.Tb(0,"small"),W.Fc(1),W.Sb()),2&t){const t=W.fc();W.Cb(1),W.Hc(" - Factura a nombre de ",t.clienteSelected.nombre," ")}}function Te(t,e){if(1&t&&(W.Tb(0,"tr"),W.Tb(1,"td"),W.Fc(2),W.Sb(),W.Tb(3,"td",25),W.Fc(4),W.gc(5,"number"),W.Sb(),W.Sb()),2&t){const t=e.$implicit;W.Cb(2),W.Ic("",t.cantidad,"\xa0",t.nombre||t.articulo.descripcion,""),W.Cb(2),W.Gc(W.ic(5,3,t.cantidad*t.precio+t.monto_extra,"1.2-2"))}}function ve(t,e){if(1&t&&(W.Tb(0,"mat-option",38),W.Fc(1),W.Sb()),2&t){const t=e.$implicit;W.lc("value",t.forma_pago),W.Cb(1),W.Hc(" ",t.descripcion," ")}}function Me(t,e){if(1&t){const t=W.Ub();W.Tb(0,"input",39),W.bc("ngModelChange",function(e){return W.xc(t),W.fc().formaPago.monto=e}),W.Sb()}if(2&t){const t=W.fc();W.lc("matKeyboard",t.keyboardLayout)("ngModel",t.formaPago.monto)}}function Fe(t,e){if(1&t){const t=W.Ub();W.Tb(0,"input",40),W.bc("ngModelChange",function(e){return W.xc(t),W.fc().formaPago.monto=e}),W.Sb()}if(2&t){const t=W.fc();W.lc("ngModel",t.formaPago.monto)}}function xe(t,e){if(1&t){const t=W.Ub();W.Tb(0,"input",41),W.bc("ngModelChange",function(e){return W.xc(t),W.fc().formaPago.propina=e}),W.Sb()}if(2&t){const t=W.fc();W.lc("matKeyboard",t.keyboardLayout)("ngModel",t.formaPago.propina)}}function ke(t,e){if(1&t){const t=W.Ub();W.Tb(0,"input",42),W.bc("ngModelChange",function(e){return W.xc(t),W.fc().formaPago.propina=e}),W.Sb()}if(2&t){const t=W.fc();W.lc("ngModel",t.formaPago.propina)}}function Oe(t,e){if(1&t){const t=W.Ub();W.Tb(0,"input",45),W.bc("ngModelChange",function(e){return W.xc(t),W.fc(2).formaPago.documento=e}),W.Sb()}if(2&t){const t=W.fc(2);W.lc("matKeyboard",t.keyboardLayout)("ngModel",t.formaPago.documento)("required",t.pideDocumento)}}function De(t,e){if(1&t){const t=W.Ub();W.Tb(0,"input",46),W.bc("ngModelChange",function(e){return W.xc(t),W.fc(2).formaPago.documento=e}),W.Sb()}if(2&t){const t=W.fc(2);W.lc("ngModel",t.formaPago.documento)("required",t.pideDocumento)}}function Ee(t,e){if(1&t&&(W.Tb(0,"mat-form-field",13),W.Dc(1,Oe,1,3,"input",43),W.Dc(2,De,1,2,"input",44),W.Sb()),2&t){const t=W.fc();W.Cb(1),W.lc("ngIf",!t.esMovil),W.Cb(1),W.lc("ngIf",t.esMovil)}}function Pe(t,e){if(1&t){const t=W.Ub();W.Tb(0,"tr"),W.Tb(1,"td"),W.Fc(2),W.Sb(),W.Tb(3,"td",25),W.Fc(4),W.gc(5,"number"),W.Sb(),W.Tb(6,"td",25),W.Fc(7),W.gc(8,"number"),W.Sb(),W.Tb(9,"td",47),W.Tb(10,"button",48),W.bc("click",function(){W.xc(t);const a=e.index;return W.fc().delFormaPago(a)}),W.Tb(11,"mat-icon"),W.Fc(12,"delete_forever"),W.Sb(),W.Sb(),W.Sb(),W.Sb()}if(2&t){const t=e.$implicit;W.Cb(2),W.Gc(t.forma_pago.descripcion),W.Cb(2),W.Gc(W.ic(5,3,t.monto,"1.2-2")),W.Cb(3),W.Gc(W.ic(8,6,t.propina,"1.2-2"))}}function _e(t,e){if(1&t&&(W.Tb(0,"mat-option",38),W.Fc(1),W.Sb()),2&t){const t=e.$implicit;W.lc("value",t.sede),W.Cb(1),W.Hc(" ",t.nombre," ")}}function ye(t,e){if(1&t){const t=W.Ub();W.Tb(0,"table",29),W.Tb(1,"caption"),W.Tb(2,"strong"),W.Fc(3,"Datos de env\xedo"),W.Sb(),W.Sb(),W.Tb(4,"tbody"),W.Tb(5,"tr"),W.Tb(6,"td"),W.Tb(7,"mat-form-field",13),W.Tb(8,"mat-label"),W.Fc(9,"Atiende:"),W.Sb(),W.Tb(10,"mat-select",49),W.bc("ngModelChange",function(e){return W.xc(t),W.fc().datosPedido.sede=e}),W.Dc(11,_e,2,2,"mat-option",15),W.Sb(),W.Sb(),W.Sb(),W.Tb(12,"td"),W.Tb(13,"mat-form-field",13),W.Tb(14,"input",50),W.bc("ngModelChange",function(e){return W.xc(t),W.fc().datosPedido.direccion_entrega=e}),W.Sb(),W.Sb(),W.Sb(),W.Sb(),W.Tb(15,"tr"),W.Tb(16,"td"),W.Tb(17,"mat-form-field",13),W.Tb(18,"input",51),W.bc("ngModelChange",function(e){return W.xc(t),W.fc().datosPedido.nombre=e}),W.Sb(),W.Sb(),W.Sb(),W.Tb(19,"td"),W.Tb(20,"mat-form-field",13),W.Tb(21,"input",52),W.bc("ngModelChange",function(e){return W.xc(t),W.fc().datosPedido.telefono=e}),W.Sb(),W.Sb(),W.Sb(),W.Sb(),W.Sb(),W.Sb()}if(2&t){const t=W.fc();W.Cb(10),W.lc("ngModel",t.datosPedido.sede),W.Cb(1),W.lc("ngForOf",t.sedes),W.Cb(3),W.lc("ngModel",t.datosPedido.direccion_entrega),W.Cb(4),W.lc("ngModel",t.datosPedido.nombre),W.Cb(3),W.lc("ngModel",t.datosPedido.telefono)}}function Ie(t,e){if(1&t&&W.Ob(0,"app-cargando",53),2&t){const t=W.fc();W.lc("configuracion",t.cargandoConf)}}function we(t,e){if(1&t){const t=W.Ub();W.Tb(0,"button",36),W.bc("click",function(){return W.xc(t),W.fc().cobrar()}),W.Fc(1,"Facturar"),W.Sb()}if(2&t){const t=W.fc();W.lc("disabled",0==t.formasPagoDeCuenta.length||+t.inputData.saldo>0||!t.factReq.cliente||t.facturando)}}function Ae(t,e){if(1&t){const t=W.Ub();W.Tb(0,"button",36),W.bc("click",function(){return W.xc(t),W.fc().cobrar()}),W.Fc(1," Enviar "),W.Sb()}if(2&t){const t=W.fc();W.lc("disabled",0==t.formasPagoDeCuenta.length||+t.inputData.saldo>0||!t.factReq.cliente||t.facturando||!t.datosPedido.sede)}}const Ne=function(t,e,a){return{"saldo-pendiente":t,"saldo-exacto":e,"saldo-extra":a}};let Re=(()=>{class t{constructor(t,e,a,o,n,i,s,c,r,l,d,u){this.dialog=t,this.dialogRef=e,this.data=a,this.snackBar=o,this.formaPagoSrvc=n,this.cobroSrvc=i,this.facturaSrvc=s,this.ls=c,this.socket=r,this.sedeSrvc=l,this.comandaSrvc=d,this.configSrvc=u,this.inputData={},this.lstFormasPago=[],this.formaPago={},this.formasPagoDeCuenta=[],this.esMovil=!1,this.facturando=!1,this.cargandoConf={w:75,h:75},this.pideDocumento=!1,this.sedes=[],this.datosPedido={sede:null,direccion_entrega:null,telefono:null,nombre:null,cliente:null},this.endSubs=new de.a,this.resetFactReq=()=>{this.factReq={cuentas:[],factura_serie:1,cliente:null,fecha_factura:se().format(X.b.dbDateFormat),moneda:1}},this.processData=()=>{this.data?this.inputData=this.data:this.data=this.inputData,this.inputData.totalDeCuenta=0,this.inputData.productosACobrar.forEach(t=>{this.inputData.totalDeCuenta+=t.precio*t.cantidad+t.monto_extra}),this.calculaPropina(),this.actualizaSaldo(),this.formaPago.monto=parseFloat(this.inputData.saldo).toFixed(2),this.inputData.clientePedido&&this.setClienteFacturar(this.inputData.clientePedido)},this.loadSedes=()=>{this.endSubs.add(this.sedeSrvc.get().subscribe(t=>{t&&(this.sedes=t)}))},this.calculaPropina=()=>{this.inputData.montoPropina=parseFloat((this.inputData.porcentajePropina*this.inputData.totalDeCuenta/100).toFixed(2)),this.actualizaSaldo()},this.loadFormasPago=()=>{this.endSubs.add(this.formaPagoSrvc.get({activo:1}).subscribe(t=>{t&&t.length>0&&(this.lstFormasPago=t)}))},this.addFormaPago=()=>{const t=this.lstFormasPago.filter(t=>+t.forma_pago==+this.formaPago.forma_pago)[0];if(1==+t.pedirautorizacion){const e=this.dialog.open(re,{width:"40%",disableClose:!0,data:new ce(1)});this.endSubs.add(e.afterClosed().subscribe(e=>{e?this.agregaFormaPago(t):this.snackBar.open("La contrase\xf1a no es correcta","Formas de pago",{duration:5e3})}))}else this.agregaFormaPago(t)},this.agregaFormaPago=t=>{this.formasPagoDeCuenta.push({forma_pago:t,monto:parseFloat(this.formaPago.monto).toFixed(2),propina:this.formaPago.propina||0,documento:this.formaPago.documento||null,comision_monto:+this.formaPago.monto*+t.comision_porcentaje/100}),this.actualizaSaldo(),this.pideDocumento=!1},this.delFormaPago=t=>{this.formasPagoDeCuenta.splice(t,1),this.actualizaSaldo()},this.actualizaSaldo=()=>{let t=0;this.formasPagoDeCuenta.forEach(e=>t+=+e.monto),this.inputData.saldo=(+this.inputData.totalDeCuenta-t).toFixed(2),this.formaPago={monto:this.inputData.saldo}},this.cancelar=()=>this.dialogRef.close(),this.setClienteFacturar=t=>{this.clienteSelected=t,this.factReq.cliente=+t.cliente,1==+this.data.mesaenuso.mesa.escallcenter&&(this.datosPedido.nombre=t.nombre,this.datosPedido.direccion_entrega=t.direccion,this.datosPedido.telefono=t.telefono)},this.cobrar=()=>{this.facturando=!0;const t={cuenta:this.inputData.idcuenta,forma_pago:[],total:this.inputData.totalDeCuenta+this.inputData.montoPropina,propina_monto:this.inputData.montoPropina,propina_porcentaje:this.inputData.porcentajePropina,comision_monto:0};let e=0;for(const a of this.formasPagoDeCuenta)e+=a.comision_monto||0,t.forma_pago.push({forma_pago:+a.forma_pago.forma_pago,monto:+a.monto+ +a.comision_monto,propina:a.propina||0,documento:a.documento,comision_monto:a.comision_monto});t.comision_monto=e,t.total+=e,1!=+this.data.mesaenuso.mesa.escallcenter?(this.factReq.cuentas.push({cuenta:+this.inputData.idcuenta}),this.endSubs.add(this.cobroSrvc.save(t).subscribe(t=>{if(t.exito&&!t.facturada)if(this.snackBar.open("Cobro",`${t.mensaje}`,{duration:3e3}),t.facturar)this.endSubs.add(this.facturaSrvc.facturar(this.factReq).subscribe(e=>{if(e.exito){const a=this.dialog.open(bt.a,{maxWidth:"400px",data:new bt.b("Imprimir factura","\xbfDesea imprimir la factura?","S\xed","No")});this.endSubs.add(a.afterClosed().subscribe(a=>{a&&this.printFactura(e.factura),this.resetFactReq(),this.snackBar.open("Factura",`${e.mensaje}`,{duration:3e3}),this.facturando=!1,this.dialogRef.close(t.cuenta),this.socket.emit("refrescar:mesa",{mesaenuso:this.data.mesaenuso})}))}else this.facturando=!1,this.snackBar.open("Factura",`ERROR: ${t.mensaje}`,{duration:7e3}),this.socket.emit("refrescar:mesa",{mesaenuso:this.data.mesaenuso}),this.dialogRef.close(t.cuenta)}));else{const e=this.dialog.open(bt.a,{maxWidth:"400px",data:new bt.b("Imprimir recibo","\xbfDesea imprimir un recibo?","S\xed","No")});this.endSubs.add(e.afterClosed().subscribe(e=>{e&&this.printRecibo(t.entidad),this.socket.emit("refrescar:mesa",{mesaenuso:this.data.mesaenuso}),this.dialogRef.close(t.cuenta)}))}else this.facturando=!1,this.snackBar.open("Cobro",`ERROR: ${t.mensaje}`,{duration:7e3}),this.socket.emit("refrescar:mesa",{mesaenuso:this.data.mesaenuso}),this.dialogRef.close("closePanel")}))):this.enviarPedido(t)},this.enviarPedido=t=>{this.datosPedido.cliente={nombre:this.clienteSelected.nombre,apellidos:"",correo:this.clienteSelected.correo,telefono:this.datosPedido.telefono,nit:this.clienteSelected.nit,direccion:this.datosPedido.direccion_entrega};const e={cobro:t,pedido:this.datosPedido,factura:{cuentas:[{cuenta:t.cuenta}],factura_serie:1,cliente:this.clienteSelected.cliente,fecha_factura:se().format(X.b.dbDateFormat),moneda:1}};this.endSubs.add(this.comandaSrvc.enviarPedido(+this.data.mesaenuso.comanda,e).subscribe(t=>{t.exito?(this.snackBar.open("Pedido",`#${t.pedido}. ${t.mensaje}`,{duration:3e3}),this.dialogRef.close("closePanel")):this.snackBar.open("Pedido",`ERROR: ${t.mensaje}`,{duration:7e3}),this.facturando=!1,this.socket.emit("refrescar:mesa",{mesaenuso:this.data.mesaenuso})}))},this.procesaDetalleFactura=t=>{const e=[];return t.forEach(t=>e.push({Cantidad:parseInt(t.cantidad),Descripcion:t.articulo.descripcion,Total:+t.total,PrecioUnitario:t.precio_unitario?+t.precio_unitario:+t.precio})),e},this.getTotalDetalle=t=>{let e=0;return t.forEach(t=>e+=+t.total),e},this.getTotalImpuestosAdicionales=t=>{let e=0;return t.forEach(t=>e+=+t.total),e},this.printFactura=t=>{this.endSubs.add(this.facturaSrvc.imprimir(+t.factura).subscribe(t=>{if(t.factura){const e={NombreEmpresa:t.factura.empresa.nombre,NitEmpresa:t.factura.empresa.nit,SedeEmpresa:t.factura.sedeFactura.nombre,DireccionEmpresa:t.factura.empresa.direccion,Fecha:se(t.factura.fecha_factura).format(X.b.dateFormat),Nit:t.factura.receptor.nit,Nombre:t.factura.receptor.nombre,Direccion:t.factura.receptor.direccion,Serie:t.factura.serie_factura,Numero:t.factura.numero_factura,Total:this.getTotalDetalle(t.factura.detalle)+this.getTotalImpuestosAdicionales(t.factura.impuestos_adicionales||[]),NoAutorizacion:t.factura.fel_uuid,NombreCertificador:t.factura.certificador_fel.nombre,NitCertificador:t.factura.certificador_fel.nit,FechaDeAutorizacion:t.factura.fecha_autorizacion,NoOrdenEnLinea:"",FormaDePago:"",DetalleFactura:this.procesaDetalleFactura(t.factura.detalle),Impresora:this.data.impresora,ImpuestosAdicionales:t.factura.impuestos_adicionales||[]};this.data.impresora?0==+this.data.impresora.bluetooth?this.socket.emit("print:factura",`${JSON.stringify(e)}`):(e.Fecha=se(t.factura.fecha_factura).format(X.b.dateFormatBT),this.printToBT(JSON.stringify(e))):this.socket.emit("print:factura",`${JSON.stringify(e)}`),this.snackBar.open(`Imprimiendo factura ${t.factura.serie_factura}-${t.factura.numero_factura}`,"Impresi\xf3n",{duration:3e3})}else this.snackBar.open(`ERROR: ${t.mensaje}`,"Impresi\xf3n",{duration:7e3})}))},this.printRecibo=t=>{const e={NombreEmpresa:t.empresa.nombre,NitEmpresa:t.empresa.nit,SedeEmpresa:t.sede.nombre,DireccionEmpresa:t.sede.direccion,Fecha:se().format(X.b.dateFormat),Nombre:this.clienteSelected.nombre||t.nombre,Numero:`${t.comanda}-${t.numero}`,Total:this.getTotalDetalle(t.detalle)+ +t.propina,Propina:+t.propina,DetalleRecibo:this.procesaDetalleFactura(t.detalle),Impresora:this.data.impresora};this.data.impresora?0==+this.data.impresora.bluetooth?this.socket.emit("print:recibo",`${JSON.stringify(e)}`):(e.Fecha=se().format(X.b.dateFormatBT),this.printToBT(JSON.stringify(e))):this.socket.emit("print:recibo",`${JSON.stringify(e)}`),this.snackBar.open(`Imprimiendo recibo ${t.comanda}-${t.numero}`,"Impresi\xf3n",{duration:3e3})},this.printToBT=(t="")=>{const e=this.configSrvc.getConfig(X.b.CONSTANTES.RT_ENVIA_COMO_BASE64)?le.a.encode(t,!0):t,a=X.b.DEEP_LINK_ANDROID.replace("__INFOBASE64__",e);try{window.location.href=a}catch(o){this.snackBar.open("No se pudo conectar con la aplicaci\xf3n de impresi\xf3n","Comanda",{duration:3e3})}},this.onSelectionChangeFP=t=>{const e=this.lstFormasPago.findIndex(e=>+e.forma_pago==+t.value);e>-1&&(this.pideDocumento=1==+this.lstFormasPago[e].pedirdocumento)}}ngOnInit(){this.esMovil=this.ls.get(X.b.usrTokenVar).enmovil||!1,this.keyboardLayout=X.b.IDIOMA_TECLADO,this.resetFactReq(),this.processData(),this.loadFormasPago(),this.ls.get(X.b.usrTokenVar).sede_uuid&&(this.socket.emit("joinRestaurant",this.ls.get(X.b.usrTokenVar).sede_uuid),this.socket.on("reconnect",()=>this.socket.emit("joinRestaurant",this.ls.get(X.b.usrTokenVar).sede_uuid))),this.loadSedes()}ngOnDestroy(){this.endSubs.unsubscribe()}calculaPorcentajePropina(){this.inputData.porcentajePropina=parseFloat((100*this.inputData.montoPropina/this.inputData.totalDeCuenta).toFixed(2)),this.actualizaSaldo()}}return t.\u0275fac=function(e){return new(e||t)(W.Nb(D.b),W.Nb(D.f),W.Nb(D.a),W.Nb(M.b),W.Nb(ue.a),W.Nb(be),W.Nb(me.a),W.Nb(ot.a),W.Nb(he.a),W.Nb(pe.a),W.Nb(te),W.Nb(fe.a))},t.\u0275cmp=W.Hb({type:t,selectors:[["app-cobrar-pedido"]],inputs:{inputData:"inputData"},decls:67,vars:31,consts:[["mat-dialog-title",""],[4,"ngIf"],["mat-dialog-content","",2,"height","650px"],[1,"row"],[1,"col","m5","s12","mat-elevation-z4","colHeight",2,"overflow-y","auto"],[3,"showAddButton","getClienteEv"],["lstClientes",""],[1,"col","m3","s12","mat-elevation-z4","colHeight",2,"overflow-y","auto"],[1,"table","table-sm","table-borderless","table-striped"],[4,"ngFor","ngForOf"],[1,"col","m4","s12","mat-elevation-z4","colHeight",2,"overflow-y","auto"],["novalidate",""],["frmFormasPago","ngForm"],[1,"fullWidth"],["name","forma_pago","cdkFocusInitial","","required","",3,"ngModel","ngModelChange","selectionChange"],[3,"value",4,"ngFor","ngForOf"],["matInput","","placeholder","monto","name","monto","required","",3,"matKeyboard","ngModel","ngModelChange",4,"ngIf"],["matInput","","placeholder","monto","name","monto","required","",3,"ngModel","ngModelChange",4,"ngIf"],["matInput","","placeholder","Propina","name","propina",3,"matKeyboard","ngModel","ngModelChange",4,"ngIf"],["matInput","","placeholder","Propina","name","propina",3,"ngModel","ngModelChange",4,"ngIf"],["class","fullWidth",4,"ngIf"],["align","end"],["mat-raised-button","","type","button","color","accent",3,"disabled","click"],[1,"table","table-sm"],[1,"text-left"],[1,"text-right"],[1,"col","m8","s8"],["class","table table-sm table-borderless",4,"ngIf"],[1,"col","m4","s4"],[1,"table","table-sm","table-borderless"],[1,"text-right","font-weight-bold"],[1,"text-right","font-weight-bold","totalCuenta",2,"max-width","15%"],[1,"text-right","font-weight-bold",2,"max-width","15%"],[3,"ngClass"],["mat-dialog-actions","","align","end"],[3,"configuracion",4,"ngIf"],["mat-raised-button","","color","accent",3,"disabled","click"],["mat-raised-button","","color","accent",3,"disabled","click",4,"ngIf"],[3,"value"],["matInput","","placeholder","monto","name","monto","required","",3,"matKeyboard","ngModel","ngModelChange"],["matInput","","placeholder","monto","name","monto","required","",3,"ngModel","ngModelChange"],["matInput","","placeholder","Propina","name","propina",3,"matKeyboard","ngModel","ngModelChange"],["matInput","","placeholder","Propina","name","propina",3,"ngModel","ngModelChange"],["matInput","","placeholder","Documento","name","documento",3,"matKeyboard","ngModel","required","ngModelChange",4,"ngIf"],["matInput","","placeholder","Documento","name","documento",3,"ngModel","required","ngModelChange",4,"ngIf"],["matInput","","placeholder","Documento","name","documento",3,"matKeyboard","ngModel","required","ngModelChange"],["matInput","","placeholder","Documento","name","documento",3,"ngModel","required","ngModelChange"],[1,"text-center"],["mat-icon-button","","type","button","color","warn",3,"click"],["name","sede","required","",3,"ngModel","ngModelChange"],["matInput","","type","text","placeholder","Direcci\xf3n de entrega","name","direccion_entrega","maxlength","1000","required","",3,"ngModel","ngModelChange"],["matInput","","type","text","placeholder","Nombre","name","nombre","maxlength","1000",3,"ngModel","ngModelChange"],["matInput","","type","text","placeholder","Tel\xe9fono","name","telefono","maxlength","1000",3,"ngModel","ngModelChange"],[3,"configuracion"]],template:function(t,e){if(1&t&&(W.Tb(0,"h1",0),W.Fc(1),W.Dc(2,Ce,2,1,"small",1),W.Sb(),W.Tb(3,"div",2),W.Tb(4,"div",3),W.Tb(5,"div",4),W.Tb(6,"app-lista-cliente",5,6),W.bc("getClienteEv",function(t){return e.setClienteFacturar(t)}),W.Sb(),W.Sb(),W.Tb(8,"div",7),W.Tb(9,"table",8),W.Tb(10,"tbody"),W.Dc(11,Te,6,6,"tr",9),W.Sb(),W.Sb(),W.Sb(),W.Tb(12,"div",10),W.Tb(13,"form",11,12),W.Tb(15,"mat-form-field",13),W.Tb(16,"mat-label"),W.Fc(17,"Forma de pago"),W.Sb(),W.Tb(18,"mat-select",14),W.bc("ngModelChange",function(t){return e.formaPago.forma_pago=t})("selectionChange",function(t){return e.onSelectionChangeFP(t)}),W.Dc(19,ve,2,2,"mat-option",15),W.Sb(),W.Sb(),W.Tb(20,"mat-form-field",13),W.Dc(21,Me,1,2,"input",16),W.Dc(22,Fe,1,1,"input",17),W.Sb(),W.Tb(23,"mat-form-field",13),W.Dc(24,xe,1,2,"input",18),W.Dc(25,ke,1,1,"input",19),W.Sb(),W.Dc(26,Ee,3,2,"mat-form-field",20),W.Tb(27,"div",21),W.Tb(28,"button",22),W.bc("click",function(){return e.addFormaPago()}),W.Fc(29," Agregar "),W.Sb(),W.Sb(),W.Sb(),W.Ob(30,"hr"),W.Tb(31,"table",23),W.Tb(32,"thead"),W.Tb(33,"tr"),W.Tb(34,"th",24),W.Fc(35,"FP"),W.Sb(),W.Tb(36,"th",25),W.Fc(37,"Mon"),W.Sb(),W.Tb(38,"th",25),W.Fc(39,"Prop"),W.Sb(),W.Sb(),W.Sb(),W.Tb(40,"tbody"),W.Dc(41,Pe,13,9,"tr",9),W.Sb(),W.Sb(),W.Sb(),W.Sb(),W.Tb(42,"div",3),W.Tb(43,"div",26),W.Dc(44,ye,22,5,"table",27),W.Sb(),W.Tb(45,"div",28),W.Tb(46,"table",29),W.Tb(47,"tbody"),W.Tb(48,"tr"),W.Tb(49,"td",30),W.Fc(50,"TOTAL DE CUENTA:"),W.Sb(),W.Tb(51,"td",31),W.Fc(52),W.gc(53,"number"),W.Sb(),W.Sb(),W.Tb(54,"tr"),W.Tb(55,"td",30),W.Fc(56,"PENDIENTE:"),W.Sb(),W.Tb(57,"td",32),W.Tb(58,"span",33),W.Fc(59),W.gc(60,"number"),W.Sb(),W.Sb(),W.Sb(),W.Sb(),W.Sb(),W.Sb(),W.Sb(),W.Sb(),W.Tb(61,"div",34),W.Dc(62,Ie,1,1,"app-cargando",35),W.Tb(63,"button",36),W.bc("click",function(){return e.cancelar()}),W.Fc(64,"Cancelar"),W.Sb(),W.Dc(65,we,2,1,"button",37),W.Dc(66,Ae,2,1,"button",37),W.Sb()),2&t){const t=W.tc(14);W.Cb(1),W.Hc(" Cobrar cuenta de ",e.data.cuenta," "),W.Cb(1),W.lc("ngIf",e.clienteSelected&&!!e.clienteSelected.cliente),W.Cb(4),W.lc("showAddButton",!0),W.Cb(5),W.lc("ngForOf",e.inputData.productosACobrar),W.Cb(7),W.lc("ngModel",e.formaPago.forma_pago),W.Cb(1),W.lc("ngForOf",e.lstFormasPago),W.Cb(2),W.lc("ngIf",!e.esMovil),W.Cb(1),W.lc("ngIf",e.esMovil),W.Cb(2),W.lc("ngIf",!e.esMovil),W.Cb(1),W.lc("ngIf",e.esMovil),W.Cb(1),W.lc("ngIf",e.pideDocumento),W.Cb(2),W.lc("disabled",!t.form.valid||e.inputData.saldo<=0),W.Cb(13),W.lc("ngForOf",e.formasPagoDeCuenta),W.Cb(3),W.lc("ngIf",1==+e.data.mesaenuso.mesa.escallcenter),W.Cb(8),W.Gc(W.ic(53,21,e.inputData.totalDeCuenta,"1.2-2")),W.Cb(6),W.lc("ngClass",W.qc(27,Ne,+e.inputData.saldo>0,0==+e.inputData.saldo,+e.inputData.saldo<0)),W.Cb(1),W.Gc(W.ic(60,24,e.inputData.saldo,"1.2-2")),W.Cb(3),W.lc("ngIf",e.facturando),W.Cb(1),W.lc("disabled",e.facturando),W.Cb(2),W.lc("ngIf",0==+e.data.mesaenuso.mesa.escallcenter),W.Cb(1),W.lc("ngIf",1==+e.data.mesaenuso.mesa.escallcenter)}},directives:[D.g,o.m,D.d,ge.a,o.l,i.r,i.l,i.m,m.b,m.f,C.a,i.p,i.k,i.n,v.a,o.k,D.c,_.m,h.b,N.a,i.c,b.a,i.f,Se.a],pipes:[o.f],styles:[".spacer[_ngcontent-%COMP%]{flex:1 1 auto}.totalCuenta[_ngcontent-%COMP%]{border-top:1px solid #000;border-bottom:5px double #000}.colHeight[_ngcontent-%COMP%]{height:400px}.saldo-pendiente[_ngcontent-%COMP%]{color:#da332d;border-bottom:5px double #da332d}.saldo-extra[_ngcontent-%COMP%]{color:#87ceeb;border-bottom:5px double #87ceeb}.saldo-exacto[_ngcontent-%COMP%]{color:green;border-bottom:5px double green}.propina[_ngcontent-%COMP%]{font-style:italic}"]}),t})();var Ue=a("XiUz");function $e(t,e){if(1&t){const t=W.Ub();W.Tb(0,"div",6),W.Tb(1,"mat-card",7),W.Ob(2,"mat-card-header"),W.Tb(3,"mat-card-content"),W.Rb(4),W.Tb(5,"div",0),W.Tb(6,"div",8),W.Tb(7,"button",9),W.bc("click",function(){W.xc(t);const a=e.$implicit;return W.fc().onConfirm(a.numero)}),W.Fc(8),W.Sb(),W.Sb(),W.Sb(),W.Qb(),W.Sb(),W.Sb(),W.Sb()}if(2&t){const t=e.$implicit;W.Cb(8),W.Gc(t.numero)}}class Be{constructor(t,e,a,o){this.titlew=t,this.cantidadPedido=e,this.lblBtnConfirm=a,this.lblBtnDeny=o}}let je=(()=>{class t{constructor(t,e){this.dialogRef=t,this.data=e,this.pedidos=[],this.datos={respuesta:!1,pedido:""},this.title=e.titlew,this.lblBtnConfirm=e.lblBtnConfirm,this.lblBtnDeny=e.lblBtnDeny,this.cantidadPedido=e.cantidadPedido,console.log(+this.cantidadPedido);for(let a=0;a<+this.cantidadPedido;a++)console.log("asdf"),this.pedidos.push({numero:a+1});console.log(this.pedidos)}ngOnInit(){}onConfirm(t){this.datos.respuesta=!0,this.datos.pedido=t,this.dialogRef.close(this.datos)}onDismiss(){this.datos.respuesta=!1,this.dialogRef.close(this.datos)}}return t.\u0275fac=function(e){return new(e||t)(W.Nb(D.f),W.Nb(D.a))},t.\u0275cmp=W.Hb({type:t,selectors:[["app-dialog-pedido"]],decls:9,vars:2,consts:[[1,"row"],["mat-dialog-title",""],["fxFlex","100%","fxFlex.xs","100%",1,"bordeRght"],["fxLayout","row wrap","fxLayoutGap","10px grid","fxFlexFill","","fxLayoutAlign","start start",1,"divContenedor"],["fxFlex","100%","fxLayoutAlign","center start"],["fxFlex","20%","fxFlex.xs","100%","fxFlex.sm","100%","fxFlex.md","50%",4,"ngFor","ngForOf"],["fxFlex","20%","fxFlex.xs","100%","fxFlex.sm","100%","fxFlex.md","50%"],[1,"mat-elevation-z4"],[1,"col"],["mat-raised-button","","color","accent","type","button",3,"click"]],template:function(t,e){1&t&&(W.Tb(0,"div",0),W.Tb(1,"h1",1),W.Fc(2),W.Sb(),W.Sb(),W.Tb(3,"mat-dialog-content"),W.Tb(4,"div",2),W.Tb(5,"div",3),W.Ob(6,"div",4),W.Dc(7,$e,9,1,"div",5),W.Sb(),W.Sb(),W.Ob(8,"mat-dialog-content"),W.Sb()),2&t&&(W.Cb(2),W.Hc(" ",e.title," "),W.Cb(5),W.lc("ngForOf",e.pedidos))},directives:[D.g,D.d,Ue.a,Ue.c,Ue.d,Ue.e,Ue.b,o.l,p.a,p.d,p.c,v.a],styles:[""]}),t})();var He=a("NGYs");function Le(t,e){if(1&t&&(W.Tb(0,"div"),W.Tb(1,"h5"),W.Fc(2),W.Sb(),W.Sb()),2&t){const t=W.fc().$implicit;W.Cb(2),W.Hc(" ",t.descripcion," ")}}function qe(t,e){if(1&t&&(W.Tb(0,"mat-option",12),W.Fc(1),W.Sb()),2&t){const t=e.$implicit;W.lc("value",t),W.Cb(1),W.Hc(" ",t.descripcion," ")}}const ze=function(){return{standalone:!0}};function Ge(t,e){if(1&t&&(W.Rb(0),W.Tb(1,"mat-select",10),W.bc("ngModelChange",function(t){return e.$implicit.seleccion=t}),W.Dc(2,qe,2,2,"mat-option",11),W.Sb(),W.Ob(3,"mat-divider"),W.Ob(4,"br"),W.Qb()),2&t){const t=e.$implicit,a=W.fc(2).$implicit;W.Cb(1),W.lc("ngModel",t.seleccion)("ngModelOptions",W.nc(3,ze)),W.Cb(1),W.lc("ngForOf",a.receta)}}function We(t,e){if(1&t&&(W.Tb(0,"div",0),W.Tb(1,"div",1),W.Dc(2,Ge,5,4,"ng-container",5),W.Sb(),W.Sb()),2&t){const t=W.fc().$implicit;W.Cb(2),W.lc("ngForOf",t.input)}}function Ve(t,e){if(1&t&&(W.Tb(0,"div"),W.Dc(1,Le,3,1,"div",8),W.Dc(2,We,3,1,"div",9),W.Sb()),2&t){const t=e.$implicit;W.Cb(1),W.lc("ngIf",t.receta.length>0),W.Cb(1),W.lc("ngIf",t.receta.length>0)}}class Ke{constructor(t,e,a){this.producto=t,this.lblBtnConfirm=e,this.lblBtnDeny=a}}let Je=(()=>{class t{constructor(t,e,a,o,n){this.dialogRef=t,this.data=e,this.articuloSvr=a,this.snackBar=o,this.ls=n,this.esMovil=!1,this.getArticulos=()=>{this.articuloSvr.getArticuloCombo({articulo:this.producto.id}).subscribe(t=>{this.combo=t;for(let e=0;e<this.combo.receta.length;e++){const t=this.combo.receta[e];if(this.combo.receta[e].seleccionado=!1,1==+t.multiple){const t=[];for(let a=0;a<+this.combo.receta[e].cantidad_maxima;a++)t.push({id:a,seleccion:{}});this.combo.receta[e].input=t}else this.seleccion.receta.push(this.combo.receta[e])}})},this.setCantidad=()=>{for(let t=0;t<this.combo.receta.length;t++)if(1==+this.combo.receta[t].multiple){const e=[];for(let a=0;a<+this.combo.receta[t].cantidad_maxima*this.seleccion.cantidad;a++)e.push({id:a,seleccion:{}});this.combo.receta[t].input=e}},this.todosSeleccionados=t=>{let e=!0;t:for(const a of t)for(const t of a.input)if(void 0===t.seleccion.articulo){e=!1;break t}return e},this.datos={respuesta:!1,seleccion:[]},this.lblBtnConfirm=e.lblBtnConfirm,this.lblBtnDeny=e.lblBtnDeny,this.producto=e.producto,this.seleccion={cantidad:1,articulo:this.producto.id,descripcion:this.producto.nombre,receta:[]}}ngOnInit(){this.esMovil=this.ls.get(X.b.usrTokenVar).enmovil||!1,this.keyboardLayout=X.b.IDIOMA_TECLADO,this.combo=[],this.getArticulos()}onConfirm(){const t=this.combo.receta.filter(t=>1==+t.multiple);if(this.todosSeleccionados(t)){for(const e of t){this.seleccion.receta.push({articulo:e.articulo,descripcion:e.descripcion,receta:[]});const t=this.seleccion.receta.findIndex(t=>+t.articulo==+e.articulo);for(const a of e.input)this.seleccion.receta[t].receta.push(a.seleccion)}this.datos.respuesta=!0,this.datos.seleccion=this.seleccion,this.dialogRef.close(this.datos)}else this.snackBar.open("Por favor seleccione todas las opciones para completar.","Combos",{duration:7e3})}onDismiss(){this.datos.respuesta=!1,this.dialogRef.close(this.datos)}}return t.\u0275fac=function(e){return new(e||t)(W.Nb(D.f),W.Nb(D.a),W.Nb(He.a),W.Nb(M.b),W.Nb(ot.a))},t.\u0275cmp=W.Hb({type:t,selectors:[["app-dialog-combo"]],decls:16,vars:4,consts:[[1,"row"],[1,"col","m12","s12"],[1,"fullWidth"],["type","number","matInput","","placeholder","Cantidad","min","1","step","1",3,"ngModel","ngModelOptions","change","ngModelChange"],[1,"col-sm-12"],[4,"ngFor","ngForOf"],["align","right",1,"row","text-right"],["mat-raised-button","","color","accent",1,"btnAccion",3,"click"],[4,"ngIf"],["class","row",4,"ngIf"],[3,"ngModel","ngModelOptions","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(t,e){1&t&&(W.Tb(0,"mat-dialog-content"),W.Tb(1,"div",0),W.Tb(2,"div",1),W.Tb(3,"h5"),W.Fc(4,"Cantidad"),W.Sb(),W.Tb(5,"mat-form-field",2),W.Tb(6,"input",3),W.bc("change",function(){return e.setCantidad()})("ngModelChange",function(t){return e.seleccion.cantidad=t}),W.Sb(),W.Sb(),W.Sb(),W.Sb(),W.Tb(7,"div",0),W.Tb(8,"div",4),W.Dc(9,Ve,3,2,"div",5),W.Sb(),W.Sb(),W.Tb(10,"div",6),W.Tb(11,"div",1),W.Tb(12,"button",7),W.bc("click",function(){return e.onDismiss()}),W.Fc(13," Cancelar "),W.Sb(),W.Tb(14,"button",7),W.bc("click",function(){return e.onConfirm()}),W.Fc(15," Aceptar "),W.Sb(),W.Sb(),W.Sb(),W.Sb()),2&t&&(W.Cb(6),W.lc("ngModel",e.seleccion.cantidad)("ngModelOptions",W.nc(3,ze)),W.Cb(3),W.lc("ngForOf",e.combo.receta))},directives:[D.d,m.b,i.o,h.b,i.c,i.k,i.n,o.l,v.a,o.m,C.a,f.a,_.m],styles:[""]}),t})();function Qe(t,e){if(1&t){const t=W.Ub();W.Tb(0,"textarea",9),W.bc("ngModelChange",function(e){return W.xc(t),W.fc().data.notasGenerales=e}),W.Sb()}if(2&t){const t=W.fc();W.lc("matKeyboard",t.keyboardLayout)("ngModel",t.data.notasGenerales)}}function Xe(t,e){if(1&t){const t=W.Ub();W.Tb(0,"textarea",10),W.bc("ngModelChange",function(e){return W.xc(t),W.fc().data.notasGenerales=e}),W.Sb()}if(2&t){const t=W.fc();W.lc("ngModel",t.data.notasGenerales)}}let Ye=(()=>{class t{constructor(t,e,a){this.dialogRef=t,this.data=e,this.ls=a,this.keyboardLayout=X.b.IDIOMA_TECLADO,this.esMovil=!1,this.terminar=(t=null)=>this.dialogRef.close(t)}ngOnInit(){this.esMovil=this.ls.get(X.b.usrTokenVar).enmovil||!1}}return t.\u0275fac=function(e){return new(e||t)(W.Nb(D.f),W.Nb(D.a),W.Nb(ot.a))},t.\u0275cmp=W.Hb({type:t,selectors:[["app-notas-generales-comanda"]],decls:13,vars:2,consts:[["mat-dialog-title",""],["novalidate",""],["frmNotasGenCom","ngForm"],[1,"fullWidth"],["matInput","","placeholder","Notas generales","name","notasGenerales","maxlength","1000",3,"matKeyboard","ngModel","ngModelChange",4,"ngIf"],["matInput","","placeholder","Notas generales","name","notasGenerales","maxlength","1000",3,"ngModel","ngModelChange",4,"ngIf"],["align","end"],["mat-raised-button","","color","secondary",1,"btnAccion",3,"click"],["mat-raised-button","","color","accent",3,"click"],["matInput","","placeholder","Notas generales","name","notasGenerales","maxlength","1000",3,"matKeyboard","ngModel","ngModelChange"],["matInput","","placeholder","Notas generales","name","notasGenerales","maxlength","1000",3,"ngModel","ngModelChange"]],template:function(t,e){1&t&&(W.Tb(0,"h1",0),W.Fc(1,"Notas generales de comanda"),W.Sb(),W.Tb(2,"mat-dialog-content"),W.Tb(3,"form",1,2),W.Tb(5,"mat-form-field",3),W.Dc(6,Qe,1,2,"textarea",4),W.Dc(7,Xe,1,1,"textarea",5),W.Sb(),W.Sb(),W.Sb(),W.Tb(8,"mat-dialog-actions",6),W.Tb(9,"button",7),W.bc("click",function(){return e.terminar()}),W.Fc(10," Cancelar "),W.Sb(),W.Tb(11,"button",8),W.bc("click",function(){return e.terminar(e.data.notasGenerales)}),W.Fc(12," Guardar "),W.Sb(),W.Sb()),2&t&&(W.Cb(6),W.lc("ngIf",!e.esMovil),W.Cb(1),W.lc("ngIf",e.esMovil))},directives:[D.g,D.d,i.r,i.l,i.m,m.b,o.m,D.c,v.a,h.b,N.a,i.c,i.f,i.k,i.n],styles:[""]}),t})(),Ze=(()=>{class t{constructor(t,e,a,o){this.dialogRef=t,this.snackBar=e,this.comandaSrvc=a,this.data=o,this.cancelar=()=>this.dialogRef.close(!1),this.guardar=()=>{this.nuevaCuenta.nombre&&(this.comanda.cuentas.findIndex(t=>t.nombre.toUpperCase().trim()===this.nuevaCuenta.nombre.toUpperCase().trim())<0?(this.comanda.cuentas.push(this.nuevaCuenta),this.comandaSrvc.save(this.comanda).subscribe(t=>{t.exito?(this.snackBar.open("Cuenta agregada con \xe9xito","Cuentas",{duration:3e3}),this.dialogRef.close(!0)):this.snackBar.open(`ERROR: ${t.mensaje}`,"Cuentas",{duration:7e3})})):this.snackBar.open("Ya existe una cuenta con ese nombre. Por favor ingrese otro nombre.","Cuentas",{duration:7e3}))}}ngOnInit(){if(+this.data.mesaEnUso.comanda>0){const t=this.data.mesaEnUso;this.comanda={area:+t.mesa.area.area,mesa:+t.mesa.mesa,mesero:+t.mesero.usuario,comensales:t.cuentas.length+1,dividirCuentasPorSillas:1,comanda:+t.comanda,cuentas:t.cuentas,replaceUnica:!1},this.nuevaCuenta={cuenta:0,numero:this.comanda.cuentas.length+1,nombre:void 0,productos:[]}}}}return t.\u0275fac=function(e){return new(e||t)(W.Nb(D.f),W.Nb(M.b),W.Nb(te),W.Nb(D.a))},t.\u0275cmp=W.Hb({type:t,selectors:[["app-nueva-cuenta"]],decls:12,vars:3,consts:[["mat-dialog-title",""],["mat-dialog-content",""],["novalidate",""],["frmNuevaCuenta","ngForm"],[1,"fullWidth"],["type","text","matInput","","placeholder","Nombre","name","nombre","required","",3,"ngModel","ngModelChange"],["mat-dialog-actions","","align","end"],["mat-raised-button","","color","warn",3,"click"],["mat-raised-button","","type","button","color","accent",3,"disabled","click"]],template:function(t,e){if(1&t&&(W.Tb(0,"h1",0),W.Fc(1),W.Sb(),W.Tb(2,"div",1),W.Tb(3,"form",2,3),W.Tb(5,"mat-form-field",4),W.Tb(6,"input",5),W.bc("ngModelChange",function(t){return e.nuevaCuenta.nombre=t}),W.Sb(),W.Sb(),W.Sb(),W.Sb(),W.Tb(7,"div",6),W.Tb(8,"button",7),W.bc("click",function(){return e.cancelar()}),W.Fc(9," Cancelar "),W.Sb(),W.Tb(10,"button",8),W.bc("click",function(){return e.guardar()}),W.Fc(11," Guardar "),W.Sb(),W.Sb()),2&t){const t=W.tc(4);W.Cb(1),W.Hc("Nueva cuenta - Comanda #",e.data.mesaEnUso.comanda,""),W.Cb(5),W.lc("ngModel",e.nuevaCuenta.nombre),W.Cb(4),W.lc("disabled",!t.form.valid)}},directives:[D.g,D.d,i.r,i.l,i.m,m.b,h.b,i.c,i.p,i.k,i.n,D.c,v.a],styles:[""]}),t})();function ta(t,e){if(1&t&&(W.Tb(0,"mat-option",12),W.Fc(1),W.Sb()),2&t){const t=e.$implicit,a=W.fc().$implicit;W.lc("value",+t.cuenta)("disabled",1==+t.cerrada||+a.idcuenta==+t.cuenta),W.Cb(1),W.Hc(" ",t.nombre," ")}}function ea(t,e){if(1&t&&(W.Tb(0,"tr"),W.Tb(1,"td"),W.Fc(2),W.Sb(),W.Tb(3,"td",7),W.Tb(4,"mat-form-field",8),W.Tb(5,"input",9),W.bc("ngModelChange",function(t){return e.$implicit.cantidad=t}),W.Sb(),W.Sb(),W.Sb(),W.Tb(6,"td"),W.Tb(7,"mat-select",10),W.bc("ngModelChange",function(t){return e.$implicit.idcuenta=t}),W.Dc(8,ta,2,3,"mat-option",11),W.Sb(),W.Sb(),W.Sb()),2&t){const t=e.$implicit,a=e.index,o=W.fc();W.Cb(2),W.Gc(t.nombre),W.Cb(3),W.lc("max",o.cantidadProducto[a])("ngModel",t.cantidad)("disabled",1==+t.combo),W.Cb(2),W.lc("ngModel",t.idcuenta),W.Cb(1),W.lc("ngForOf",o.comanda.cuentas)}}let aa=(()=>{class t{constructor(t,e,a,o){this.dialogRef=t,this.snackBar=e,this.comandaSrvc=a,this.data=o,this.cantidadProducto=[],this.cpLstProductos=[],this.compLstProductos=[],this.cancelar=()=>this.dialogRef.close(!1),this.guardar=()=>{const t=[];let e=0;for(const a of this.cpLstProductos)+a.idcuenta!=+this.compLstProductos[e].idcuenta&&t.push({detalle_comanda:+a.detalle_comanda,cuenta:+a.idcuenta,cantidad:+a.cantidad}),e++;t.length>0?this.comandaSrvc.distribuirCuentas(t).subscribe(t=>{t.exito?(this.snackBar.open("Productos redistribuidos","Cuentas",{duration:3e3}),this.dialogRef.close(!0)):(this.snackBar.open(`ERROR: ${t.mensaje}`,"Cuentas",{duration:7e3}),this.cancelar())}):(this.snackBar.open("Sin cambios en las cuentas.","Cuentas",{duration:7e3}),this.dialogRef.close(!0))}}ngOnInit(){if(+this.data.mesaEnUso.comanda>0){const t=this.data.mesaEnUso;this.comanda={area:+t.mesa.area.area,mesa:+t.mesa.mesa,mesero:+t.mesero.usuario,comensales:t.cuentas.length+1,dividirCuentasPorSillas:1,comanda:+t.comanda,cuentas:t.cuentas,replaceUnica:!1}}this.cpLstProductos=[],this.data.lstProductos.length>0&&(this.data.lstProductos.forEach(t=>{0==+this.data.mesaEnUso.cuentas.find(e=>+e.cuenta==+t.idcuenta).cerrada&&(this.cpLstProductos.push(t),this.cantidadProducto.push(+t.cantidad))}),this.cpLstProductos=JSON.parse(JSON.stringify(this.cpLstProductos)),this.compLstProductos=JSON.parse(JSON.stringify(this.cpLstProductos)))}}return t.\u0275fac=function(e){return new(e||t)(W.Nb(D.f),W.Nb(M.b),W.Nb(te),W.Nb(D.a))},t.\u0275cmp=W.Hb({type:t,selectors:[["app-distribuir-productos-cuentas"]],decls:17,vars:2,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[1,"rtxt","size-cantidad"],[4,"ngFor","ngForOf"],["mat-dialog-actions","","align","end"],["mat-raised-button","","color","warn",3,"click"],["mat-raised-button","","type","button","color","accent",3,"click"],[1,"rtxt"],[1,"size-cantidad"],["type","number","matInput","","name","cantidad","min","1","required","",3,"max","ngModel","disabled","ngModelChange"],["name","cuenta","required","",3,"ngModel","ngModelChange"],[3,"value","disabled",4,"ngFor","ngForOf"],[3,"value","disabled"]],template:function(t,e){1&t&&(W.Tb(0,"h1",0),W.Fc(1),W.Sb(),W.Tb(2,"div",1),W.Tb(3,"table"),W.Tb(4,"tr"),W.Tb(5,"th"),W.Fc(6,"Art\xedculo"),W.Sb(),W.Tb(7,"th",2),W.Fc(8,"Cantidad"),W.Sb(),W.Tb(9,"th"),W.Fc(10,"Cuenta"),W.Sb(),W.Sb(),W.Dc(11,ea,9,6,"tr",3),W.Sb(),W.Sb(),W.Tb(12,"div",4),W.Tb(13,"button",5),W.bc("click",function(){return e.cancelar()}),W.Fc(14," Cancelar "),W.Sb(),W.Tb(15,"button",6),W.bc("click",function(){return e.guardar()}),W.Fc(16," Guardar "),W.Sb(),W.Sb()),2&t&&(W.Cb(1),W.Hc("Distribuci\xf3n de productos - Comanda #",e.data.mesaEnUso.comanda,""),W.Cb(10),W.lc("ngForOf",e.cpLstProductos))},directives:[D.g,D.d,o.l,D.c,v.a,m.b,i.o,h.b,i.c,i.p,i.k,i.n,C.a,_.m],styles:[".size-cantidad[_ngcontent-%COMP%]{width:25%}"]}),t})();function oa(t,e){if(1&t){const t=W.Ub();W.Tb(0,"button",0),W.bc("click",function(){return W.xc(t),W.fc().comandar()}),W.Fc(1,"Comanda"),W.Sb()}if(2&t){const t=W.fc();W.lc("disabled",!t.data.tranComanda.cuentaActiva.nombre||t.data.tranComanda.bloqueoBotones)}}function na(t,e){if(1&t){const t=W.Ub();W.Tb(0,"button",0),W.bc("click",function(){return W.xc(t),W.fc().imprimirCuenta()}),W.Fc(1,"Cuenta"),W.Sb()}if(2&t){const t=W.fc();W.lc("disabled",!t.data.tranComanda.cuentaActiva.nombre||t.data.tranComanda.bloqueoBotones)}}function ia(t,e){if(1&t){const t=W.Ub();W.Tb(0,"button",0),W.bc("click",function(){return W.xc(t),W.fc().distribuirProductos()}),W.Fc(1,"Distribuir"),W.Sb()}if(2&t){const t=W.fc();W.lc("disabled",t.data.tranComanda.mesaEnUso.cuentas.length<2||t.data.tranComanda.bloqueoBotones)}}function sa(t,e){if(1&t){const t=W.Ub();W.Tb(0,"button",0),W.bc("click",function(){return W.xc(t),W.fc().unirCuentas()}),W.Fc(1,"Unir cuentas"),W.Sb()}if(2&t){const t=W.fc();W.lc("disabled",t.data.tranComanda.mesaEnUso.cuentas.length<2||t.data.tranComanda.bloqueoBotones)}}function ca(t,e){if(1&t){const t=W.Ub();W.Tb(0,"button",0),W.bc("click",function(){return W.xc(t),W.fc().cobrarCuenta()}),W.Fc(1,"Cobrar cuenta"),W.Sb()}if(2&t){const t=W.fc();W.lc("disabled",!t.data.tranComanda.cuentaActiva.nombre||t.data.tranComanda.esCajero()||t.data.tranComanda.bloqueoBotones)}}function ra(t,e){if(1&t){const t=W.Ub();W.Tb(0,"button",0),W.bc("click",function(){return W.xc(t),W.fc().enviarPedido()}),W.Fc(1,"Enviar pedido"),W.Sb()}if(2&t){const t=W.fc();W.lc("disabled",!t.data.tranComanda.cuentaActiva.nombre||t.data.tranComanda.esCajero()||t.data.tranComanda.bloqueoBotones)}}function la(t,e){if(1&t){const t=W.Ub();W.Tb(0,"button",0),W.bc("click",function(){return W.xc(t),W.fc().trasladarMesa()}),W.Fc(1,"Trasladar"),W.Sb()}if(2&t){const t=W.fc();W.lc("disabled",t.data.tranComanda.bloqueoBotones)}}function da(t,e){if(1&t){const t=W.Ub();W.Tb(0,"button",3),W.bc("click",function(){return W.xc(t),W.fc().cerrarMesa()}),W.Fc(1),W.Sb()}if(2&t){const t=W.fc();W.Cb(1),W.Hc("Cerrar ",0==+t.data.tranComanda.mesaEnUso.mesa.esmostrador?"Mesa":0==+t.data.tranComanda.mesaEnUso.mesa.escallcenter?"Mostrador":"Pedido","")}}let ua=(()=>{class t{constructor(t,e){this.bsAccionesComanda=t,this.data=e,this.cerrar=(t={cerrar:!1})=>this.bsAccionesComanda.dismiss(t),this.notasGenerales=()=>{this.data.tranComanda.getNotasGenerales(),this.cerrar()},this.comandar=()=>{this.data.tranComanda.validarImpresion(!1,this.data.dialogRef),this.cerrar()},this.imprimirCuenta=()=>{this.data.tranComanda.printCuenta(this.data.dialogRef),this.cerrar()},this.distribuirProductos=()=>{this.data.tranComanda.distribuirProductos(this.data.dialogRef),this.cerrar()},this.unirCuentas=()=>{this.data.tranComanda.unirCuentas(this.data.dialogRef),this.cerrar()},this.cobrarCuenta=()=>{this.data.tranComanda.cobrarCuenta(this.data.dialogRef),this.cerrar()},this.enviarPedido=()=>{this.data.tranComanda.enviarPedido(this.data.dialogRef),this.cerrar()},this.trasladarMesa=()=>{this.data.tranComanda.trasladoMesa(this.data.dialogRef),this.cerrar()},this.cerrarMesa=()=>{this.data.tranComanda.cerrarMesa(),this.cerrar({cerrar:!0,mesaEnUso:this.data.tranComanda.mesaEnUso})}}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)(W.Nb(A.d),W.Nb(A.a))},t.\u0275cmp=W.Hb({type:t,selectors:[["app-acciones-comanda"]],decls:11,vars:9,consts:[["mat-list-item","",1,"accion-comanda","mat-elevation-z4",3,"disabled","click"],["class","accion-comanda mat-elevation-z4","mat-list-item","",3,"disabled","click",4,"ngIf"],["class","accion-comanda mat-elevation-z4","mat-list-item","",3,"click",4,"ngIf"],["mat-list-item","",1,"accion-comanda","mat-elevation-z4",3,"click"]],template:function(t,e){1&t&&(W.Tb(0,"mat-action-list"),W.Tb(1,"button",0),W.bc("click",function(){return e.notasGenerales()}),W.Fc(2,"Notas"),W.Sb(),W.Dc(3,oa,2,1,"button",1),W.Dc(4,na,2,1,"button",1),W.Dc(5,ia,2,1,"button",1),W.Dc(6,sa,2,1,"button",1),W.Dc(7,ca,2,1,"button",1),W.Dc(8,ra,2,1,"button",1),W.Dc(9,la,2,1,"button",1),W.Dc(10,da,2,1,"button",2),W.Sb()),2&t&&(W.Cb(1),W.lc("disabled",e.data.tranComanda.bloqueoBotones),W.Cb(2),W.lc("ngIf",0==+e.data.tranComanda.mesaEnUso.mesa.escallcenter),W.Cb(1),W.lc("ngIf",0==+e.data.tranComanda.mesaEnUso.mesa.esmostrador),W.Cb(1),W.lc("ngIf",0==+e.data.tranComanda.mesaEnUso.mesa.esmostrador),W.Cb(1),W.lc("ngIf",0==+e.data.tranComanda.mesaEnUso.mesa.esmostrador),W.Cb(1),W.lc("ngIf",0==+e.data.tranComanda.mesaEnUso.mesa.escallcenter),W.Cb(1),W.lc("ngIf",1==+e.data.tranComanda.mesaEnUso.mesa.escallcenter),W.Cb(1),W.lc("ngIf",0==+e.data.tranComanda.mesaEnUso.mesa.esmostrador),W.Cb(1),W.lc("ngIf",e.data.tranComanda.lstProductosSeleccionados.length<=0))},directives:[u.a,u.c,o.m],styles:[".accion-comanda[_ngcontent-%COMP%]{background-color:#f3d852;font-weight:700;text-align:center;margin:10px 0}"]}),t})();var ba=a("FHMA");function ma(t,e){if(1&t){const t=W.Ub();W.Tb(0,"input",9),W.bc("ngModelChange",function(e){return W.xc(t),W.fc().data.pwd=e}),W.Sb()}if(2&t){const t=W.fc();W.lc("matKeyboard",t.keyboardLayout)("ngModel",t.data.pwd)}}function ha(t,e){if(1&t){const t=W.Ub();W.Tb(0,"input",10),W.bc("ngModelChange",function(e){return W.xc(t),W.fc().data.pwd=e}),W.Sb()}if(2&t){const t=W.fc();W.lc("ngModel",t.data.pwd)}}let pa=(()=>{class t{constructor(t,e,a){this.dialogRef=t,this.comandaSrvc=e,this.ls=a,this.data={pwd:void 0},this.keyboardLayout=X.b.IDIOMA_TECLADO,this.esMovil=!1,this.cancelar=()=>this.dialogRef.close(),this.terminar=()=>{this.comandaSrvc.validaPwdGerenteTurno(this.data.pwd).subscribe(t=>{this.dialogRef.close(!!t.exito&&t.esgerente)})}}ngOnInit(){this.esMovil=this.ls.get(X.b.usrTokenVar).enmovil||!1}}return t.\u0275fac=function(e){return new(e||t)(W.Nb(D.f),W.Nb(te),W.Nb(ot.a))},t.\u0275cmp=W.Hb({type:t,selectors:[["app-valida-pwd-gerente-turno"]],decls:13,vars:3,consts:[["mat-dialog-title",""],["novalidate","",3,"ngSubmit"],["frmValidarPwdGerenteTurno","ngForm"],[1,"fullWidth"],["type","password","matInput","","placeholder","Contrase\xf1a del gerente de turno","name","pwd","required","",3,"matKeyboard","ngModel","ngModelChange",4,"ngIf"],["type","password","matInput","","placeholder","Contrase\xf1a del gerente de turno","name","pwd","required","",3,"ngModel","ngModelChange",4,"ngIf"],["align","end"],["mat-raised-button","","color","secondary",1,"btnAccion",3,"click"],["mat-raised-button","","color","accent",3,"disabled","click"],["type","password","matInput","","placeholder","Contrase\xf1a del gerente de turno","name","pwd","required","",3,"matKeyboard","ngModel","ngModelChange"],["type","password","matInput","","placeholder","Contrase\xf1a del gerente de turno","name","pwd","required","",3,"ngModel","ngModelChange"]],template:function(t,e){if(1&t){const t=W.Ub();W.Tb(0,"h1",0),W.Fc(1,"Contrase\xf1a del gerente de turno"),W.Sb(),W.Tb(2,"mat-dialog-content"),W.Tb(3,"form",1,2),W.bc("ngSubmit",function(){return W.xc(t),W.tc(4).form.valid}),W.Tb(5,"mat-form-field",3),W.Dc(6,ma,1,2,"input",4),W.Dc(7,ha,1,1,"input",5),W.Sb(),W.Sb(),W.Sb(),W.Tb(8,"mat-dialog-actions",6),W.Tb(9,"button",7),W.bc("click",function(){return e.cancelar()}),W.Fc(10," Cancelar "),W.Sb(),W.Tb(11,"button",8),W.bc("click",function(){return e.terminar()}),W.Fc(12," Eliminar producto "),W.Sb(),W.Sb()}if(2&t){const t=W.tc(4);W.Cb(6),W.lc("ngIf",!e.esMovil),W.Cb(1),W.lc("ngIf",e.esMovil),W.Cb(4),W.lc("disabled",!t.form.valid)}},directives:[D.g,D.d,i.r,i.l,i.m,m.b,o.m,D.c,v.a,h.b,N.a,i.c,i.p,i.k,i.n],styles:[""]}),t})();const fa=function(){return{standalone:!0}};class ga{constructor(t){this.producto=t}}let Sa=(()=>{class t{constructor(t,e,a){this.dialogRef=t,this.data=e,this.snackBar=a,this.datos={},this.prod=e.producto,this.cantidad=this.prod.cantidad,this.datos={respuesta:!1,producto:null}}ngOnInit(){}onConfirm(){this.cantidad<1||this.cantidad>this.prod.cantidad?this.snackBar.open("La cantidad debe estar entre 1 y "+this.prod.cantidad,"Error",{duration:5e3}):(this.datos.respuesta=!0,this.prod.cantidad-=this.cantidad,this.datos.producto=this.prod,this.dialogRef.close(this.datos))}onDismiss(){this.datos.respuesta=!1,this.dialogRef.close(this.datos)}}return t.\u0275fac=function(e){return new(e||t)(W.Nb(D.f),W.Nb(D.a),W.Nb(M.b))},t.\u0275cmp=W.Hb({type:t,selectors:[["app-dialog-elminar-producto"]],decls:13,vars:4,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[1,"fullWidth"],["type","number","matInput","","placeholder","Cantidad","min","1","step","1",3,"max","ngModel","ngModelOptions","ngModelChange"],["mat-dialog-actions","","align","center"],["mat-raised-button","",1,"btnConfig",3,"click"],["mat-raised-button","","color","accent",1,"btnConfig",3,"click"]],template:function(t,e){1&t&&(W.Tb(0,"h1",0),W.Fc(1," Eliminar Articulos "),W.Sb(),W.Tb(2,"div",1),W.Tb(3,"p"),W.Fc(4,"Seleccione la cantidad que desea eliminar"),W.Sb(),W.Sb(),W.Tb(5,"form"),W.Tb(6,"mat-form-field",2),W.Tb(7,"input",3),W.bc("ngModelChange",function(t){return e.cantidad=t}),W.Sb(),W.Sb(),W.Sb(),W.Tb(8,"div",4),W.Tb(9,"button",5),W.bc("click",function(){return e.onDismiss()}),W.Fc(10,"Cancelar"),W.Sb(),W.Tb(11,"button",6),W.bc("click",function(){return e.onConfirm()}),W.Fc(12,"Aceptar"),W.Sb(),W.Sb()),2&t&&(W.Cb(7),W.mc("max",e.prod.cantidad),W.lc("ngModel",e.cantidad)("ngModelOptions",W.nc(3,fa)))},directives:[D.g,D.d,i.r,i.l,i.m,m.b,i.o,h.b,i.c,i.k,i.n,D.c,v.a],styles:[""]}),t})();function Ca(t,e){if(1&t&&(W.Tb(0,"mat-list-item"),W.Tb(1,"div",3),W.Tb(2,"span",4),W.Fc(3),W.gc(4,"number"),W.Sb(),W.Sb(),W.Sb()),2&t){const t=W.fc();W.Cb(3),W.Jc(" ",t.cantidadDeProductos," ",t.cantidadDeProductos>1?"art\xedculos":"art\xedculo"," por ",W.ic(4,3,t.totalDeProductos,"1.2-2")," ")}}function Ta(t,e){if(1&t&&(W.Tb(0,"span"),W.Fc(1),W.Sb()),2&t){const t=W.fc(2).$implicit;W.Cb(1),W.Gc(t.cantidad)}}function va(t,e){if(1&t&&(W.Tb(0,"div",3),W.Tb(1,"span",13),W.Fc(2),W.Sb(),W.Sb()),2&t){const t=e.$implicit;W.Cb(2),W.Gc(t)}}function Ma(t,e){if(1&t&&(W.Rb(0),W.Dc(1,va,3,1,"div",12),W.Qb()),2&t){const t=W.fc(2).$implicit;W.Cb(1),W.lc("ngForOf",t.detalle)}}function Fa(t,e){if(1&t){const t=W.Ub();W.Tb(0,"button",17),W.bc("click",function(){W.xc(t);const e=W.fc(3),a=e.$implicit,o=e.index;return W.fc().removeProducto(a,o)}),W.Tb(1,"mat-icon",18),W.Fc(2,"remove_circle"),W.Sb(),W.Sb()}if(2&t){const t=W.fc(4);W.lc("disabled",t.bloqueoBotones)}}function xa(t,e){if(1&t){const t=W.Ub();W.Tb(0,"eco-fab-speed-dial",14),W.Tb(1,"eco-fab-speed-dial-trigger"),W.Tb(2,"button",15),W.Tb(3,"mat-icon",16),W.Fc(4,"keyboard_arrow_left"),W.Sb(),W.Sb(),W.Sb(),W.Tb(5,"eco-fab-speed-dial-actions"),W.Tb(6,"button",17),W.bc("click",function(){W.xc(t);const e=W.fc(2),a=e.$implicit,o=e.index;return W.fc().deleteProductoFromList(a,o)}),W.Tb(7,"mat-icon",18),W.Fc(8,"delete_forever"),W.Sb(),W.Sb(),W.Dc(9,Fa,3,1,"button",19),W.Tb(10,"button",20),W.bc("click",function(){W.xc(t);const e=W.fc(2).$implicit;return W.fc().toggleShowInputNotas(e)}),W.Tb(11,"mat-icon",18),W.Fc(12,"notes"),W.Sb(),W.Sb(),W.Sb(),W.Sb()}if(2&t){const t=W.fc(2).$implicit,e=W.fc();W.Cb(6),W.lc("disabled",e.bloqueoBotones),W.Cb(3),W.lc("ngIf",t.detalle.length<=1),W.Cb(1),W.lc("disabled",e.bloqueoBotones)}}function ka(t,e){if(1&t){const t=W.Ub();W.Tb(0,"eco-fab-speed-dial",14),W.Tb(1,"eco-fab-speed-dial-trigger"),W.Tb(2,"button",15),W.Tb(3,"mat-icon",16),W.Fc(4,"keyboard_arrow_left"),W.Sb(),W.Sb(),W.Sb(),W.Tb(5,"eco-fab-speed-dial-actions"),W.Tb(6,"button",17),W.bc("click",function(){W.xc(t);const e=W.fc(2),a=e.$implicit,o=e.index;return W.fc().deleteProductoFromListAfterPrinted(a,o)}),W.Tb(7,"mat-icon",18),W.Fc(8,"delete_forever"),W.Sb(),W.Sb(),W.Sb(),W.Sb()}if(2&t){const t=W.fc(3);W.Cb(6),W.lc("disabled",t.bloqueoBotones)}}function Oa(t,e){if(1&t&&(W.Tb(0,"div",7),W.Tb(1,"div",8),W.Tb(2,"div",9),W.Tb(3,"span",3),W.Dc(4,Ta,2,1,"span",1),W.Fc(5),W.Sb(),W.Dc(6,Ma,2,1,"ng-container",1),W.Sb(),W.Tb(7,"div",10),W.Tb(8,"span"),W.Fc(9),W.gc(10,"number"),W.Sb(),W.Fc(11,"\xa0 "),W.Dc(12,xa,13,3,"eco-fab-speed-dial",11),W.Dc(13,ka,9,1,"eco-fab-speed-dial",11),W.Sb(),W.Sb(),W.Sb()),2&t){const t=W.fc().$implicit;W.Cb(4),W.lc("ngIf",0==+t.multiple),W.Cb(1),W.Hc("\xa0",t.nombre," "),W.Cb(1),W.lc("ngIf",1==+t.combo),W.Cb(3),W.Gc(W.ic(10,6,t.cantidad*t.precio+t.monto_extra,"1.2-2")),W.Cb(3),W.lc("ngIf",0==+t.impreso),W.Cb(1),W.lc("ngIf",1==+t.impreso)}}function Da(t,e){if(1&t){const t=W.Ub();W.Tb(0,"input",24),W.bc("ngModelChange",function(e){return W.xc(t),W.fc(3).$implicit.notas=e})("keyup.enter",function(){W.xc(t);const e=W.fc(3).$implicit;return W.fc().toggleShowInputNotas(e)})("blur",function(){W.xc(t);const e=W.fc(3).$implicit;return W.fc().saveNotasProducto(e)}),W.Sb()}if(2&t){const t=W.fc(3).$implicit,e=W.fc();W.lc("matKeyboard",e.keyboardLayout)("ngModel",t.notas)}}function Ea(t,e){if(1&t){const t=W.Ub();W.Tb(0,"input",25),W.bc("ngModelChange",function(e){return W.xc(t),W.fc(3).$implicit.notas=e})("keyup.enter",function(){W.xc(t);const e=W.fc(3).$implicit;return W.fc().toggleShowInputNotas(e)})("blur",function(){W.xc(t);const e=W.fc(3).$implicit;return W.fc().saveNotasProducto(e)}),W.Sb()}if(2&t){const t=W.fc(3).$implicit;W.lc("ngModel",t.notas)}}function Pa(t,e){if(1&t&&(W.Tb(0,"mat-form-field",0),W.Dc(1,Da,1,2,"input",22),W.Dc(2,Ea,1,1,"input",23),W.Sb()),2&t){const t=W.fc(3);W.Cb(1),W.lc("ngIf",!t.esMovil),W.Cb(1),W.lc("ngIf",t.esMovil)}}function _a(t,e){if(1&t&&(W.Tb(0,"div",7),W.Dc(1,Pa,3,2,"mat-form-field",21),W.Sb()),2&t){const t=W.fc().$implicit;W.Cb(1),W.lc("ngIf",t.showInputNotas)}}const ya=function(t){return{noImpreso:t}};function Ia(t,e){if(1&t&&(W.Tb(0,"mat-list-item",5),W.Dc(1,Oa,14,9,"div",6),W.Dc(2,_a,2,1,"div",6),W.Sb()),2&t){const t=e.$implicit;W.lc("ngClass",W.oc(3,ya,0==+t.impreso)),W.Cb(1),W.lc("ngIf",+t.cantidad>0),W.Cb(1),W.lc("ngIf",+t.cantidad>0)}}let wa=(()=>{class t{constructor(t,e,a,o,n){this.snackBar=t,this.ls=e,this.comandaSrvc=a,this.socket=o,this.dialog=n,this.listaProductos=[],this.noCuenta=null,this.listHeight="450px",this.IdComanda=0,this.IdCuenta=0,this.bloqueoBotones=!1,this.mesaEnUso={},this.productoRemovedEv=new W.o,this.esMovil=!1,this.keyboardLayout=X.b.IDIOMA_TECLADO,this.totalDeProductos=0,this.cantidadDeProductos=0,this.removeProducto=(t,e,a=!1,o)=>{this.bloqueoBotones=!0,this.detalleComanda={detalle_cuenta:t.detalle_cuenta,detalle_comanda:t.detalle_comanda,articulo:t.id,cantidad:+t.cantidad>1?+t.cantidad-1:0,precio:+t.precio,total:+t.cantidad>1?(+t.cantidad-1)*+t.precio:0,notas:t.notas,autorizado:a},o&&(this.detalleComanda.cantidad=o,this.detalleComanda.total=o*this.detalleComanda.precio),this.comandaSrvc.saveDetalle(this.IdComanda,this.IdCuenta,this.detalleComanda).subscribe(e=>{e.exito?(t.cantidad=this.detalleComanda.cantidad,this.productoRemovedEv.emit({listaProductos:this.listaProductos,comanda:e.comanda}),0==+t.cantidad&&(this.socket.emit("refrescar:mesa",{mesaenuso:this.mesaEnUso}),this.socket.emit("refrescar:listaCocina",{mesaenuso:this.mesaEnUso}))):this.snackBar.open(`ERROR: ${e.mensaje}`,"Comanda",{duration:3e3}),this.bloqueoBotones=!1})},this.deleteProductoFromList=(t,e,a=!1)=>{t.cantidad=0,t.notas="",this.removeProducto(t,e,a)},this.deleteProductoFromListAfterPrinted=(t,e)=>{this.bloqueoBotones=!0,this.dialog.open(pa,{width:"40%",disableClose:!0}).afterClosed().subscribe(a=>{a?this.dialog.open(Sa,{width:"40%",disableClose:!0,data:new ga(t)}).afterClosed().subscribe(t=>{t&&t.respuesta&&(this.removeProducto(t.producto,e,!0,t.producto.cantidad),this.snackBar.open("Se eliminar\xe1 el producto seleccionado.","Comanda",{duration:5e3}))}):this.snackBar.open("La contrase\xf1a no es correcta","Comanda",{duration:5e3}),this.bloqueoBotones=!1})},this.saveNotasProducto=t=>{this.comandaSrvc.saveNotasProducto({detalle_comanda:t.detalle_comanda,notas:t.notas}).subscribe(t=>{t.exito&&this.snackBar.open("Notas de producto guardadas con \xe9xito...","Producto",{duration:3e3})})},this.getTotalProductos=()=>{this.totalDeProductos=0,this.cantidadDeProductos=0;for(const t of this.listaProductos)this.totalDeProductos+=t.cantidad*t.precio+t.monto_extra,this.cantidadDeProductos+=t.cantidad}}ngOnInit(){this.esMovil=this.ls.get(X.b.usrTokenVar).enmovil||!1}ngOnChanges(t){this.listaProductos&&this.listaProductos.length>0&&this.getTotalProductos()}toggleShowInputNotas(t){console.log("ARTICULO = ",t),t.showInputNotas=!t.showInputNotas,t.showInputNotas?t.itemListHeight="140px":(t.itemListHeight="70px",this.saveNotasProducto(t))}doAction(t){console.log(t)}}return t.\u0275fac=function(e){return new(e||t)(W.Nb(M.b),W.Nb(ot.a),W.Nb(te),W.Nb(he.a),W.Nb(D.b))},t.\u0275cmp=W.Hb({type:t,selectors:[["app-lista-productos-comanda"]],inputs:{listaProductos:"listaProductos",noCuenta:"noCuenta",listHeight:"listHeight",IdComanda:"IdComanda",IdCuenta:"IdCuenta",bloqueoBotones:"bloqueoBotones",mesaEnUso:"mesaEnUso"},outputs:{productoRemovedEv:"productoRemovedEv"},features:[W.Ab],decls:3,vars:4,consts:[[1,"fullWidth"],[4,"ngIf"],[3,"ngClass",4,"ngFor","ngForOf"],["matLine",""],[1,"lineaDeTotal"],[3,"ngClass"],["matLine","","class","fullWidth",4,"ngIf"],["matLine","",1,"fullWidth"],[1,"row"],[1,"col","m6","s12"],["align","end",1,"col","m6","s12"],["direction","left",4,"ngIf"],["matLine","",4,"ngFor","ngForOf"],[1,"tabulador"],["direction","left"],["mat-fab",""],[2,"font-size","18pt !important"],["mat-mini-fab","","color","warn",3,"disabled","click"],[2,"font-size","16pt !important"],["mat-mini-fab","","color","warn",3,"disabled","click",4,"ngIf"],["mat-mini-fab","","color","accent",3,"disabled","click"],["class","fullWidth",4,"ngIf"],["matInput","","placeholder","Notas de producto","maxlength","1000",3,"matKeyboard","ngModel","ngModelChange","keyup.enter","blur",4,"ngIf"],["matInput","","placeholder","Notas de producto","maxlength","1000",3,"ngModel","ngModelChange","keyup.enter","blur",4,"ngIf"],["matInput","","placeholder","Notas de producto","maxlength","1000",3,"matKeyboard","ngModel","ngModelChange","keyup.enter","blur"],["matInput","","placeholder","Notas de producto","maxlength","1000",3,"ngModel","ngModelChange","keyup.enter","blur"]],template:function(t,e){1&t&&(W.Tb(0,"mat-list",0),W.Dc(1,Ca,5,6,"mat-list-item",1),W.Dc(2,Ia,3,5,"mat-list-item",2),W.Sb()),2&t&&(W.Ac("height",e.listHeight),W.Cb(1),W.lc("ngIf",e.listaProductos.length>0),W.Cb(1),W.lc("ngForOf",e.listaProductos))},directives:[u.a,o.m,o.l,u.c,_.j,o.k,mt.a,R.b,R.d,v.a,b.a,R.a,m.b,h.b,N.a,i.c,i.f,i.k,i.n],pipes:[o.f],styles:[".fullWidth[_ngcontent-%COMP%]{width:100%!important}.spacer[_ngcontent-%COMP%]{flex:1 1 auto!important}.noImpreso[_ngcontent-%COMP%]{background-color:#c7c7c7}.text-pre-wrap[_ngcontent-%COMP%]{white-space:pre-wrap!important}.lineaDeTotal[_ngcontent-%COMP%]{font-weight:700!important;font-size:11pt!important}"]}),t})();const Aa=["txtCodigoBarras"];function Na(t,e){if(1&t){const t=W.Ub();W.Tb(0,"mat-chip",20),W.bc("click",function(){W.xc(t);const a=e.$implicit,o=W.fc();return 0==+a.cerrada&&o.setSelectedCuenta(a.numero)}),W.Fc(1),W.Sb()}if(2&t){const t=e.$implicit,a=W.fc();W.lc("disabled",1==+t.cerrada||a.bloqueoBotones)("selected",0==+t.cerrada),W.Cb(1),W.Hc(" ",t.nombre," ")}}function Ra(t,e){if(1&t){const t=W.Ub();W.Tb(0,"mat-chip",21),W.bc("click",function(){W.xc(t);const e=W.fc();return e.nuevaCuenta(e.dialogRef)}),W.Fc(1," Nueva "),W.Sb()}}const Ua=function(){return{standalone:!0}};function $a(t,e){if(1&t){const t=W.Ub();W.Tb(0,"mat-form-field",22),W.Tb(1,"input",23,24),W.bc("ngModelChange",function(e){return W.xc(t),W.fc().codigoBarras=e})("onDetected",function(){return W.xc(t),W.fc().buscarArticulo()}),W.Sb(),W.Sb()}if(2&t){const t=W.fc();W.Cb(1),W.lc("ngModel",t.codigoBarras)("ngModelOptions",W.nc(2,Ua))}}function Ba(t,e){1&t&&W.Ob(0,"br")}function ja(t,e){if(1&t){const t=W.Ub();W.Tb(0,"mat-chip",25),W.bc("click",function(){W.xc(t);const a=e.$implicit;return W.fc().loadSubcategorias(a)}),W.Fc(1),W.Sb()}if(2&t){const t=e.$implicit,a=W.fc();W.lc("disabled",a.bloqueoBotones),W.Cb(1),W.Hc(" ",t.descripcion," ")}}function Ha(t,e){if(1&t){const t=W.Ub();W.Tb(0,"mat-chip",28),W.bc("click",function(){W.xc(t);const a=e.$implicit,o=W.fc().index;return W.fc().loadSubcategorias({categoria:a.categoria},a,o)}),W.Fc(1),W.Sb()}if(2&t){const t=e.$implicit,a=W.fc(2);W.lc("disabled",a.bloqueoBotones),W.Cb(1),W.Hc(" ",t.descripcion," ")}}function La(t,e){if(1&t&&(W.Tb(0,"div",26),W.Tb(1,"mat-chip-list"),W.Dc(2,Ha,2,2,"mat-chip",27),W.Sb(),W.Sb()),2&t){const t=e.$implicit;W.Cb(2),W.lc("ngForOf",t)}}function qa(t,e){if(1&t){const t=W.Ub();W.Tb(0,"div",29),W.Tb(1,"mat-card",30),W.bc("click",function(){W.xc(t);const a=e.$implicit,o=W.fc();return!o.bloqueoBotones&&o.addArticulo(a)}),W.Tb(2,"mat-card-content"),W.Tb(3,"p"),W.Fc(4),W.Sb(),W.Sb(),W.Sb(),W.Sb()}if(2&t){const t=e.$implicit;W.Cb(4),W.Gc(t.descripcion)}}let za=(()=>{class t extends class{constructor(t,e,a,o,n,i,s,c,r){this.dialog=t,this.snackBar=e,this.comandaSrvc=a,this.socket=o,this.ls=n,this.pdfServicio=i,this.configSrvc=s,this.articuloSrvc=c,this.bsAccionesCmd=r,this.clientePedido=null,this.closeSideNavEv=new W.o,this.mesaSavedEv=new W.o,this.showPortalComanda=!1,this.showPortalCuenta=!1,this.noComanda=0,this.sumCuenta=0,this.categorias=[],this.bloqueoBotones=!1,this.rolesUsuario=[],this.impreso=0,this.usaCodigoBarras=!1,this.codigoBarras=null,this.imprimeRecetaEnComanda=!0,this.endSubs=new de.a,this.alIniciar=()=>{this.resetLstProductosSeleccionados(),this.resetLstProductosDeCuenta(),this.resetCuentaActiva(),this.impreso=0,this.noComanda=this.mesaEnUso.comanda||0,this.llenaProductosSeleccionados(),this.ls.get(X.b.usrTokenVar).sede_uuid&&(this.socket.emit("joinRestaurant",this.ls.get(X.b.usrTokenVar).sede_uuid),this.socket.on("reconnect",()=>this.socket.emit("joinRestaurant",this.ls.get(X.b.usrTokenVar).sede_uuid))),this.usaCodigoBarras=this.configSrvc.getConfig(X.b.CONSTANTES.RT_USA_CODIGO_BARRAS),this.imprimeRecetaEnComanda=this.configSrvc.getConfig(X.b.CONSTANTES.RT_IMPRIME_RECETA_EN_COMANDA)},this.resetMesaEnUso=()=>this.mesaEnUso={exito:!0,comanda:null,usuario:null,sede:null,estatus:null,mesa:{mesa:null,area:{area:null,sede:null,area_padre:null,nombre:null},numero:null,posx:null,posy:null,tamanio:null,estatus:null},numero_pedido:null,cuentas:[]},this.resetLstProductosSeleccionados=()=>this.lstProductosSeleccionados=[],this.resetLstProductosDeCuenta=()=>this.lstProductosDeCuenta=[],this.resetCuentaActiva=()=>this.cuentaActiva={cuenta:null,numero:null,nombre:null,productos:[]},this.resetListadoArticulos=()=>this.appLstProdAlt.loadArbolArticulos(),this.setListaCategorias=(t=[])=>this.categorias=this.setVerBotones(t),this.setVerBotones=t=>{for(const e of t)t:for(const t of e.categoria_grupo)for(const a of t.articulo)if(1==+a.mostrar_pos){t.mostrarEnPos=!0,e.mostrarEnPos=!0;continue t}return t},this.clickOnCategoria=t=>this.appLstProdAlt.fillSubCategorias(t.categoria_grupo),this.buscarArticulo=()=>{this.codigoBarras&&this.codigoBarras.trim().length>0&&this.endSubs.add(this.articuloSrvc.getArticulos({codigo:this.codigoBarras.trim()}).subscribe(t=>{if(t&&t.length>0){const e=t[0];this.agregarProductos({id:+e.articulo,nombre:e.descripcion,precio:+e.precio,impresora:e.impresora,presentacion:e.presentacion,codigo:e.codigo,combo:e.combo,multiple:e.multiple})}this.codigoBarras=null,this.txtCodigoBarras.focus()}))},this.llenaProductosSeleccionados=(t=this.mesaEnUso)=>{null==this.mesaEnUso.comanda&&(this.mesaEnUso=t),this.lstProductosSeleccionados=[];for(const e of t.cuentas)for(const t of e.productos)this.lstProductosSeleccionados.push({id:+t.articulo.articulo,nombre:t.articulo.descripcion,cuenta:+t.numero_cuenta||1,idcuenta:+e.cuenta,cantidad:+t.cantidad,impreso:+t.impreso,precio:parseFloat(t.precio)||10,total:parseFloat(t.total)||parseFloat(t.cantidad)*parseFloat(t.precio),notas:t.notas||"",showInputNotas:!1,itemListHeight:"70px",detalle_comanda:+t.detalle_comanda,detalle_cuenta:+t.detalle_cuenta,impresora:t.articulo.impresora,detalle:t.detalle,monto_extra:+t.monto_extra||0,multiple:+t.articulo.multiple,combo:+t.articulo.combo})},this.cerrarMesa=()=>{this.endSubs.add(this.comandaSrvc.cerrarMesa(this.mesaEnUso.mesa.mesa).subscribe(t=>{t.exito?(this.snackBar.open(t.mensaje,"Comanda",{duration:3e3}),this.mesaEnUso.mesa.estatus=1,this.mesaSavedEv.emit(),this.socket.emit("refrescar:mesa",{mesaenuso:this.mesaEnUso})):this.snackBar.open(`ERROR: ${t.mensaje}`,"Comanda",{duration:7e3})}))},this.printToBT=(t="")=>{const e=this.configSrvc.getConfig(X.b.CONSTANTES.RT_ENVIA_COMO_BASE64)?le.a.encode(t,!0):t,a=X.b.DEEP_LINK_ANDROID.replace("__INFOBASE64__",e);try{window.location.href=a}catch(o){this.snackBar.open("No se pudo conectar con la aplicaci\xf3n de impresi\xf3n","Comanda",{duration:3e3})}this.bloqueoBotones=!1},this.printComandaPDF=()=>{const t=+this.cuentaActiva.cuenta;this.endSubs.add(this.pdfServicio.getComanda(t).subscribe(e=>{if(e){const a=new Blob([e],{type:"application/pdf"}),o=window.URL.createObjectURL(a);window.open(o,`cuenta_${t}`,"height=700,width=800,menubar=no,location=no,resizable=no,scrollbars=no,status=no")}else this.snackBar.open("No se pudo generar la comanda...","Comanda",{duration:3e3})}))},this.sumaDetalle=t=>{let e=0;for(const a of t)e+=+a.total||0,e+=+a.monto_extra||0;return e},this.enviarPedido=(t=null)=>{const e=this.mesaEnUso.cuentas[0];this.cuentaActiva=this.mesaEnUso.cuentas.find(t=>+t.numero==+e.numero);const a=this.lstProductosSeleccionados.filter(t=>+t.cuenta==+this.cuentaActiva.numero);a.map(t=>t.impreso=1),this.noComanda=this.mesaEnUso.comanda,this.cuentaActiva.productos=this.prepProductosComanda(a),this.mesaEnUso.cuentas.findIndex(t=>+t.cuenta==+this.cuentaActiva.cuenta)>-1&&this.endSubs.add(this.comandaSrvc.save({area:this.mesaEnUso.mesa.area.area,mesa:this.mesaEnUso.mesa.mesa,mesero:this.mesaEnUso.usuario,comanda:this.mesaEnUso.comanda,cuentas:this.mesaEnUso.cuentas,numero_pedido:this.mesaEnUso.numero_pedido}).subscribe(a=>{a.exito&&(this.mesaEnUso.numero_pedido=a.comanda.numero_pedido,this.endSubs.add(this.comandaSrvc.setProductoImpreso(e.cuenta).subscribe(a=>{this.llenaProductosSeleccionados(a.comanda),this.setSelectedCuenta(e.numero),this.cobrarCuenta(t)})))}))},this.cambiarEstatusCuenta=t=>{const e=this.mesaEnUso.cuentas.findIndex(e=>+e.cuenta==+t.cuenta);this.mesaEnUso.cuentas[e].cerrada=+t.cerrada},this.esCajero=()=>!1,this.trasladoMesa=(t=null)=>{const e=this.dialog.open(ie,{width:"55%",data:{mesaEnUso:this.mesaEnUso}});this.endSubs.add(e.afterClosed().subscribe(e=>{e&&(this.socket.emit("refrescar:mesa",{mesaenuso:this.mesaEnUso}),t?t.close(this.mesaEnUso):this.closeSideNavEv.emit(this.mesaEnUso))}))},this.getNotasGenerales=()=>{const t=this.dialog.open(Ye,{width:"50%",data:{notasGenerales:this.mesaEnUso.notas_generales||""}});this.endSubs.add(t.afterClosed().subscribe(t=>{null!==t&&t.trim().length>0&&this.endSubs.add(this.comandaSrvc.saveNotasGenerales({comanda:this.mesaEnUso.comanda,notas_generales:t}).subscribe(e=>{e.exito?(this.mesaEnUso.notas_generales=t,this.snackBar.open(e.mensaje,"Comanda",{duration:3e3})):this.snackBar.open(`ERROR: ${e.mensaje}`,"Comanda",{duration:7e3})}))}))},this.nuevaCuenta=(t=null)=>{const e=this.dialog.open(Ze,{width:"50%",data:{mesaEnUso:this.mesaEnUso}});this.endSubs.add(e.afterClosed().subscribe(e=>{e&&(t?t.close():this.closeSideNavEv.emit())}))},this.distribuirProductos=(t=null)=>{const e=this.dialog.open(aa,{width:"50%",data:{mesaEnUso:this.mesaEnUso,lstProductos:this.lstProductosSeleccionados||[]}});this.endSubs.add(e.afterClosed().subscribe(e=>{e&&(t?t.close():this.closeSideNavEv.emit())}))},this.abrirAccionesComanda=t=>{const e=this.bsAccionesCmd.open(ua,{autoFocus:!1,data:{tranComanda:this,dialogRef:t}});this.endSubs.add(e.afterDismissed().subscribe(e=>{(null==e?void 0:e.cerrar)&&t.close(e.mesaEnUso||null)}))}}setSelectedCuenta(t){this.bloqueoBotones=!0,this.cuentaActiva=this.mesaEnUso.cuentas.find(e=>+e.numero==+t),this.setLstProductosDeCuenta(),this.bloqueoBotones=!1}setSumaCuenta(t){let e=0;for(const a of t)e+=a.precio*a.cantidad;this.sumCuenta=e}setLstProductosDeCuenta(){this.lstProductosDeCuenta=this.lstProductosSeleccionados.filter(t=>+t.cuenta==+this.cuentaActiva.numero)}agregarProductos(t){if(1==+t.combo||1==+t.multiple){this.bloqueoBotones=!0;const e=this.dialog.open(Je,{maxWidth:"50%",data:new Ke(t,"S\xed","No")});this.endSubs.add(e.afterClosed().subscribe(t=>{t&&t.respuesta&&t.seleccion.receta.length>0?this.endSubs.add(this.comandaSrvc.saveDetalleCombo(this.mesaEnUso.comanda,this.cuentaActiva.cuenta,t.seleccion).subscribe(t=>{t.exito?(this.mesaEnUso=t.comanda,this.llenaProductosSeleccionados(this.mesaEnUso),this.setSelectedCuenta(+this.cuentaActiva.numero)):this.snackBar.open(`ERROR:${t.mensaje}`,"Comanda",{duration:3e3}),this.bloqueoBotones=!1})):(this.bloqueoBotones=!1,this.snackBar.open("Error, Debe seleccionar los productos del combo","Comanda",{duration:7e3}))}))}else this.addProductoSelected(t)}addProductoSelected(t){if(this.bloqueoBotones=!0,+this.cuentaActiva.numero){const e=this.lstProductosSeleccionados.findIndex(e=>+e.id==+t.id&&+e.cuenta==+this.cuentaActiva.numero&&0==+e.impreso);if(e<0)this.detalleComanda={articulo:t.id,cantidad:1,precio:+t.precio,total:1*+t.precio,notas:""},this.endSubs.add(this.comandaSrvc.saveDetalle(this.mesaEnUso.comanda,this.cuentaActiva.cuenta,this.detalleComanda).subscribe(t=>{t.exito?(this.mesaEnUso=t.comanda,this.llenaProductosSeleccionados(this.mesaEnUso),this.setSelectedCuenta(+this.cuentaActiva.numero)):this.snackBar.open(`ERROR:${t.mensaje}`,"Comanda",{duration:3e3}),this.bloqueoBotones=!1}));else{const t=this.lstProductosSeleccionados[e];this.detalleComanda={detalle_cuenta:t.detalle_cuenta,detalle_comanda:t.detalle_comanda,articulo:t.id,cantidad:+t.cantidad+1,precio:+t.precio,total:(+t.cantidad+1)*+t.precio,notas:t.notas},this.endSubs.add(this.comandaSrvc.saveDetalle(this.mesaEnUso.comanda,this.cuentaActiva.cuenta,this.detalleComanda).subscribe(t=>{t.exito?(this.mesaEnUso=t.comanda,this.llenaProductosSeleccionados(this.mesaEnUso),this.setSelectedCuenta(+this.cuentaActiva.numero)):this.snackBar.open(`ERROR:${t.mensaje}`,"Comanda",{duration:3e3}),this.bloqueoBotones=!1}))}this.setLstProductosDeCuenta()}}updProductosCuenta(t){const e=t.listaProductos||[],a=this.lstProductosSeleccionados.filter(t=>+t.cuenta!=+this.cuentaActiva.numero);this.lstProductosSeleccionados=e.length>0?a.concat(e):a,t.comanda&&(this.mesaEnUso=t.comanda,this.llenaProductosSeleccionados(this.mesaEnUso),this.setSelectedCuenta(+this.cuentaActiva.numero))}prepProductosComanda(t){const e=[];for(const a of t)e.push({articulo:a.id,cantidad:a.cantidad,precio:a.precio,total:a.total,notas:a.notas,impreso:1,detalle_comanda:a.detalle_comanda,detalle_cuenta:a.detalle_cuenta});return e}validarImpresion(t=!1,e=null){const a=this.configSrvc.getConfig(X.b.CONSTANTES.RT_INGRESO_NUMERO_PEDIDO);if(1==+this.mesaEnUso.mesa.esmostrador&&a&&!this.mesaEnUso.numero_pedido){let a=this.configSrvc.getConfig(X.b.CONSTANTES.RT_TOTAL_NUMEROS_PEDIDO);(!a||a<=0)&&(a=30);const o=this.dialog.open(je,{maxWidth:"50%",data:new Be("Numero de Pedido",a,"S\xed","No")});this.endSubs.add(o.afterClosed().subscribe(a=>{a&&a.respuesta&&a.pedido?(this.mesaEnUso.numero_pedido=a.pedido,this.printComanda(t,e)):this.snackBar.open("Error, Debe seleccionar un numero de pedido","Comanda",{duration:7e3})}))}else this.printComanda(t,e)}printComanda(t=!1,e=null){const a=JSON.parse(JSON.stringify(this.mesaEnUso));this.bloqueoBotones=!0,this.impreso=0;const o=this.configSrvc.getConfig(X.b.CONSTANTES.RT_MODO_COMANDA)||1;for(let n=0;n<a.cuentas.length;n++){const i=a.cuentas[n];this.cuentaActiva=a.cuentas.find(t=>+t.numero==+i.numero);const s=this.lstProductosSeleccionados.filter(t=>+t.cuenta==+this.cuentaActiva.numero),c=s.filter(t=>0==+t.impreso&&+t.cantidad>0);c.length>0?(s.map(t=>t.impreso=1),this.noComanda=a.comanda,this.cuentaActiva.productos=this.prepProductosComanda(s),a.cuentas.findIndex(t=>+t.cuenta==+this.cuentaActiva.cuenta)>-1&&this.endSubs.add(this.comandaSrvc.save({area:a.mesa.area.area,mesa:a.mesa.mesa,mesero:a.usuario,comanda:a.comanda,cuentas:a.cuentas,numero_pedido:a.numero_pedido}).subscribe(n=>{n.exito?(a.numero_pedido=n.comanda.numero_pedido,this.endSubs.add(this.comandaSrvc.setProductoImpreso(i.cuenta).subscribe(n=>{n.exito&&this.impreso++,this.llenaProductosSeleccionados(n.comanda),this.setSelectedCuenta(i.numero),this.snackBar.open("Cuenta actualizada",`Cuenta #${i.numero}`,{duration:3e3});let s=[],r=[];try{s=c.filter(t=>0==+t.impresora.bluetooth),r=c.filter(t=>1==+t.impresora.bluetooth)}catch(l){console.log("PRODUCTOS A IMPRIMIR = ",c),console.log("NORMAL = ",s),console.log("BT = ",r),console.log(l)}t?this.printComandaPDF():(s.length>0&&(3!==o?(this.imprimeRecetaEnComanda||s.map(t=>(0==+t.combo&&1==+t.esreceta&&(t.detalle=[]),t)),this.socket.emit("print:comanda",`${JSON.stringify({Tipo:"Comanda",Nombre:this.cuentaActiva.nombre,Numero:this.noComanda,DetalleCuenta:s,Ubicacion:`${a.mesa.area.nombre} - Mesa ${a.mesa.etiqueta||a.mesa.numero}`,Mesero:`${a.mesero.nombres} ${a.mesero.apellidos}`,Total:null,NumeroPedido:a.numero_pedido,NotasGenerales:a.notas_generales||""})}`),this.snackBar.open(`Imprimiendo comanda #${this.noComanda}`,"Comanda",{duration:7e3})):this.snackBar.open(`Comanda #${this.noComanda} enviada a cocina`,"Comanda",{duration:7e3}),this.bloqueoBotones=!1),r.length>0&&3!==o&&(this.imprimeRecetaEnComanda||s.map(t=>(0==+t.combo&&1==+t.esreceta&&(t.detalle=[]),t)),this.printToBT(JSON.stringify({Tipo:"Comanda",Nombre:this.cuentaActiva.nombre,Numero:this.noComanda,DetalleCuenta:r,Ubicacion:`${a.mesa.area.nombre} - Mesa ${a.mesa.etiqueta||a.mesa.numero}`,Mesero:`${a.mesero.nombres} ${a.mesero.apellidos}`,Total:null,NumeroPedido:a.numero_pedido})))),+this.impreso===a.cuentas.length&&(this.impreso=0,this.socket.emit("refrescar:mesa",{mesaenuso:a}),this.socket.emit("refrescar:listaCocina",{mesaenuso:a}),0==+a.mesa.esmostrador?e?e.close():this.closeSideNavEv.emit():this.cobrarCuenta(e))}))):this.snackBar.open(`ERROR: ${n.mensaje}`,`Cuenta #${this.cuentaActiva.numero}`,{duration:3e3}),this.bloqueoBotones=!1}))):(this.impreso++,this.bloqueoBotones=!1)}}printCuenta(t=null){if(this.bloqueoBotones=!0,this.lstProductosAImprimir=this.lstProductosDeCuenta.filter(t=>1==+t.impreso),this.lstProductosAImprimir.length>0){this.setSumaCuenta(this.lstProductosAImprimir);const e=this.sumaDetalle(this.lstProductosAImprimir),a=this.mesaEnUso.mesa.impresora||this.mesaEnUso.mesa.area.impresora,o=this.configSrvc.getConfig(X.b.CONSTANTES.RT_IMPRIME_PROPINA_SUGERIDA),n={Tipo:"Cuenta",Nombre:this.cuentaActiva.nombre,Numero:null,DetalleCuenta:this.lstProductosAImprimir,Total:e,Empresa:this.ls.get(X.b.usrTokenVar).empresa,Restaurante:this.ls.get(X.b.usrTokenVar).restaurante,PropinaSugerida:o?(.1*e).toFixed(2):null,Impresora:a,Ubicacion:`${this.mesaEnUso.mesa.area.nombre} - Mesa ${this.mesaEnUso.mesa.etiqueta||this.mesaEnUso.mesa.numero} - Comanda ${this.mesaEnUso.comanda}`,Mesero:`${this.mesaEnUso.mesero.nombres} ${this.mesaEnUso.mesero.apellidos}`};0==+a.bluetooth?this.socket.emit("print:cuenta",`${JSON.stringify(n)}`):this.printToBT(JSON.stringify(n)),this.snackBar.open(`Imprimiendo cuenta de ${this.cuentaActiva.nombre}`,"Cuenta",{duration:7e3}),t?t.close():this.closeSideNavEv.emit()}else this.snackBar.open(`La cuenta de ${this.cuentaActiva.nombre} no tiene ning\xfan art\xedculo.`,"Cuenta",{duration:7e3});this.bloqueoBotones=!1}unirCuentas(t=null){const e=this.dialog.open(oe,{width:"55%",data:{lstProductosSeleccionados:this.lstProductosSeleccionados,mesaEnUso:this.mesaEnUso}});this.endSubs.add(e.afterClosed().subscribe(e=>{e&&(t?t.close():this.closeSideNavEv.emit())}))}cobrarCuenta(t=null){this.endSubs.add(this.comandaSrvc.getCuenta(this.cuentaActiva.cuenta).subscribe(e=>{if(e.pendiente.length>0)this.snackBar.open("Cobro","Tiene productos sin comandar",{duration:3e3});else{const e=this.lstProductosDeCuenta.filter(t=>1==+t.impreso);if(e.length>0){const a=this.dialog.open(Re,{width:"95%",data:{mesaenuso:this.mesaEnUso,cuenta:this.cuentaActiva.nombre,idcuenta:this.cuentaActiva.cuenta,productosACobrar:e,porcentajePropina:0,impresora:0==+this.mesaEnUso.mesa.esmostrador?this.mesaEnUso.mesa.area.impresora_factura||null:this.mesaEnUso.mesa.impresora||this.mesaEnUso.mesa.area.impresora,clientePedido:this.clientePedido}});this.endSubs.add(a.afterClosed().subscribe(e=>{e&&"closePanel"!==e?(this.cambiarEstatusCuenta(e),t?t.close(this.mesaEnUso):this.closeSideNavEv.emit(this.mesaEnUso)):"closePanel"===e&&(t?t.close(this.mesaEnUso):this.closeSideNavEv.emit())}))}else this.snackBar.open("Cobro","Sin productos a cobrar.",{duration:3e3})}}))}}{constructor(t,e,a,o,n,i,s,c,r,l,d){super(a,o,n,i,s,c,r,l,d),this.dialogRef=t,this.data=e,this.dialog=a,this.snackBar=o,this.comandaSrvc=n,this.socket=i,this.ls=s,this.pdfServicio=c,this.configSrvc=r,this.articuloSrvc=l,this.bsAccionesCmd=d,this.categorias=[],this.subCategorias=[],this.listaSubCategorias=[],this.articulos=[],this.fullListArticulos=[],this.setDatos=()=>{this.data&&this.data.mesa&&(this.mesaEnUso=this.data.mesa,this.alIniciar(),this.setSelectedCuenta(this.mesaEnUso.cuentas[0].numero))},this.cerrar=()=>this.dialogRef.close(),this.resetArticulos=()=>this.articulos=[],this.resetListaSubCategorias=()=>this.listaSubCategorias=[],this.loadArticulosDePOS=()=>{this.endSubs.add(this.articuloSrvc.getArticulosDePOS().subscribe(t=>{t&&(this.categorias=t.categorias,this.subCategorias=t.subcategorias,this.articulos=t.articulos,this.fullListArticulos=JSON.parse(JSON.stringify(this.articulos)))}))},this.loadSubcategorias=(t,e=null,a=0)=>{this.bloqueoBotones||(e?(this.listaSubCategorias.length>0&&this.listaSubCategorias.splice(a+1),e.subcategorias&&(0===e.subcategorias.length?this.filterArticulos(+e.categoria_grupo):this.listaSubCategorias.push(e.subcategorias))):(this.resetListaSubCategorias(),this.resetArticulos(),this.listaSubCategorias.push(this.subCategorias.filter(e=>+e.categoria==+t.categoria))))},this.filterArticulos=(t=null)=>{this.bloqueoBotones||(this.articulos=t?this.fullListArticulos.filter(e=>+e.categoria_grupo==+t):this.fullListArticulos)},this.addArticulo=t=>{this.bloqueoBotones||this.agregarProductos({id:+t.articulo,nombre:t.descripcion,precio:+t.precio,impresora:t.impresora,presentacion:t.presentacion,codigo:t.codigo,combo:t.combo,multiple:t.multiple})}}ngOnInit(){this.usaCodigoBarras=this.configSrvc.getConfig(X.b.CONSTANTES.RT_USA_CODIGO_BARRAS),this.loadArticulosDePOS(),this.setDatos()}ngOnDestroy(){this.endSubs.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(W.Nb(D.f),W.Nb(D.a),W.Nb(D.b),W.Nb(M.b),W.Nb(te),W.Nb(he.a),W.Nb(ot.a),W.Nb(ba.a),W.Nb(fe.a),W.Nb(He.a),W.Nb(A.b))},t.\u0275cmp=W.Hb({type:t,selectors:[["app-tran-comanda-alt"]],viewQuery:function(t,e){if(1&t&&W.Kc(Aa,1),2&t){let t;W.sc(t=W.cc())&&(e.txtCodigoBarras=t.first)}},features:[W.zb],decls:25,vars:18,consts:[["fxLayout","row","fxLayout.xs","column"],["fxFlex","50%","fxFelx.xs","100%","fxLayoutAlign","start start"],[1,"bld",2,"font-size","16pt","margin-left","10px"],["fxFlex","50%","fxFelx.xs","100%","fxLayoutAlign","end start"],["mat-raised-button","","type","button","color","warn",3,"disabled","click"],["mat-raised-button","","type","button","color","accent",2,"margin-left","8px",3,"disabled","click"],["mat-dialog-content","",1,"contenido"],["fxLayout","row wrap","fxLayout.xs","column","fxLayoutAlign","center center",1,"divSeparacion"],["color","accent",3,"disabled","selected","click",4,"ngFor","ngForOf"],[3,"click",4,"ngIf"],["style","width: 25%;",4,"ngIf"],[4,"ngIf"],["fxLayout","row wrap","fxLayout.xs","column","fxLayoutAlign","start center"],["selected","","color","accent",3,"disabled","click",4,"ngFor","ngForOf"],["fxLayout","row wrap","fxLayout.xs","column","fxLayoutAlign","start center","class","divSubCategorias",4,"ngFor","ngForOf"],["fxLayout","row wrap","fxLayout.xs","column","fxLayoutAlign","start start"],["fxFlex","55%","fxFlex.xs","100%","fxFlex.sm","100%","fxLayout","row wrap","fxLayoutGap","8px grid","fxLayoutAlign","start start",1,"divArticulos"],["fxFlex","20%","fxFlex.xs","100%","fxFlex.sm","33%","fxFlex.md","25%",4,"ngFor","ngForOf"],["fxFlex","45%","fxFlex.xs","100%","fxFlex.sm","100%",1,"divArticulos"],[3,"listaProductos","noCuenta","IdComanda","IdCuenta","bloqueoBotones","mesaEnUso","productoRemovedEv"],["color","accent",3,"disabled","selected","click"],[3,"click"],[2,"width","25%"],["matInput","","cdkFocusInitial","","ngxBarCodePut","","type","text","placeholder","C\xf3digo","name","codigoBarras",3,"ngModel","ngModelOptions","ngModelChange","onDetected"],["txtCodigoBarras","matInput"],["selected","","color","accent",3,"disabled","click"],["fxLayout","row wrap","fxLayout.xs","column","fxLayoutAlign","start center",1,"divSubCategorias"],["selected","","color","warn","class","btnAccion",3,"disabled","click",4,"ngFor","ngForOf"],["selected","","color","warn",1,"btnAccion",3,"disabled","click"],["fxFlex","20%","fxFlex.xs","100%","fxFlex.sm","33%","fxFlex.md","25%"],[1,"mat-elevation-z4",3,"click"]],template:function(t,e){1&t&&(W.Tb(0,"div",0),W.Tb(1,"div",1),W.Tb(2,"span",2),W.Fc(3),W.Sb(),W.Sb(),W.Tb(4,"div",3),W.Tb(5,"button",4),W.bc("click",function(){return e.abrirAccionesComanda(e.dialogRef)}),W.Fc(6," Acciones "),W.Sb(),W.Tb(7,"button",5),W.bc("click",function(){return e.cerrar()}),W.Fc(8," Cerrar "),W.Sb(),W.Sb(),W.Sb(),W.Tb(9,"div",6),W.Tb(10,"div",7),W.Tb(11,"mat-chip-list"),W.Dc(12,Na,2,3,"mat-chip",8),W.Dc(13,Ra,2,0,"mat-chip",9),W.Sb(),W.Sb(),W.Dc(14,$a,3,3,"mat-form-field",10),W.Dc(15,Ba,1,0,"br",11),W.Tb(16,"div",12),W.Tb(17,"mat-chip-list"),W.Dc(18,ja,2,2,"mat-chip",13),W.Sb(),W.Sb(),W.Dc(19,La,3,1,"div",14),W.Tb(20,"div",15),W.Tb(21,"div",16),W.Dc(22,qa,5,1,"div",17),W.Sb(),W.Tb(23,"div",18),W.Tb(24,"app-lista-productos-comanda",19),W.bc("productoRemovedEv",function(t){return e.updProductosCuenta(t)}),W.Sb(),W.Sb(),W.Sb(),W.Sb()),2&t&&(W.Cb(3),W.Jc(" ",e.mesaEnUso.mesa.area.nombre," - Mesa",e.mesaEnUso.mesa.numero," - Comanda ",e.mesaEnUso.comanda," "),W.Cb(2),W.lc("disabled",e.bloqueoBotones),W.Cb(2),W.lc("disabled",e.bloqueoBotones),W.Cb(5),W.lc("ngForOf",e.mesaEnUso.cuentas),W.Cb(1),W.lc("ngIf",0==+e.mesaEnUso.mesa.esmostrador&&0==+e.mesaEnUso.mesa.escallcenter),W.Cb(1),W.lc("ngIf",e.usaCodigoBarras),W.Cb(1),W.lc("ngIf",e.usaCodigoBarras),W.Cb(3),W.lc("ngForOf",e.categorias),W.Cb(1),W.lc("ngForOf",e.listaSubCategorias),W.Cb(3),W.lc("ngForOf",e.articulos),W.Cb(2),W.lc("listaProductos",e.lstProductosDeCuenta)("noCuenta",+e.cuentaActiva.numero)("IdComanda",e.mesaEnUso.comanda)("IdCuenta",e.cuentaActiva.cuenta)("bloqueoBotones",e.bloqueoBotones)("mesaEnUso",e.mesaEnUso))},directives:[Ue.c,Ue.a,Ue.b,v.a,D.d,w.b,o.l,o.m,Ue.d,wa,w.a,m.b,h.b,i.c,V,i.k,i.n,p.a,p.c],styles:[".contenido[_ngcontent-%COMP%]{max-height:80vh!important;height:100%;overflow-y:auto;padding:0 5px}.divSubCategorias[_ngcontent-%COMP%]{padding-top:3px;padding-bottom:3px}.divArticulos[_ngcontent-%COMP%]{padding:3px 8px;overflow-y:auto;margin:0;height:73vh}.divArticulos[_ngcontent-%COMP%] > mat-card[_ngcontent-%COMP%]{width:200px;max-height:95px}.divSeparacion[_ngcontent-%COMP%]{padding-top:3px;padding-bottom:3px}.bordeTest2[_ngcontent-%COMP%]{border:1px solid #00f}.bordeTest3[_ngcontent-%COMP%]{border:1px solid #90ee90}@media (max-height:768px){.divArticulos[_ngcontent-%COMP%]{height:60vh}}@media (min-height:769px) and (max-height:960px){.divArticulos[_ngcontent-%COMP%]{height:69vh}}"]}),t})();function Ga(t,e){if(1&t){const t=W.Ub();W.Tb(0,"button",6),W.bc("click",function(){W.xc(t);const e=W.fc().$implicit;return W.fc().clickOnSubCategoria(e)}),W.Fc(1),W.Sb()}if(2&t){const t=W.fc().$implicit,e=W.fc();W.lc("disabled",e.bloqueoBotones),W.Cb(1),W.Hc(" ",t.descripcion," ")}}function Wa(t,e){if(1&t&&(W.Rb(0),W.Dc(1,Ga,2,2,"button",5),W.Qb()),2&t){const t=e.$implicit;W.Cb(1),W.lc("ngIf",t.mostrarEnPos)}}function Va(t,e){1&t&&W.Ob(0,"hr")}function Ka(t,e){if(1&t){const t=W.Ub();W.Tb(0,"button",7),W.bc("click",function(){W.xc(t);const a=e.$implicit;return W.fc().clickOnArticulo(a)}),W.Fc(1),W.Sb()}if(2&t){const t=e.$implicit,a=W.fc();W.lc("disabled",a.bloqueoBotones),W.Cb(1),W.Hc(" ",t.descripcion," ")}}let Ja=(()=>{class t{constructor(t,e){this.articuloSrvc=t,this.ls=e,this.bloqueoBotones=!1,this.productoClickedEv=new W.o,this.categoriasFilledEv=new W.o,this.categorias=[],this.subcategorias=[],this.articulos=[],this.loadArbolArticulos=()=>{this.articuloSrvc.getArbolArticulos(this.ls.get(X.b.usrTokenVar).sede||0).subscribe(t=>{this.fillCategorias(t)})},this.fillCategorias=t=>{this.categorias=[],this.subcategorias=[],this.articulos=[];for(const e of t)this.categorias.push(e);this.categoriasFilledEv.emit(this.categorias)},this.fillSubCategorias=t=>{this.subcategorias=[],this.articulos=[];for(const e of t)0==+e.debaja&&this.subcategorias.push(e)},this.fillArticulos=t=>{this.articulos=[];for(const e of t)0==+e.debaja&&this.articulos.push(e)},this.clickOnCategoria=t=>{t.categoria_grupo.length>0&&this.fillSubCategorias(t.categoria_grupo)},this.clickOnSubCategoria=t=>{t.articulo.length>0&&this.fillArticulos(t.articulo)},this.clickOnArticulo=t=>{this.productoClickedEv.emit({id:+t.articulo,nombre:t.descripcion,precio:+t.precio,impresora:t.impresora,presentacion:t.presentacion,codigo:t.codigo,combo:t.combo,multiple:t.multiple,debaja:t.debaja})}}ngOnInit(){this.loadArbolArticulos()}}return t.\u0275fac=function(e){return new(e||t)(W.Nb(He.a),W.Nb(ot.a))},t.\u0275cmp=W.Hb({type:t,selectors:[["app-lista-producto-alt"]],inputs:{bloqueoBotones:"bloqueoBotones"},outputs:{productoClickedEv:"productoClickedEv",categoriasFilledEv:"categoriasFilledEv"},decls:7,vars:3,consts:[[1,"row"],[1,"col","m12","s12"],[4,"ngFor","ngForOf"],[4,"ngIf"],["mat-raised-button","","class","btnAccion","color","warn",3,"disabled","click",4,"ngFor","ngForOf"],["mat-raised-button","","class","btnAccion","color","primary",3,"disabled","click",4,"ngIf"],["mat-raised-button","","color","primary",1,"btnAccion",3,"disabled","click"],["mat-raised-button","","color","warn",1,"btnAccion",3,"disabled","click"]],template:function(t,e){1&t&&(W.Tb(0,"div",0),W.Tb(1,"div",1),W.Dc(2,Wa,2,1,"ng-container",2),W.Sb(),W.Sb(),W.Dc(3,Va,1,0,"hr",3),W.Tb(4,"div",0),W.Tb(5,"div",1),W.Dc(6,Ka,2,2,"button",4),W.Sb(),W.Sb()),2&t&&(W.Cb(2),W.lc("ngForOf",e.subcategorias),W.Cb(1),W.lc("ngIf",e.articulos.length>0),W.Cb(3),W.lc("ngForOf",e.articulos))},directives:[o.l,o.m,v.a],styles:[""]}),t})();const Qa=["appLstProdAlt"],Xa=["txtCodigoBarras"];function Ya(t,e){if(1&t&&(W.Tb(0,"span",25),W.Fc(1),W.Sb()),2&t){const t=W.fc();W.Cb(1),W.Jc(" ",t.mesaEnUso.mesa.area.nombre," - Mesa ",t.mesaEnUso.mesa.etiqueta||t.mesaEnUso.mesa.numero," - Comanda ",t.mesaEnUso.comanda," ")}}function Za(t,e){if(1&t){const t=W.Ub();W.Tb(0,"button",29),W.bc("click",function(){W.xc(t);const a=e.$implicit;return W.fc(2).setSelectedCuenta(a.numero)}),W.Fc(1),W.Sb()}if(2&t){const t=e.$implicit;W.lc("disabled",1==+t.cerrada),W.Cb(1),W.Hc(" ",t.nombre," ")}}function to(t,e){if(1&t){const t=W.Ub();W.Tb(0,"button",30),W.bc("click",function(){return W.xc(t),W.fc(2).nuevaCuenta()}),W.Fc(1," Nueva "),W.Sb()}}function eo(t,e){if(1&t&&(W.Tb(0,"div",26),W.Dc(1,Za,2,2,"button",27),W.Dc(2,to,2,0,"button",28),W.Sb()),2&t){const t=W.fc();W.Cb(1),W.lc("ngForOf",t.mesaEnUso.cuentas),W.Cb(1),W.lc("ngIf",t.mesaEnUso&&0==+t.mesaEnUso.mesa.esmostrador&&0==+t.mesaEnUso.mesa.escallcenter)}}const ao=function(){return{standalone:!0}};function oo(t,e){if(1&t){const t=W.Ub();W.Tb(0,"mat-form-field",31),W.Tb(1,"input",32,33),W.bc("ngModelChange",function(e){return W.xc(t),W.fc().codigoBarras=e})("onDetected",function(){return W.xc(t),W.fc().buscarArticulo()}),W.Sb(),W.Sb()}if(2&t){const t=W.fc();W.Cb(1),W.lc("ngModel",t.codigoBarras)("ngModelOptions",W.nc(2,ao))}}function no(t,e){1&t&&W.Ob(0,"br")}function io(t,e){if(1&t){const t=W.Ub();W.Tb(0,"button",35),W.bc("click",function(){W.xc(t);const e=W.fc().$implicit;return W.fc().clickOnCategoria(e)}),W.Fc(1),W.Sb()}if(2&t){const t=W.fc().$implicit,e=W.fc();W.lc("disabled",!e.cuentaActiva||e.bloqueoBotones||!e.cuentaActiva.cuenta),W.Cb(1),W.Hc(" ",t.descripcion," ")}}function so(t,e){if(1&t&&(W.Rb(0),W.Dc(1,io,2,2,"button",34),W.Qb()),2&t){const t=e.$implicit;W.Cb(1),W.lc("ngIf",t.mostrarEnPos)}}function co(t,e){if(1&t&&(W.Tb(0,"span",9),W.Fc(1),W.Sb()),2&t){const t=W.fc();W.Cb(1),W.Hc("Cuenta de ",t.cuentaActiva.nombre,"")}}function ro(t,e){1&t&&(W.Tb(0,"span",9),W.Fc(1,"Por favor seleccione una cuenta. Gracias."),W.Sb())}function lo(t,e){if(1&t){const t=W.Ub();W.Tb(0,"button",18),W.bc("click",function(){return W.xc(t),W.fc().validarImpresion()}),W.Fc(1," Comanda "),W.Sb()}if(2&t){const t=W.fc();W.lc("disabled",!t.cuentaActiva.nombre||t.bloqueoBotones)}}function uo(t,e){if(1&t){const t=W.Ub();W.Tb(0,"button",18),W.bc("click",function(){return W.xc(t),W.fc().printCuenta()}),W.Fc(1," Cuenta "),W.Sb()}if(2&t){const t=W.fc();W.lc("disabled",!t.cuentaActiva.nombre||t.bloqueoBotones)}}function bo(t,e){if(1&t){const t=W.Ub();W.Tb(0,"button",18),W.bc("click",function(){return W.xc(t),W.fc().distribuirProductos()}),W.Fc(1," Distribuir "),W.Sb()}if(2&t){const t=W.fc();W.lc("disabled",t.mesaEnUso.cuentas.length<2||t.bloqueoBotones)}}function mo(t,e){if(1&t){const t=W.Ub();W.Tb(0,"button",18),W.bc("click",function(){return W.xc(t),W.fc().unirCuentas()}),W.Fc(1," Unir cuentas "),W.Sb()}if(2&t){const t=W.fc();W.lc("disabled",t.mesaEnUso.cuentas.length<2||t.bloqueoBotones)}}function ho(t,e){if(1&t){const t=W.Ub();W.Tb(0,"button",18),W.bc("click",function(){return W.xc(t),W.fc().cobrarCuenta()}),W.Fc(1," Cobrar cuenta "),W.Sb()}if(2&t){const t=W.fc();W.lc("disabled",!t.cuentaActiva.nombre||t.esCajero()||t.bloqueoBotones)}}function po(t,e){if(1&t){const t=W.Ub();W.Tb(0,"button",18),W.bc("click",function(){return W.xc(t),W.fc().enviarPedido()}),W.Fc(1," Enviar pedido "),W.Sb()}if(2&t){const t=W.fc();W.lc("disabled",!t.cuentaActiva.nombre||t.esCajero()||t.bloqueoBotones)}}function fo(t,e){if(1&t){const t=W.Ub();W.Tb(0,"button",18),W.bc("click",function(){return W.xc(t),W.fc().trasladoMesa()}),W.Fc(1," Trasladar "),W.Sb()}if(2&t){const t=W.fc();W.lc("disabled",t.bloqueoBotones)}}function go(t,e){if(1&t){const t=W.Ub();W.Tb(0,"button",36),W.bc("click",function(){return W.xc(t),W.fc().cerrarMesa()}),W.Fc(1),W.Sb()}if(2&t){const t=W.fc();W.Cb(1),W.Hc(" Cerrar ",0==+t.mesaEnUso.mesa.esmostrador?"Mesa":0==+t.mesaEnUso.mesa.escallcenter?"Mostrador":"Pedido"," ")}}function So(t,e){if(1&t){const t=W.Ub();W.Tb(0,"app-lista-productos-comanda",37),W.bc("productoRemovedEv",function(e){return W.xc(t),W.fc().updProductosCuenta(e)}),W.Sb()}if(2&t){const t=W.fc();W.lc("listaProductos",t.lstProductosDeCuenta)("noCuenta",t.cuentaActiva&&+t.cuentaActiva.numero?+t.cuentaActiva.numero:1)("IdComanda",t.mesaEnUso.comanda)("IdCuenta",t.cuentaActiva.cuenta)("bloqueoBotones",t.bloqueoBotones)("mesaEnUso",t.mesaEnUso)}}let Co=(()=>{class t{constructor(t,e,a,o,n,i,s,c){this.dialog=t,this.snackBar=e,this.comandaSrvc=a,this.socket=o,this.ls=n,this.pdfServicio=i,this.configSrvc=s,this.articuloSrvc=c,this.clientePedido=null,this.closeSideNavEv=new W.o,this.mesaSavedEv=new W.o,this.showPortalComanda=!1,this.showPortalCuenta=!1,this.noComanda=0,this.sumCuenta=0,this.categorias=[],this.bloqueoBotones=!1,this.rolesUsuario=[],this.impreso=0,this.usaCodigoBarras=!1,this.codigoBarras=null,this.imprimeRecetaEnComanda=!0,this.resetMesaEnUso=()=>this.mesaEnUso={exito:!0,comanda:null,usuario:null,sede:null,estatus:null,mesa:{mesa:null,area:{area:null,sede:null,area_padre:null,nombre:null},numero:null,posx:null,posy:null,tamanio:null,estatus:null},numero_pedido:null,cuentas:[]},this.resetLstProductosSeleccionados=()=>this.lstProductosSeleccionados=[],this.resetLstProductosDeCuenta=()=>this.lstProductosDeCuenta=[],this.resetCuentaActiva=()=>this.cuentaActiva={cuenta:null,numero:null,nombre:null,productos:[]},this.resetListadoArticulos=()=>this.appLstProdAlt.loadArbolArticulos(),this.setListaCategorias=(t=[])=>this.categorias=this.setVerBotones(t),this.setVerBotones=t=>{for(const e of t)t:for(const t of e.categoria_grupo)for(const a of t.articulo)if(1==+a.mostrar_pos&&0==+a.debaja){t.mostrarEnPos=!0,e.mostrarEnPos=!0;continue t}return t},this.clickOnCategoria=t=>this.appLstProdAlt.fillSubCategorias(t.categoria_grupo),this.buscarArticulo=()=>{this.codigoBarras&&this.codigoBarras.trim().length>0&&this.articuloSrvc.getArticulos({codigo:this.codigoBarras.trim(),debaja:0}).subscribe(t=>{if(t&&t.length>0){const e=t[0];this.agregarProductos({id:+e.articulo,nombre:e.descripcion,precio:+e.precio,impresora:e.impresora,presentacion:e.presentacion,codigo:e.codigo,combo:e.combo,multiple:e.multiple,debaja:e.debaja})}this.codigoBarras=null,this.txtCodigoBarras.focus()})},this.llenaProductosSeleccionados=(t=this.mesaEnUso)=>{null==this.mesaEnUso.comanda&&(this.mesaEnUso=t),this.lstProductosSeleccionados=[];for(const e of t.cuentas)for(const t of e.productos)this.lstProductosSeleccionados.push({id:+t.articulo.articulo,nombre:t.articulo.descripcion,cuenta:+t.numero_cuenta||1,idcuenta:+e.cuenta,cantidad:+t.cantidad,impreso:+t.impreso,precio:parseFloat(t.precio)||10,total:parseFloat(t.total)||parseFloat(t.cantidad)*parseFloat(t.precio),notas:t.notas||"",showInputNotas:!1,itemListHeight:"70px",detalle_comanda:+t.detalle_comanda,detalle_cuenta:+t.detalle_cuenta,impresora:t.articulo.impresora,detalle:t.detalle,monto_extra:+t.monto_extra||0,multiple:+t.articulo.multiple,combo:+t.articulo.combo,esreceta:+t.articulo.esreceta||0})},this.cerrarMesa=()=>{this.comandaSrvc.cerrarMesa(this.mesaEnUso.mesa.mesa).subscribe(t=>{t.exito?(this.snackBar.open(t.mensaje,"Comanda",{duration:3e3}),this.mesaEnUso.mesa.estatus=1,this.mesaSavedEv.emit(),this.socket.emit("refrescar:mesa",{mesaenuso:this.mesaEnUso})):this.snackBar.open(`ERROR: ${t.mensaje}`,"Comanda",{duration:7e3})})},this.printToBT=(t="")=>{const e=this.configSrvc.getConfig(X.b.CONSTANTES.RT_ENVIA_COMO_BASE64)?le.a.encode(t,!0):t,a=X.b.DEEP_LINK_ANDROID.replace("__INFOBASE64__",e);try{window.location.href=a}catch(o){this.snackBar.open("No se pudo conectar con la aplicaci\xf3n de impresi\xf3n","Comanda",{duration:3e3})}this.bloqueoBotones=!1},this.printComandaPDF=()=>{const t=+this.cuentaActiva.cuenta;this.pdfServicio.getComanda(t).subscribe(e=>{if(e){const a=new Blob([e],{type:"application/pdf"}),o=window.URL.createObjectURL(a);window.open(o,`cuenta_${t}`,"height=700,width=800,menubar=no,location=no,resizable=no,scrollbars=no,status=no")}else this.snackBar.open("No se pudo generar la comanda...","Comanda",{duration:3e3})})},this.sumaDetalle=t=>{let e=0;for(const a of t)e+=+a.total||0,e+=+a.monto_extra||0;return e},this.enviarPedido=()=>{const t=this.mesaEnUso.cuentas[0];this.cuentaActiva=this.mesaEnUso.cuentas.find(e=>+e.numero==+t.numero);const e=this.lstProductosSeleccionados.filter(t=>+t.cuenta==+this.cuentaActiva.numero);e.map(t=>t.impreso=1),this.noComanda=this.mesaEnUso.comanda,this.cuentaActiva.productos=this.prepProductosComanda(e),this.mesaEnUso.cuentas.findIndex(t=>+t.cuenta==+this.cuentaActiva.cuenta)>-1&&this.comandaSrvc.save({area:this.mesaEnUso.mesa.area.area,mesa:this.mesaEnUso.mesa.mesa,mesero:this.mesaEnUso.usuario,comanda:this.mesaEnUso.comanda,cuentas:this.mesaEnUso.cuentas,numero_pedido:this.mesaEnUso.numero_pedido}).subscribe(e=>{e.exito&&(this.mesaEnUso.numero_pedido=e.comanda.numero_pedido,this.comandaSrvc.setProductoImpreso(t.cuenta).subscribe(e=>{this.llenaProductosSeleccionados(e.comanda),this.setSelectedCuenta(t.numero),this.cobrarCuenta()}))})},this.cambiarEstatusCuenta=t=>{const e=this.mesaEnUso.cuentas.findIndex(e=>+e.cuenta==+t.cuenta);this.mesaEnUso.cuentas[e].cerrada=+t.cerrada},this.esCajero=()=>!1,this.trasladoMesa=()=>{this.dialog.open(ie,{width:"55%",data:{mesaEnUso:this.mesaEnUso}}).afterClosed().subscribe(t=>{t&&(this.socket.emit("refrescar:mesa",{mesaenuso:this.mesaEnUso}),this.closeSideNavEv.emit(this.mesaEnUso))})},this.getNotasGenerales=()=>{this.dialog.open(Ye,{width:"50%",data:{notasGenerales:this.mesaEnUso.notas_generales||""}}).afterClosed().subscribe(t=>{null!==t&&t.trim().length>0&&this.comandaSrvc.saveNotasGenerales({comanda:this.mesaEnUso.comanda,notas_generales:t}).subscribe(e=>{e.exito?(this.mesaEnUso.notas_generales=t,this.snackBar.open(e.mensaje,"Comanda",{duration:3e3})):this.snackBar.open(`ERROR: ${e.mensaje}`,"Comanda",{duration:7e3})})})},this.nuevaCuenta=()=>{this.dialog.open(Ze,{width:"50%",data:{mesaEnUso:this.mesaEnUso}}).afterClosed().subscribe(t=>{t&&this.closeSideNavEv.emit()})},this.distribuirProductos=()=>{this.dialog.open(aa,{width:"50%",data:{mesaEnUso:this.mesaEnUso,lstProductos:this.lstProductosSeleccionados||[]}}).afterClosed().subscribe(t=>{t&&this.closeSideNavEv.emit()})}}ngOnInit(){this.resetMesaEnUso(),this.resetLstProductosSeleccionados(),this.resetLstProductosDeCuenta(),this.resetCuentaActiva(),this.impreso=0,this.noComanda=this.mesaEnUso.comanda||0,this.llenaProductosSeleccionados(),this.ls.get(X.b.usrTokenVar).sede_uuid&&(this.socket.emit("joinRestaurant",this.ls.get(X.b.usrTokenVar).sede_uuid),this.socket.on("reconnect",()=>this.socket.emit("joinRestaurant",this.ls.get(X.b.usrTokenVar).sede_uuid))),this.usaCodigoBarras=this.configSrvc.getConfig(X.b.CONSTANTES.RT_USA_CODIGO_BARRAS),this.imprimeRecetaEnComanda=this.configSrvc.getConfig(X.b.CONSTANTES.RT_IMPRIME_RECETA_EN_COMANDA)}setSelectedCuenta(t){this.bloqueoBotones=!0,this.cuentaActiva=this.mesaEnUso.cuentas.find(e=>+e.numero==+t),this.setLstProductosDeCuenta(),this.bloqueoBotones=!1}setSumaCuenta(t){let e=0;for(const a of t)e+=a.precio*a.cantidad;this.sumCuenta=e}setLstProductosDeCuenta(){var t;const e=(null===(t=this.cuentaActiva)||void 0===t?void 0:t.numero)||1;this.lstProductosDeCuenta=this.lstProductosSeleccionados.filter(t=>+t.cuenta==+e)}agregarProductos(t){1==+t.combo||1==+t.multiple?(this.bloqueoBotones=!0,this.dialog.open(Je,{maxWidth:"50%",data:new Ke(t,"S\xed","No")}).afterClosed().subscribe(t=>{t&&t.respuesta&&t.seleccion.receta.length>0?this.comandaSrvc.saveDetalleCombo(this.mesaEnUso.comanda,this.cuentaActiva.cuenta,t.seleccion).subscribe(t=>{t.exito?(this.mesaEnUso=t.comanda,this.llenaProductosSeleccionados(this.mesaEnUso),this.setSelectedCuenta(+this.cuentaActiva.numero)):this.snackBar.open(`ERROR:${t.mensaje}`,"Comanda",{duration:3e3}),this.bloqueoBotones=!1}):(this.bloqueoBotones=!1,this.snackBar.open("Error, Debe seleccionar los productos del combo","Comanda",{duration:7e3}))})):this.addProductoSelected(t)}addProductoSelected(t){if(this.bloqueoBotones=!0,+this.cuentaActiva.numero){const e=this.lstProductosSeleccionados.findIndex(e=>+e.id==+t.id&&+e.cuenta==+this.cuentaActiva.numero&&0==+e.impreso);if(e<0)this.detalleComanda={articulo:t.id,cantidad:1,precio:+t.precio,total:1*+t.precio,notas:""},this.comandaSrvc.saveDetalle(this.mesaEnUso.comanda,this.cuentaActiva.cuenta,this.detalleComanda).subscribe(t=>{t.exito?(this.mesaEnUso=t.comanda,this.llenaProductosSeleccionados(this.mesaEnUso),this.setSelectedCuenta(+this.cuentaActiva.numero)):this.snackBar.open(`ERROR:${t.mensaje}`,"Comanda",{duration:3e3}),this.bloqueoBotones=!1});else{const t=this.lstProductosSeleccionados[e];this.detalleComanda={detalle_cuenta:t.detalle_cuenta,detalle_comanda:t.detalle_comanda,articulo:t.id,cantidad:+t.cantidad+1,precio:+t.precio,total:(+t.cantidad+1)*+t.precio,notas:t.notas},this.comandaSrvc.saveDetalle(this.mesaEnUso.comanda,this.cuentaActiva.cuenta,this.detalleComanda).subscribe(t=>{t.exito?(this.mesaEnUso=t.comanda,this.llenaProductosSeleccionados(this.mesaEnUso),this.setSelectedCuenta(+this.cuentaActiva.numero)):this.snackBar.open(`ERROR:${t.mensaje}`,"Comanda",{duration:3e3}),this.bloqueoBotones=!1})}this.setLstProductosDeCuenta()}}updProductosCuenta(t){const e=t.listaProductos||[],a=this.lstProductosSeleccionados.filter(t=>+t.cuenta!=+this.cuentaActiva.numero);this.lstProductosSeleccionados=e.length>0?a.concat(e):a,t.comanda&&(this.mesaEnUso=t.comanda,this.llenaProductosSeleccionados(this.mesaEnUso),this.setSelectedCuenta(+this.cuentaActiva.numero))}prepProductosComanda(t){const e=[];for(let a=0;a<t.length;a++)e.push({articulo:t[a].id,cantidad:t[a].cantidad,precio:t[a].precio,total:t[a].total,notas:t[a].notas,impreso:1,detalle_comanda:t[a].detalle_comanda,detalle_cuenta:t[a].detalle_cuenta});return e}validarImpresion(t=!1){const e=this.configSrvc.getConfig(X.b.CONSTANTES.RT_INGRESO_NUMERO_PEDIDO);if(1==+this.mesaEnUso.mesa.esmostrador&&e&&!this.mesaEnUso.numero_pedido){let e=this.configSrvc.getConfig(X.b.CONSTANTES.RT_TOTAL_NUMEROS_PEDIDO);(!e||e<=0)&&(e=30),this.dialog.open(je,{maxWidth:"50%",data:new Be("Numero de Pedido",e,"S\xed","No")}).afterClosed().subscribe(e=>{e&&e.respuesta&&e.pedido?(this.mesaEnUso.numero_pedido=e.pedido,this.printComanda(t)):this.snackBar.open("Error, Debe seleccionar un numero de pedido","Comanda",{duration:7e3})})}else this.printComanda(t)}printComanda(t=!1){const e=JSON.parse(JSON.stringify(this.mesaEnUso));this.bloqueoBotones=!0,this.impreso=0;const a=this.configSrvc.getConfig(X.b.CONSTANTES.RT_MODO_COMANDA)||1;for(let o=0;o<e.cuentas.length;o++){const n=e.cuentas[o];this.cuentaActiva=e.cuentas.find(t=>+t.numero==+n.numero);const i=this.lstProductosSeleccionados.filter(t=>+t.cuenta==+this.cuentaActiva.numero),s=i.filter(t=>0==+t.impreso&&+t.cantidad>0);s.length>0?(i.map(t=>t.impreso=1),this.noComanda=e.comanda,this.cuentaActiva.productos=this.prepProductosComanda(i),e.cuentas.findIndex(t=>+t.cuenta==+this.cuentaActiva.cuenta)>-1&&this.comandaSrvc.save({area:e.mesa.area.area,mesa:e.mesa.mesa,mesero:e.mesero.usuario,comanda:e.comanda,cuentas:e.cuentas,numero_pedido:e.numero_pedido}).subscribe(o=>{o.exito?(e.numero_pedido=o.comanda.numero_pedido,this.comandaSrvc.setProductoImpreso(n.cuenta).subscribe(o=>{o.exito&&this.impreso++,this.llenaProductosSeleccionados(o.comanda),this.setSelectedCuenta(n.numero),this.snackBar.open("Cuenta actualizada",`Cuenta #${n.numero}`,{duration:3e3});let i=[],c=[];try{i=s.filter(t=>0==+t.impresora.bluetooth),c=s.filter(t=>1==+t.impresora.bluetooth)}catch(r){console.log("PRODUCTOS A IMPRIMIR = ",s),console.log("NORMAL = ",i),console.log("BT = ",c),console.log(r)}t?this.printComandaPDF():(i.length>0&&(3!==a?(this.imprimeRecetaEnComanda||i.map(t=>(0==+t.combo&&1==+t.esreceta&&(t.detalle=[]),t)),this.socket.emit("print:comanda",`${JSON.stringify({Tipo:"Comanda",Nombre:this.cuentaActiva.nombre,Numero:this.noComanda,DetalleCuenta:i,Ubicacion:`${e.mesa.area.nombre} - Mesa ${e.mesa.etiqueta||e.mesa.numero}`,Mesero:`${e.mesero.nombres} ${e.mesero.apellidos}`,Total:null,NumeroPedido:e.numero_pedido,NotasGenerales:e.notas_generales||""})}`),this.snackBar.open(`Imprimiendo comanda #${this.noComanda}`,"Comanda",{duration:7e3})):this.snackBar.open(`Comanda #${this.noComanda} enviada a cocina`,"Comanda",{duration:7e3}),this.bloqueoBotones=!1),c.length>0&&3!==a&&(this.imprimeRecetaEnComanda||c.map(t=>(0==+t.combo&&1==+t.esreceta&&(t.detalle=[]),t)),this.printToBT(JSON.stringify({Tipo:"Comanda",Nombre:this.cuentaActiva.nombre,Numero:this.noComanda,DetalleCuenta:c,Ubicacion:`${e.mesa.area.nombre} - Mesa ${e.mesa.etiqueta||e.mesa.numero}`,Mesero:`${e.mesero.nombres} ${e.mesero.apellidos}`,Total:null,NumeroPedido:e.numero_pedido})))),+this.impreso===e.cuentas.length&&(this.impreso=0,this.socket.emit("refrescar:mesa",{mesaenuso:e}),this.socket.emit("refrescar:listaCocina",{mesaenuso:e}),0==+e.mesa.esmostrador?this.closeSideNavEv.emit():this.cobrarCuenta())})):this.snackBar.open(`ERROR: ${o.mensaje}`,`Cuenta #${this.cuentaActiva.numero}`,{duration:3e3}),this.bloqueoBotones=!1})):(this.impreso++,this.bloqueoBotones=!1)}}printCuenta(){if(this.bloqueoBotones=!0,this.lstProductosAImprimir=this.lstProductosDeCuenta.filter(t=>1==+t.impreso),this.lstProductosAImprimir.length>0){this.setSumaCuenta(this.lstProductosAImprimir);const t=this.sumaDetalle(this.lstProductosAImprimir),e=this.mesaEnUso.mesa.impresora||this.mesaEnUso.mesa.area.impresora,a=this.configSrvc.getConfig(X.b.CONSTANTES.RT_IMPRIME_PROPINA_SUGERIDA),o={Tipo:"Cuenta",Nombre:this.cuentaActiva.nombre,Numero:null,DetalleCuenta:this.lstProductosAImprimir,Total:t,Empresa:this.ls.get(X.b.usrTokenVar).empresa,Restaurante:this.ls.get(X.b.usrTokenVar).restaurante,PropinaSugerida:a?(.1*t).toFixed(2):null,Impresora:e,Ubicacion:`${this.mesaEnUso.mesa.area.nombre} - Mesa ${this.mesaEnUso.mesa.etiqueta||this.mesaEnUso.mesa.numero} - Comanda ${this.mesaEnUso.comanda}`,Mesero:`${this.mesaEnUso.mesero.nombres} ${this.mesaEnUso.mesero.apellidos}`};0==+e.bluetooth?this.socket.emit("print:cuenta",`${JSON.stringify(o)}`):this.printToBT(JSON.stringify(o)),this.snackBar.open(`Imprimiendo cuenta de ${this.cuentaActiva.nombre}`,"Cuenta",{duration:7e3}),this.closeSideNavEv.emit()}else this.snackBar.open(`La cuenta de ${this.cuentaActiva.nombre} no tiene ning\xfan art\xedculo.`,"Cuenta",{duration:7e3});this.bloqueoBotones=!1}unirCuentas(){this.dialog.open(oe,{width:"55%",data:{lstProductosSeleccionados:this.lstProductosSeleccionados,mesaEnUso:this.mesaEnUso}}).afterClosed().subscribe(t=>{t&&this.closeSideNavEv.emit()})}cobrarCuenta(){this.comandaSrvc.getCuenta(this.cuentaActiva.cuenta).subscribe(t=>{if(t.pendiente.length>0)this.snackBar.open("Cobro","Tiene productos sin comandar",{duration:3e3});else{const t=this.lstProductosDeCuenta.filter(t=>1==+t.impreso);t.length>0?this.dialog.open(Re,{width:"95%",data:{mesaenuso:this.mesaEnUso,cuenta:this.cuentaActiva.nombre,idcuenta:this.cuentaActiva.cuenta,productosACobrar:t,porcentajePropina:0,impresora:0==+this.mesaEnUso.mesa.esmostrador?this.mesaEnUso.mesa.area.impresora_factura||null:this.mesaEnUso.mesa.impresora||this.mesaEnUso.mesa.area.impresora,clientePedido:this.clientePedido}}).afterClosed().subscribe(t=>{t&&"closePanel"!==t?(this.cambiarEstatusCuenta(t),this.closeSideNavEv.emit(this.mesaEnUso)):"closePanel"===t&&this.closeSideNavEv.emit()}):this.snackBar.open("Cobro","Sin productos a cobrar.",{duration:3e3})}})}}return t.\u0275fac=function(e){return new(e||t)(W.Nb(D.b),W.Nb(M.b),W.Nb(te),W.Nb(he.a),W.Nb(ot.a),W.Nb(ba.a),W.Nb(fe.a),W.Nb(He.a))},t.\u0275cmp=W.Hb({type:t,selectors:[["app-tran-comanda"]],viewQuery:function(t,e){if(1&t&&(W.Kc(Qa,1),W.Kc(Xa,1)),2&t){let t;W.sc(t=W.cc())&&(e.appLstProdAlt=t.first),W.sc(t=W.cc())&&(e.txtCodigoBarras=t.first)}},inputs:{mesaEnUso:"mesaEnUso",clientePedido:"clientePedido"},outputs:{closeSideNavEv:"closeSideNavEv",mesaSavedEv:"mesaSavedEv"},decls:43,vars:19,consts:[["fxLayout","row","fxLayout.xs","column"],["fxFlex","50%","fxFelx.xs","100%","fxLayoutAlign","center start"],["class","bld","style","font-size: 16pt; margin-left: 10px;",4,"ngIf"],["fxFlex","50%","fxFelx.xs","100%","fxLayoutAlign","end start"],["mat-raised-button","","type","button","color","accent",2,"margin-left","8px",3,"disabled","click"],[1,"divFullSize"],[1,"row"],["class","col m12 s12","align","center","style","padding: 0 !important;",4,"ngIf"],["align","center",1,"col","m6","s12",2,"padding","0 !important"],[1,"bld"],["class","fullWidth","style","margin-left: 10px; margin-right: 10px;",4,"ngIf"],[4,"ngIf"],[4,"ngFor","ngForOf"],["class","bld",4,"ngIf"],["align","center"],["direction","down"],["mat-fab","","color","warn"],[2,"font-size","18pt !important"],["mat-mini-fab","","type","button","color","warn",1,"btnAccion","btnAccionComanda",3,"disabled","click"],["mat-mini-fab","","type","button","color","warn","class","btnAccion btnAccionComanda",3,"disabled","click",4,"ngIf"],["mat-mini-fab","","type","button","color","warn","class","btnAccionComanda",3,"click",4,"ngIf"],[1,"col","m6","s12","mat-elevation-z3","colProductos"],[3,"bloqueoBotones","productoClickedEv","categoriasFilledEv"],["appLstProdAlt",""],[3,"listaProductos","noCuenta","IdComanda","IdCuenta","bloqueoBotones","mesaEnUso","productoRemovedEv",4,"ngIf"],[1,"bld",2,"font-size","16pt","margin-left","10px"],["align","center",1,"col","m12","s12",2,"padding","0 !important"],["mat-raised-button","","type","button","color","accent","class","btnAccion",3,"disabled","click",4,"ngFor","ngForOf"],["mat-raised-button","","type","button","class","btnAccion",3,"click",4,"ngIf"],["mat-raised-button","","type","button","color","accent",1,"btnAccion",3,"disabled","click"],["mat-raised-button","","type","button",1,"btnAccion",3,"click"],[1,"fullWidth",2,"margin-left","10px","margin-right","10px"],["matInput","","cdkFocusInitial","","ngxBarCodePut","","type","text","placeholder","C\xf3digo","name","codigoBarras",3,"ngModel","ngModelOptions","ngModelChange","onDetected"],["txtCodigoBarras","matInput"],["mat-raised-button","","class","btnAccion","color","accent",3,"disabled","click",4,"ngIf"],["mat-raised-button","","color","accent",1,"btnAccion",3,"disabled","click"],["mat-mini-fab","","type","button","color","warn",1,"btnAccionComanda",3,"click"],[3,"listaProductos","noCuenta","IdComanda","IdCuenta","bloqueoBotones","mesaEnUso","productoRemovedEv"]],template:function(t,e){1&t&&(W.Tb(0,"div",0),W.Tb(1,"div",1),W.Dc(2,Ya,2,3,"span",2),W.Sb(),W.Tb(3,"div",3),W.Tb(4,"button",4),W.bc("click",function(){return e.closeSideNavEv.emit()}),W.Fc(5," Cerrar Panel "),W.Sb(),W.Sb(),W.Sb(),W.Tb(6,"div",5),W.Tb(7,"div",6),W.Dc(8,eo,3,2,"div",7),W.Sb(),W.Tb(9,"div",6),W.Tb(10,"div",8),W.Tb(11,"span",9),W.Fc(12,"Productos"),W.Sb(),W.Ob(13,"br"),W.Dc(14,oo,3,3,"mat-form-field",10),W.Dc(15,no,1,0,"br",11),W.Dc(16,so,2,1,"ng-container",12),W.Sb(),W.Tb(17,"div",8),W.Dc(18,co,2,1,"span",13),W.Dc(19,ro,2,0,"span",13),W.Tb(20,"div",14),W.Tb(21,"eco-fab-speed-dial",15),W.Tb(22,"eco-fab-speed-dial-trigger"),W.Tb(23,"button",16),W.Tb(24,"mat-icon",17),W.Fc(25,"keyboard_arrow_down"),W.Sb(),W.Sb(),W.Sb(),W.Tb(26,"eco-fab-speed-dial-actions"),W.Tb(27,"button",18),W.bc("click",function(){return e.getNotasGenerales()}),W.Fc(28," Notas "),W.Sb(),W.Dc(29,lo,2,1,"button",19),W.Dc(30,uo,2,1,"button",19),W.Dc(31,bo,2,1,"button",19),W.Dc(32,mo,2,1,"button",19),W.Dc(33,ho,2,1,"button",19),W.Dc(34,po,2,1,"button",19),W.Dc(35,fo,2,1,"button",19),W.Dc(36,go,2,1,"button",20),W.Sb(),W.Sb(),W.Sb(),W.Sb(),W.Sb(),W.Tb(37,"div",6),W.Tb(38,"div",21),W.Tb(39,"app-lista-producto-alt",22,23),W.bc("productoClickedEv",function(t){return e.agregarProductos(t)})("categoriasFilledEv",function(t){return e.setListaCategorias(t)}),W.Sb(),W.Sb(),W.Tb(41,"div",21),W.Dc(42,So,1,6,"app-lista-productos-comanda",24),W.Sb(),W.Sb(),W.Sb()),2&t&&(W.Cb(2),W.lc("ngIf",e.mesaEnUso),W.Cb(2),W.lc("disabled",e.bloqueoBotones),W.Cb(4),W.lc("ngIf",e.mesaEnUso),W.Cb(6),W.lc("ngIf",e.usaCodigoBarras),W.Cb(1),W.lc("ngIf",e.usaCodigoBarras),W.Cb(1),W.lc("ngForOf",e.categorias),W.Cb(2),W.lc("ngIf",e.cuentaActiva&&e.cuentaActiva.nombre),W.Cb(1),W.lc("ngIf",!e.cuentaActiva||!e.cuentaActiva.nombre),W.Cb(8),W.lc("disabled",e.bloqueoBotones),W.Cb(2),W.lc("ngIf",e.cuentaActiva&&e.mesaEnUso&&0==+e.mesaEnUso.mesa.escallcenter),W.Cb(1),W.lc("ngIf",e.cuentaActiva&&e.mesaEnUso&&0==+e.mesaEnUso.mesa.esmostrador),W.Cb(1),W.lc("ngIf",e.mesaEnUso&&0==+e.mesaEnUso.mesa.esmostrador),W.Cb(1),W.lc("ngIf",e.mesaEnUso&&0==+e.mesaEnUso.mesa.esmostrador),W.Cb(1),W.lc("ngIf",e.cuentaActiva&&e.mesaEnUso&&0==+e.mesaEnUso.mesa.escallcenter),W.Cb(1),W.lc("ngIf",e.cuentaActiva&&e.mesaEnUso&&1==+e.mesaEnUso.mesa.escallcenter),W.Cb(1),W.lc("ngIf",e.mesaEnUso&&0==+e.mesaEnUso.mesa.esmostrador),W.Cb(1),W.lc("ngIf",e.mesaEnUso&&e.lstProductosSeleccionados.length<=0),W.Cb(3),W.lc("bloqueoBotones",e.bloqueoBotones),W.Cb(3),W.lc("ngIf",e.mesaEnUso&&e.cuentaActiva))},directives:[Ue.c,Ue.a,Ue.b,o.m,v.a,o.l,R.b,R.d,b.a,R.a,Ja,m.b,h.b,i.c,V,i.k,i.n,wa],styles:[".divFullSize[_ngcontent-%COMP%]{width:100%;height:100%;overflow-y:hidden}.col[_ngcontent-%COMP%]{padding-top:1px;padding-bottom:1px}.btnAccionComanda[_ngcontent-%COMP%]{width:135px}.colProductos[_ngcontent-%COMP%]{overflow-y:auto;height:450px!important}@media (max-width:400px){.colProductos[_ngcontent-%COMP%]{height:300px!important}}@media (min-width:401px) and (max-width:1024px){.colProductos[_ngcontent-%COMP%]{height:450px!important}}@media (min-height:985px){.colProductos[_ngcontent-%COMP%]{height:600px!important}}@media (max-height:768px){.colProductos[_ngcontent-%COMP%]{height:400px!important}}"]}),t})();const To=["matTabArea"],vo=["rightSidenav"],Mo=["tabArea"],Fo=["snTranComanda"];function xo(t,e){if(1&t){const t=W.Ub();W.Tb(0,"app-mesa",12),W.bc("onClickMesa",function(e){W.xc(t);const a=W.fc(2);return!a.cargando&&a.onClickMesa(e)}),W.Sb()}if(2&t){const t=e.$implicit,a=W.fc(2);W.lc("configuracion",t)("isDisabled",a.cargando)}}function ko(t,e){if(1&t){const t=W.Ub();W.Tb(0,"mat-tab",7,8),W.Tb(2,"div",9,10),W.bc("resize",function(e){return W.xc(t),W.fc().onResize(e)},!1,W.wc),W.Dc(4,xo,1,2,"app-mesa",11),W.Sb(),W.Sb()}if(2&t){const t=e.$implicit;W.mc("label",t.nombre),W.Cb(4),W.lc("ngForOf",t.mesas)}}let Oo=(()=>{class t{constructor(t,e,a,o,n,i,s){this.dialog=t,this.snackBar=e,this.ls=a,this.areaSrvc=o,this.comandaSrvc=n,this.configSrvc=i,this.socket=s,this.divSize={h:0,w:0},this.cargando=!1,this.lstTabsAreas=[],this.lstTabsAreasForUpdate=[],this.configTipoPantalla=1,this.clientePedido=null,this.endSubs=new de.a,this.actualizar=()=>{const t=this.lstTabsAreas.find(t=>+t.area==+this.mesaSeleccionada.mesa.area.area),e=this.lstTabsAreas.findIndex(t=>+t.area==+this.mesaSeleccionada.mesa.area.area),a=t.mesas.findIndex(t=>+t.mesa==+this.mesaSeleccionada.mesa.mesa);this.lstTabsAreas[e].mesas[a].estatus=1,this.toggleRightSidenav()},this.resetMesaSeleccionada=()=>this.mesaSeleccionada={comanda:null,usuario:null,sede:null,estatus:null,mesa:{mesa:null,area:{area:null,sede:null,area_padre:null,nombre:null},numero:null,posx:null,posy:null,tamanio:null,estatus:null},cuentas:[]},this.loadAreas=(t=!1,e={})=>{this.cargando=!0,this.endSubs.add(this.areaSrvc.get({sede:+this.ls.get(X.b.usrTokenVar).sede||0}).subscribe(a=>{t?(this.lstTabsAreasForUpdate=a,this.updateTableStatus(e.mesaenuso)):(this.lstTabsAreas=a,this.cargando=!1)}))},this.updateTableStatus=(t={})=>{for(const e of this.lstTabsAreasForUpdate)for(const t of e.mesas)this.setEstatusMesa({area:+e.area,mesa:+t.mesa},+t.estatus);this.cargando=!1,this.rightSidenav.opened&&+this.mesaSeleccionada.comanda==+t.comanda&&this.toggleRightSidenav()},this.onResize=t=>this.setDivSize(),this.aperturaCargaMesa=t=>{switch(+t.mesaSelected.estatus){case 1:this.openAbrirMesaDialog(t.mesaSelected);break;case 2:this.loadComandaMesa(t.mesaSelected)}},this.setEstatusMesa=(t,e)=>{const a=this.lstTabsAreas.findIndex(e=>+e.area==+t.area);if(a>-1){const o=this.lstTabsAreas[a].mesas.findIndex(e=>+e.mesa==+t.mesa);o>-1&&(this.lstTabsAreas[a].mesas[o].estatus=e)}},this.guardarMesa=t=>{this.endSubs.add(this.comandaSrvc.save(this.mesaSeleccionadaToOpen).subscribe(e=>{if(this.cargando=!1,e.exito)switch(this.socket.emit("refrescar:mesa",{}),this.mesaSeleccionada=e.comanda,this.setEstatusMesa(t,+e.comanda.mesa.estatus),this.snTrancomanda.llenaProductosSeleccionados(this.mesaSeleccionada),this.snTrancomanda.setSelectedCuenta(this.mesaSeleccionada.cuentas[0].numero),this.snTrancomanda.rolesUsuario=this.mesaSeleccionada.turno_rol,this.configTipoPantalla){case 1:this.toggleRightSidenav();break;case 2:this.openTranComandaAlt();break;default:this.toggleRightSidenav()}else this.snackBar.open(`${e.mensaje}`,"ERROR",{duration:5e3})}))},this.toggleRightSidenav=(t=null)=>{this.rightSidenav.toggle().then(e=>{"close"===e?t?this.loadAreas(!0,{mesaenuso:t}):this.cargando=!1:"open"===e&&1===this.mesaSeleccionada.cuentas.length&&this.snTrancomanda.setSelectedCuenta(this.mesaSeleccionada.cuentas[0].numero)})},this.cerrandoRightSideNav=()=>{this.snTrancomanda.resetMesaEnUso(),this.snTrancomanda.resetLstProductosDeCuenta(),this.snTrancomanda.resetLstProductosSeleccionados(),this.snTrancomanda.resetCuentaActiva(),this.snTrancomanda.resetListadoArticulos(),this.checkEstatusMesa(),this.resetMesaSeleccionada()},this.msnOpenedChange=t=>{t||this.cerrandoRightSideNav()},this.checkEstatusMesa=()=>{this.mesaSeleccionada&&this.mesaSeleccionada.cuentas&&this.mesaSeleccionada.cuentas.length>0&&0===(this.mesaSeleccionada.cuentas.filter(t=>0==+t.cerrada).length||0)&&this.setEstatusMesa({area:this.mesaSeleccionada.mesa.area.area,mesa:this.mesaSeleccionada.mesa.mesa},1)},this.fuerzaCierreComanda=t=>{this.endSubs.add(this.comandaSrvc.cerrarEstacion(this.mesaSeleccionada.comanda).subscribe(e=>{this.loadComandaMesa(this.mesaSeleccionada.mesa,t)}))},this.openTranComandaAlt=()=>{const t=this.dialog.open(za,{maxWidth:"100vw",maxHeight:"85vh",width:"99vw",height:"85vh",disableClose:!0,data:{mesa:this.mesaSeleccionada}});this.endSubs.add(t.afterClosed().subscribe(t=>{this.checkEstatusMesa(),t?this.loadAreas(!0,{mesaenuso:t}):this.cargando=!1}))},this.loadComandaMesa=(t,e=!0)=>{e&&this.cargando?this.snackBar.open("El sistema est\xe1 terminando de cargar informaci\xf3n. Por favor intente de nuevo.","\xc1reas",{duration:5e3}):(this.cargando=!0,this.endSubs.add(this.comandaSrvc.getComandaDeMesa(t.mesa).subscribe(t=>{if(t.exito)if(Array.isArray(t)?(0===t.length&&(this.mesaSeleccionada={mesa:this.mesaSeleccionada.mesa,cuentas:[{cerrada:1}]}),this.checkEstatusMesa()):(this.mesaSeleccionada=t,this.snTrancomanda.rolesUsuario=this.mesaSeleccionada.turno_rol),this.checkEstatusMesa(),e)switch(this.snTrancomanda.llenaProductosSeleccionados(this.mesaSeleccionada),this.configTipoPantalla){case 1:this.toggleRightSidenav();break;case 2:this.openTranComandaAlt();break;default:this.toggleRightSidenav()}else this.checkEstatusMesa(),this.cargando=!1;else t.mensaje&&this.snackBar.open(`${t.mensaje}`,"ERROR",{duration:5e3}),Array.isArray(t)&&0===t.length&&(this.mesaSeleccionada={mesa:this.mesaSeleccionada.mesa,cuentas:[{cerrada:1}]}),this.checkEstatusMesa(),this.cargando=!1;this.checkEstatusMesa()})))}}ngOnInit(){this.loadAreas(),this.resetMesaSeleccionada(),this.ls.get(X.b.usrTokenVar).sede_uuid&&(this.socket.emit("joinRestaurant",this.ls.get(X.b.usrTokenVar).sede_uuid),this.socket.on("reconnect",()=>this.socket.emit("joinRestaurant",this.ls.get(X.b.usrTokenVar).sede_uuid)),this.socket.on("refrescar:mesa",t=>{this.loadAreas(!0,t)})),this.configTipoPantalla=this.configSrvc.getConfig(X.b.CONSTANTES.RT_PANTALLA_TOMA_COMANDA)}ngAfterViewInit(){setTimeout(()=>{this.setDivSize(),this.snTrancomanda.resetMesaEnUso()},600)}ngOnDestroy(){this.endSubs.unsubscribe()}setDivSize(){}onClickMesa(t){if(this.cargando)this.snackBar.open("El sistema est\xe1 terminando de cargar informaci\xf3n. Por favor intente de nuevo.","\xc1reas",{duration:5e3});else if(0==+t.mesaSelected.escallcenter)this.aperturaCargaMesa(t);else{const e=`${X.b.rtClientePedido}_${t.mesaSelected.mesa}`;if(1==+t.mesaSelected.estatus){this.ls.clear(e);const a=this.dialog.open(Bt,{width:"50%",disableClose:!0,data:{mesa:t.mesaSelected}});this.endSubs.add(a.afterClosed().subscribe(a=>{a&&(this.clientePedido=a,this.ls.set(e,this.clientePedido),this.aperturaCargaMesa(t))}))}else this.clientePedido=this.ls.get(e),this.aperturaCargaMesa(t)}}openAbrirMesaDialog(t){var e;if(this.cargando=!0,this.mesaSeleccionadaToOpen={nombreArea:this.tabArea.textLabel,area:+t.area,mesa:+t.mesa,numero:+t.numero,mesero:"",comensales:"1",comanda:0,esEvento:!1,dividirCuentasPorSillas:!1,estatus:1,clientePedido:this.clientePedido||null,cuentas:[{numero:1,nombre:(null===(e=this.clientePedido)||void 0===e?void 0:e.nombre)||"\xdanica",productos:[]}]},0==+t.esmostrador){const e=this.dialog.open(Zt,{width:"50%",height:"auto",disableClose:!0,data:this.mesaSeleccionadaToOpen});this.endSubs.add(e.afterClosed().subscribe(e=>{e?(this.mesaSeleccionadaToOpen=e,this.guardarMesa(t)):this.cargando=!1}))}else this.mesaSeleccionadaToOpen.mesero=this.ls.get(X.b.usrTokenVar).idusr,this.guardarMesa(t)}}return t.\u0275fac=function(e){return new(e||t)(W.Nb(D.b),W.Nb(M.b),W.Nb(ot.a),W.Nb(at),W.Nb(te),W.Nb(fe.a),W.Nb(he.a))},t.\u0275cmp=W.Hb({type:t,selectors:[["app-tran-areas"]],viewQuery:function(t,e){if(1&t&&(W.Kc(To,1),W.Kc(vo,1),W.Kc(Mo,1),W.Kc(Fo,1)),2&t){let t;W.sc(t=W.cc())&&(e.pestania=t.first),W.sc(t=W.cc())&&(e.rightSidenav=t.first),W.sc(t=W.cc())&&(e.tabArea=t.first),W.sc(t=W.cc())&&(e.snTrancomanda=t.first)}},decls:8,vars:4,consts:[[1,"matSideNavContainer"],["mode","over","position","end","disableClose","",3,"opened","openedChange"],["rightSidenav",""],[3,"mesaEnUso","clientePedido","mesaSavedEv","closeSideNavEv"],["snTranComanda",""],["dynamicHeight","","backgroundColor","primary"],[3,"label",4,"ngFor","ngForOf"],[3,"label"],["tabArea",""],[1,"divAreaMesa",3,"resize"],["matTabArea",""],[3,"configuracion","isDisabled","onClickMesa",4,"ngFor","ngForOf"],[3,"configuracion","isDisabled","onClickMesa"]],template:function(t,e){1&t&&(W.Tb(0,"mat-sidenav-container",0),W.Tb(1,"mat-sidenav",1,2),W.bc("openedChange",function(t){return e.openedRightPanel=t})("openedChange",function(t){return e.msnOpenedChange(t)}),W.Tb(3,"app-tran-comanda",3,4),W.bc("mesaSavedEv",function(){return e.actualizar()})("closeSideNavEv",function(t){return e.toggleRightSidenav(t)}),W.Sb(),W.Sb(),W.Tb(5,"mat-sidenav-content"),W.Tb(6,"mat-tab-group",5),W.Dc(7,ko,5,2,"mat-tab",6),W.Sb(),W.Sb(),W.Sb()),2&t&&(W.Cb(1),W.lc("opened",e.openedRightPanel),W.Cb(2),W.lc("mesaEnUso",e.mesaSeleccionada)("clientePedido",e.clientePedido),W.Cb(4),W.lc("ngForOf",e.lstTabsAreas))},directives:[E.b,E.a,Co,E.c,g.b,o.l,g.a,ft],styles:[".matSideNavContainer[_ngcontent-%COMP%]{height:90%;overflow:hidden!important}.divAreaMesa[_ngcontent-%COMP%]{width:100vw;height:90vh;background-color:hsla(0,0%,78%,.28627450980392155)}mat-sidenav[_ngcontent-%COMP%]{width:97vw}  .mat-drawer-inner-container{overflow-y:auto!important;overflow-x:hidden!important}"]}),t})(),Do=(()=>{class t{constructor(t){this.http=t,this.moduleUrl="turno",this.srvcErrHndl=new Y.a}get(t={}){return this.http.get(`${X.b.urlMantenimientos}/${this.moduleUrl}/buscar?${et.stringify(t)}`).pipe(Object(Z.a)(X.b.reintentos),Object(tt.a)(this.srvcErrHndl.errorHandler))}save(t){return this.http.post(`${X.b.urlMantenimientos}/${this.moduleUrl}/guardar${t.turno?"/"+t.turno:""}`,t).pipe(Object(Z.a)(X.b.reintentos),Object(tt.a)(this.srvcErrHndl.errorHandler))}getDetalle(t,e={}){return this.http.get(`${X.b.urlMantenimientos}/${this.moduleUrl}/buscar_usuario/${t}?${et.stringify(e)}`).pipe(Object(Z.a)(X.b.reintentos),Object(tt.a)(this.srvcErrHndl.errorHandler))}saveDetalle(t){return this.http.post(`${X.b.urlMantenimientos}/${this.moduleUrl}/agregar_usuario/${t.turno}`,t).pipe(Object(Z.a)(X.b.reintentos),Object(tt.a)(this.srvcErrHndl.errorHandler))}anularDetalle(t){return this.http.post(`${X.b.urlMantenimientos}/${this.moduleUrl}/anular_usuario/${t.turno}`,t).pipe(Object(Z.a)(X.b.reintentos),Object(tt.a)(this.srvcErrHndl.errorHandler))}replicaDetalleTurno(t,e){return this.http.get(`${X.b.urlMantenimientos}/${this.moduleUrl}/replica_detalle_turno/${t}/${e}`).pipe(Object(Z.a)(X.b.reintentos),Object(tt.a)(this.srvcErrHndl.errorHandler))}}return t.\u0275fac=function(e){return new(e||t)(W.Xb(n.b))},t.\u0275prov=W.Jb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function Eo(t,e){if(1&t){const t=W.Ub();W.Tb(0,"mat-list-item",5),W.bc("click",function(){W.xc(t);const a=e.$implicit;return W.fc().getTurno(a)}),W.Tb(1,"mat-icon",6),W.Fc(2,"schedule"),W.Sb(),W.Tb(3,"h5",7),W.Fc(4),W.gc(5,"date"),W.Sb(),W.Ob(6,"br"),W.Tb(7,"p",7),W.Fc(8),W.gc(9,"date"),W.Sb(),W.Sb()}if(2&t){const t=e.$implicit;W.Cb(4),W.Hc("Inicio: ",W.ic(5,2,t.inicio,"dd/MM/yyyy HH:mm:ss"),""),W.Cb(4),W.Hc(" Fin: ",W.ic(9,5,t.fin,"dd/MM/yyyy HH:mm:ss")," ")}}const Po=function(){return{standalone:!0}};let _o=(()=>{class t{constructor(t,e){this.ls=t,this.turnoSrvc=e,this.getTurnoEv=new W.o,this.length=0,this.pageSize=5,this.pageSizeOptions=[5,10,15],this.pageIndex=0,this.txtFiltro="",this.loadTurnos=()=>{this.turnoSrvc.get({sede:+this.ls.get(X.b.usrTokenVar).sede||0}).subscribe(t=>{t&&t.length>0&&(this.lstTurnos=t,this.applyFilter())})},this.getTurno=t=>{this.getTurnoEv.emit({turno:t.turno,turno_tipo:t.turno_tipo.turno_tipo,fecha:t.fecha,inicio:t.inicio,fin:t.fin})},this.pageChange=t=>{this.pageSize=t.pageSize,this.pageIndex=t.pageIndex,this.applyFilter()}}ngOnInit(){this.loadTurnos()}applyFilter(){if(this.txtFiltro.length>0){const t=Object(X.c)(this.lstTurnos,this.txtFiltro);this.length=t.length,this.lstTurnosPaged=Object(X.f)(t,this.pageSize,this.pageIndex+1)}else this.length=this.lstTurnos.length,this.lstTurnosPaged=Object(X.f)(this.lstTurnos,this.pageSize,this.pageIndex+1)}}return t.\u0275fac=function(e){return new(e||t)(W.Nb(ot.a),W.Nb(Do))},t.\u0275cmp=W.Hb({type:t,selectors:[["app-lista-turno"]],outputs:{getTurnoEv:"getTurnoEv"},decls:7,vars:7,consts:[[1,"mat-elevation-z4","fullWidth"],[1,"fullWidth"],["matInput","","placeholder","Buscar...",3,"ngModel","ngModelOptions","keyup","ngModelChange"],[3,"click",4,"ngFor","ngForOf"],["showFirstLastButtons","",3,"length","pageSize","pageSizeOptions","page"],[3,"click"],["mat-list-icon",""],["mat-line",""]],template:function(t,e){1&t&&(W.Tb(0,"mat-card",0),W.Tb(1,"mat-card-content"),W.Tb(2,"mat-form-field",1),W.Tb(3,"input",2),W.bc("keyup",function(){return e.applyFilter()})("ngModelChange",function(t){return e.txtFiltro=t}),W.Sb(),W.Sb(),W.Tb(4,"mat-nav-list"),W.Dc(5,Eo,10,8,"mat-list-item",3),W.Sb(),W.Tb(6,"mat-paginator",4),W.bc("page",function(t){return e.pageChange(t)}),W.Sb(),W.Sb(),W.Sb()),2&t&&(W.Cb(3),W.lc("ngModel",e.txtFiltro)("ngModelOptions",W.nc(6,Po)),W.Cb(2),W.lc("ngForOf",e.lstTurnosPaged),W.Cb(1),W.lc("length",e.length)("pageSize",e.pageSize)("pageSizeOptions",e.pageSizeOptions))},directives:[p.a,p.c,m.b,h.b,i.c,i.k,i.n,u.e,o.l,O.a,u.c,b.a,u.b,_.j],pipes:[o.e],styles:[".fullWidth[_ngcontent-%COMP%], table[_ngcontent-%COMP%]{width:100%!important}"]}),t})();function yo(t,e){if(1&t){const t=W.Ub();W.Tb(0,"mat-list-item",8),W.bc("click",function(){W.xc(t);const e=W.fc().$implicit;return W.fc().turnoSelected=e}),W.Tb(1,"mat-icon",9),W.Fc(2,"schedule"),W.Sb(),W.Tb(3,"h5",10),W.Fc(4),W.gc(5,"date"),W.Sb(),W.Ob(6,"br"),W.Tb(7,"p",10),W.Fc(8),W.gc(9,"date"),W.Sb(),W.Sb()}if(2&t){const t=W.fc().$implicit;W.Cb(4),W.Hc("Inicio: ",W.ic(5,2,t.inicio,"dd/MM/yyyy HH:mm:ss"),""),W.Cb(4),W.Hc("Fin: ",W.ic(9,5,t.fin,"dd/MM/yyyy HH:mm:ss"),"")}}function Io(t,e){if(1&t&&(W.Rb(0),W.Dc(1,yo,10,8,"mat-list-item",7),W.Qb()),2&t){const t=e.$implicit,a=W.fc();W.Cb(1),W.lc("ngIf",+t.turno!=+a.data.turnoCopia.turno)}}function wo(t,e){if(1&t&&(W.Tb(0,"small"),W.Tb(1,"div"),W.Tb(2,"strong"),W.Fc(3),W.gc(4,"date"),W.gc(5,"date"),W.Sb(),W.Sb(),W.Sb()),2&t){const t=W.fc();W.Cb(3),W.Ic("Seleccion\xf3 el turno que inicia el ",W.ic(4,2,t.turnoSelected.inicio,"dd/MM/yyyy HH:mm:ss")," y finaliza el ",W.ic(5,5,t.turnoSelected.fin,"dd/MM/yyyy HH:mm:ss"),"")}}let Ao=(()=>{class t{constructor(t,e,a,o,n,i){this.dialogRef=t,this.data=e,this.ls=a,this.snackBar=o,this.turnoSrvc=n,this.dialog=i,this.lstTurnos=[],this.loadTurnos=()=>{this.lstTurnos=[],this.turnoSrvc.get({sede:+this.ls.get(X.b.usrTokenVar).sede||0}).subscribe(t=>{if(t&&t.length>0){const e=t.length>=11?11:t.length;for(let a=0;a<e;a++)this.lstTurnos.push(t[a])}})},this.cancelar=()=>this.dialogRef.close(),this.copiar=()=>{this.turnoSelected&&this.dialog.open(bt.a,{maxWidth:"400px",data:new bt.b("Detalle de turno","Esto copiar\xe1 el detalle del turno que seleccion\xf3. \xbfDesea continuar?","S\xed","No")}).afterClosed().subscribe(t=>{t&&this.turnoSrvc.replicaDetalleTurno(this.turnoSelected.turno,this.data.turnoCopia.turno).subscribe(t=>{t.exito?this.snackBar.open("Turno copiado con \xe9xito","Detalle turno",{duration:3e3}):this.snackBar.open(`ERROR: ${t.mensaje}`,"Detalle turno",{duration:7e3}),this.dialogRef.close()})})}}ngOnInit(){this.loadTurnos()}}return t.\u0275fac=function(e){return new(e||t)(W.Nb(D.f),W.Nb(D.a),W.Nb(ot.a),W.Nb(M.b),W.Nb(Do),W.Nb(D.b))},t.\u0275cmp=W.Hb({type:t,selectors:[["app-selecciona-turno-previo"]],decls:11,vars:3,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[4,"ngFor","ngForOf"],[4,"ngIf"],["mat-dialog-actions","","align","end"],["mat-raised-button","","type","button","color","warn",3,"click"],["mat-raised-button","","type","button","color","accent",3,"disabled","click"],[3,"click",4,"ngIf"],[3,"click"],["mat-list-icon",""],["mat-line",""]],template:function(t,e){1&t&&(W.Tb(0,"h1",0),W.Fc(1,"\xbfDe qu\xe9 turno quiere copiar el detalle?"),W.Sb(),W.Tb(2,"div",1),W.Tb(3,"mat-nav-list"),W.Dc(4,Io,2,1,"ng-container",2),W.Sb(),W.Dc(5,wo,6,8,"small",3),W.Sb(),W.Tb(6,"div",4),W.Tb(7,"button",5),W.bc("click",function(){return e.cancelar()}),W.Fc(8," Cancelar "),W.Sb(),W.Tb(9,"button",6),W.bc("click",function(){return e.copiar()}),W.Fc(10," Copiar "),W.Sb(),W.Sb()),2&t&&(W.Cb(4),W.lc("ngForOf",e.lstTurnos),W.Cb(1),W.lc("ngIf",e.turnoSelected),W.Cb(4),W.lc("disabled",!e.turnoSelected))},directives:[D.g,D.d,u.e,o.l,o.m,D.c,v.a,u.c,b.a,u.b,_.j],pipes:[o.e],styles:[""]}),t})(),No=(()=>{class t{constructor(t){this.http=t,this.moduleUrl="turno",this.srvcErrHndl=new Y.a}get(t={}){return this.http.get(`${X.b.urlMantenimientos}/${this.moduleUrl}/get_turno_tipo?${et.stringify(t)}`).pipe(Object(Z.a)(X.b.reintentos),Object(tt.a)(this.srvcErrHndl.errorHandler))}save(t){return this.http.post(`${X.b.urlMantenimientos}/${this.moduleUrl}/guardar_turno_tipo${t.turno_tipo?"/"+t.turno_tipo:""}`,t).pipe(Object(Z.a)(X.b.reintentos),Object(tt.a)(this.srvcErrHndl.errorHandler))}}return t.\u0275fac=function(e){return new(e||t)(W.Xb(n.b))},t.\u0275prov=W.Jb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),Ro=(()=>{class t{constructor(t){this.http=t,this.srvcErrHndl=new Y.a}get(t={}){return this.http.get(`${X.b.urlCatalogos}/get_tipo_usuario?${et.stringify(t)}`).pipe(Object(Z.a)(X.b.reintentos),Object(tt.a)(this.srvcErrHndl.errorHandler))}}return t.\u0275fac=function(e){return new(e||t)(W.Xb(n.b))},t.\u0275prov=W.Jb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function Uo(t,e){if(1&t){const t=W.Ub();W.Tb(0,"button",5),W.bc("click",function(){return W.xc(t),W.fc().showTurnoForm=!0}),W.Tb(1,"mat-icon",6),W.Fc(2,"expand_more"),W.Sb(),W.Sb()}}function $o(t,e){if(1&t){const t=W.Ub();W.Tb(0,"button",5),W.bc("click",function(){return W.xc(t),W.fc().showTurnoForm=!1}),W.Tb(1,"mat-icon",6),W.Fc(2,"expand_less"),W.Sb(),W.Sb()}}function Bo(t,e){if(1&t&&(W.Tb(0,"mat-option",20),W.Fc(1),W.Sb()),2&t){const t=e.$implicit;W.lc("value",t.turno_tipo),W.Cb(1),W.Hc(" ",t.descripcion," ")}}function jo(t,e){if(1&t){const t=W.Ub();W.Tb(0,"button",21),W.bc("click",function(){W.xc(t);const e=W.fc(2);return e.turno.inicio=e.getNow()}),W.Tb(1,"mat-icon",6),W.Fc(2,"query_builder"),W.Sb(),W.Sb()}}function Ho(t,e){if(1&t){const t=W.Ub();W.Tb(0,"button",22),W.bc("click",function(){return W.xc(t),W.fc(2).turno.inicio=null}),W.Tb(1,"mat-icon",6),W.Fc(2,"close"),W.Sb(),W.Sb()}}function Lo(t,e){if(1&t){const t=W.Ub();W.Tb(0,"button",21),W.bc("click",function(){W.xc(t);const e=W.fc(2);return e.turno.fin=e.getNow()}),W.Tb(1,"mat-icon",6),W.Fc(2,"query_builder"),W.Sb(),W.Sb()}}function qo(t,e){if(1&t){const t=W.Ub();W.Tb(0,"button",22),W.bc("click",function(){return W.xc(t),W.fc(2).turno.fin=null}),W.Tb(1,"mat-icon",6),W.Fc(2,"close"),W.Sb(),W.Sb()}}function zo(t,e){if(1&t){const t=W.Ub();W.Tb(0,"button",23),W.bc("click",function(){return W.xc(t),W.fc(2).resetTurno()}),W.Fc(1," Nuevo "),W.Sb()}}function Go(t,e){if(1&t&&(W.Tb(0,"li"),W.Fc(1),W.Sb()),2&t){const t=e.$implicit;W.Cb(1),W.Gc(t)}}function Wo(t,e){if(1&t&&(W.Tb(0,"li"),W.Fc(1),W.Sb()),2&t){const t=e.$implicit;W.Cb(1),W.Gc(t)}}function Vo(t,e){if(1&t&&(W.Tb(0,"div"),W.Tb(1,"h6"),W.Fc(2,"Documentos Pendientes"),W.Sb(),W.Tb(3,"div",24),W.Tb(4,"div",25),W.Tb(5,"label"),W.Tb(6,"b"),W.Fc(7,"Comandas sin facturar"),W.Sb(),W.Sb(),W.Tb(8,"ul"),W.Dc(9,Go,2,1,"li",26),W.Sb(),W.Sb(),W.Tb(10,"div",25),W.Tb(11,"label"),W.Tb(12,"b"),W.Fc(13,"Facturas sin firmar"),W.Sb(),W.Sb(),W.Tb(14,"ul"),W.Dc(15,Wo,2,1,"li",26),W.Sb(),W.Sb(),W.Sb(),W.Sb()),2&t){const t=W.fc(2);W.Cb(9),W.lc("ngForOf",t.comandas),W.Cb(6),W.lc("ngForOf",t.facturas)}}function Ko(t,e){if(1&t){const t=W.Ub();W.Tb(0,"form",7,8),W.bc("ngSubmit",function(){W.xc(t);const e=W.tc(1),a=W.fc();return e.form.valid&&a.onSubmit()}),W.Tb(2,"div",9),W.Tb(3,"mat-form-field",10),W.Tb(4,"mat-label"),W.Fc(5,"Tipo de turno"),W.Sb(),W.Tb(6,"mat-select",11),W.bc("ngModelChange",function(e){return W.xc(t),W.fc().turno.turno_tipo=e}),W.Dc(7,Bo,2,2,"mat-option",12),W.Sb(),W.Sb(),W.Sb(),W.Tb(8,"div",9),W.Tb(9,"mat-form-field",10),W.Tb(10,"input",13),W.bc("ngModelChange",function(e){return W.xc(t),W.fc().turno.inicio=e}),W.Sb(),W.Dc(11,jo,3,0,"button",14),W.Dc(12,Ho,3,0,"button",15),W.Sb(),W.Sb(),W.Tb(13,"div",9),W.Tb(14,"mat-form-field",10),W.Tb(15,"input",16),W.bc("ngModelChange",function(e){return W.xc(t),W.fc().turno.fin=e}),W.Sb(),W.Dc(16,Lo,3,0,"button",14),W.Dc(17,qo,3,0,"button",15),W.Sb(),W.Sb(),W.Tb(18,"div",17),W.Tb(19,"button",18),W.Fc(20," Guardar "),W.Sb(),W.Dc(21,zo,2,0,"button",19),W.Sb(),W.Dc(22,Vo,16,2,"div",3),W.Sb()}if(2&t){const t=W.tc(1),e=W.fc();W.Cb(6),W.lc("ngModel",e.turno.turno_tipo),W.Cb(1),W.lc("ngForOf",e.tiposTurno),W.Cb(3),W.lc("ngModel",e.turno.inicio),W.Cb(1),W.lc("ngIf",!e.turno.inicio),W.Cb(1),W.lc("ngIf",e.turno.inicio),W.Cb(3),W.lc("ngModel",e.turno.fin),W.Cb(1),W.lc("ngIf",!e.turno.fin),W.Cb(1),W.lc("ngIf",e.turno.fin),W.Cb(2),W.lc("disabled",!t.form.valid),W.Cb(2),W.lc("ngIf",e.turno.turno),W.Cb(1),W.lc("ngIf",e.pendientes)}}function Jo(t,e){1&t&&W.Ob(0,"hr")}function Qo(t,e){if(1&t){const t=W.Ub();W.Tb(0,"button",5),W.bc("click",function(){return W.xc(t),W.fc(2).showDetalleTurnoForm=!0}),W.Tb(1,"mat-icon",6),W.Fc(2,"expand_more"),W.Sb(),W.Sb()}}function Xo(t,e){if(1&t){const t=W.Ub();W.Tb(0,"button",5),W.bc("click",function(){return W.xc(t),W.fc(2).showDetalleTurnoForm=!1}),W.Tb(1,"mat-icon",6),W.Fc(2,"expand_less"),W.Sb(),W.Sb()}}function Yo(t,e){if(1&t&&(W.Tb(0,"mat-option",20),W.Fc(1),W.Sb()),2&t){const t=e.$implicit;W.lc("value",t.usuario_tipo),W.Cb(1),W.Hc(" ",t.descripcion," ")}}function Zo(t,e){if(1&t&&(W.Tb(0,"mat-option",20),W.Fc(1),W.Sb()),2&t){const t=e.$implicit;W.lc("value",t.usuario),W.Cb(1),W.Ic(" ",t.nombres," ",t.apellidos," ")}}function tn(t,e){if(1&t){const t=W.Ub();W.Tb(0,"form",7,28),W.bc("ngSubmit",function(){W.xc(t);const e=W.tc(1),a=W.fc(2);return e.form.valid&&a.onSubmitDetail()}),W.Tb(2,"div",9),W.Tb(3,"mat-form-field",10),W.Tb(4,"mat-label"),W.Fc(5,"Tipo"),W.Sb(),W.Tb(6,"mat-select",29),W.bc("ngModelChange",function(e){return W.xc(t),W.fc(2).detalleTurno.usuario_tipo=e}),W.Dc(7,Yo,2,2,"mat-option",12),W.Sb(),W.Sb(),W.Sb(),W.Tb(8,"div",9),W.Tb(9,"mat-form-field",10),W.Tb(10,"mat-label"),W.Fc(11,"Usuario"),W.Sb(),W.Tb(12,"mat-select",30),W.bc("ngModelChange",function(e){return W.xc(t),W.fc(2).detalleTurno.usuario=e}),W.Dc(13,Zo,2,3,"mat-option",12),W.Sb(),W.Sb(),W.Sb(),W.Tb(14,"div",31),W.Tb(15,"button",32),W.bc("click",function(){return W.xc(t),W.fc(2).copiaDetalleTurno()}),W.Fc(16," Copiar de turno anterior "),W.Sb(),W.Tb(17,"button",18),W.Fc(18," Guardar "),W.Sb(),W.Sb(),W.Sb()}if(2&t){const t=W.tc(1),e=W.fc(2);W.Cb(6),W.lc("ngModel",e.detalleTurno.usuario_tipo),W.Cb(1),W.lc("ngForOf",e.tiposUsuario),W.Cb(5),W.lc("ngModel",e.detalleTurno.usuario),W.Cb(1),W.lc("ngForOf",e.usuarios),W.Cb(2),W.lc("disabled",!!e.turno.fin),W.Cb(2),W.lc("disabled",!t.form.valid||!!e.turno.fin)}}function en(t,e){1&t&&W.Ob(0,"hr")}function an(t,e){1&t&&(W.Tb(0,"th",43),W.Fc(1,"Tipo"),W.Sb())}function on(t,e){if(1&t&&(W.Tb(0,"td",44),W.Fc(1),W.Sb()),2&t){const t=e.$implicit;W.Cb(1),W.Gc(t.usuario_tipo.descripcion)}}function nn(t,e){1&t&&(W.Tb(0,"th",45),W.Fc(1,"Usuario"),W.Sb())}function sn(t,e){if(1&t&&(W.Tb(0,"td",46),W.Fc(1),W.Sb()),2&t){const t=e.$implicit;W.Cb(1),W.Ic("",t.usuario.nombres," ",t.usuario.apellidos,"")}}function cn(t,e){1&t&&(W.Tb(0,"th",43),W.Fc(1,"\xa0"),W.Sb())}function rn(t,e){if(1&t){const t=W.Ub();W.Tb(0,"td",44),W.Tb(1,"button",47),W.bc("click",function(){W.xc(t);const a=e.$implicit;return W.fc(3).anularDetalleTurno(a)}),W.Fc(2," Anular "),W.Sb(),W.Sb()}if(2&t){const t=W.fc(3);W.Cb(1),W.lc("disabled",!!t.turno.fin)}}function ln(t,e){1&t&&W.Ob(0,"tr",48)}function dn(t,e){1&t&&W.Ob(0,"tr",49)}function un(t,e){if(1&t&&(W.Tb(0,"table",33),W.Rb(1,34),W.Dc(2,an,2,0,"th",35),W.Dc(3,on,2,1,"td",36),W.Qb(),W.Rb(4,37),W.Dc(5,nn,2,0,"th",38),W.Dc(6,sn,2,2,"td",39),W.Qb(),W.Rb(7,40),W.Dc(8,cn,2,0,"th",35),W.Dc(9,rn,3,1,"td",36),W.Qb(),W.Dc(10,ln,1,0,"tr",41),W.Dc(11,dn,1,0,"tr",42),W.Sb()),2&t){const t=W.fc(2);W.lc("dataSource",t.dataSource),W.Cb(10),W.lc("matHeaderRowDef",t.displayedColumns),W.Cb(1),W.lc("matRowDefColumns",t.displayedColumns)}}function bn(t,e){if(1&t&&(W.Tb(0,"mat-card",0),W.Tb(1,"mat-card-title"),W.Tb(2,"h4"),W.Fc(3),W.gc(4,"date"),W.Dc(5,Qo,3,0,"button",1),W.Dc(6,Xo,3,0,"button",1),W.Sb(),W.Sb(),W.Tb(7,"mat-card-content"),W.Dc(8,tn,19,6,"form",2),W.Dc(9,en,1,0,"hr",3),W.Dc(10,un,12,3,"table",27),W.Sb(),W.Sb()),2&t){const t=W.fc();W.Cb(3),W.Hc(" Detalle del turno ",W.ic(4,6,t.turno.inicio,"dd/MM/yyyy HH:mm:ss")," "),W.Cb(2),W.lc("ngIf",!t.showDetalleTurnoForm),W.Cb(1),W.lc("ngIf",t.showDetalleTurnoForm),W.Cb(2),W.lc("ngIf",t.showDetalleTurnoForm),W.Cb(1),W.lc("ngIf",t.detallesTurno.length>0),W.Cb(1),W.lc("ngIf",t.detallesTurno.length>0)}}let mn=(()=>{class t{constructor(t,e,a,o,n,i,s){this.snackBar=t,this.ls=e,this.tipoTurnoSrvc=a,this.turnoSrvc=o,this.usuarioTipoSrvc=n,this.usuarioSrvc=i,this.dialog=s,this.turnoSavedEv=new W.o,this.showTurnoForm=!0,this.showDetalleTurnoForm=!0,this.detallesTurno=[],this.displayedColumns=["usuario_tipo","usuario","editItem"],this.tiposTurno=[],this.tiposUsuario=[],this.usuarios=[],this.esMovil=!1,this.comandas=[],this.facturas=[],this.pendientes=!1,this.loadTiposTurno=()=>{this.tipoTurnoSrvc.get().subscribe(t=>{t&&(this.tiposTurno=t)})},this.loadTiposUsuario=()=>{this.usuarioTipoSrvc.get().subscribe(t=>{t&&(this.tiposUsuario=t)})},this.loadUsuarios=()=>{this.usuarioSrvc.get({sede:this.ls.get(X.b.usrTokenVar).sede||0}).subscribe(t=>{t&&(this.usuarios=t)})},this.resetTurno=()=>{this.pendientes=!1,this.comandas=[],this.facturas=[],this.turno={turno:null,turno_tipo:null,inicio:se().format(X.b.dbDateTimeFormat),fin:null},this.resetDetalleTurno(),this.detallesTurno=[],this.updateTableDataSource()},this.saveInfoTurno=()=>{this.pendientes=!1,this.turnoSrvc.save(this.turno).subscribe(t=>{t.exito?(this.turnoSavedEv.emit(),this.resetTurno(),this.turno=t.turno,this.snackBar.open("Turno modificado con \xe9xito...","Turno",{duration:3e3})):(t.pendientes&&(this.snackBar.open("ERROR: Error al cerrar el turno","Turno",{duration:3e3}),this.pendientes=!0,this.comandas=t.comandas,this.facturas=t.facturas),this.snackBar.open(`ERROR: ${t.mensaje}`,"Turno",{duration:3e3}))})},this.onSubmit=()=>{se(this.turno.fin).isValid()?this.dialog.open(bt.a,{maxWidth:"400px",data:new bt.b("Cerrar turno","La fecha de finalizaci\xf3n cerrar\xe1 el turno. \xbfDesea continuar?","S\xed","No")}).afterClosed().subscribe(t=>{t&&this.saveInfoTurno()}):this.saveInfoTurno()},this.resetDetalleTurno=()=>this.detalleTurno={turno:this.turno.turno?this.turno.turno:null,usuario:null,usuario_tipo:null},this.loadDetalleTurno=(t=+this.turno.turno)=>{this.turnoSrvc.getDetalle(t,{turno:t}).subscribe(t=>{t&&(this.detallesTurno=t,this.updateTableDataSource())})},this.onSubmitDetail=()=>{this.detalleTurno.turno=this.turno.turno,this.turnoSrvc.saveDetalle(this.detalleTurno).subscribe(t=>{t.exito?(this.loadDetalleTurno(),this.resetDetalleTurno(),this.snackBar.open("Usuario agregado al turno...","Turno",{duration:3e3})):this.snackBar.open(`ERROR: ${t.mensaje}`,"Turno",{duration:3e3})})},this.anularDetalleTurno=t=>{this.turnoSrvc.anularDetalle({turno:t.turno,usuario:t.usuario.usuario,usuario_tipo:t.usuario_tipo.usuario_tipo}).subscribe(t=>{t.exito?(this.loadDetalleTurno(),this.resetDetalleTurno(),this.snackBar.open("Se quit\xf3 al usuario del turno...","Turno",{duration:3e3})):this.snackBar.open(`ERROR: ${t.mensaje}`,"Turno",{duration:3e3})})},this.updateTableDataSource=()=>this.dataSource=new S.l(this.detallesTurno),this.getNow=()=>se().format(X.b.dbDateTimeFormat),this.copiaDetalleTurno=()=>{this.dialog.open(Ao,{maxWidth:"400px",data:{turnoCopia:this.turno}}).afterClosed().subscribe(()=>this.loadDetalleTurno(+this.turno.turno))}}ngOnInit(){this.esMovil=this.ls.get(X.b.usrTokenVar).enmovil||!1,this.resetTurno(),this.loadTiposTurno(),this.loadTiposUsuario(),this.loadUsuarios()}}return t.\u0275fac=function(e){return new(e||t)(W.Nb(M.b),W.Nb(ot.a),W.Nb(No),W.Nb(Do),W.Nb(Ro),W.Nb(Jt.a),W.Nb(D.b))},t.\u0275cmp=W.Hb({type:t,selectors:[["app-form-turno"]],inputs:{turno:"turno"},outputs:{turnoSavedEv:"turnoSavedEv"},decls:11,vars:9,consts:[[1,"mat-elevation-z4","fullWidth"],["mat-icon-button","","type","button","color","accent",3,"click",4,"ngIf"],["novalidate","",3,"ngSubmit",4,"ngIf"],[4,"ngIf"],["class","mat-elevation-z4 fullWidth",4,"ngIf"],["mat-icon-button","","type","button","color","accent",3,"click"],[1,"iconFontSize"],["novalidate","",3,"ngSubmit"],["frmTurno","ngForm"],[1,"form-group"],[1,"fullWidth"],["name","turno_tipo","required","",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["matInput","","type","datetime-locale","placeholder","Inicio","name","inicio","required","",3,"ngModel","ngModelChange"],["type","button","mat-button","","matSuffix","","mat-icon-button","",3,"click",4,"ngIf"],["type","button","mat-button","","matSuffix","","mat-icon-button","","aria-label","Clear",3,"click",4,"ngIf"],["matInput","","type","datetime-locale","placeholder","Fin","name","fin",3,"ngModel","ngModelChange"],["role","group","align","end"],["mat-raised-button","","type","submit","color","accent",1,"btnAccion",3,"disabled"],["mat-raised-button","","type","button","color","accent",3,"click",4,"ngIf"],[3,"value"],["type","button","mat-button","","matSuffix","","mat-icon-button","",3,"click"],["type","button","mat-button","","matSuffix","","mat-icon-button","","aria-label","Clear",3,"click"],["mat-raised-button","","type","button","color","accent",3,"click"],[1,"row"],[1,"col"],[4,"ngFor","ngForOf"],["mat-table","","class","mat-elevation-z4 full-width",3,"dataSource",4,"ngIf"],["frmDetalleTurno","ngForm"],["name","usuario_tipo","required","",3,"ngModel","ngModelChange"],["name","usuario","required","",3,"ngModel","ngModelChange"],["align","right"],["mat-raised-button","","type","button","color","accent",1,"btnAccion",3,"disabled","click"],["mat-table","",1,"mat-elevation-z4","full-width",3,"dataSource"],["matColumnDef","usuario_tipo"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","","class","text-wrap",4,"matCellDef"],["matColumnDef","usuario"],["mat-header-cell","","class","text-right",4,"matHeaderCellDef"],["mat-cell","","class","text-right",4,"matCellDef"],["matColumnDef","editItem"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell","",1,"text-wrap"],["mat-header-cell","",1,"text-right"],["mat-cell","",1,"text-right"],["mat-raised-button","","type","button","color","accent",3,"disabled","click"],["mat-header-row",""],["mat-row",""]],template:function(t,e){1&t&&(W.Tb(0,"mat-card",0),W.Tb(1,"mat-card-title"),W.Tb(2,"h4"),W.Fc(3),W.gc(4,"date"),W.Dc(5,Uo,3,0,"button",1),W.Dc(6,$o,3,0,"button",1),W.Sb(),W.Sb(),W.Tb(7,"mat-card-content"),W.Dc(8,Ko,23,11,"form",2),W.Sb(),W.Sb(),W.Dc(9,Jo,1,0,"hr",3),W.Dc(10,bn,11,9,"mat-card",4)),2&t&&(W.Cb(3),W.Hc(" Turno ",e.turno.turno?W.ic(4,6,e.turno.inicio,"dd/MM/yyyy HH:mm:ss"):""," "),W.Cb(2),W.lc("ngIf",!e.showTurnoForm),W.Cb(1),W.lc("ngIf",e.showTurnoForm),W.Cb(2),W.lc("ngIf",e.showTurnoForm),W.Cb(1),W.lc("ngIf",e.turno.turno),W.Cb(1),W.lc("ngIf",e.turno.turno))},directives:[p.a,p.h,o.m,p.c,v.a,b.a,i.r,i.l,i.m,m.b,m.f,C.a,i.p,i.k,i.n,o.l,h.b,i.c,_.m,m.g,S.k,S.c,S.e,S.b,S.g,S.j,S.d,S.a,S.f,S.i],pipes:[o.e],styles:[".full-width[_ngcontent-%COMP%]{width:100%}.iconFontSize[_ngcontent-%COMP%]{font-size:34pt!important}"]}),t})();const hn=["lstTurno"],pn=["frmTurno"];let fn=(()=>{class t{constructor(){this.setTurno=t=>{this.turno=t,this.frmTurno.loadDetalleTurno(+this.turno.turno),this.frmTurno.pendientes=!1,this.frmTurno.comandas=[],this.frmTurno.facturas=[]},this.refreshTurnoList=()=>this.lstTurnoComponent.loadTurnos(),this.turno={turno:null,turno_tipo:null,inicio:se().format(X.b.dbDateTimeFormat),fin:null}}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=W.Hb({type:t,selectors:[["app-turno"]],viewQuery:function(t,e){if(1&t&&(W.Kc(hn,1),W.Kc(pn,1)),2&t){let t;W.sc(t=W.cc())&&(e.lstTurnoComponent=t.first),W.sc(t=W.cc())&&(e.frmTurno=t.first)}},decls:7,vars:1,consts:[[1,"row"],[1,"col","m5","s12"],[3,"getTurnoEv"],["lstTurno",""],[1,"col","m7","s12"],[3,"turno","turnoSavedEv"],["frmTurno",""]],template:function(t,e){1&t&&(W.Tb(0,"div",0),W.Tb(1,"div",1),W.Tb(2,"app-lista-turno",2,3),W.bc("getTurnoEv",function(t){return e.setTurno(t)}),W.Sb(),W.Sb(),W.Tb(4,"div",4),W.Tb(5,"app-form-turno",5,6),W.bc("turnoSavedEv",function(){return e.refreshTurnoList()}),W.Sb(),W.Sb(),W.Sb()),2&t&&(W.Cb(5),W.lc("turno",e.turno))},directives:[_o,mn],styles:[""]}),t})();var gn=a("Iab2");let Sn=(()=>{class t{constructor(t){this.http=t,this.moduleUrl="reporte/venta",this.srvcErrHndl=new Y.a}porCategoria(t){return this.http.get(`${X.b.urlFacturacion}/${this.moduleUrl}/categoria?${et.stringify(t)}`).pipe(Object(Z.a)(X.b.reintentos),Object(tt.a)(this.srvcErrHndl.errorHandler))}porArticulo(t){return this.http.get(`${X.b.urlFacturacion}/${this.moduleUrl}/articulo?${et.stringify(t)}`).pipe(Object(Z.a)(X.b.reintentos),Object(tt.a)(this.srvcErrHndl.errorHandler))}porCategoriaPdf(t){const e={headers:new n.d({Accept:"application/pdf"}),responseType:"blob"};return this.http.get(`${X.b.urlFacturacion}/${this.moduleUrl}/categoriapdf/1?${et.stringify(t)}`,e).pipe(Object(Z.a)(X.b.reintentos),Object(tt.a)(this.srvcErrHndl.errorHandler))}porArticuloPdf(t){const e={headers:new n.d({Accept:"application/pdf"}),responseType:"blob"};return this.http.get(`${X.b.urlFacturacion}/${this.moduleUrl}/articulopdf/1?${et.stringify(t)}`,e).pipe(Object(Z.a)(X.b.reintentos),Object(tt.a)(this.srvcErrHndl.errorHandler))}}return t.\u0275fac=function(e){return new(e||t)(W.Xb(n.b))},t.\u0275prov=W.Jb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var Cn=a("2qVp"),Tn=a("NU9O");function vn(t,e){if(1&t&&(W.Rb(0),W.Tb(1,"tr"),W.Tb(2,"td",10),W.Fc(3),W.Sb(),W.Tb(4,"td",11),W.Fc(5),W.gc(6,"number"),W.Sb(),W.Tb(7,"td",11),W.Fc(8),W.gc(9,"number"),W.Sb(),W.Tb(10,"td",11),W.Fc(11),W.gc(12,"number"),W.Sb(),W.Tb(13,"td",11),W.Fc(14),W.gc(15,"number"),W.Sb(),W.Sb(),W.Qb()),2&t){const t=e.$implicit;W.Cb(3),W.Gc(t.descripcion),W.Cb(2),W.Gc(W.ic(6,5,t.cantidad,"1.2-2")),W.Cb(3),W.Gc(W.ic(9,8,t.porcentaje,"1.2-2")),W.Cb(3),W.Gc(W.ic(12,11,t.precio_unitario,"1.2-2")),W.Cb(3),W.Gc(W.ic(15,14,t.total,"1.2-2"))}}function Mn(t,e){if(1&t&&(W.Rb(0),W.Tb(1,"tr"),W.Tb(2,"th",7),W.Fc(3),W.Sb(),W.Sb(),W.Dc(4,vn,16,17,"ng-container",4),W.Tb(5,"tr"),W.Tb(6,"th",8),W.Fc(7,"Total de subcategor\xeda:"),W.Sb(),W.Tb(8,"th",9),W.Fc(9),W.gc(10,"number"),W.Sb(),W.Sb(),W.Qb()),2&t){const t=W.fc().$implicit;W.Cb(3),W.Gc(t.descripcion),W.Cb(1),W.lc("ngForOf",t.articulos),W.Cb(5),W.Gc(W.ic(10,3,t.total,"1.2-2"))}}function Fn(t,e){if(1&t&&(W.Rb(0),W.Dc(1,Mn,11,6,"ng-container",5),W.Qb()),2&t){const t=e.$implicit;W.Cb(1),W.lc("ngIf",t.articulos.length>0)}}function xn(t,e){if(1&t&&(W.Rb(0),W.Tb(1,"tr"),W.Tb(2,"th",6),W.Fc(3),W.Sb(),W.Sb(),W.Dc(4,Fn,2,1,"ng-container",4),W.Qb()),2&t){const t=W.fc().$implicit;W.Cb(3),W.Gc(t.descripcion),W.Cb(1),W.lc("ngForOf",t.subcategoria)}}function kn(t,e){if(1&t&&(W.Rb(0),W.Dc(1,xn,5,2,"ng-container",5),W.Qb()),2&t){const t=e.$implicit;W.Cb(1),W.lc("ngIf",t.subcategoria.length>0)}}let On=(()=>{class t{constructor(){this.params={},this.data=[]}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=W.Hb({type:t,selectors:[["app-por-categoria"]],inputs:{params:"params",data:"data"},decls:26,vars:9,consts:[[1,"mat-elevation-z4","fullWidth"],[1,"tbl"],[1,"brdTSingleBSingle"],[1,"rtxt","numWidth","brdTSingleBSingle"],[4,"ngFor","ngForOf"],[4,"ngIf"],["colspan","5"],["colspan","5",1,"tab"],["colspan","4",1,"rtxt"],[1,"rtxt","brdTSingleBDouble","numWidth"],[1,"doubleTab","brdBSingle"],[1,"rtxt","numWidth","brdBSingle"]],template:function(t,e){1&t&&(W.Tb(0,"mat-card",0),W.Tb(1,"mat-card-header"),W.Tb(2,"mat-card-title"),W.Fc(3,"Reporte de ventas"),W.Sb(),W.Tb(4,"mat-card-subtitle"),W.Fc(5," Por categor\xeda"),W.Ob(6,"br"),W.Fc(7),W.gc(8,"date"),W.gc(9,"date"),W.Sb(),W.Sb(),W.Tb(10,"mat-card-content"),W.Tb(11,"table",1),W.Tb(12,"thead"),W.Tb(13,"tr"),W.Tb(14,"th",2),W.Fc(15,"Descripci\xf3n"),W.Sb(),W.Tb(16,"th",3),W.Fc(17,"Cantidad"),W.Sb(),W.Tb(18,"th",3),W.Fc(19,"Porcentaje"),W.Sb(),W.Tb(20,"th",3),W.Fc(21,"Precio unitario"),W.Sb(),W.Tb(22,"th",3),W.Fc(23,"Total"),W.Sb(),W.Sb(),W.Sb(),W.Tb(24,"tbody"),W.Dc(25,kn,2,1,"ng-container",4),W.Sb(),W.Sb(),W.Sb(),W.Sb()),2&t&&(W.Cb(7),W.Ic(" Del ",W.ic(8,3,e.params.fdel,"dd/MM/yyyy")," al ",W.ic(9,6,e.params.fal,"dd/MM/yyyy")," "),W.Cb(18),W.lc("ngForOf",e.data))},directives:[p.a,p.d,p.h,p.g,p.c,o.l,o.m],pipes:[o.e,o.f],styles:[".numWidth[_ngcontent-%COMP%]{width:10%}tr[_ngcontent-%COMP%]{border:none}td[_ngcontent-%COMP%], th[_ngcontent-%COMP%]{padding-top:.25em;padding-bottom:.25em}"]}),t})();function Dn(t,e){if(1&t&&(W.Rb(0),W.Tb(1,"tr"),W.Tb(2,"td",6),W.Fc(3),W.Sb(),W.Tb(4,"td",7),W.Fc(5),W.gc(6,"number"),W.Sb(),W.Tb(7,"td",7),W.Fc(8),W.gc(9,"number"),W.Sb(),W.Sb(),W.Qb()),2&t){const t=e.$implicit;W.Cb(3),W.Gc(t.articulo.descripcion),W.Cb(2),W.Gc(W.ic(6,3,t.cantidad,"1.2-2")),W.Cb(3),W.Gc(W.ic(9,6,t.total,"1.2-2"))}}function En(t,e){if(1&t&&(W.Tb(0,"mat-card-content"),W.Tb(1,"table",2),W.Tb(2,"thead"),W.Tb(3,"tr"),W.Tb(4,"th",3),W.Fc(5,"Descripci\xf3n"),W.Sb(),W.Tb(6,"th",4),W.Fc(7,"Cantidad"),W.Sb(),W.Tb(8,"th",4),W.Fc(9,"Total"),W.Sb(),W.Sb(),W.Sb(),W.Tb(10,"tbody"),W.Dc(11,Dn,10,9,"ng-container",5),W.Sb(),W.Sb(),W.Sb()),2&t){const t=W.fc();W.Cb(11),W.lc("ngForOf",t.data.datos)}}function Pn(t,e){if(1&t&&(W.Tb(0,"tr"),W.Tb(1,"td",6),W.Fc(2),W.Sb(),W.Tb(3,"td",7),W.Fc(4),W.gc(5,"number"),W.Sb(),W.Tb(6,"td",7),W.Fc(7),W.gc(8,"number"),W.Sb(),W.Sb()),2&t){const t=e.$implicit;W.Cb(2),W.Gc(t.articulo.descripcion),W.Cb(2),W.Gc(W.ic(5,3,t.cantidad,"1.2-2")),W.Cb(3),W.Gc(W.ic(8,6,t.total,"1.2-2"))}}function _n(t,e){if(1&t&&(W.Rb(0),W.Tb(1,"tr"),W.Tb(2,"th",8),W.Fc(3),W.Sb(),W.Sb(),W.Dc(4,Pn,9,9,"tr",5),W.Qb()),2&t){const t=e.$implicit;W.Cb(3),W.Gc(t.sede),W.Cb(1),W.lc("ngForOf",t.articulos)}}function yn(t,e){if(1&t&&(W.Tb(0,"mat-card-content"),W.Tb(1,"table",2),W.Tb(2,"thead"),W.Tb(3,"tr"),W.Tb(4,"th",3),W.Fc(5,"Descripci\xf3n"),W.Sb(),W.Tb(6,"th",4),W.Fc(7,"Cantidad"),W.Sb(),W.Tb(8,"th",4),W.Fc(9,"Total"),W.Sb(),W.Sb(),W.Sb(),W.Tb(10,"tbody"),W.Dc(11,_n,5,2,"ng-container",5),W.Sb(),W.Sb(),W.Sb()),2&t){const t=W.fc();W.Cb(11),W.lc("ngForOf",t.data.datos)}}let In=(()=>{class t{constructor(){this.params={},this.data={}}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=W.Hb({type:t,selectors:[["app-por-articulo"]],inputs:{params:"params",data:"data"},decls:12,vars:10,consts:[[1,"mat-elevation-z4","fullWidth"],[4,"ngIf"],[1,"tbl"],[1,"brdTSingleBSingle"],[1,"rtxt","numWidth","brdTSingleBSingle"],[4,"ngFor","ngForOf"],[1,"doubleTab","brdBSingle"],[1,"rtxt","numWidth","brdBSingle"],["colspan","3",1,"brdTSingleBSingle"]],template:function(t,e){1&t&&(W.Tb(0,"mat-card",0),W.Tb(1,"mat-card-header"),W.Tb(2,"mat-card-title"),W.Fc(3,"Reporte de ventas"),W.Sb(),W.Tb(4,"mat-card-subtitle"),W.Fc(5," Por art\xedculo"),W.Ob(6,"br"),W.Fc(7),W.gc(8,"date"),W.gc(9,"date"),W.Sb(),W.Sb(),W.Dc(10,En,12,1,"mat-card-content",1),W.Dc(11,yn,12,1,"mat-card-content",1),W.Sb()),2&t&&(W.Cb(7),W.Ic(" Del ",W.ic(8,4,e.params.fdel,"dd/MM/yyyy")," al ",W.ic(9,7,e.params.fal,"dd/MM/yyyy")," "),W.Cb(3),W.lc("ngIf",1==e.data.grupo),W.Cb(1),W.lc("ngIf",2==e.data.grupo))},directives:[p.a,p.d,p.h,p.g,o.m,p.c,o.l],pipes:[o.e,o.f],styles:[".numWidth[_ngcontent-%COMP%]{width:10%}tr[_ngcontent-%COMP%]{border:none}td[_ngcontent-%COMP%], th[_ngcontent-%COMP%]{padding-top:.25em;padding-bottom:.25em}"]}),t})();function wn(t,e){if(1&t&&(W.Tb(0,"mat-option",16),W.Fc(1),W.Sb()),2&t){const t=e.$implicit;W.lc("value",t.tipo_reporte),W.Cb(1),W.Hc(" ",t.descripcion," ")}}function An(t,e){if(1&t&&(W.Tb(0,"mat-option",16),W.Fc(1),W.Sb()),2&t){const t=e.$implicit;W.lc("value",t.turno_tipo),W.Cb(1),W.Hc(" ",t.descripcion," ")}}function Nn(t,e){if(1&t&&(W.Tb(0,"mat-option",16),W.Fc(1),W.Sb()),2&t){const t=e.$implicit;W.lc("value",t.sede.sede),W.Cb(1),W.Hc(" ",t.sede.nombre," ")}}function Rn(t,e){if(1&t&&(W.Tb(0,"mat-option",16),W.Fc(1),W.Sb()),2&t){const t=e.$implicit;W.lc("value",t.id),W.Cb(1),W.Hc(" ",t.descripcion," ")}}function Un(t,e){if(1&t){const t=W.Ub();W.Tb(0,"mat-form-field",5),W.Tb(1,"mat-label"),W.Fc(2,"Agrupar por"),W.Sb(),W.Tb(3,"mat-select",17),W.bc("ngModelChange",function(e){return W.xc(t),W.fc().params._grupo=e}),W.Dc(4,Rn,2,2,"mat-option",7),W.Sb(),W.Sb()}if(2&t){const t=W.fc();W.Cb(3),W.lc("ngModel",t.params._grupo),W.Cb(1),W.lc("ngForOf",t.grupos)}}function $n(t,e){1&t&&W.Ob(0,"app-cargando")}function Bn(t,e){if(1&t&&(W.Tb(0,"div",0),W.Tb(1,"div",1),W.Ob(2,"app-por-categoria",18),W.Sb(),W.Sb()),2&t){const t=W.fc();W.Cb(2),W.lc("params",t.params)("data",t.porCategoria)}}function jn(t,e){if(1&t&&(W.Tb(0,"div",0),W.Tb(1,"div",1),W.Ob(2,"app-por-articulo",18),W.Sb(),W.Sb()),2&t){const t=W.fc();W.Cb(2),W.lc("params",t.params)("data",t.porArticulo)}}let Hn=(()=>{class t{constructor(t,e,a,o){this.snackBar=t,this.rptVentasSrvc=e,this.tipoTurnoSrvc=a,this.sedeSrvc=o,this.tiposReporte=[],this.params={},this.paramsToSend={},this.msgGenerandoReporte=null,this.porCategoria=[],this.porArticulo={datos:[]},this.tiposTurno=[],this.sedes=[],this.grupos=X.b.grupos,this.tituloCategoria="Ventas por categoria",this.tituloArticulo="Ventas por articulo",this.cargando=!1,this.configBotones={showPdf:!0,showHtml:!0,showExcel:!0},this.loadSedes=()=>{this.sedeSrvc.getSedes({reporte:!0}).subscribe(t=>{t&&(this.sedes=t)})},this.loadTiposTurno=()=>{this.tipoTurnoSrvc.get().subscribe(t=>{t&&(this.tiposTurno=t)})},this.loadTiposReporte=()=>{this.tiposReporte=[{tipo_reporte:1,descripcion:"Por categor\xeda"},{tipo_reporte:2,descripcion:"Por art\xedculo"}]},this.resetParams=()=>{this.porCategoria=[],this.porArticulo=[],this.msgGenerandoReporte=null,this.params={tipo_reporte:void 0,fdel:se().startOf("week").format(X.b.dbDateFormat),fal:se().endOf("week").format(X.b.dbDateFormat)},this.cargando=!1},this.getReporte=(t=1)=>{switch(this.paramsToSend=JSON.parse(JSON.stringify(this.params)),this.msgGenerandoReporte="GENERANDO REPORTE EN ",t){case 1:this.getEnPantalla();break;case 2:this.getPdf();break;case 3:this.getExcel()}},this.getPdf=()=>{switch(this.params.tipo_reporte){case 1:this.getPorCategoriaPdf();break;case 2:this.getPorArticuloPdf()}},this.getExcel=()=>{switch(this.params.tipo_reporte){case 1:this.getPorCategoriaExcel();break;case 2:this.getPorArticuloExcel()}},this.getPorCategoriaExcel=()=>{this.paramsToSend._excel=1,this.cargando=!0,this.cleanParams(),this.rptVentasSrvc.porCategoriaPdf(this.paramsToSend).subscribe(t=>{if(this.cargando=!1,t){const e=new Blob([t],{type:"application/vnd.ms-excel"});Object(gn.saveAs)(e,`${this.tituloCategoria}.xls`)}else this.snackBar.open("No se pudo generar el reporte...",this.tituloCategoria,{duration:3e3})})},this.getPorCategoriaPdf=()=>{this.paramsToSend._excel=0,this.cargando=!0,this.cleanParams(),this.rptVentasSrvc.porCategoriaPdf(this.paramsToSend).subscribe(t=>{if(this.cargando=!1,t){const e=new Blob([t],{type:"application/pdf"});Object(gn.saveAs)(e,`${this.tituloCategoria}.pdf`)}else this.snackBar.open("No se pudo generar el reporte...",this.tituloCategoria,{duration:3e3})})},this.getPorArticuloPdf=()=>{this.paramsToSend._excel=0,this.cargando=!0,this.cleanParams(),this.rptVentasSrvc.porArticuloPdf(this.paramsToSend).subscribe(t=>{if(this.cargando=!1,t){const e=new Blob([t],{type:"application/pdf"});Object(gn.saveAs)(e,`${this.tituloArticulo}.pdf`)}else this.snackBar.open("No se pudo generar el reporte...",this.tituloArticulo,{duration:3e3})})},this.getPorArticuloExcel=()=>{this.paramsToSend._excel=1,this.cargando=!0,this.cleanParams(),this.rptVentasSrvc.porArticuloPdf(this.paramsToSend).subscribe(t=>{if(this.cargando=!1,t){const e=new Blob([t],{type:"application/vnd.ms-excel"});Object(gn.saveAs)(e,`${this.tituloArticulo}.xls`)}else this.snackBar.open("No se pudo generar el reporte...",this.tituloArticulo,{duration:3e3})})},this.getEnPantalla=()=>{switch(this.params.tipo_reporte){case 1:this.getPorCategoriaEnPantalla();break;case 2:this.getPorArticuloEnPantalla()}},this.cleanParams=()=>delete this.paramsToSend.tipo_reporte,this.getPorCategoriaEnPantalla=()=>{this.cargando=!0,this.cleanParams(),this.rptVentasSrvc.porCategoria(this.paramsToSend).subscribe(t=>{this.cargando=!1,t?this.porCategoria=t:this.snackBar.open("No se pudo generar el reporte...","Ventas por categor\xeda",{duration:3e3})})},this.getPorArticuloEnPantalla=()=>{this.cargando=!0,this.cleanParams(),this.rptVentasSrvc.porArticulo(this.paramsToSend).subscribe(t=>{this.cargando=!1,t?this.porArticulo=t:this.snackBar.open("No se pudo generar el reporte...","Ventas por art\xedculo",{duration:3e3})})}}ngOnInit(){this.resetParams(),this.loadTiposReporte(),this.loadTiposTurno(),this.loadSedes()}}return t.\u0275fac=function(e){return new(e||t)(W.Nb(M.b),W.Nb(Sn),W.Nb(No),W.Nb(Cn.a))},t.\u0275cmp=W.Hb({type:t,selectors:[["app-rpt-ventas"]],decls:33,vars:13,consts:[[1,"row"],[1,"col","m12","s12"],[1,"mat-elevation-z4","fullWidth"],["novalidate",""],["frmEntidad","ngForm"],[1,"fullWidth"],["name","tipo_reporte","required","",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["name","turno_tipo",3,"ngModel","ngModelChange"],["type","date","matInput","","placeholder","Del","name","fdel","required","",3,"ngModel","ngModelChange"],["type","date","matInput","","placeholder","Al","name","fal","required","",3,"ngModel","ngModelChange"],["name","sede","multiple","",3,"ngModel","ngModelChange"],["class","fullWidth",4,"ngIf"],[3,"configuracion","excelClick","htmlClick","pdfClick","resetParamsClick"],[4,"ngIf"],["class","row",4,"ngIf"],[3,"value"],["name","grupo",3,"ngModel","ngModelChange"],[3,"params","data"]],template:function(t,e){1&t&&(W.Tb(0,"div",0),W.Tb(1,"div",1),W.Tb(2,"mat-card",2),W.Tb(3,"mat-card-title"),W.Tb(4,"h4"),W.Fc(5,"Reporte de ventas"),W.Sb(),W.Sb(),W.Tb(6,"mat-card-content"),W.Tb(7,"form",3,4),W.Tb(9,"mat-form-field",5),W.Tb(10,"mat-label"),W.Fc(11,"Tipo"),W.Sb(),W.Tb(12,"mat-select",6),W.bc("ngModelChange",function(t){return e.params.tipo_reporte=t}),W.Dc(13,wn,2,2,"mat-option",7),W.Sb(),W.Sb(),W.Tb(14,"mat-form-field",5),W.Tb(15,"mat-label"),W.Fc(16,"Tipo de turno"),W.Sb(),W.Tb(17,"mat-select",8),W.bc("ngModelChange",function(t){return e.params.turno_tipo=t}),W.Dc(18,An,2,2,"mat-option",7),W.Sb(),W.Sb(),W.Tb(19,"mat-form-field",5),W.Tb(20,"input",9),W.bc("ngModelChange",function(t){return e.params.fdel=t}),W.Sb(),W.Sb(),W.Tb(21,"mat-form-field",5),W.Tb(22,"input",10),W.bc("ngModelChange",function(t){return e.params.fal=t}),W.Sb(),W.Sb(),W.Tb(23,"mat-form-field",5),W.Tb(24,"mat-label"),W.Fc(25,"Sede"),W.Sb(),W.Tb(26,"mat-select",11),W.bc("ngModelChange",function(t){return e.params.sede=t}),W.Dc(27,Nn,2,2,"mat-option",7),W.Sb(),W.Sb(),W.Dc(28,Un,5,2,"mat-form-field",12),W.Tb(29,"app-rpt-botones",13),W.bc("excelClick",function(){return e.getReporte(3)})("htmlClick",function(){return e.getReporte(1)})("pdfClick",function(){return e.getReporte(2)})("resetParamsClick",function(){return e.resetParams()}),W.Sb(),W.Sb(),W.Dc(30,$n,1,0,"app-cargando",14),W.Sb(),W.Sb(),W.Sb(),W.Sb(),W.Dc(31,Bn,3,2,"div",15),W.Dc(32,jn,3,2,"div",15)),2&t&&(W.Cb(12),W.lc("ngModel",e.params.tipo_reporte),W.Cb(1),W.lc("ngForOf",e.tiposReporte),W.Cb(4),W.lc("ngModel",e.params.turno_tipo),W.Cb(1),W.lc("ngForOf",e.tiposTurno),W.Cb(2),W.lc("ngModel",e.params.fdel),W.Cb(2),W.lc("ngModel",e.params.fal),W.Cb(4),W.lc("ngModel",e.params.sede),W.Cb(1),W.lc("ngForOf",e.sedes),W.Cb(1),W.lc("ngIf",e.params.sede&&e.params.sede.length>1),W.Cb(1),W.lc("configuracion",e.configBotones),W.Cb(1),W.lc("ngIf",e.cargando),W.Cb(1),W.lc("ngIf",1===e.params.tipo_reporte&&e.porCategoria.length>0),W.Cb(1),W.lc("ngIf",2===e.params.tipo_reporte))},directives:[p.a,p.h,p.c,i.r,i.l,i.m,m.b,m.f,C.a,i.p,i.k,i.n,o.l,h.b,i.c,o.m,Tn.a,_.m,Se.a,On,In],styles:[""]}),t})();var Ln=a("EwG7");function qn(t,e){1&t&&W.Ob(0,"app-cargando")}let zn=(()=>{class t{constructor(){this.params={},this.configParams={isRequiredFDel:!0,isRequiredFAl:!0},this.configBotones={isHtmlDisabled:!1,isPdfDisabled:!1,isExcelDisabled:!1},this.cargando=!1,this.resetParams=()=>{this.params={fdel:se().startOf("week").format(X.b.dbDateFormat),fal:se().endOf("week").format(X.b.dbDateFormat)}},this.getReporte=()=>{console.log("GENERANDO CON PARAMETROS = ",this.params)}}ngOnInit(){this.resetParams()}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=W.Hb({type:t,selectors:[["app-turnos"]],decls:12,vars:5,consts:[[1,"row"],[1,"col","m12","s12"],[1,"mat-elevation-z4","fullWidth"],["novalidate",""],["frmEntidad","ngForm"],[3,"fdel","fal","configuracion","fdelChange","falChange"],[3,"configuracion","htmlClick","pdfClick","excelClick","resetParamsClick"],[4,"ngIf"]],template:function(t,e){1&t&&(W.Tb(0,"div",0),W.Tb(1,"div",1),W.Tb(2,"mat-card",2),W.Tb(3,"mat-card-title"),W.Tb(4,"h4"),W.Fc(5,"Reporte de Turnos"),W.Sb(),W.Sb(),W.Tb(6,"mat-card-content"),W.Tb(7,"form",3,4),W.Tb(9,"app-rpt-fechas",5),W.bc("fdelChange",function(t){return e.params.fdel=t})("falChange",function(t){return e.params.fal=t}),W.Sb(),W.Tb(10,"app-rpt-botones",6),W.bc("htmlClick",function(){return e.getReporte()})("pdfClick",function(){return e.getReporte()})("excelClick",function(){return e.getReporte()})("resetParamsClick",function(){return e.resetParams()}),W.Sb(),W.Sb(),W.Dc(11,qn,1,0,"app-cargando",7),W.Sb(),W.Sb(),W.Sb(),W.Sb()),2&t&&(W.Cb(9),W.lc("fdel",e.params.fdel)("fal",e.params.fal)("configuracion",e.configParams),W.Cb(1),W.lc("configuracion",e.configBotones),W.Cb(1),W.lc("ngIf",e.cargando))},directives:[p.a,p.h,p.c,i.r,i.l,i.m,Ln.a,Tn.a,o.m,Se.a],styles:[""]}),t})();function Gn(t,e){1&t&&W.Ob(0,"app-cargando")}const Wn=function(){return{standalone:!0}};let Vn=(()=>{class t{constructor(t,e){this.snackBar=t,this.pdfServicio=e,this.params={},this.titulo="Propinas",this.configBotones={isHtmlDisabled:!0,isPdfDisabled:!1,isExcelDisabled:!1,showHtml:!1,showExcel:!0,showPdf:!0},this.cargando=!1,this.resetParams=()=>{this.params={},this.cargando=!1}}ngOnInit(){}onSubmit(){this.params._excel=0,this.cargando=!0,this.pdfServicio.getReportePropina(this.params).subscribe(t=>{if(this.cargando=!1,t){const e=new Blob([t],{type:"application/pdf"});Object(gn.saveAs)(e,`${this.titulo}.pdf`)}else this.snackBar.open("No se pudo generar el reporte...",this.titulo,{duration:3e3})})}excelClick(){this.params._excel=1,this.cargando=!0,this.pdfServicio.getReportePropina(this.params).subscribe(t=>{if(this.cargando=!1,t){const e=new Blob([t],{type:"application/vnd.ms-excel"});Object(gn.saveAs)(e,`${this.titulo}.xls`)}else this.snackBar.open("No se pudo generar el reporte...",this.titulo,{duration:3e3})})}}return t.\u0275fac=function(e){return new(e||t)(W.Nb(M.b),W.Nb(ba.a))},t.\u0275cmp=W.Hb({type:t,selectors:[["app-propinas"]],decls:17,vars:9,consts:[[1,"row"],[1,"col","m12","s12"],[1,"mat-elevation-z4","fullWidth"],["novalidate",""],["frmRptPropinas","ngForm"],[1,"fullWidth"],["matInput","","type","date","placeholder","Del","required","",3,"ngModel","ngModelOptions","ngModelChange"],["matInput","","type","date","placeholder","Al","required","",3,"ngModel","ngModelOptions","ngModelChange"],["name","mostrar_detalle",1,"fullWidth",3,"ngModel","ngModelChange"],[3,"configuracion","pdfClick","resetParamsClick","excelClick"],[4,"ngIf"]],template:function(t,e){1&t&&(W.Tb(0,"div",0),W.Tb(1,"div",1),W.Tb(2,"mat-card",2),W.Tb(3,"mat-card-title"),W.Tb(4,"h4"),W.Fc(5,"Reporte de propinas"),W.Sb(),W.Sb(),W.Tb(6,"mat-card-content"),W.Tb(7,"form",3,4),W.Tb(9,"mat-form-field",5),W.Tb(10,"input",6),W.bc("ngModelChange",function(t){return e.params.fdel=t}),W.Sb(),W.Sb(),W.Tb(11,"mat-form-field",5),W.Tb(12,"input",7),W.bc("ngModelChange",function(t){return e.params.fal=t}),W.Sb(),W.Sb(),W.Tb(13,"mat-checkbox",8),W.bc("ngModelChange",function(t){return+(e.params._detalle=t)}),W.Fc(14,"Mostrar Detalle"),W.Sb(),W.Tb(15,"app-rpt-botones",9),W.bc("pdfClick",function(){return e.onSubmit()})("resetParamsClick",function(){return e.resetParams()})("excelClick",function(){return e.excelClick()}),W.Sb(),W.Sb(),W.Dc(16,Gn,1,0,"app-cargando",10),W.Sb(),W.Sb(),W.Sb(),W.Sb()),2&t&&(W.Cb(10),W.lc("ngModel",e.params.fdel)("ngModelOptions",W.nc(7,Wn)),W.Cb(2),W.lc("ngModel",e.params.fal)("ngModelOptions",W.nc(8,Wn)),W.Cb(1),W.lc("ngModel",+e.params._detalle),W.Cb(2),W.lc("configuracion",e.configBotones),W.Cb(1),W.lc("ngIf",e.cargando))},directives:[p.a,p.h,p.c,i.r,i.l,i.m,m.b,h.b,i.c,i.p,i.k,i.n,T.a,Tn.a,o.m,Se.a],styles:[""]}),t})();var Kn=a("R0Ic"),Jn=a("+iZS"),Qn=a("u0wK");function Xn(t,e){1&t&&(W.Tb(0,"th",19),W.Fc(1,"No."),W.Sb())}function Yn(t,e){if(1&t&&(W.Tb(0,"td",20),W.Fc(1),W.Sb()),2&t){const t=e.$implicit;W.Cb(1),W.Hc("",t.comanda," ")}}function Zn(t,e){1&t&&(W.Tb(0,"th",19),W.Fc(1,"Orden"),W.Sb())}function ti(t,e){if(1&t&&(W.Tb(0,"td",20),W.Fc(1),W.Sb()),2&t){const t=e.$implicit;W.Cb(1),W.Gc(t.origen_datos.numero_orden||"")}}function ei(t,e){1&t&&(W.Tb(0,"th",19),W.Fc(1,"Fecha/Hora"),W.Sb())}function ai(t,e){if(1&t&&(W.Tb(0,"td",20),W.Fc(1),W.gc(2,"date"),W.Sb()),2&t){const t=e.$implicit;W.Cb(1),W.Gc(W.ic(2,1,t.fhcreacion,"dd/MM/yyyy HH:mm:ss")||"")}}function oi(t,e){1&t&&(W.Tb(0,"th",19),W.Fc(1,"Cliente"),W.Sb())}function ni(t,e){if(1&t&&(W.Tb(0,"td",20),W.Fc(1),W.Sb()),2&t){const t=e.$implicit;W.Cb(1),W.Gc(t.cuentas[0].nombre)}}function ii(t,e){1&t&&(W.Tb(0,"th",19),W.Fc(1,"Total"),W.Sb())}function si(t,e){if(1&t&&(W.Tb(0,"td",20),W.Fc(1),W.gc(2,"number"),W.Sb()),2&t){const t=e.$implicit;W.Cb(1),W.Gc(W.ic(2,1,t.total,"1.2-2"))}}function ci(t,e){1&t&&(W.Tb(0,"th",21),W.Fc(1,"Imprimir"),W.Sb())}function ri(t,e){if(1&t){const t=W.Ub();W.Tb(0,"td",22),W.Tb(1,"button",23),W.bc("click",function(){W.xc(t);const a=e.$implicit;return W.fc().imprimir(a)}),W.Fc(2," Imprimir "),W.Sb(),W.Sb()}}function li(t,e){1&t&&(W.Tb(0,"th",21),W.Fc(1,"Cancelar"),W.Sb())}function di(t,e){if(1&t){const t=W.Ub();W.Tb(0,"td",22),W.Tb(1,"button",23),W.bc("click",function(){W.xc(t);const a=e.$implicit;return W.fc().cancelarPedido(a)}),W.Fc(2," Cancelar "),W.Sb(),W.Sb()}}function ui(t,e){1&t&&(W.Tb(0,"th",21),W.Fc(1,"Facturar"),W.Sb())}function bi(t,e){if(1&t){const t=W.Ub();W.Tb(0,"td",22),W.Tb(1,"button",23),W.bc("click",function(){W.xc(t);const a=e.$implicit;return W.fc().firmar(a)}),W.Fc(2," Facturar "),W.Sb(),W.Sb()}}function mi(t,e){if(1&t&&(W.Tb(0,"h6"),W.Fc(1),W.Sb()),2&t){const t=W.fc().$implicit;W.Cb(1),W.Hc("Orden #",t.origen_datos.numero_orden,"")}}function hi(t,e){if(1&t&&(W.Tb(0,"tr"),W.Tb(1,"td",29),W.Tb(2,"p",30),W.Fc(3),W.Sb(),W.Sb(),W.Sb()),2&t){const t=W.fc().$implicit;W.Cb(3),W.Gc(t.notas_generales)}}function pi(t,e){1&t&&W.Ob(0,"br")}function fi(t,e){if(1&t&&(W.Tb(0,"span"),W.Fc(1),W.Sb()),2&t){const t=W.fc().$implicit;W.Cb(1),W.Hc("\xa0\xa0\xa0",t.notas,"")}}function gi(t,e){if(1&t&&(W.Tb(0,"tr"),W.Tb(1,"td",31),W.Fc(2),W.Sb(),W.Sb()),2&t){const t=W.fc().$implicit;W.Cb(2),W.Hc(" ",t," ")}}function Si(t,e){if(1&t&&(W.Rb(0),W.Dc(1,gi,3,1,"tr",26),W.Qb()),2&t){const t=e.$implicit;W.Cb(1),W.lc("ngIf",t.length>0)}}function Ci(t,e){if(1&t&&(W.Rb(0),W.Tb(1,"tr"),W.Tb(2,"td"),W.Fc(3),W.Dc(4,pi,1,0,"br",26),W.Dc(5,fi,2,1,"span",26),W.Sb(),W.Tb(6,"td",27),W.Fc(7),W.gc(8,"number"),W.Sb(),W.Sb(),W.Dc(9,Si,2,1,"ng-container",28),W.Qb()),2&t){const t=e.$implicit;W.Cb(3),W.Ic(" ",t.cantidad," ",t.articulo.descripcion,""),W.Cb(1),W.lc("ngIf",t.notas.length>0),W.Cb(1),W.lc("ngIf",t.notas.length>0),W.Cb(2),W.Gc(W.ic(8,6,+t.precio*+t.cantidad+ +t.monto_extra,"1.2-2")),W.Cb(2),W.lc("ngForOf",t.detalle)}}function Ti(t,e){if(1&t&&(W.Tb(0,"td",20),W.Tb(1,"div",24),W.Tb(2,"table",25),W.Tb(3,"caption"),W.Tb(4,"h5"),W.Fc(5),W.Sb(),W.Dc(6,mi,2,1,"h6",26),W.Sb(),W.Tb(7,"thead"),W.Tb(8,"th"),W.Fc(9,"Producto"),W.Sb(),W.Tb(10,"th",27),W.Fc(11,"Total"),W.Sb(),W.Sb(),W.Tb(12,"tbody"),W.Dc(13,hi,4,1,"tr",26),W.Dc(14,Ci,10,9,"ng-container",28),W.Sb(),W.Sb(),W.Sb(),W.Sb()),2&t){const t=e.$implicit,a=W.fc();W.Db("colspan",a.columnsToDisplay.length),W.Cb(1),W.lc("@detailExpand",t==a.expandedElement?"expanded":"collapsed"),W.Cb(4),W.Hc("Detalle del pedido #",t.comanda,""),W.Cb(1),W.lc("ngIf",t.origen_datos.numero_orden),W.Cb(7),W.lc("ngIf",t.notas_generales),W.Cb(1),W.lc("ngForOf",t.cuentas[0].productos)}}function vi(t,e){1&t&&W.Ob(0,"tr",32)}function Mi(t,e){if(1&t){const t=W.Ub();W.Tb(0,"tr",33),W.bc("click",function(){W.xc(t);const a=e.$implicit,o=W.fc();return o.expandedElement=o.expandedElement===a?null:a}),W.Sb()}if(2&t){const t=e.$implicit,a=W.fc();W.Fb("example-expanded-row",a.expandedElement===t)}}function Fi(t,e){1&t&&W.Ob(0,"tr",34)}const xi=function(){return["expandedDetail"]};let ki=(()=>{class t{constructor(t,e,a,o,n,i,s,c,r,l){this.dialog=t,this.snackBar=e,this.socket=a,this.ls=o,this.comandaSrvc=n,this.facturaSrvc=i,this.dns=s,this.pdfServicio=c,this.configSrvc=r,this.ordenGkSrvc=l,this.dataSource=[],this.columnsToDisplay=["comanda","orden","fechahora","nombre","total","imprimir","cancelar","facturar"],this.comandasEnLinea=[],this.params={de:0,a:99},this.avisoSocketIOEvent=(t="")=>{this.dialog.open(bt.a,{maxWidth:"400px",data:new bt.b("Socket.IO",t,"Aceptar","Cancelar")}).afterClosed().subscribe(t=>{})},this.notificarUsuario=()=>{const t={icon:"assets/img/minilogo.png",body:`Se recibi\xf3 una nueva orden a las ${se().format(X.b.dateTimeFormat)}.`,dir:"auto"};this.dns.createNotification("Rest-Touch Pro",1e4,t)},this.loadComandasEnLinea=()=>{this.comandaSrvc.getComandasOnLIne().subscribe(t=>{this.comandasEnLinea=t,this.dataSource=this.comandasEnLinea})},this.setToPrint=t=>{const e=[];return t.forEach(t=>{e.push({id:+t.articulo.articulo,nombre:t.articulo.descripcion,cantidad:+t.cantidad,total:+t.total,notas:t.notas||"",impresora:{bluetooth:+t.articulo.impresora.bluetooth,direccion_ip:t.articulo.impresora.direccion_ip||"",impresora:+t.articulo.impresora.impresora,nombre:t.articulo.impresora.nombre||"",sede:+t.articulo.impresora.sede,ubicacion:t.articulo.impresora.ubicacion||""},detalle:t.detalle})}),e},this.getPdf=t=>{const e=+t.cuentas[0].cuenta;this.pdfServicio.getComanda(e).subscribe(t=>{if(t){const a=new Blob([t],{type:"application/pdf"}),o=window.URL.createObjectURL(a);window.open(o,`cuenta_${e}`,"height=700,width=800,menubar=no,location=no,resizable=no,scrollbars=no,status=no")}else this.snackBar.open("No se pudo generar la comanda...","Comanda",{duration:3e3})})},this.imprimir=(t,e=0)=>{const a=this.setToPrint(t.cuentas[0].productos),o=a.filter(t=>0==+t.impresora.bluetooth),n=a.filter(t=>1==+t.impresora.bluetooth);let i={};if(o.length>0&&(i={Indice:e+1,Tipo:"Comanda",Nombre:t.cuentas[0].nombre,Numero:t.comanda,NoOrdenEnLinea:t.origen_datos.numero_orden,DireccionEntrega:t.origen_datos.direccion_entrega,DetalleCuenta:o,Total:0,NotasGenerales:t.notas_generales||""},this.socket.emit("print:comanda",`${JSON.stringify(i)}`)),n.length>0&&(i={Tipo:"Comanda",Nombre:t.cuentas[0].nombre,Numero:t.comanda,NoOrdenEnLinea:t.origen_datos.numero_orden,DireccionEntrega:t.origen_datos.direccion_entrega,DetalleCuenta:n,Total:0},this.printToBT(JSON.stringify(i))),+t.orden_gk>0){const e={orden_gk:+t.orden_gk,estatus_orden_gk:5,sede:this.ls.get(X.b.usrTokenVar).sede,comentario:`Se mand\xf3 a imprimir la comanda #${t.comanda} de la orden #${t.orden_gk} de Ghost Kitchen.`};this.cambiarEstatusOrdenGK(e)}},this.printToBT=(t="")=>{const e=window.open(`com.restouch.impresion://impresion/${t}`,"PrntBT","height=200,width=200,menubar=no,location=no,resizable=no,scrollbars=no,status=no");setTimeout(()=>e.close(),1e3)},this.firmar=t=>{this.facturaSrvc.firmar(+t.factura.factura).subscribe(e=>{if(e.exito){if(this.loadComandasEnLinea(),+t.orden_gk>0){const e={orden_gk:+t.orden_gk,estatus_orden_gk:6,sede:this.ls.get(X.b.usrTokenVar).sede,comentario:`Se firm\xf3 la factura de la comanda #${t.comanda} de la orden #${t.orden_gk} de Ghost Kitchen.`};this.cambiarEstatusOrdenGK(e)}this.dialog.open(bt.a,{maxWidth:"400px",data:new bt.b("Imprimir factura","\xbfDesea imprimir la factura?","S\xed","No")}).afterClosed().subscribe(a=>{a&&(1===(this.configSrvc.getConfig(X.b.CONSTANTES.RT_MODO_FACTURA)||1)?this.printFactura(e.factura,t.origen_datos):this.representacionGrafica(+t.factura.factura))})}this.snackBar.open(e.mensaje,"Facturaci\xf3n",{duration:e.exito?3e3:1e4})})},this.printFactura=(t,e={})=>{const a={NombreEmpresa:t.empresa.nombre_comercial,NitEmpresa:t.empresa.nit,SedeEmpresa:t.sedeFactura.nombre,DireccionEmpresa:t.empresa.direccion,Fecha:se(t.fecha_factura).format(X.b.dateFormat),Nit:t.receptor.nit,Nombre:t.receptor.nombre,Direccion:t.receptor.direccion,Serie:t.serie_factura,Numero:t.numero_factura,Total:0,NoAutorizacion:t.fel_uuid,NombreCertificador:t.certificador_fel.nombre,NitCertificador:t.certificador_fel.nit,FechaDeAutorizacion:t.fecha_autorizacion,NoOrdenEnLinea:e.numero_orden,FormaDePago:e.metodo_pago&&e.metodo_pago.length>0?e.metodo_pago.join(", "):"",DetalleFactura:[]};for(const o of t.detalle)a.DetalleFactura.push({Cantidad:parseInt(o.cantidad),Descripcion:o.articulo.descripcion,Total:parseFloat(o.total),PrecioUnitario:+o.precio_unitario}),a.Total+=parseFloat(o.total);this.socket.emit("print:factura",JSON.stringify(a))},this.representacionGrafica=t=>{this.facturaSrvc.getGrafo(t).subscribe(t=>{if(t.exito)switch(t.tipo){case"link":this.openLinkWindow(t.documento);break;case"pdf":this.openPdfDocument(t.documento)}})},this.openLinkWindow=t=>window.open(t,"winFactPdf","height=700,width=800,menubar=no,location=no,resizable=no,scrollbars=no,status=no"),this.openPdfDocument=t=>{window.open("","winFactPdf","height=700,width=800,menubar=no,location=no,resizable=no,scrollbars=no,status=no").document.write('<iframe width="100%" style="margin: -8px;border: none;" height="100%" src="data:application/pdf;base64, '+encodeURI(t)+'"></iframe>')},this.imprimirLote=()=>{for(let t=this.params.de;t<=this.params.a;t++)this.imprimir(this.comandasEnLinea[t],t)},this.cancelarPedido=t=>{this.dialog.open(bt.a,{maxWidth:"400px",data:new bt.b("Cancelar pedido","Si cancela el pedido, ser\xe1 necesario volver a ingresarlo. \xbfDesea continuar?","S\xed","No",{input:[{select:!1,label:"Comentario",valor:null,id:"comentario",requerido:!1}]})}).afterClosed().subscribe(e=>{if(e.resultado){const a={};for(const t of e.config.input)a[t.id]=t.valor;this.comandaSrvc.cancelarPedido(t.comanda,a).subscribe(e=>{if(e.exito){if(+t.orden_gk>0){const e={orden_gk:+t.orden_gk,estatus_orden_gk:2,sede:this.ls.get(X.b.usrTokenVar).sede,comentario:`Se cancel\xf3 la comanda #${t.comanda} de la orden #${t.orden_gk} de Ghost Kitchen.`};this.cambiarEstatusOrdenGK(e)}this.snackBar.open("Pedido cancelado con \xe9xito...","Pedido",{duration:3e3})}else this.snackBar.open(`ERROR: ${e.mensaje}`,"Pedido",{duration:7e3});this.loadComandasEnLinea()})}})},this.cambiarEstatusOrdenGK=t=>{this.ordenGkSrvc.cambiarEstatus(t).subscribe(e=>{e.exito?this.socket.emit("gk:updEstatusOrden",`${JSON.stringify({orden_gk:t.orden_gk,estatus_orden_gk:e.estatus_orden_gk,sede_uuid:this.ls.get(X.b.usrTokenVar).sede_uuid})}`):this.snackBar.open(`ERROR:${e.mensaje}`,"Orden de Ghost Kitchen",{duration:7e3})})}}ngOnInit(){this.ls.get(X.b.usrTokenVar).sede_uuid&&(this.socket.emit("joinRestaurant",this.ls.get(X.b.usrTokenVar).sede_uuid),this.socket.on("shopify:updlist",(t=null)=>{t&&t.corporacion?this.ls.get(X.b.usrTokenVar).sede_uuid.indexOf(t.corporacion)>-1&&(this.loadComandasEnLinea(),this.notificarUsuario()):(this.loadComandasEnLinea(),this.notificarUsuario())}),this.socket.on("reconnect",()=>this.socket.emit("joinRestaurant",this.ls.get(X.b.usrTokenVar).sede_uuid)),this.socket.on("connect_timeout",()=>{const t="DESCONECTADO DEL SERVIDOR (TIMEOUT)";this.snackBar.open(t,"ERROR",{duration:5e3}),this.avisoSocketIOEvent(t)}),this.socket.on("reconnect_attempt",t=>this.snackBar.open(`INTENTO DE RECONEXI\xd3N #${t}`,"ERROR",{duration:1e4})),this.socket.on("shopify:error",t=>{this.loadComandasEnLinea(),this.snackBar.open(`ERROR: ${t}`,"Firmar",{duration:1e4})})),this.loadComandasEnLinea()}ngOnDestroy(){}}return t.\u0275fac=function(e){return new(e||t)(W.Nb(D.b),W.Nb(M.b),W.Nb(he.a),W.Nb(ot.a),W.Nb(te),W.Nb(me.a),W.Nb(Jn.a),W.Nb(ba.a),W.Nb(fe.a),W.Nb(Qn.a))},t.\u0275cmp=W.Hb({type:t,selectors:[["app-comanda-en-linea"]],decls:32,vars:5,consts:[[1,"row"],[1,"col","m12","s12"],["mat-table","","multiTemplateDataRows","",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","comanda"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","orden"],["matColumnDef","fechahora"],["matColumnDef","nombre"],["matColumnDef","total"],["matColumnDef","imprimir"],["mat-header-cell","","style","width: 10%;",4,"matHeaderCellDef"],["mat-cell","","class","tamanioAmigable","style","width: 10%;",4,"matCellDef"],["matColumnDef","cancelar"],["matColumnDef","facturar"],["matColumnDef","expandedDetail"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","","class","example-element-row",3,"example-expanded-row","click",4,"matRowDef","matRowDefColumns"],["mat-row","","class","example-detail-row",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],["mat-header-cell","",2,"width","10%"],["mat-cell","",1,"tamanioAmigable",2,"width","10%"],["mat-flat-button","","type","button","color","accent",1,"btnCelSize",3,"click"],[1,"example-element-detail"],[2,"width","75%","background-color","#f5f5f5","table-layout","fixed"],[4,"ngIf"],[1,"rtxt"],[4,"ngFor","ngForOf"],["colspan","2"],[1,"long-notes"],["colspan","2",1,"tabulador-doble"],["mat-header-row",""],["mat-row","",1,"example-element-row",3,"click"],["mat-row","",1,"example-detail-row"]],template:function(t,e){1&t&&(W.Tb(0,"div",0),W.Tb(1,"div",1),W.Tb(2,"table",2),W.Rb(3,3),W.Dc(4,Xn,2,0,"th",4),W.Dc(5,Yn,2,1,"td",5),W.Qb(),W.Rb(6,6),W.Dc(7,Zn,2,0,"th",4),W.Dc(8,ti,2,1,"td",5),W.Qb(),W.Rb(9,7),W.Dc(10,ei,2,0,"th",4),W.Dc(11,ai,3,4,"td",5),W.Qb(),W.Rb(12,8),W.Dc(13,oi,2,0,"th",4),W.Dc(14,ni,2,1,"td",5),W.Qb(),W.Rb(15,9),W.Dc(16,ii,2,0,"th",4),W.Dc(17,si,3,4,"td",5),W.Qb(),W.Rb(18,10),W.Dc(19,ci,2,0,"th",11),W.Dc(20,ri,3,0,"td",12),W.Qb(),W.Rb(21,13),W.Dc(22,li,2,0,"th",11),W.Dc(23,di,3,0,"td",12),W.Qb(),W.Rb(24,14),W.Dc(25,ui,2,0,"th",11),W.Dc(26,bi,3,0,"td",12),W.Qb(),W.Rb(27,15),W.Dc(28,Ti,15,6,"td",5),W.Qb(),W.Dc(29,vi,1,0,"tr",16),W.Dc(30,Mi,1,2,"tr",17),W.Dc(31,Fi,1,0,"tr",18),W.Sb(),W.Sb(),W.Sb()),2&t&&(W.Cb(2),W.lc("dataSource",e.dataSource),W.Cb(27),W.lc("matHeaderRowDef",e.columnsToDisplay),W.Cb(1),W.lc("matRowDefColumns",e.columnsToDisplay),W.Cb(1),W.lc("matRowDefColumns",W.nc(4,xi)))},directives:[S.k,S.c,S.e,S.b,S.g,S.j,S.d,S.a,v.a,o.m,o.l,S.f,S.i],pipes:[o.e,o.f],styles:["table[_ngcontent-%COMP%]{width:100%}tr.example-detail-row[_ngcontent-%COMP%]{height:0}tr.example-element-row[_ngcontent-%COMP%]:not(.example-expanded-row):hover{background:#777}tr.example-element-row[_ngcontent-%COMP%]:not(.example-expanded-row):active{background:#efefef}.tamanioAmigable[_ngcontent-%COMP%]{padding:5px;width:10%!important;min-height:55px}.btnCelSize[_ngcontent-%COMP%]{min-width:55px;width:100%}.example-element-row[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border-bottom-width:0}.example-element-detail[_ngcontent-%COMP%]{overflow:hidden;display:flex}.example-element-diagram[_ngcontent-%COMP%]{min-width:80px;border:2px solid #000;padding:8px;font-weight:lighter;margin:8px 0;height:104px}.example-element-symbol[_ngcontent-%COMP%]{font-weight:700;font-size:40px;line-height:normal}.example-element-description[_ngcontent-%COMP%]{padding:16px}.example-element-description-attribution[_ngcontent-%COMP%]{opacity:.5}.long-notes[_ngcontent-%COMP%]{overflow-wrap:break-word}"],data:{animation:[Object(Kn.m)("detailExpand",[Object(Kn.j)("collapsed",Object(Kn.k)({height:"0px",minHeight:"0"})),Object(Kn.j)("expanded",Object(Kn.k)({height:"*"})),Object(Kn.l)("expanded <=> collapsed",Object(Kn.e)("225ms cubic-bezier(0.4, 0.0, 0.2, 1)"))])]}}),t})();var Oi=a("roIu");function Di(t,e){if(1&t&&(W.Tb(0,"mat-option",17),W.Fc(1),W.Sb()),2&t){const t=e.$implicit;W.lc("value",t.turno_tipo),W.Cb(1),W.Hc(" ",t.descripcion," ")}}function Ei(t,e){if(1&t&&(W.Tb(0,"mat-option",17),W.Fc(1),W.Sb()),2&t){const t=e.$implicit;W.lc("value",t.sede.sede),W.Cb(1),W.Hc(" ",t.sede.nombre," ")}}function Pi(t,e){if(1&t&&(W.Tb(0,"mat-option",17),W.Fc(1),W.Sb()),2&t){const t=e.$implicit;W.lc("value",t.id),W.Cb(1),W.Hc(" ",t.descripcion," ")}}function _i(t,e){if(1&t){const t=W.Ub();W.Tb(0,"mat-form-field",5),W.Tb(1,"mat-label"),W.Fc(2,"Agrupar por"),W.Sb(),W.Tb(3,"mat-select",18),W.bc("ngModelChange",function(e){return W.xc(t),W.fc().params._grupo=e}),W.Dc(4,Pi,2,2,"mat-option",7),W.Sb(),W.Sb()}if(2&t){const t=W.fc();W.Cb(3),W.lc("ngModel",t.params._grupo),W.Cb(1),W.lc("ngForOf",t.grupos)}}function yi(t,e){1&t&&W.Ob(0,"hr")}const Ii=function(){return{standalone:!0}};function wi(t,e){if(1&t&&(W.Tb(0,"div"),W.Tb(1,"mat-form-field",5),W.Tb(2,"input",20),W.bc("ngModelChange",function(t){return e.$implicit.monto=t}),W.Sb(),W.Sb(),W.Sb()),2&t){const t=e.$implicit;W.Cb(2),W.mc("placeholder",t.descripcion),W.lc("ngModel",t.monto)("ngModelOptions",W.nc(3,Ii))}}function Ai(t,e){if(1&t&&(W.Tb(0,"form"),W.Dc(1,wi,3,4,"div",19),W.Sb()),2&t){const t=W.fc();W.Cb(1),W.lc("ngForOf",t.fpagos)}}function Ni(t,e){1&t&&W.Ob(0,"app-cargando")}let Ri=(()=>{class t{constructor(t,e,a,o,n){this.snackBar=t,this.pdfServicio=e,this.tipoTurnoSrvc=a,this.fpagoSrvc=o,this.sedeSrvc=n,this.params={_validar:!1,sede:[]},this.titulo="Resumen de caja",this.tiposTurno=[],this.cargando=!1,this.fpagos=[],this.sedes=[],this.grupos=X.b.grupos,this.configBotones={showPdf:!0,showHtml:!1,showExcel:!0},this.loadFormaPago=()=>{this.fpagoSrvc.get().subscribe(t=>{t&&(this.fpagos=t)})},this.loadSedes=()=>{this.sedeSrvc.getSedes({reporte:!0}).subscribe(t=>{t&&(this.sedes=t)})},this.loadTiposTurno=()=>{this.tipoTurnoSrvc.get().subscribe(t=>{t&&(this.tiposTurno=t)})},this.resetParams=()=>{this.params={},this.cargando=!1},this.excelClick=()=>{this.cargando=!0,this.params._pagos=this.fpagos,this.params._excel=1,this.pdfServicio.getReporteCaja(this.params).subscribe(t=>{if(this.cargando=!1,t){const e=new Blob([t],{type:"application/vnd.ms-excel"});Object(gn.saveAs)(e,`${this.titulo}.xls`)}else this.snackBar.open("No se pudo generar el reporte...",this.titulo,{duration:3e3})})}}ngOnInit(){this.loadTiposTurno(),this.loadFormaPago(),this.loadSedes()}onSubmit(){this.cargando=!0,this.params._pagos=this.fpagos,this.params._excel=0,this.pdfServicio.getReporteCaja(this.params).subscribe(t=>{if(this.cargando=!1,t){const e=new Blob([t],{type:"application/pdf"});Object(gn.saveAs)(e,`${this.titulo}.pdf`)}else this.snackBar.open("No se pudo generar el reporte...",this.titulo,{duration:3e3})})}}return t.\u0275fac=function(e){return new(e||t)(W.Nb(M.b),W.Nb(ba.a),W.Nb(No),W.Nb(Oi.a),W.Nb(Cn.a))},t.\u0275cmp=W.Hb({type:t,selectors:[["app-caja"]],decls:35,vars:17,consts:[[1,"row"],[1,"col","m12","s12"],[1,"mat-elevation-z4","fullWidth"],["novalidate",""],["frmRptCaja","ngForm"],[1,"fullWidth"],["name","turno_tipo",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["matInput","","type","date","placeholder","Del","required","",3,"ngModel","ngModelOptions","ngModelChange"],["matInput","","type","date","placeholder","Al","required","",3,"ngModel","ngModelOptions","ngModelChange"],["name","sede","multiple","",3,"ngModel","ngModelChange"],["class","fullWidth",4,"ngIf"],[1,"col"],["name","mostrar_detalle",1,"fullWidth",3,"ngModel","ngModelChange"],["name","validar",1,"fullWidth",3,"ngModel","ngModelChange"],[4,"ngIf"],[3,"configuracion","excelClick","pdfClick","resetParamsClick"],[3,"value"],["name","grupo",3,"ngModel","ngModelChange"],[4,"ngFor","ngForOf"],["matInput","","type","number","step","0.01",3,"placeholder","ngModel","ngModelOptions","ngModelChange"]],template:function(t,e){1&t&&(W.Tb(0,"div",0),W.Tb(1,"div",1),W.Tb(2,"mat-card",2),W.Tb(3,"mat-card-title"),W.Tb(4,"h4"),W.Fc(5,"Reporte de caja"),W.Sb(),W.Sb(),W.Tb(6,"mat-card-content"),W.Tb(7,"form",3,4),W.Tb(9,"mat-form-field",5),W.Tb(10,"mat-label"),W.Fc(11,"Tipo de turno"),W.Sb(),W.Tb(12,"mat-select",6),W.bc("ngModelChange",function(t){return e.params.turno_tipo=t}),W.Dc(13,Di,2,2,"mat-option",7),W.Sb(),W.Sb(),W.Tb(14,"mat-form-field",5),W.Tb(15,"input",8),W.bc("ngModelChange",function(t){return e.params.fdel=t}),W.Sb(),W.Sb(),W.Tb(16,"mat-form-field",5),W.Tb(17,"input",9),W.bc("ngModelChange",function(t){return e.params.fal=t}),W.Sb(),W.Sb(),W.Tb(18,"mat-form-field",5),W.Tb(19,"mat-label"),W.Fc(20,"Sede"),W.Sb(),W.Tb(21,"mat-select",10),W.bc("ngModelChange",function(t){return e.params.sede=t}),W.Dc(22,Ei,2,2,"mat-option",7),W.Sb(),W.Sb(),W.Dc(23,_i,5,2,"mat-form-field",11),W.Tb(24,"div",0),W.Tb(25,"div",12),W.Tb(26,"mat-checkbox",13),W.bc("ngModelChange",function(t){return+(e.params._detalle=t)}),W.Fc(27,"Mostrar Detalle"),W.Sb(),W.Sb(),W.Tb(28,"div",12),W.Tb(29,"mat-checkbox",14),W.bc("ngModelChange",function(t){return+(e.params._validar=t)}),W.Fc(30,"Validar Montos"),W.Sb(),W.Sb(),W.Sb(),W.Dc(31,yi,1,0,"hr",15),W.Dc(32,Ai,2,1,"form",15),W.Tb(33,"app-rpt-botones",16),W.bc("excelClick",function(){return e.excelClick()})("pdfClick",function(){return e.onSubmit()})("resetParamsClick",function(){return e.resetParams()}),W.Sb(),W.Sb(),W.Dc(34,Ni,1,0,"app-cargando",15),W.Sb(),W.Sb(),W.Sb(),W.Sb()),2&t&&(W.Cb(12),W.lc("ngModel",e.params.turno_tipo),W.Cb(1),W.lc("ngForOf",e.tiposTurno),W.Cb(2),W.lc("ngModel",e.params.fdel)("ngModelOptions",W.nc(15,Ii)),W.Cb(2),W.lc("ngModel",e.params.fal)("ngModelOptions",W.nc(16,Ii)),W.Cb(4),W.lc("ngModel",e.params.sede),W.Cb(1),W.lc("ngForOf",e.sedes),W.Cb(1),W.lc("ngIf",e.params.sede&&e.params.sede.length>1),W.Cb(3),W.lc("ngModel",+e.params._detalle),W.Cb(3),W.lc("ngModel",+e.params._validar),W.Cb(2),W.lc("ngIf",e.params._validar),W.Cb(1),W.lc("ngIf",e.params._validar),W.Cb(1),W.lc("configuracion",e.configBotones),W.Cb(1),W.lc("ngIf",e.cargando))},directives:[p.a,p.h,p.c,i.r,i.l,i.m,m.b,m.f,C.a,i.k,i.n,o.l,h.b,i.c,i.p,o.m,T.a,Tn.a,_.m,i.o,Se.a],styles:[""]}),t})();function Ui(t,e){1&t&&W.Ob(0,"app-cargando")}let $i=(()=>{class t{constructor(t,e){this.snackBar=t,this.pdfServicio=e,this.params={},this.titulo="Facturas",this.cargando=!1,this.configBotones={showPdf:!0,showHtml:!1,showExcel:!0,isPdfDisabled:!1,isExcelDisabled:!1},this.resetParams=()=>{this.params={fdel:se().startOf("month").format(X.b.dbDateFormat),fal:se().format(X.b.dbDateFormat)},this.cargando=!1},this.chkDates=()=>{this.configBotones.isPdfDisabled=!this.params.fdel||!this.params.fal,this.configBotones.isExcelDisabled=!this.params.fdel||!this.params.fal}}ngOnInit(){this.resetParams()}onSubmit(){this.cargando=!0,this.params._excel=0,this.pdfServicio.getReporteFactura(this.params).subscribe(t=>{if(this.cargando=!1,t){const e=new Blob([t],{type:"application/pdf"});Object(gn.saveAs)(e,`${this.titulo}.pdf`)}else this.snackBar.open("No se pudo generar el reporte...",this.titulo,{duration:3e3})})}excelClick(){this.cargando=!0,this.params._excel=1,this.pdfServicio.getReporteFactura(this.params).subscribe(t=>{if(this.cargando=!1,t){const e=new Blob([t],{type:"application/vnd.ms-excel"});Object(gn.saveAs)(e,`${this.titulo}.xls`)}else this.snackBar.open("No se pudo generar el reporte...",this.titulo,{duration:3e3})})}}return t.\u0275fac=function(e){return new(e||t)(W.Nb(M.b),W.Nb(ba.a))},t.\u0275cmp=W.Hb({type:t,selectors:[["app-factura"]],decls:22,vars:6,consts:[[1,"row"],[1,"col","m12","s12"],[1,"mat-elevation-z4","fullWidth"],["novalidate",""],["frmRptFactura","ngForm"],[1,"fullWidth"],["matInput","","type","date","placeholder","Del","name","fdel","required","",3,"ngModel","ngModelChange","change"],["matInput","","type","date","placeholder","Al","name","fal","required","",3,"ngModel","ngModelChange","change"],[1,"col"],["name","detalle",1,"fullWidth",3,"ngModel","ngModelChange"],["name","anuladas",1,"fullWidth",3,"ngModel","ngModelChange"],[3,"configuracion","excelClick","pdfClick","resetParamsClick"],[4,"ngIf"]],template:function(t,e){1&t&&(W.Tb(0,"div",0),W.Tb(1,"div",1),W.Tb(2,"mat-card",2),W.Tb(3,"mat-card-title"),W.Tb(4,"h4"),W.Fc(5,"Reporte de facturas"),W.Sb(),W.Sb(),W.Tb(6,"mat-card-content"),W.Tb(7,"form",3,4),W.Tb(9,"mat-form-field",5),W.Tb(10,"input",6),W.bc("ngModelChange",function(t){return e.params.fdel=t})("change",function(){return e.chkDates()}),W.Sb(),W.Sb(),W.Tb(11,"mat-form-field",5),W.Tb(12,"input",7),W.bc("ngModelChange",function(t){return e.params.fal=t})("change",function(){return e.chkDates()}),W.Sb(),W.Sb(),W.Tb(13,"div",0),W.Tb(14,"div",8),W.Tb(15,"mat-checkbox",9),W.bc("ngModelChange",function(t){return+(e.params._detalle=t)}),W.Fc(16,"Mostrar Detalle"),W.Sb(),W.Sb(),W.Tb(17,"div",8),W.Tb(18,"mat-checkbox",10),W.bc("ngModelChange",function(t){return+(e.params._anuladas=t)}),W.Fc(19,"Mostrar \xdanicamente Anuladas"),W.Sb(),W.Sb(),W.Sb(),W.Tb(20,"app-rpt-botones",11),W.bc("excelClick",function(){return e.excelClick()})("pdfClick",function(){return e.onSubmit()})("resetParamsClick",function(){return e.resetParams()}),W.Sb(),W.Sb(),W.Dc(21,Ui,1,0,"app-cargando",12),W.Sb(),W.Sb(),W.Sb(),W.Sb()),2&t&&(W.Cb(10),W.lc("ngModel",e.params.fdel),W.Cb(2),W.lc("ngModel",e.params.fal),W.Cb(3),W.lc("ngModel",+e.params._detalle),W.Cb(3),W.lc("ngModel",+e.params._anuladas),W.Cb(2),W.lc("configuracion",e.configBotones),W.Cb(1),W.lc("ngIf",e.cargando))},directives:[p.a,p.h,p.c,i.r,i.l,i.m,m.b,h.b,i.c,i.p,i.k,i.n,T.a,Tn.a,o.m,Se.a],styles:[""]}),t})();function Bi(t,e){if(1&t){const t=W.Ub();W.Tb(0,"mat-list-item",5),W.bc("click",function(){W.xc(t);const a=e.$implicit;return W.fc().getTurno(a)}),W.Tb(1,"mat-icon",6),W.Fc(2,"line_weight"),W.Sb(),W.Tb(3,"h5",7),W.Fc(4),W.Sb(),W.Sb()}if(2&t){const t=e.$implicit;W.Cb(4),W.Gc(t.descripcion)}}const ji=function(){return{standalone:!0}};let Hi=(()=>{class t{constructor(t){this.turnoSrvc=t,this.getTurnoEv=new W.o,this.length=0,this.pageSize=5,this.pageSizeOptions=[5,10,15],this.pageIndex=0,this.txtFiltro="",this.loadTurnos=()=>{this.turnoSrvc.get().subscribe(t=>{t&&t.length>0&&(this.lstTurnos=t,this.applyFilter())})},this.getTurno=t=>{this.getTurnoEv.emit(t)},this.pageChange=t=>{this.pageSize=t.pageSize,this.pageIndex=t.pageIndex,this.applyFilter()}}ngOnInit(){this.loadTurnos()}applyFilter(){if(this.txtFiltro.length>0){const t=Object(X.c)(this.lstTurnos,this.txtFiltro);this.length=t.length,this.lstTurnosPaged=Object(X.f)(t,this.pageSize,this.pageIndex+1)}else this.length=this.lstTurnos.length,this.lstTurnosPaged=Object(X.f)(this.lstTurnos,this.pageSize,this.pageIndex+1)}}return t.\u0275fac=function(e){return new(e||t)(W.Nb(No))},t.\u0275cmp=W.Hb({type:t,selectors:[["app-lista-turno-tipo"]],outputs:{getTurnoEv:"getTurnoEv"},decls:7,vars:7,consts:[[1,"mat-elevation-z4","fullWidth"],[1,"fullWidth"],["matInput","","placeholder","Buscar...",3,"ngModel","ngModelOptions","keyup","ngModelChange"],[3,"click",4,"ngFor","ngForOf"],["showFirstLastButtons","",3,"length","pageSize","pageSizeOptions","page"],[3,"click"],["mat-list-icon",""],["mat-line",""]],template:function(t,e){1&t&&(W.Tb(0,"mat-card",0),W.Tb(1,"mat-card-content"),W.Tb(2,"mat-form-field",1),W.Tb(3,"input",2),W.bc("keyup",function(){return e.applyFilter()})("ngModelChange",function(t){return e.txtFiltro=t}),W.Sb(),W.Sb(),W.Tb(4,"mat-nav-list"),W.Dc(5,Bi,5,1,"mat-list-item",3),W.Sb(),W.Tb(6,"mat-paginator",4),W.bc("page",function(t){return e.pageChange(t)}),W.Sb(),W.Sb(),W.Sb()),2&t&&(W.Cb(3),W.lc("ngModel",e.txtFiltro)("ngModelOptions",W.nc(6,ji)),W.Cb(2),W.lc("ngForOf",e.lstTurnosPaged),W.Cb(1),W.lc("length",e.length)("pageSize",e.pageSize)("pageSizeOptions",e.pageSizeOptions))},directives:[p.a,p.c,m.b,h.b,i.c,i.k,i.n,u.e,o.l,O.a,u.c,b.a,u.b,_.j],styles:[""]}),t})();function Li(t,e){if(1&t){const t=W.Ub();W.Tb(0,"button",9),W.bc("click",function(){return W.xc(t),W.fc().resetTurno()}),W.Fc(1," Nuevo "),W.Sb()}}let qi=(()=>{class t{constructor(t,e){this._snackBar=t,this.turnoSrvc=e,this.turnoSavedEv=new W.o,this.resetTurno=()=>this.turno={turno_tipo:null,descripcion:null,activo:1},this.onSubmit=()=>{this.turnoSrvc.save(this.turno).subscribe(t=>{t.exito?(this.turnoSavedEv.emit(),this.resetTurno(),this._snackBar.open("Tipo de Turno agregado...","Turno",{duration:3e3})):this._snackBar.open(`ERROR: ${t.mensaje}`,"Turno",{duration:3e3})})}}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)(W.Nb(M.b),W.Nb(No))},t.\u0275cmp=W.Hb({type:t,selectors:[["app-form-turno-tipo"]],inputs:{turno:"turno"},outputs:{turnoSavedEv:"turnoSavedEv"},decls:15,vars:5,consts:[[1,"mat-elevation-z4","fullWidth"],["novalidate","",3,"ngSubmit"],["frmTurno","ngForm"],[1,"fullWidth"],["matInput","","type","text","placeholder","Descripci\xf3n","name","descripcion","required","",3,"ngModel","ngModelChange"],["name","activo",1,"fullWidth",3,"ngModel","ngModelChange"],["align","end"],["mat-raised-button","","type","submit","color","accent",1,"btnAccion",3,"disabled"],["mat-raised-button","","type","button","color","accent",3,"click",4,"ngIf"],["mat-raised-button","","type","button","color","accent",3,"click"]],template:function(t,e){if(1&t){const t=W.Ub();W.Tb(0,"mat-card",0),W.Tb(1,"mat-card-title"),W.Tb(2,"h4"),W.Fc(3),W.Sb(),W.Sb(),W.Tb(4,"mat-card-content"),W.Tb(5,"form",1,2),W.bc("ngSubmit",function(){return W.xc(t),W.tc(6).form.valid&&e.onSubmit()}),W.Tb(7,"mat-form-field",3),W.Tb(8,"input",4),W.bc("ngModelChange",function(t){return e.turno.descripcion=t}),W.Sb(),W.Sb(),W.Tb(9,"mat-checkbox",5),W.bc("ngModelChange",function(t){return+(e.turno.activo=t)}),W.Fc(10,"Activo"),W.Sb(),W.Tb(11,"div",6),W.Tb(12,"button",7),W.Fc(13," Guardar "),W.Sb(),W.Dc(14,Li,2,0,"button",8),W.Sb(),W.Sb(),W.Sb(),W.Sb()}if(2&t){const t=W.tc(6);W.Cb(3),W.Hc(" Tipo de Turno ",e.turno.turno_tipo?e.turno.descripcion:""," "),W.Cb(5),W.lc("ngModel",e.turno.descripcion),W.Cb(1),W.lc("ngModel",+e.turno.activo),W.Cb(3),W.lc("disabled",!t.form.valid),W.Cb(2),W.lc("ngIf",e.turno.turno_tipo)}},directives:[p.a,p.h,p.c,i.r,i.l,i.m,m.b,h.b,i.c,i.p,i.k,i.n,T.a,v.a,o.m],styles:[""]}),t})();const zi=["lstTurno"];let Gi=(()=>{class t{constructor(){this.setTurno=t=>this.turno=t,this.refreshTurnoList=()=>this.lstTurnoComponent.loadTurnos(),this.turno={turno_tipo:null,descripcion:null,activo:1}}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=W.Hb({type:t,selectors:[["app-turno-tipo"]],viewQuery:function(t,e){if(1&t&&W.Kc(zi,1),2&t){let t;W.sc(t=W.cc())&&(e.lstTurnoComponent=t.first)}},decls:7,vars:1,consts:[[1,"row"],[1,"col","m5","s12"],[3,"getTurnoEv"],["lstTurno",""],[1,"col","m7","s12"],[3,"turno","turnoSavedEv"],["frmTurno",""]],template:function(t,e){1&t&&(W.Tb(0,"div",0),W.Tb(1,"div",1),W.Tb(2,"app-lista-turno-tipo",2,3),W.bc("getTurnoEv",function(t){return e.setTurno(t)}),W.Sb(),W.Sb(),W.Tb(4,"div",4),W.Tb(5,"app-form-turno-tipo",5,6),W.bc("turnoSavedEv",function(){return e.refreshTurnoList()}),W.Sb(),W.Sb(),W.Sb()),2&t&&(W.Cb(5),W.lc("turno",e.turno))},directives:[Hi,qi],styles:[""]}),t})(),Wi=(()=>{class t{constructor(t){this.http=t,this.moduleUrl="propina",this.srvcErrHndl=new Y.a}get(t={}){return this.http.get(`${X.b.urlAppRestaurante}/${this.moduleUrl}/buscar?${et.stringify(t)}`).pipe(Object(Z.a)(X.b.reintentos),Object(tt.a)(this.srvcErrHndl.errorHandler))}save(t){return this.http.post(`${X.b.urlAppRestaurante}/${this.moduleUrl}/guardar${t.propina_distribucion?"/"+t.propina_distribucion:""}`,t).pipe(Object(Z.a)(X.b.reintentos),Object(tt.a)(this.srvcErrHndl.errorHandler))}}return t.\u0275fac=function(e){return new(e||t)(W.Xb(n.b))},t.\u0275prov=W.Jb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function Vi(t,e){if(1&t){const t=W.Ub();W.Tb(0,"td",7),W.bc("click",function(){W.xc(t);const a=e.$implicit;return W.fc().getPropina(a)}),W.Tb(1,"mat-list"),W.Tb(2,"mat-list-item"),W.Tb(3,"mat-icon",8),W.Fc(4,"line_weight"),W.Sb(),W.Tb(5,"h5",9),W.Fc(6),W.Sb(),W.Tb(7,"span",9),W.Fc(8),W.Sb(),W.Tb(9,"button",10),W.Tb(10,"mat-icon"),W.Fc(11,"arrow_right_alt"),W.Sb(),W.Sb(),W.Sb(),W.Sb(),W.Sb()}if(2&t){const t=e.$implicit;W.Cb(6),W.Hc("",t.porcentaje,"%"),W.Cb(2),W.Gc(t.usuario_tipo.descripcion)}}function Ki(t,e){1&t&&W.Ob(0,"tr",11)}const Ji=function(){return[5,10,20]};let Qi=(()=>{class t{constructor(t){this.propinaSrvc=t,this.displayedColumns=["propina"],this.getPropinaEv=new W.o,this.loadPropinas=()=>{this.propinaSrvc.get().subscribe(t=>{t&&t.length>0&&(this.lstPropinas=t,this.dataSource=new S.l(this.lstPropinas),this.dataSource.paginator=this.paginator)})},this.getPropina=t=>{this.getPropinaEv.emit(t)}}ngOnInit(){this.loadPropinas()}applyFilter(t){this.dataSource.filter=t.trim().toLowerCase()}}return t.\u0275fac=function(e){return new(e||t)(W.Nb(Wi))},t.\u0275cmp=W.Hb({type:t,selectors:[["app-lista-propina"]],viewQuery:function(t,e){if(1&t&&W.Kc(O.a,3),2&t){let t;W.sc(t=W.cc())&&(e.paginator=t.first)}},outputs:{getPropinaEv:"getPropinaEv"},decls:9,vars:4,consts:[[1,"mat-elevation-z4","fullWidth"],["matInput","","placeholder","Buscar...",3,"keyup"],["mat-table","",3,"dataSource"],["matColumnDef","propina"],["mat-cell","",3,"click",4,"matCellDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["showFirstLastButtons","",3,"pageSizeOptions"],["mat-cell","",3,"click"],["mat-list-icon",""],["mat-line",""],["mat-icon-button","","type","button","color","accent"],["mat-row",""]],template:function(t,e){1&t&&(W.Tb(0,"mat-card",0),W.Tb(1,"mat-card-content"),W.Tb(2,"mat-form-field"),W.Tb(3,"input",1),W.bc("keyup",function(t){return e.applyFilter(t.target.value)}),W.Sb(),W.Sb(),W.Tb(4,"table",2),W.Rb(5,3),W.Dc(6,Vi,12,2,"td",4),W.Qb(),W.Dc(7,Ki,1,0,"tr",5),W.Sb(),W.Ob(8,"mat-paginator",6),W.Sb(),W.Sb()),2&t&&(W.Cb(4),W.lc("dataSource",e.dataSource),W.Cb(3),W.lc("matRowDefColumns",e.displayedColumns),W.Cb(1),W.lc("pageSizeOptions",W.nc(3,Ji)))},directives:[p.a,p.c,m.b,h.b,S.k,S.c,S.b,S.j,O.a,S.a,u.a,u.c,b.a,u.b,_.j,v.a,S.i],styles:[""]}),t})();function Xi(t,e){if(1&t&&(W.Tb(0,"mat-option",14),W.Fc(1),W.Sb()),2&t){const t=e.$implicit;W.lc("value",t.usuario_tipo),W.Cb(1),W.Hc(" ",t.descripcion," ")}}function Yi(t,e){if(1&t){const t=W.Ub();W.Tb(0,"button",15),W.bc("click",function(){return W.xc(t),W.fc().resetPropina()}),W.Tb(1,"mat-icon"),W.Fc(2,"add"),W.Sb(),W.Sb()}}let Zi=(()=>{class t{constructor(t,e,a){this.snackBar=t,this.propinaSrvc=e,this.usuarioSrvc=a,this.propinaSavedEv=new W.o,this.usuarios=[],this.loadUsuario=()=>{this.usuarioSrvc.get().subscribe(t=>{this.usuarios=t})},this.resetPropina=()=>this.propina={propina_distribucion:null,usuario_tipo:null,porcentaje:null,anulado:0,sede:null,grupal:0},this.onSubmit=()=>{this.propinaSrvc.save(this.propina).subscribe(t=>{t.exito?(this.propinaSavedEv.emit(),this.resetPropina(),this.snackBar.open("Propina agregada...","Distribucion de propinas",{duration:3e3})):this.snackBar.open(`ERROR: ${t.mensaje}`,"Distribucion de propinas",{duration:3e3})})}}ngOnInit(){this.resetPropina(),this.loadUsuario()}}return t.\u0275fac=function(e){return new(e||t)(W.Nb(M.b),W.Nb(Wi),W.Nb(Ro))},t.\u0275cmp=W.Hb({type:t,selectors:[["app-form-propina"]],inputs:{propina:"propina"},outputs:{propinaSavedEv:"propinaSavedEv"},decls:24,vars:7,consts:[[1,"mat-elevation-z4","fullWidth"],["novalidate","",3,"ngSubmit"],["frmPropina","ngForm"],[1,"fullWidth"],["name","usuario","required","",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["matInput","","type","number","step","0.01","placeholder","Porcentaje","name","porcentaje","required","",3,"ngModel","ngModelChange"],[1,"row"],[1,"col","m6","s6"],["name","grupal",1,"fullWidth",3,"ngModel","ngModelChange"],["name","anulado",1,"fullWidth",3,"ngModel","ngModelChange"],["align","end"],["mat-icon-button","","type","submit","color","accent",3,"disabled"],["mat-icon-button","","type","button","color","accent",3,"click",4,"ngIf"],[3,"value"],["mat-icon-button","","type","button","color","accent",3,"click"]],template:function(t,e){if(1&t){const t=W.Ub();W.Tb(0,"mat-card",0),W.Ob(1,"mat-card-title"),W.Tb(2,"mat-card-content"),W.Tb(3,"form",1,2),W.bc("ngSubmit",function(){return W.xc(t),W.tc(4).form.valid&&e.onSubmit()}),W.Tb(5,"mat-form-field",3),W.Tb(6,"mat-label"),W.Fc(7,"Tipo Usuario"),W.Sb(),W.Tb(8,"mat-select",4),W.bc("ngModelChange",function(t){return e.propina.usuario_tipo=t}),W.Dc(9,Xi,2,2,"mat-option",5),W.Sb(),W.Sb(),W.Tb(10,"mat-form-field",3),W.Tb(11,"input",6),W.bc("ngModelChange",function(t){return e.propina.porcentaje=t}),W.Sb(),W.Sb(),W.Tb(12,"div",7),W.Tb(13,"div",8),W.Tb(14,"mat-checkbox",9),W.bc("ngModelChange",function(t){return+(e.propina.grupal=t)}),W.Fc(15,"Propina Grupal"),W.Sb(),W.Sb(),W.Tb(16,"div",8),W.Tb(17,"mat-checkbox",10),W.bc("ngModelChange",function(t){return+(e.propina.anulado=t)}),W.Fc(18,"Anulado"),W.Sb(),W.Sb(),W.Sb(),W.Tb(19,"div",11),W.Tb(20,"button",12),W.Tb(21,"mat-icon"),W.Fc(22,"save"),W.Sb(),W.Sb(),W.Dc(23,Yi,3,0,"button",13),W.Sb(),W.Sb(),W.Sb(),W.Sb()}if(2&t){const t=W.tc(4);W.Cb(8),W.lc("ngModel",e.propina.usuario_tipo),W.Cb(1),W.lc("ngForOf",e.usuarios),W.Cb(2),W.lc("ngModel",e.propina.porcentaje),W.Cb(3),W.lc("ngModel",+e.propina.grupal),W.Cb(3),W.lc("ngModel",+e.propina.anulado),W.Cb(3),W.lc("disabled",!t.form.valid),W.Cb(3),W.lc("ngIf",e.propina.propina_distribucion)}},directives:[p.a,p.h,p.c,i.r,i.l,i.m,m.b,m.f,C.a,i.p,i.k,i.n,o.l,h.b,i.o,i.c,T.a,v.a,b.a,o.m,_.m],styles:[""]}),t})();const ts=["lstPropina"];let es=(()=>{class t{constructor(){this.setPropina=t=>this.propina={propina_distribucion:t.propina_distribucion,usuario_tipo:t.usuario_tipo.usuario_tipo,porcentaje:t.porcentaje,anulado:t.anulado,sede:t.sede,grupal:t.grupal},this.refreshPropinaList=()=>this.lstPropinaComponent.loadPropinas(),this.propina={propina_distribucion:null,usuario_tipo:null,porcentaje:null,anulado:null,sede:null,grupal:null}}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=W.Hb({type:t,selectors:[["app-propina"]],viewQuery:function(t,e){if(1&t&&W.Kc(ts,1),2&t){let t;W.sc(t=W.cc())&&(e.lstPropinaComponent=t.first)}},decls:7,vars:1,consts:[[1,"row"],[1,"col","m5","s12"],[3,"getPropinaEv"],["lstPropina",""],[1,"col","m7","s12"],[3,"propina","propinaSavedEv"],["frmPropina",""]],template:function(t,e){1&t&&(W.Tb(0,"div",0),W.Tb(1,"div",1),W.Tb(2,"app-lista-propina",2,3),W.bc("getPropinaEv",function(t){return e.setPropina(t)}),W.Sb(),W.Sb(),W.Tb(4,"div",4),W.Tb(5,"app-form-propina",5,6),W.bc("propinaSavedEv",function(){return e.refreshPropinaList()}),W.Sb(),W.Sb(),W.Sb()),2&t&&(W.Cb(5),W.lc("propina",e.propina))},directives:[Qi,Zi],styles:[""]}),t})(),as=(()=>{class t{constructor(t){this.http=t,this.srvcErrHndl=new Y.a}getCampos(t={}){return this.http.get(`${X.b.urlCatalogos}/get_campos?${et.stringify(t)}`).pipe(Object(Z.a)(X.b.reintentos),Object(tt.a)(this.srvcErrHndl.errorHandler))}getReporte(t={}){const e={headers:new n.d({Accept:"application/vnd.ms-excel"}),responseType:"blob"};return this.http.post(`${X.b.urlAppRestaurante}/reporte/autoconsulta`,t,e).pipe(Object(Z.a)(X.b.reintentos),Object(tt.a)(this.srvcErrHndl.errorHandler))}}return t.\u0275fac=function(e){return new(e||t)(W.Xb(n.b))},t.\u0275prov=W.Jb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function os(t,e){if(1&t&&(W.Tb(0,"mat-option",14),W.Fc(1),W.Sb()),2&t){const t=e.$implicit;W.lc("value",t.tabla_campo),W.Cb(1),W.Hc(" ",t.descripcion," ")}}function ns(t,e){if(1&t&&(W.Tb(0,"mat-option",14),W.Fc(1),W.Sb()),2&t){const t=e.$implicit;W.lc("value",t.tabla_campo),W.Cb(1),W.Hc(" ",t.descripcion," ")}}function is(t,e){if(1&t&&(W.Tb(0,"mat-option",14),W.Fc(1),W.Sb()),2&t){const t=e.$implicit;W.lc("value",t.tabla_campo),W.Cb(1),W.Hc(" ",t.descripcion," ")}}function ss(t,e){1&t&&W.Ob(0,"app-cargando")}let cs=(()=>{class t{constructor(t,e){this.snackBar=t,this.autoconsultaSrvc=e,this.params={campos:[],datos:[]},this.titulo="Autoconsulta",this.campos=[],this.fechas=[],this.orden=[],this.cargando=!1,this.configBotones={showPdf:!1,showHtml:!1,showExcel:!0},this.resetParams=()=>{this.params={campos:[],datos:[]},this.cargando=!1},this.getReporte=()=>{this.cargando=!0;for(const t in this.params.campos)this.params.datos.push(this.params.campos[t]);this.autoconsultaSrvc.getReporte(this.params).subscribe(t=>{if(this.cargando=!1,t){const e=new Blob([t],{type:"application/vnd.ms-excel"});Object(gn.saveAs)(e,`${this.titulo}.xls`)}else this.snackBar.open("No se pudo generar el reporte...",this.titulo,{duration:3e3})})},this.getCampos=(t={},e=1)=>{this.cargando=!0,this.autoconsultaSrvc.getCampos(t).subscribe(t=>{switch(this.cargando=!1,e){case 1:this.campos=t;break;case 2:this.fechas=t;break;case 3:this.orden=t}})}}ngOnInit(){this.getCampos(),this.getCampos({por_fecha:1},2),this.getCampos({ordenar_por:1},3)}}return t.\u0275fac=function(e){return new(e||t)(W.Nb(M.b),W.Nb(as))},t.\u0275cmp=W.Hb({type:t,selectors:[["app-autoconsulta"]],decls:30,vars:10,consts:[[1,"row"],[1,"col","m12","s12"],[1,"mat-elevation-z4","fullWidth"],["novalidate",""],["frmEntidad","ngForm"],[1,"fullWidth"],["name","campos","multiple","multiple","required","",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["type","date","matInput","","placeholder","Del","name","fdel","required","",3,"ngModel","ngModelChange"],["type","date","matInput","","placeholder","Al","name","fal","required","",3,"ngModel","ngModelChange"],["name","campos","required","",3,"ngModel","ngModelChange"],["name","campos",3,"ngModel","ngModelChange"],[3,"configuracion","excelClick","resetParamsClick"],[4,"ngIf"],[3,"value"]],template:function(t,e){1&t&&(W.Tb(0,"div",0),W.Tb(1,"div",1),W.Tb(2,"mat-card",2),W.Tb(3,"mat-card-title"),W.Tb(4,"h4"),W.Fc(5,"Autoconsulta"),W.Sb(),W.Sb(),W.Tb(6,"mat-card-content"),W.Tb(7,"form",3,4),W.Tb(9,"mat-form-field",5),W.Tb(10,"mat-label"),W.Fc(11,"Campos"),W.Sb(),W.Tb(12,"mat-select",6),W.bc("ngModelChange",function(t){return e.params.campos=t}),W.Dc(13,os,2,2,"mat-option",7),W.Sb(),W.Sb(),W.Tb(14,"mat-form-field",5),W.Tb(15,"input",8),W.bc("ngModelChange",function(t){return e.params.fdel=t}),W.Sb(),W.Sb(),W.Tb(16,"mat-form-field",5),W.Tb(17,"input",9),W.bc("ngModelChange",function(t){return e.params.fal=t}),W.Sb(),W.Sb(),W.Tb(18,"mat-form-field",5),W.Tb(19,"mat-label"),W.Fc(20,"Filtrar Por"),W.Sb(),W.Tb(21,"mat-select",10),W.bc("ngModelChange",function(t){return e.params.fecha=t}),W.Dc(22,ns,2,2,"mat-option",7),W.Sb(),W.Sb(),W.Tb(23,"mat-form-field",5),W.Tb(24,"mat-label"),W.Fc(25,"Ordenar Por"),W.Sb(),W.Tb(26,"mat-select",11),W.bc("ngModelChange",function(t){return e.params.orden=t}),W.Dc(27,is,2,2,"mat-option",7),W.Sb(),W.Sb(),W.Tb(28,"app-rpt-botones",12),W.bc("excelClick",function(){return e.getReporte()})("resetParamsClick",function(){return e.resetParams()}),W.Sb(),W.Sb(),W.Dc(29,ss,1,0,"app-cargando",13),W.Sb(),W.Sb(),W.Sb(),W.Sb()),2&t&&(W.Cb(12),W.lc("ngModel",e.params.campos),W.Cb(1),W.lc("ngForOf",e.campos),W.Cb(2),W.lc("ngModel",e.params.fdel),W.Cb(2),W.lc("ngModel",e.params.fal),W.Cb(4),W.lc("ngModel",e.params.fecha),W.Cb(1),W.lc("ngForOf",e.fechas),W.Cb(4),W.lc("ngModel",e.params.orden),W.Cb(1),W.lc("ngForOf",e.orden),W.Cb(1),W.lc("configuracion",e.configBotones),W.Cb(1),W.lc("ngIf",e.cargando))},directives:[p.a,p.h,p.c,i.r,i.l,i.m,m.b,m.f,C.a,i.p,i.k,i.n,o.l,h.b,i.c,Tn.a,o.m,_.m,Se.a],styles:[""]}),t})(),rs=(()=>{class t{constructor(t){this.http=t,this.moduleUrl="cajacorte",this.srvcErrHndl=new Y.a}buscar(t={}){return this.http.get(`${X.b.urlAppRestaurante}/${this.moduleUrl}/buscar?${et.stringify(t)}`).pipe(Object(Z.a)(X.b.reintentos),Object(tt.a)(this.srvcErrHndl.errorHandler))}getCajaCorteTipo(t={}){return this.http.get(`${X.b.urlCatalogos}/get_caja_corte_tipo?${et.stringify(t)}`).pipe(Object(Z.a)(X.b.reintentos),Object(tt.a)(this.srvcErrHndl.errorHandler))}getCajaCorteNominacion(t={}){return this.http.get(`${X.b.urlCatalogos}/get_caja_corte_nominacion?${et.stringify(t)}`).pipe(Object(Z.a)(X.b.reintentos),Object(tt.a)(this.srvcErrHndl.errorHandler))}guardar(t){return this.http.post(`${X.b.urlAppRestaurante}/${this.moduleUrl}/guardar`,t).pipe(Object(Z.a)(X.b.reintentos),Object(tt.a)(this.srvcErrHndl.errorHandler))}anularCorte(t){return this.http.post(`${X.b.urlAppRestaurante}/${this.moduleUrl}/anular_caja`,t).pipe(Object(Z.a)(X.b.reintentos),Object(tt.a)(this.srvcErrHndl.errorHandler))}anularDetalle(t){return this.http.post(`${X.b.urlAppRestaurante}/${this.moduleUrl}/anular_caja_detalle`,t).pipe(Object(Z.a)(X.b.reintentos),Object(tt.a)(this.srvcErrHndl.errorHandler))}}return t.\u0275fac=function(e){return new(e||t)(W.Xb(n.b))},t.\u0275prov=W.Jb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function ls(t,e){if(1&t){const t=W.Ub();W.Tb(0,"td",7),W.Tb(1,"mat-list"),W.Tb(2,"mat-list-item"),W.Tb(3,"mat-icon",8),W.bc("click",function(){W.xc(t);const a=e.$implicit;return W.fc().anularCaja(a)}),W.Fc(4,"close"),W.Sb(),W.Tb(5,"h5",9),W.Fc(6),W.Sb(),W.Tb(7,"span",9),W.Fc(8),W.Sb(),W.Tb(9,"span",9),W.Fc(10),W.Sb(),W.Tb(11,"button",10),W.bc("click",function(){W.xc(t);const a=e.$implicit;return W.fc().getCajacorte(a)}),W.Tb(12,"mat-icon"),W.Fc(13,"arrow_right_alt"),W.Sb(),W.Sb(),W.Sb(),W.Sb(),W.Sb()}if(2&t){const t=e.$implicit;W.Cb(6),W.Gc(t.descripcion),W.Cb(2),W.Gc(t.creacion),W.Cb(2),W.Hc("Total: ",t.total,"")}}function ds(t,e){1&t&&W.Ob(0,"tr",11)}const us=function(){return[5,10,20]};let bs=(()=>{class t{constructor(t,e){this.ccorteSrvc=t,this._snackBar=e,this.displayedColumns=["ccGeneral"],this.getCajacorteEv=new W.o,this.getCajascortes=()=>{this.ccorteSrvc.buscar().subscribe(t=>{this.listacc=t,this.dataSource=new S.l(this.listacc),this.dataSource.paginator=this.paginator})},this.anularCaja=t=>{confirm("\xbfSi anula este corte, se anular\xe1 tambi\xe9n las nominaciones.?")&&this.ccorteSrvc.anularCorte(t).subscribe(t=>{t.exito&&this.getCajascortes(),this._snackBar.open(`${t.mensaje}`,"Corte de caja",{duration:3e3})})},this.getCajacorte=t=>{this.getCajacorteEv.emit(t)}}ngOnInit(){this.getCajascortes()}filtrar(t){this.dataSource.filter=t.trim().toLowerCase()}}return t.\u0275fac=function(e){return new(e||t)(W.Nb(rs),W.Nb(M.b))},t.\u0275cmp=W.Hb({type:t,selectors:[["app-cajacorte-lista"]],viewQuery:function(t,e){if(1&t&&W.Kc(O.a,3),2&t){let t;W.sc(t=W.cc())&&(e.paginator=t.first)}},outputs:{getCajacorteEv:"getCajacorteEv"},decls:9,vars:4,consts:[[1,"mat-elevation-z4","fullWidth"],["matInput","","placeholder","Buscar...",3,"keyup"],["mat-table","",3,"dataSource"],["matColumnDef","ccGeneral"],["mat-cell","",4,"matCellDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["showFirstLastButtons","",3,"pageSizeOptions"],["mat-cell",""],["mat-list-icon","",1,"anulaicon",3,"click"],["mat-line",""],["mat-icon-button","","type","button","color","accent",3,"click"],["mat-row",""]],template:function(t,e){1&t&&(W.Tb(0,"mat-card",0),W.Tb(1,"mat-card-content"),W.Tb(2,"mat-form-field"),W.Tb(3,"input",1),W.bc("keyup",function(t){return e.filtrar(t.target.value)}),W.Sb(),W.Sb(),W.Tb(4,"table",2),W.Rb(5,3),W.Dc(6,ls,14,3,"td",4),W.Qb(),W.Dc(7,ds,1,0,"tr",5),W.Sb(),W.Ob(8,"mat-paginator",6),W.Sb(),W.Sb()),2&t&&(W.Cb(4),W.lc("dataSource",e.dataSource),W.Cb(3),W.lc("matRowDefColumns",e.displayedColumns),W.Cb(1),W.lc("pageSizeOptions",W.nc(3,us)))},directives:[p.a,p.c,m.b,h.b,S.k,S.c,S.b,S.j,O.a,S.a,u.a,u.c,b.a,u.b,_.j,v.a,S.i],styles:[".anulaicon[_ngcontent-%COMP%]{cursor:pointer}"]}),t})();function ms(t,e){if(1&t&&(W.Tb(0,"mat-option",16),W.Fc(1),W.Sb()),2&t){const t=e.$implicit;W.lc("value",t.caja_corte_tipo),W.Cb(1),W.Hc(" ",t.descripcion," ")}}function hs(t,e){if(1&t&&(W.Tb(0,"mat-option",16),W.Fc(1),W.Sb()),2&t){const t=e.$implicit;W.lc("value",t.caja_corte_nominacion),W.Cb(1),W.Hc(" ",t.nombre," ")}}function ps(t,e){if(1&t){const t=W.Ub();W.Tb(0,"mat-grid-list",11),W.Tb(1,"mat-grid-tile"),W.Fc(2),W.Sb(),W.Tb(3,"mat-grid-tile"),W.Fc(4),W.Sb(),W.Tb(5,"mat-grid-tile"),W.Fc(6),W.Sb(),W.Tb(7,"mat-grid-tile"),W.Tb(8,"mat-icon",17),W.bc("click",function(){W.xc(t);const a=e.$implicit;return W.fc().anularCajaDetalle(a)}),W.Fc(9,"close"),W.Sb(),W.Sb(),W.Sb()}if(2&t){const t=e.$implicit;W.Cb(2),W.Gc(t.nombre),W.Cb(2),W.Gc(t.cantidad),W.Cb(2),W.Gc(t.total)}}function fs(t,e){if(1&t){const t=W.Ub();W.Tb(0,"button",18),W.bc("click",function(){return W.xc(t),W.fc().reseteGeneral()}),W.Tb(1,"mat-icon"),W.Fc(2,"add"),W.Sb(),W.Sb()}}let gs=(()=>{class t{constructor(t,e){this._snackBar=t,this.cajacorteSrvc=e,this.cajacorteSavedEv=new W.o,this.ccorteTipo=[],this.ccorteNomi=[],this.detalle={caja_corte_detalle:0,caja_corte:0,cantidad:0,total:0,anulado:0,caja_corte_nominacion:0,nombre:null},this.getCajaCorteTipo=()=>{this.cajacorteSrvc.getCajaCorteTipo().subscribe(t=>{this.ccorteTipo=t})},this.getCajaCorteNominacion=()=>{this.cajacorteSrvc.getCajaCorteNominacion().subscribe(t=>{this.ccorteNomi=t})},this.setTotal=()=>{if(this.detalle.caja_corte_nominacion){let t=this.ccorteNomi.filter(t=>t.caja_corte_nominacion==this.detalle.caja_corte_nominacion)[0];this.detalle.total=1==t.calcula?this.detalle.cantidad*t.valor:this.detalle.cantidad}},this.setNamenomi=()=>{let t=this.ccorteNomi.filter(t=>t.caja_corte_nominacion==this.detalle.caja_corte_nominacion)[0];console.log(t,this.detalle.caja_corte_nominacion),this.detalle.nombre=t.nombre},this.setNameTipo=()=>{let t=this.ccorteTipo.filter(t=>t.caja_corte_tipo==this.ccorte.caja_corte_tipo)[0];console.log(t,this.ccorte.caja_corte_tipo),this.ccorte.descripcion=t.descripcion},this.reseteGeneral=()=>this.ccorte={caja_corte:0,creacion:null,usuario:0,turno:0,confirmado:null,anulado:0,caja_corte_tipo:0,descripcion:null,detalle:[]},this.resetDetalle=()=>this.detalle={caja_corte_detalle:0,caja_corte:0,cantidad:0,total:0,anulado:0,caja_corte_nominacion:0,nombre:null},this.agregarDetalle=()=>{this.detalle.caja_corte_nominacion&&this.detalle.cantidad&&this.detalle.total?(this.ccorte.detalle.push(this.detalle),this.resetDetalle()):this._snackBar.open("Complete los datos de nominaciones","Corte de caja",{duration:3e3})},this.guardar=()=>{if(confirm("\xbfEst\xe1 seguro?")){if(0==this.ccorte.detalle.length)return this._snackBar.open("Por favor agregue las nominaciones","Corte de caja",{duration:3e3}),!1;if(!this.ccorte.caja_corte_tipo)return this._snackBar.open("Seleccione el tipo de corte de caja.","Corte de caja",{duration:3e3}),!1;this.cajacorteSrvc.guardar(this.ccorte).subscribe(t=>{t.exito&&(this.cajacorteSavedEv.emit(),this.reseteGeneral()),this._snackBar.open(`${t.mensaje}`,"Corte de caja",{duration:3e3})})}},this.anularCajaDetalle=t=>{if(confirm("\xbfEst\xe1 seguro.?"))if(t.caja_corte_detalle)this.cajacorteSrvc.anularDetalle(t).subscribe(e=>{if(e.exito){let e=this.ccorte.detalle.indexOf(t);this.ccorte.detalle.splice(e,1)}this._snackBar.open(`${e.mensaje}`,"Corte de caja",{duration:3e3})});else{let e=this.ccorte.detalle.indexOf(t);this.ccorte.detalle.splice(e,1)}}}ngOnInit(){this.getCajaCorteTipo(),this.getCajaCorteNominacion()}}return t.\u0275fac=function(e){return new(e||t)(W.Nb(M.b),W.Nb(rs))},t.\u0275cmp=W.Hb({type:t,selectors:[["app-cajacorte-form"]],inputs:{ccorte:"ccorte"},outputs:{cajacorteSavedEv:"cajacorteSavedEv"},decls:49,vars:9,consts:[[1,"mat-elevation-z4","fullWidth"],["novalidate","",3,"ngSubmit"],["frmcc","ngForm"],[1,"fullWidth"],["name","tipo","required","",3,"ngModel","ngModelChange","selectionChange"],[3,"value",4,"ngFor","ngForOf"],[1,"example-container"],["name","nominacion",3,"ngModel","ngModelChange","selectionChange"],["matInput","","type","number","step","0.01","name","cantidad",3,"ngModel","ngModelChange","blur"],["matInput","","type","number","step","0.01","name","total","readonly","",3,"ngModel","ngModelChange"],["mat-icon-button","","type","button","color","accent","title","Agregar el detalle",3,"click"],["cols","4","rowHeight","7:1"],["cols","4","rowHeight","7:1",4,"ngFor","ngForOf"],["align","end"],["mat-icon-button","","type","button","color","accent",3,"click",4,"ngIf"],["mat-icon-button","","type","submit","color","accent","title","Guardar corte de caja",3,"disabled"],[3,"value"],["mat-list-icon","",1,"anulacion",3,"click"],["mat-icon-button","","type","button","color","accent",3,"click"]],template:function(t,e){if(1&t){const t=W.Ub();W.Tb(0,"mat-card",0),W.Tb(1,"mat-card-title"),W.Tb(2,"h5"),W.Fc(3,"Corte de caja"),W.Sb(),W.Sb(),W.Tb(4,"mat-card-content"),W.Tb(5,"form",1,2),W.bc("ngSubmit",function(){return W.xc(t),W.tc(6).form.valid&&e.guardar()}),W.Tb(7,"mat-form-field",3),W.Tb(8,"mat-label"),W.Fc(9,"Tipo de Corte"),W.Sb(),W.Tb(10,"mat-select",4),W.bc("ngModelChange",function(t){return e.ccorte.caja_corte_tipo=t})("selectionChange",function(){return e.setNameTipo()}),W.Dc(11,ms,2,2,"mat-option",5),W.Sb(),W.Sb(),W.Tb(12,"p"),W.Fc(13,"Agregar nominaciones"),W.Sb(),W.Tb(14,"div",6),W.Tb(15,"mat-form-field"),W.Tb(16,"mat-label"),W.Fc(17,"Nominaci\xf3n:"),W.Sb(),W.Tb(18,"mat-select",7),W.bc("ngModelChange",function(t){return e.detalle.caja_corte_nominacion=t})("selectionChange",function(){return e.setNamenomi()}),W.Dc(19,hs,2,2,"mat-option",5),W.Sb(),W.Sb(),W.Tb(20,"mat-form-field"),W.Tb(21,"mat-label"),W.Fc(22,"Cantidad:"),W.Sb(),W.Tb(23,"input",8),W.bc("ngModelChange",function(t){return e.detalle.cantidad=t})("blur",function(){return e.setTotal()}),W.Sb(),W.Sb(),W.Tb(24,"mat-form-field"),W.Tb(25,"mat-label"),W.Fc(26,"Total:"),W.Sb(),W.Tb(27,"input",9),W.bc("ngModelChange",function(t){return e.detalle.total=t}),W.Sb(),W.Sb(),W.Tb(28,"button",10),W.bc("click",function(){return e.agregarDetalle()}),W.Tb(29,"mat-icon"),W.Fc(30,"add"),W.Sb(),W.Sb(),W.Sb(),W.Tb(31,"mat-grid-list",11),W.Tb(32,"mat-grid-tile"),W.Tb(33,"b"),W.Fc(34,"Nominaci\xf3n"),W.Sb(),W.Sb(),W.Tb(35,"mat-grid-tile"),W.Tb(36,"b"),W.Fc(37,"Cantidad"),W.Sb(),W.Sb(),W.Tb(38,"mat-grid-tile"),W.Tb(39,"b"),W.Fc(40,"Total"),W.Sb(),W.Sb(),W.Ob(41,"mat-grid-tile"),W.Sb(),W.Dc(42,ps,10,3,"mat-grid-list",12),W.Ob(43,"hr"),W.Tb(44,"div",13),W.Dc(45,fs,3,0,"button",14),W.Tb(46,"button",15),W.Tb(47,"mat-icon"),W.Fc(48,"save"),W.Sb(),W.Sb(),W.Sb(),W.Sb(),W.Sb(),W.Sb()}if(2&t){const t=W.tc(6);W.Cb(10),W.lc("ngModel",e.ccorte.caja_corte_tipo),W.Cb(1),W.lc("ngForOf",e.ccorteTipo),W.Cb(7),W.lc("ngModel",e.detalle.caja_corte_nominacion),W.Cb(1),W.lc("ngForOf",e.ccorteNomi),W.Cb(4),W.lc("ngModel",e.detalle.cantidad),W.Cb(4),W.lc("ngModel",e.detalle.total),W.Cb(15),W.lc("ngForOf",e.ccorte.detalle),W.Cb(3),W.lc("ngIf",e.ccorte.caja_corte),W.Cb(1),W.lc("disabled",!t.form.valid)}},directives:[p.a,p.h,p.c,i.r,i.l,i.m,m.b,m.f,C.a,i.p,i.k,i.n,o.l,h.b,i.o,i.c,v.a,b.a,k.a,k.c,o.m,_.m,u.b],styles:[".example-container[_ngcontent-%COMP%]   .mat-form-field[_ngcontent-%COMP%] + .mat-form-field[_ngcontent-%COMP%]{margin-left:8px}mat-grid-tile[_ngcontent-%COMP%]{text-align:left}.anulacion[_ngcontent-%COMP%]{cursor:pointer}"]}),t})();const Ss=["lstCortecaja"];let Cs=(()=>{class t{constructor(){this.editarCajaCorte=t=>this.ccorte=t,this.actualizaLista=()=>this.lstCajacorteComponent.getCajascortes(),this.ccorte={caja_corte:0,creacion:null,usuario:0,turno:0,confirmado:null,anulado:0,caja_corte_tipo:0,descripcion:null,detalle:[]}}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=W.Hb({type:t,selectors:[["app-cajacorte"]],viewQuery:function(t,e){if(1&t&&W.Kc(Ss,1),2&t){let t;W.sc(t=W.cc())&&(e.lstCajacorteComponent=t.first)}},decls:7,vars:1,consts:[[1,"row"],[1,"col","m5","s12"],[3,"getCajacorteEv"],["lstCortecaja",""],[1,"col","m7","s12"],[3,"ccorte","cajacorteSavedEv"],["frmCortecaja",""]],template:function(t,e){1&t&&(W.Tb(0,"div",0),W.Tb(1,"div",1),W.Tb(2,"app-cajacorte-lista",2,3),W.bc("getCajacorteEv",function(t){return e.editarCajaCorte(t)}),W.Sb(),W.Sb(),W.Tb(4,"div",4),W.Tb(5,"app-cajacorte-form",5,6),W.bc("cajacorteSavedEv",function(){return e.actualizaLista()}),W.Sb(),W.Sb(),W.Sb()),2&t&&(W.Cb(5),W.lc("ccorte",e.ccorte))},directives:[bs,gs],styles:[""]}),t})();const Ts=function(){return{standalone:!0}};function vs(t,e){if(1&t){const t=W.Ub();W.Tb(0,"form"),W.Tb(1,"mat-form-field",6),W.Tb(2,"input",7),W.bc("ngModelChange",function(e){return W.xc(t),W.fc().datos.tiempo=e}),W.Sb(),W.Sb(),W.Sb()}if(2&t){const t=W.fc();W.Cb(2),W.lc("ngModel",t.datos.tiempo)("ngModelOptions",W.nc(2,Ts))}}class Ms{constructor(t,e,a,o,n,i){this.title=t,this.message=e,this.lblBtnConfirm=a,this.lblBtnDeny=o,this.datos=n,this.showTimer=i}}let Fs=(()=>{class t{constructor(t,e){this.dialogRef=t,this.data=e,this.title=e.title,this.message=e.message,this.lblBtnConfirm=e.lblBtnConfirm,this.lblBtnDeny=e.lblBtnDeny,this.datos={respuesta:!1,tiempo:"00:00"}}ngOnInit(){}onConfirm(t){this.datos.respuesta=!0,this.datos.tiempo=t.tiempo,this.dialogRef.close(this.datos)}onDismiss(){this.datos.respuesta=!1,this.dialogRef.close(this.datos)}}return t.\u0275fac=function(e){return new(e||t)(W.Nb(D.f),W.Nb(D.a))},t.\u0275cmp=W.Hb({type:t,selectors:[["app-dialog-cocina"]],decls:11,vars:5,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[4,"ngIf"],["mat-dialog-actions","","align","center"],["mat-raised-button","",1,"btnConfig",3,"click"],["mat-raised-button","","color","accent",1,"btnConfig",3,"click"],[1,"fullWidth"],["type","number","matInput","","placeholder","Minutos","min","0","max","59","step","1",3,"ngModel","ngModelOptions","ngModelChange"]],template:function(t,e){1&t&&(W.Tb(0,"h1",0),W.Fc(1),W.Sb(),W.Tb(2,"div",1),W.Tb(3,"p"),W.Fc(4),W.Sb(),W.Sb(),W.Dc(5,vs,3,3,"form",2),W.Tb(6,"div",3),W.Tb(7,"button",4),W.bc("click",function(){return e.onDismiss()}),W.Fc(8),W.Sb(),W.Tb(9,"button",5),W.bc("click",function(){return e.onConfirm(e.datos)}),W.Fc(10),W.Sb(),W.Sb()),2&t&&(W.Cb(1),W.Hc(" ",e.title," "),W.Cb(3),W.Gc(e.message),W.Cb(1),W.lc("ngIf",e.data.showTimer),W.Cb(3),W.Gc(e.lblBtnDeny),W.Cb(2),W.Gc(e.lblBtnConfirm))},directives:[D.g,D.d,o.m,D.c,v.a,i.r,i.l,i.m,m.b,i.o,h.b,i.c,i.k,i.n],styles:[""]}),t})();function xs(t,e){1&t&&W.Ob(0,"br")}function ks(t,e){if(1&t&&(W.Rb(0),W.Tb(1,"span"),W.Fc(2),W.Sb(),W.Ob(3,"br"),W.Qb()),2&t){const t=e.$implicit;W.Cb(2),W.Gc(t.trim())}}function Os(t,e){1&t&&W.Ob(0,"br")}function Ds(t,e){if(1&t&&(W.Tb(0,"span"),W.Tb(1,"strong"),W.Fc(2,"Notas:"),W.Sb(),W.Fc(3),W.Sb()),2&t){const t=W.fc().$implicit;W.Cb(3),W.Hc(" ",t.notas," ")}}function Es(t,e){if(1&t&&(W.Tb(0,"tr"),W.Tb(1,"td"),W.Fc(2),W.Dc(3,xs,1,0,"br",11),W.Dc(4,ks,4,1,"ng-container",8),W.Dc(5,Os,1,0,"br",11),W.Dc(6,Ds,4,1,"span",11),W.Sb(),W.Sb()),2&t){const t=e.$implicit;W.Cb(2),W.Ic(" ",t.cantidad," ",t.articulo.descripcion," "),W.Cb(1),W.lc("ngIf",t.detalle.length>0),W.Cb(1),W.lc("ngForOf",t.detalle),W.Cb(1),W.lc("ngIf",!!t.notas&&t.notas.length>0&&!t.detalle),W.Cb(1),W.lc("ngIf",!!t.notas&&t.notas.length>0)}}function Ps(t,e){if(1&t&&(W.Tb(0,"table"),W.Dc(1,Es,7,6,"tr",8),W.Sb()),2&t){const t=W.fc().$implicit;W.Cb(1),W.lc("ngForOf",t.productos)}}function _s(t,e){if(1&t&&(W.Rb(0),W.Dc(1,Ps,2,1,"table",11),W.Qb()),2&t){const t=e.$implicit;W.Cb(1),W.lc("ngIf",t.productos.length>0)}}function ys(t,e){if(1&t){const t=W.Ub();W.Tb(0,"div",6),W.Tb(1,"mat-card",7),W.Tb(2,"mat-card-header"),W.Tb(3,"mat-card-title"),W.Fc(4),W.Sb(),W.Tb(5,"mat-card-subtitle"),W.Fc(6),W.Ob(7,"br"),W.Fc(8),W.Sb(),W.Sb(),W.Tb(9,"mat-card-content"),W.Dc(10,_s,2,1,"ng-container",8),W.Sb(),W.Tb(11,"mat-card-actions",9),W.Tb(12,"button",10),W.bc("click",function(){W.xc(t);const a=e.$implicit;return W.fc().setCocinado(a,1)}),W.Fc(13,"Vista"),W.Sb(),W.Sb(),W.Sb(),W.Sb()}if(2&t){const t=e.$implicit;W.Cb(4),W.Ic("Comanda #",t.comanda," - ",t.numero,""),W.Cb(2),W.Ic(" Area ",t.mesa.area.nombre," - Mesa #",t.mesa.etiqueta||t.mesa.numero,""),W.Cb(2),W.Ic(" Atiende: ",t.mesero.nombres," ",t.mesero.apellidos," "),W.Cb(2),W.lc("ngForOf",t.cuentas)}}function Is(t,e){1&t&&W.Ob(0,"br")}function ws(t,e){if(1&t&&(W.Rb(0),W.Tb(1,"span"),W.Fc(2),W.Sb(),W.Ob(3,"br"),W.Qb()),2&t){const t=e.$implicit;W.Cb(2),W.Gc(t.trim())}}function As(t,e){1&t&&W.Ob(0,"br")}function Ns(t,e){if(1&t&&(W.Tb(0,"span"),W.Tb(1,"strong"),W.Fc(2,"Notas:"),W.Sb(),W.Fc(3),W.Sb()),2&t){const t=W.fc().$implicit;W.Cb(3),W.Hc(" ",t.notas," ")}}function Rs(t,e){if(1&t&&(W.Tb(0,"tr"),W.Tb(1,"td"),W.Fc(2),W.Dc(3,Is,1,0,"br",11),W.Dc(4,ws,4,1,"ng-container",8),W.Dc(5,As,1,0,"br",11),W.Dc(6,Ns,4,1,"span",11),W.Sb(),W.Sb()),2&t){const t=e.$implicit;W.Cb(2),W.Ic(" ",t.cantidad," ",t.articulo.descripcion," "),W.Cb(1),W.lc("ngIf",t.detalle.length>0),W.Cb(1),W.lc("ngForOf",t.detalle),W.Cb(1),W.lc("ngIf",!!t.notas&&t.notas.length>0&&!t.detalle),W.Cb(1),W.lc("ngIf",!!t.notas&&t.notas.length>0)}}function Us(t,e){if(1&t&&(W.Tb(0,"table"),W.Dc(1,Rs,7,6,"tr",8),W.Sb()),2&t){const t=W.fc().$implicit;W.Cb(1),W.lc("ngForOf",t.productos)}}function $s(t,e){if(1&t&&(W.Rb(0),W.Dc(1,Us,2,1,"table",11),W.Qb()),2&t){const t=e.$implicit;W.Cb(1),W.lc("ngIf",t.productos.length>0)}}const Bs=function(t){return{"text-danger":t}};function js(t,e){if(1&t){const t=W.Ub();W.Tb(0,"div",6),W.Tb(1,"mat-card",7),W.Tb(2,"mat-card-header"),W.Tb(3,"mat-card-title"),W.Fc(4),W.Sb(),W.Tb(5,"mat-card-subtitle"),W.Fc(6),W.Ob(7,"br"),W.Fc(8),W.Sb(),W.Sb(),W.Tb(9,"mat-card-content"),W.Tb(10,"div",12),W.Tb(11,"h6",13),W.Fc(12),W.gc(13,"date"),W.Sb(),W.Sb(),W.Dc(14,$s,2,1,"ng-container",8),W.Sb(),W.Tb(15,"mat-card-actions",9),W.Tb(16,"button",10),W.bc("click",function(){W.xc(t);const a=e.$implicit;return W.fc().setCocinado(a)}),W.Fc(17,"Cocinado"),W.Sb(),W.Sb(),W.Sb(),W.Sb()}if(2&t){const t=e.$implicit,a=W.fc();W.Cb(4),W.Ic("Comanda #",t.comanda," - ",t.numero,""),W.Cb(2),W.Ic(" Area ",t.mesa.area.nombre," - Mesa #",t.mesa.etiqueta||t.mesa.numero,""),W.Cb(2),W.Ic(" Atiende: ",t.mesero.nombres," ",t.mesero.apellidos," "),W.Cb(3),W.lc("ngClass",W.oc(12,Bs,a.comparaFecha(t))),W.Cb(1),W.Hc(" ",W.ic(13,9,t.tiempo_transcurrido,"HH:mm:ss")," "),W.Cb(2),W.lc("ngForOf",t.cuentas)}}const Hs=[{path:"mantareas",component:yt,canActivate:[Q.a]},{path:"tranareas",component:Oo,canActivate:[Q.a]},{path:"turno",component:fn,canActivate:[Q.a]},{path:"rptvtascat",component:Hn,canActivate:[Q.a]},{path:"rptturnos",component:zn,canActivate:[Q.a]},{path:"rptpropinas",component:Vn,canActivate:[Q.a]},{path:"rptcaja",component:Ri,canActivate:[Q.a]},{path:"rptfactura",component:$i,canActivate:[Q.a]},{path:"cmdonline",component:ki,canActivate:[Q.a]},{path:"tipoturno",component:Gi,canActivate:[Q.a]},{path:"propina",component:es,canActivate:[Q.a]},{path:"autoconsulta",component:cs,canActivate:[Q.a]},{path:"cajacorte",component:Cs,canActivate:[Q.a]},{path:"trancocina",component:(()=>{class t{constructor(t,e,a,o,n,i){this.ls=t,this.comandaSrvc=e,this.socket=a,this.dns=o,this.snackBar=n,this.dialog=i,this.lstComandasCocina=[],this.lstComandasCocinaEnProceso=[],this.notificarUsuario=()=>{const t={icon:"assets/img/minilogo.png",body:`Se recibi\xf3 una nueva orden a las ${se().format(X.b.dateTimeFormat)}.`,dir:"auto"};this.dns.createNotification("Rest-Touch Pro",1e4,t)},this.loadComandasCocina=()=>this.comandaSrvc.getComandasCocina().subscribe(t=>{this.lstComandasCocina=t.pendientes,this.lstComandasCocinaEnProceso=t.enproceso,this.setTiempo()}),this.setTiempo=()=>{if(this.lstComandasCocinaEnProceso)for(let t=0;t<this.lstComandasCocinaEnProceso.length;t++){const e=this.lstComandasCocinaEnProceso[t],a=6e4,o=60*a,n=24*o;let i=new Date(e.fecha_proceso);this.lstComandasCocinaEnProceso[t].inicio_proceso=i,e.inicio=i;const s=i.getTime();i=new Date;let c=i.getTime()-s;c-=Math.floor(c/n)*n;const r=Math.floor(c/o);c-=r*o;const l=Math.floor(c/a);c-=l*a;const d=Math.floor(c/1e3),u=new Date;if(u.setHours(r),u.setMinutes(l),u.setSeconds(d),this.lstComandasCocinaEnProceso[t].tiempo_transcurrido=u,e.tiempo_preparacion){const a=e.tiempo_preparacion.split(":");e.inicio.setHours(e.inicio.getHours()+ +a[0]),e.inicio.setMinutes(e.inicio.getMinutes()+ +a[1]),this.lstComandasCocinaEnProceso[t].fin_proceso=e.inicio}else this.lstComandasCocinaEnProceso[t].fin_proceso=i}},this.comparaFecha=t=>new Date>t.fin_proceso,this.setCocinado=(t,e=2)=>{this.dialog.open(Fs,{maxWidth:"400px",data:new Ms("Cocina",`\xbfSeguro de marcar como '${1==+e?"vista":"cocinada"}' la comanda #${t.comanda}?`,"S\xed","No",{respuesta:!1,tiempo:""},1==+e)}).afterClosed().subscribe(a=>{a&&a.respuesta&&a.tiempo&&this.comandaSrvc.setComandaCocinada(+t.comanda,{numero:+t.numero,estatus:e,tiempo:a.tiempo}).subscribe(t=>{t.exito?this.snackBar.open(t.mensaje,"Cocina",{duration:3e3}):this.snackBar.open(`ERROR: ${t.mensaje}`,"Cocina",{duration:7e3}),this.loadComandasCocina()})})}}ngOnInit(){this.ls.get(X.b.usrTokenVar).sede_uuid&&(this.socket.emit("joinRestaurant",this.ls.get(X.b.usrTokenVar).sede_uuid),this.socket.on("refrescar:listaCocina",()=>{this.loadComandasCocina(),this.notificarUsuario()}),setInterval(()=>{this.setTiempo()},1e3)),this.loadComandasCocina()}}return t.\u0275fac=function(e){return new(e||t)(W.Nb(ot.a),W.Nb(te),W.Nb(he.a),W.Nb(Jn.a),W.Nb(M.b),W.Nb(D.b))},t.\u0275cmp=W.Hb({type:t,selectors:[["app-tran-cocina"]],decls:13,vars:2,consts:[["fxLayout","row","fxLayout.xs","column","fxFlexFill",""],["fxFlex","50%","fxFlex.xs","100%",1,"bordeRght"],["fxLayout","row wrap","fxLayoutGap","10px grid","fxFlexFill","","fxLayoutAlign","start start",1,"divContenedor"],["fxFlex","100%","fxLayoutAlign","center start"],["fxFlex","33%","fxFlex.xs","100%","fxFlex.sm","100%","fxFlex.md","50%",4,"ngFor","ngForOf"],["fxFlex","50%","fxFlex.xs","100%",1,"bordeLft"],["fxFlex","33%","fxFlex.xs","100%","fxFlex.sm","100%","fxFlex.md","50%"],[1,"mat-elevation-z4"],[4,"ngFor","ngForOf"],["align","end"],["mat-raised-button","","color","accent","type","button",3,"click"],[4,"ngIf"],["align","center"],[3,"ngClass"]],template:function(t,e){1&t&&(W.Tb(0,"div",0),W.Tb(1,"div",1),W.Tb(2,"div",2),W.Tb(3,"div",3),W.Tb(4,"h4"),W.Fc(5,"Pendientes"),W.Sb(),W.Sb(),W.Dc(6,ys,14,7,"div",4),W.Sb(),W.Sb(),W.Tb(7,"div",5),W.Tb(8,"div",2),W.Tb(9,"div",3),W.Tb(10,"h4"),W.Fc(11,"En Proceso"),W.Sb(),W.Sb(),W.Dc(12,js,18,14,"div",4),W.Sb(),W.Sb(),W.Sb()),2&t&&(W.Cb(6),W.lc("ngForOf",e.lstComandasCocina),W.Cb(6),W.lc("ngForOf",e.lstComandasCocinaEnProceso))},directives:[Ue.c,Ue.e,Ue.a,Ue.d,Ue.b,o.l,p.a,p.d,p.h,p.g,p.c,p.b,v.a,o.m,o.k,mt.a],pipes:[o.e],styles:[".divContenedor[_ngcontent-%COMP%]{margin-left:5px!important}.bordeRght[_ngcontent-%COMP%]{border-right:1.5px solid #000}.bordeLft[_ngcontent-%COMP%]{border-left:1.5px solid #000}.text-danger[_ngcontent-%COMP%]{color:#dc143c}.item[_ngcontent-%COMP%]{display:block;height:auto;white-space:nowrap;word-wrap:break-word}"]}),t})(),canActivate:[Q.a]},{path:"**",redirectTo:"/admin/dashboard",pathMatch:"full"}];let Ls=(()=>{class t{}return t.\u0275mod=W.Lb({type:t}),t.\u0275inj=W.Kb({factory:function(e){return new(e||t)},imports:[[J.d.forChild(Hs)],J.d]}),t})(),qs=(()=>{class t{}return t.\u0275mod=W.Lb({type:t}),t.\u0275inj=W.Kb({factory:function(e){return new(e||t)},providers:[_.l],imports:[[o.c,Ls,n.c,i.e,K,s.a,c.WmsModule,r.PosModule,l.CallcenterModule,d.a,u.d,b.b,m.d,h.c,p.f,f.b,g.c,S.m,C.b,T.b,v.b,M.c,F.b,x.d,k.b,O.b,D.e,E.d,P.a,_.l,R.c,y.b,I.a,w.c,A.c,N.b]]}),t})()}}]);