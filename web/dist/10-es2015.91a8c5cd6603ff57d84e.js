(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{"3e6T":function(e,t,o){"use strict";o.d(t,"a",(function(){return p}));var a=o("mrSG"),n=o("8Y7J"),r=o("IheW"),l=o("sKxO"),i=o("R5jZ"),s=o("FY0D"),d=o("un/a"),m=o("JIr8"),c=o("Qyje");let p=class{constructor(e,t){this.http=e,this.ls=t,this.usrToken=null,this.srvcErrHndl=new i.a,this.usrToken=this.ls.get(l.a.usrTokenVar)?this.ls.get(l.a.usrTokenVar).token:null}get(e={}){const t={headers:new r.c({Authorization:this.usrToken})};return this.http.get(`${l.a.urlCatalogos}/get_tipo_movimiento?${c.stringify(e)}`,t).pipe(Object(d.a)(l.a.reintentos),Object(m.a)(this.srvcErrHndl.errorHandler))}};p.ctorParameters=()=>[{type:r.a},{type:s.a}],p=a.b([Object(n.Injectable)({providedIn:"root"})],p)},PYui:function(e,t,o){"use strict";o.r(t),t.default='<div class="row">\n    <div class="col m5 s12">\n        <app-lista-orden-compra #lstOrdenCompra (getOrdenCompraEv)="setOrdenCompra($event)"></app-lista-orden-compra>\n    </div>\n    <div class="col m7 s12">\n        <app-form-orden-compra #frmOrdenCompra [ordenCompra]="ordenCompra"\n            (ordenCompraSavedEv)="refreshOrdenCompraList()"></app-form-orden-compra>\n    </div>\n</div>'},"Wc/8":function(e,t,o){"use strict";o.r(t);var a=o("mrSG"),n=o("8Y7J"),r=o("SVse"),l=o("IheW"),i=o("s7LF"),s=o("PCNd"),d=o("Q+lL"),m=o("Gi4r"),c=o("HsOI"),p=o("ZwOa"),u=o("igqZ"),h=o("02hT"),C=o("rWV4"),g=o("8rEH"),b=o("JjoW"),f=o("r0V8"),v=o("Fwaw"),O=o("dFDH"),_=o("BzsH"),y=o("gavF"),I=o("FVPZ"),D=o("OIZN"),w=o("s6ns"),S=o("BV1i"),k=o("AaDx"),F=o("Y8tL"),M=o("drcI"),j=o("iInd"),T=o("0T/Q"),x=o("FY0D"),z=o("sKxO");let H=class{constructor(e){this.ls=e,this.setOrdenCompra=e=>{this.ordenCompra=e,this.frmOrdenCompra.loadDetalleOrdenCompra(+this.ordenCompra.orden_compra)},this.refreshOrdenCompraList=()=>{this.lstOrdenCompraComponent.loadOrdenesCompra()},this.ordenCompra={orden_compra:null,proveedor:null,usuario:this.ls.get(z.a.usrTokenVar).idusr||0,notas:null,estatus_movimiento:1,bodega:null,tipo_movimiento:null}}ngOnInit(){}};H.ctorParameters=()=>[{type:x.a}],a.b([Object(n.ViewChild)("lstOrdenCompra",{static:!1})],H.prototype,"lstOrdenCompraComponent",void 0),a.b([Object(n.ViewChild)("frmOrdenCompra",{static:!1})],H.prototype,"frmOrdenCompra",void 0);const W=[{path:"ordcomp",component:H=a.b([Object(n.Component)({selector:"app-orden-compra",template:a.c(o("PYui")).default,styles:[a.c(o("yTCc")).default]})],H),canActivate:[T.a]},{path:"**",redirectTo:"/admin/dashboard",pathMatch:"full"}];let E=class{};E=a.b([Object(n.NgModule)({imports:[j.b.forChild(W)],exports:[j.b]})],E);var $=o("R5jZ"),A=o("un/a"),V=o("JIr8"),N=o("Qyje");let P=class{constructor(e,t){this.http=e,this.ls=t,this.ordenCompraUrl="compra",this.usrToken=null,this.srvcErrHndl=new $.a,this.usrToken=this.ls.get(z.a.usrTokenVar)?this.ls.get(z.a.usrTokenVar).token:null}get(e={}){const t={headers:new l.c({Authorization:this.usrToken})};return this.http.get(`${z.a.urlWms}/${this.ordenCompraUrl}/buscar?${N.stringify(e)}`,t).pipe(Object(A.a)(z.a.reintentos),Object(V.a)(this.srvcErrHndl.errorHandler))}save(e){const t={headers:new l.c({Authorization:this.usrToken})};return this.http.post(`${z.a.urlWms}/${this.ordenCompraUrl}/guardar${+e.orden_compra>0?"/"+e.orden_compra:""}`,e,t).pipe(Object(A.a)(z.a.reintentos),Object(V.a)(this.srvcErrHndl.errorHandler))}getDetalle(e,t={}){const o={headers:new l.c({Authorization:this.usrToken})};return this.http.get(`${z.a.urlWms}/${this.ordenCompraUrl}/buscar_detalle/${e}?${N.stringify(t)}`,o).pipe(Object(A.a)(z.a.reintentos),Object(V.a)(this.srvcErrHndl.errorHandler))}saveDetalle(e){const t={headers:new l.c({Authorization:this.usrToken})};return this.http.post(`${z.a.urlWms}/${this.ordenCompraUrl}/guardar_detalle/${e.orden_compra}${+e.orden_compra_detalle>0?"/"+e.orden_compra_detalle:""}`,e,t).pipe(Object(A.a)(z.a.reintentos),Object(V.a)(this.srvcErrHndl.errorHandler))}};P.ctorParameters=()=>[{type:l.a},{type:x.a}],P=a.b([Object(n.Injectable)({providedIn:"root"})],P);let J=class{constructor(e){this.ordenCompraSrvc=e,this.getOrdenCompraEv=new n.EventEmitter,this.length=0,this.pageSize=5,this.pageSizeOptions=[5,10,15],this.pageIndex=0,this.txtFiltro="",this.loadOrdenesCompra=()=>{this.ordenCompraSrvc.get().subscribe(e=>{e&&e.length>0&&(this.lstOrdenesCompra=e,this.applyFilter())})},this.getOrdenCompra=e=>{this.getOrdenCompraEv.emit({orden_compra:e.orden_compra,proveedor:e.proveedor||0,fecha:e.fecha,usuario:e.usuario||0,notas:e.notas,estatus_movimiento:e.estatus_movimiento||1})},this.pageChange=e=>{this.pageSize=e.pageSize,this.pageIndex=e.pageIndex,this.applyFilter()}}ngOnInit(){this.loadOrdenesCompra()}applyFilter(){if(this.txtFiltro.length>0){const e=Object(z.b)(this.lstOrdenesCompra,this.txtFiltro);this.length=e.length,this.lstOrdenesCompraPaged=Object(z.c)(e,this.pageSize,this.pageIndex+1)}else this.length=this.lstOrdenesCompra.length,this.lstOrdenesCompraPaged=Object(z.c)(this.lstOrdenesCompra,this.pageSize,this.pageIndex+1)}};J.ctorParameters=()=>[{type:P}],a.b([Object(n.Output)()],J.prototype,"getOrdenCompraEv",void 0),J=a.b([Object(n.Component)({selector:"app-lista-orden-compra",template:a.c(o("rR3N")).default,styles:[a.c(o("rqBJ")).default]})],J);var B=o("50cD"),Y=o("NGYs"),q=o("3e6T"),G=o("u5dX");let R=class{constructor(e,t,o,a,r,l,i){this._snackBar=e,this.ls=t,this.ordenCompraSrvc=o,this.proveedorSrvc=a,this.articuloSrvc=r,this.tipoMovimientoSrvc=l,this.bodegaSrvc=i,this.ordenCompraSavedEv=new n.EventEmitter,this.showOrdenCompraForm=!0,this.showDetalleOrdenCompraForm=!0,this.detallesOrdenCompra=[],this.displayedColumns=["articulo","cantidad","monto","total","editItem"],this.proveedores=[],this.articulos=[],this.tiposMovimiento=[],this.bodegas=[],this.esMovil=!1,this.loadProveedores=()=>{this.proveedorSrvc.get().subscribe(e=>{e&&(this.proveedores=e)})},this.loadTiposMovimiento=()=>{this.tipoMovimientoSrvc.get().subscribe(e=>{e&&(this.tiposMovimiento=e)})},this.loadBodegas=()=>{this.bodegaSrvc.get().subscribe(e=>{e&&(this.bodegas=e)})},this.resetOrdenCompra=()=>{this.ordenCompra={orden_compra:null,proveedor:null,usuario:this.ls.get(z.a.usrTokenVar).idusr||0,notas:null,estatus_movimiento:1,bodega:null,tipo_movimiento:null},this.resetDetalleOrdenCompra()},this.onSubmit=()=>{this.ordenCompraSrvc.save(this.ordenCompra).subscribe(e=>{e.exito&&(this.ordenCompraSavedEv.emit(),this.resetOrdenCompra(),this.ordenCompra={orden_compra:+e.compra.orden_compra,proveedor:e.compra.proveedor,fecha:e.compra.fecha,usuario:e.compra.usuario,notas:e.compra.notas,estatus_movimiento:1},this.loadDetalleOrdenCompra(this.ordenCompra.orden_compra))})},this.loadArticulos=()=>{this.articuloSrvc.getArticulos().subscribe(e=>{e&&(this.articulos=e)})},this.resetDetalleOrdenCompra=()=>this.detalleOrdenCompra={orden_compra_detalle:null,orden_compra:this.ordenCompra.orden_compra?this.ordenCompra.orden_compra:null,articulo:null,cantidad:null,monto:null,total:null},this.loadDetalleOrdenCompra=(e=+this.ordenCompra.orden_compra)=>{this.ordenCompraSrvc.getDetalle(e,{orden_compra:e}).subscribe(e=>{e&&(this.detallesOrdenCompra=e,this.updateTableDataSource())})},this.getDetalleOrdenCompra=(e=+this.ordenCompra.orden_compra,t)=>{this.ordenCompraSrvc.getDetalle(e,{orden_compra_detalle:t}).subscribe(e=>{e&&(this.detalleOrdenCompra={orden_compra_detalle:e[0].orden_compra_detalle,orden_compra:e[0].orden_compra,articulo:e[0].articulo.articulo,cantidad:+e[0].cantidad,monto:+e[0].monto,total:+e[0].total},this.showDetalleOrdenCompraForm=!0)})},this.onSubmitDetail=()=>{this.detalleOrdenCompra.orden_compra=this.ordenCompra.orden_compra,this.ordenCompraSrvc.saveDetalle(this.detalleOrdenCompra).subscribe(e=>{e&&(this.loadDetalleOrdenCompra(),this.resetDetalleOrdenCompra())})},this.updateTableDataSource=()=>this.dataSource=new g.a(this.detallesOrdenCompra),this.generarIngreso=()=>{this.ordenCompra.estatus_movimiento=2,this.onSubmit()}}ngOnInit(){this.esMovil=this.ls.get(z.a.usrTokenVar).enmovil||!1,this.resetOrdenCompra(),this.loadProveedores(),this.loadArticulos(),this.loadBodegas(),this.loadTiposMovimiento()}};R.ctorParameters=()=>[{type:O.a},{type:x.a},{type:P},{type:B.a},{type:Y.a},{type:q.a},{type:G.a}],a.b([Object(n.Input)()],R.prototype,"ordenCompra",void 0),a.b([Object(n.Output)()],R.prototype,"ordenCompraSavedEv",void 0),R=a.b([Object(n.Component)({selector:"app-form-orden-compra",template:a.c(o("n7A6")).default,styles:[a.c(o("pM9h")).default]})],R),o.d(t,"OrdenCompraModule",(function(){return Z}));let Z=class{};Z=a.b([Object(n.NgModule)({declarations:[H,J,R],imports:[r.CommonModule,E,s.a,l.b,i.FormsModule,d.a,m.a,c.c,p.b,u.a,h.a,C.a,g.b,b.a,f.a,v.b,O.b,_.a,y.a,I.a,D.b,w.c,F.a,S.a,k.a,M.NgVirtualKeyboardModule]})],Z)},n7A6:function(e,t,o){"use strict";o.r(t),t.default='<mat-card class="mat-elevation-z4 fullWidth">\n    <mat-card-title>\n        <h4>\n            Orden de compra{{!!ordenCompra.orden_compra ? (\' No. \' + ordenCompra.orden_compra) : \'\'}}\n            <button mat-icon-button type="button" color="accent" (click)="showOrdenCompraForm = true;"\n                *ngIf="!showOrdenCompraForm">\n                <mat-icon class="iconFontSize">expand_more</mat-icon>\n            </button>\n            <button mat-icon-button type="button" color="accent" (click)="showOrdenCompraForm = false;"\n                *ngIf="showOrdenCompraForm">\n                <mat-icon class="iconFontSize">expand_less</mat-icon>\n            </button>\n        </h4>\n    </mat-card-title>\n    <mat-card-content>\n        <form #frmOrdenCompra="ngForm" *ngIf="showOrdenCompraForm" (ngSubmit)="frmOrdenCompra.form.valid && onSubmit()" novalidate>\n            <mat-form-field class="fullWidth">\n                <mat-label>Proveedor</mat-label>\n                <mat-select name="proveedor" [(ngModel)]="ordenCompra.proveedor" required>\n                    <mat-option *ngFor="let prov of proveedores" [value]="prov.proveedor">\n                        ({{prov.nit}}) {{prov.razon_social}}\n                    </mat-option>\n                </mat-select>\n            </mat-form-field>\n            <mat-form-field class="fullWidth" *ngIf="esMovil">\n                <input matInput placeholder="Notas" name="notas" [(ngModel)]="ordenCompra.notas">\n            </mat-form-field>\n            <mat-form-field class="fullWidth" *ngIf="!esMovil">\n                <input matInput ng-virtual-keyboard ng-virtual-keyboard-layout="alphanumeric"\n                    ng-virtual-keyboard-placeholder="Notas" placeholder="Notas" name="notas"\n                    [(ngModel)]="ordenCompra.notas">\n            </mat-form-field>\n            <mat-form-field class="fullWidth">\n                <mat-label>Tipo de movimiento</mat-label>\n                <mat-select name="tipo_movimiento" [(ngModel)]="ordenCompra.tipo_movimiento">\n                    <mat-option *ngFor="let tm of tiposMovimiento" [value]="tm.tipo_movimiento">\n                        {{tm.descripcion}}\n                    </mat-option>\n                </mat-select>\n            </mat-form-field>\n            <mat-form-field class="fullWidth">\n                <mat-label>Bodega</mat-label>\n                <mat-select name="bodega" [(ngModel)]="ordenCompra.bodega">\n                    <mat-option *ngFor="let bode of bodegas" [value]="bode.bodega">\n                        {{bode.descripcion}}\n                    </mat-option>\n                </mat-select>\n            </mat-form-field>\n            <div align="end">\n                <button mat-raised-button type="submit" color="accent" class="btnAccion"\n                    [disabled]="!frmOrdenCompra.form.valid || [2, 3].indexOf(+ordenCompra.estatus_movimiento) >= 0">\n                    Guardar\n                </button>\n                <button mat-raised-button type="button" color="accent" class="btnAccion" (click)="generarIngreso()"\n                    *ngIf="ordenCompra.orden_compra && detallesOrdenCompra.length > 0"\n                    [disabled]="!frmOrdenCompra.form.valid || [2, 3].indexOf(+ordenCompra.estatus_movimiento) >= 0 || !ordenCompra.bodega || !ordenCompra.tipo_movimiento">\n                    Generar ingreso\n                </button>\n                <button mat-raised-button type="button" color="accent" (click)="resetOrdenCompra()"\n                    *ngIf="ordenCompra.orden_compra">\n                    Nueva\n                </button>\n            </div>\n        </form>\n    </mat-card-content>\n</mat-card>\n<hr *ngIf="ordenCompra.orden_compra" />\n<mat-card class="mat-elevation-z4 fullWidth" *ngIf="ordenCompra.orden_compra">\n    <mat-card-title>\n        <h4>\n            Detalle de orden de compra No. {{ordenCompra.orden_compra}}\n            <button mat-icon-button type="button" color="accent" (click)="showDetalleOrdenCompraForm = true;"\n                *ngIf="!showDetalleOrdenCompraForm">\n                <mat-icon class="iconFontSize">expand_more</mat-icon>\n            </button>\n            <button mat-icon-button type="button" color="accent" (click)="showDetalleOrdenCompraForm = false;"\n                *ngIf="showDetalleOrdenCompraForm">\n                <mat-icon class="iconFontSize">expand_less</mat-icon>\n            </button>\n        </h4>\n    </mat-card-title>\n    <mat-card-content>\n        <form #frmDetalleOrdenCompra="ngForm" *ngIf="showDetalleOrdenCompraForm" (ngSubmit)="frmDetalleOrdenCompra.form.valid && onSubmitDetail()" novalidate>\n            <mat-form-field class="fullWidth">\n                <mat-label>Art\xedculo</mat-label>\n                <mat-select name="articulo" [(ngModel)]="detalleOrdenCompra.articulo" required>\n                    <mat-option *ngFor="let a of articulos" [value]="a.articulo">\n                        {{a.descripcion}}\n                    </mat-option>\n                </mat-select>\n            </mat-form-field>\n            <mat-form-field class="fullWidth" *ngIf="esMovil">\n                <input matInput placeholder="Cantidad" name="cantidad" [(ngModel)]="detalleOrdenCompra.cantidad"\n                    (change)="detalleOrdenCompra.total = +detalleOrdenCompra.monto * +detalleOrdenCompra.cantidad"\n                    required>\n            </mat-form-field>\n            <mat-form-field class="fullWidth" *ngIf="!esMovil">\n                <input matInput ng-virtual-keyboard ng-virtual-keyboard-layout="numeric"\n                    ng-virtual-keyboard-placeholder="Cantidad" placeholder="Cantidad" name="cantidad"\n                    [(ngModel)]="detalleOrdenCompra.cantidad"\n                    (change)="detalleOrdenCompra.total = +detalleOrdenCompra.monto * +detalleOrdenCompra.cantidad"\n                    required>\n            </mat-form-field>\n            <mat-form-field class="fullWidth" *ngIf="esMovil">\n                <input matInput placeholder="Monto" name="monto" [(ngModel)]="detalleOrdenCompra.monto"\n                    (change)="detalleOrdenCompra.total = +detalleOrdenCompra.monto * +detalleOrdenCompra.cantidad"\n                    required>\n            </mat-form-field>\n            <mat-form-field class="fullWidth" *ngIf="!esMovil">\n                <input matInput ng-virtual-keyboard ng-virtual-keyboard-layout="numeric"\n                    ng-virtual-keyboard-placeholder="Monto" placeholder="Monto" name="monto"\n                    [(ngModel)]="detalleOrdenCompra.monto"\n                    (change)="detalleOrdenCompra.total = +detalleOrdenCompra.monto * +detalleOrdenCompra.cantidad"\n                    required>\n            </mat-form-field>\n            <div align="end">\n                <button mat-raised-button type="submit" color="accent" class="btnAccion"\n                    [disabled]="!frmDetalleOrdenCompra.form.valid || [2, 3].indexOf(+ordenCompra.estatus_movimiento) >= 0">\n                    Guardar\n                </button>\n                <button mat-raised-button type="button" color="accent" (click)="resetDetalleOrdenCompra()"\n                    *ngIf="detalleOrdenCompra.orden_compra_detalle">\n                    Nuevo\n                </button>\n            </div>\n        </form>\n        <hr *ngIf="detallesOrdenCompra.length > 0" />\n        <table mat-table [dataSource]="dataSource" class="mat-elevation-z4 full-width"\n            *ngIf="detallesOrdenCompra.length > 0">\n            <ng-container matColumnDef="articulo">\n                <th mat-header-cell *matHeaderCellDef>Art\xedculo</th>\n                <td mat-cell *matCellDef="let element" class="text-wrap">{{element.articulo.descripcion}}</td>\n            </ng-container>\n            <ng-container matColumnDef="cantidad">\n                <th mat-header-cell *matHeaderCellDef class="text-right">Cantidad</th>\n                <td mat-cell *matCellDef="let element" class="text-right">{{element.cantidad | number:\'1.2-2\'}}</td>\n            </ng-container>\n            <ng-container matColumnDef="monto">\n                <th mat-header-cell *matHeaderCellDef class="text-right">Monto</th>\n                <td mat-cell *matCellDef="let element" class="text-right">{{element.monto | number:\'1.2-2\'}}</td>\n            </ng-container>\n            <ng-container matColumnDef="total">\n                <th mat-header-cell *matHeaderCellDef class="text-right">Total</th>\n                <td mat-cell *matCellDef="let element" class="text-right">{{element.total | number:\'1.2-2\'}}</td>\n            </ng-container>\n            <ng-container matColumnDef="editItem">\n                <th mat-header-cell *matHeaderCellDef>&nbsp;</th>\n                <td mat-cell *matCellDef="let element" class="text-wrap">\n                    <button mat-raised-button type="button" color="accent"\n                        (click)="getDetalleOrdenCompra(element.orden_compra, element.orden_compra_detalle)"\n                        [disabled]="[2, 3].indexOf(+ordenCompra.estatus_movimiento) >= 0">\n                        Editar\n                    </button>\n                </td>\n            </ng-container>\n            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>\n            <tr mat-row *matRowDef="let row; columns: displayedColumns;">\n            </tr>\n        </table>\n    </mat-card-content>\n</mat-card>'},pM9h:function(e,t,o){"use strict";o.r(t),t.default=".full-width {\n    width: 100%;\n}\n\n.iconFontSize {\n    font-size: 24pt;\n}"},rR3N:function(e,t,o){"use strict";o.r(t),t.default='<mat-card class="mat-elevation-z4 fullWidth">\n    <mat-card-content>\n        <mat-form-field class="fullWidth">\n            <input matInput (keyup)="applyFilter()" placeholder="Buscar..." [(ngModel)]="txtFiltro" [ngModelOptions]="{standalone: true}">\n        </mat-form-field>\n        <mat-nav-list>\n            <mat-list-item *ngFor="let element of lstOrdenesCompraPaged" (click)="getOrdenCompra(element)">\n                <mat-icon mat-list-icon>description</mat-icon>\n                <h5 mat-line>No. {{element.orden_compra}}</h5><br/>\n                <p mat-line>\n                    Fecha: {{element.fecha | date: \'dd/MM/yyyy\'}}\n                </p>\n            </mat-list-item>\n        </mat-nav-list>\n        <mat-paginator [length]="length" [pageSize]="pageSize" [pageSizeOptions]="pageSizeOptions" (page)="pageChange($event)" showFirstLastButtons>\n        </mat-paginator>\n    </mat-card-content>\n</mat-card>\n'},rqBJ:function(e,t,o){"use strict";o.r(t),t.default=".fullWidth {\n    width: 100% !important;\n}\n\ntable {\n    width: 100% !important;\n}"},u5dX:function(e,t,o){"use strict";o.d(t,"a",(function(){return p}));var a=o("mrSG"),n=o("8Y7J"),r=o("IheW"),l=o("sKxO"),i=o("R5jZ"),s=o("FY0D"),d=o("un/a"),m=o("JIr8"),c=o("Qyje");let p=class{constructor(e,t){this.http=e,this.ls=t,this.usrToken=null,this.srvcErrHndl=new i.a,this.usrToken=this.ls.get(l.a.usrTokenVar)?this.ls.get(l.a.usrTokenVar).token:null}get(e={}){const t={headers:new r.c({Authorization:this.usrToken})};return this.http.get(`${l.a.urlCatalogos}/get_bodega?${c.stringify(e)}`,t).pipe(Object(d.a)(l.a.reintentos),Object(m.a)(this.srvcErrHndl.errorHandler))}};p.ctorParameters=()=>[{type:r.a},{type:s.a}],p=a.b([Object(n.Injectable)({providedIn:"root"})],p)},yTCc:function(e,t,o){"use strict";o.r(t),t.default=""}}]);