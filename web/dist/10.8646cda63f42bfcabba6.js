(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{"3e6T":function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var o=n("mrSG"),r=n("CcnG"),a=n("t/Na"),l=n("sKxO"),i=n("R5jZ"),d=n("FY0D"),m=n("5tAl"),s=n("9Z1F"),c=n("Qyje"),p=function(){function e(e,t){this.http=e,this.ls=t,this.usrToken=null,this.srvcErrHndl=new i.a,this.usrToken=this.ls.get(l.a.usrTokenVar)?this.ls.get(l.a.usrTokenVar).token:null}return e.prototype.get=function(e){void 0===e&&(e={});var t={headers:new a.c({Authorization:this.usrToken})};return this.http.get(l.a.urlCatalogos+"/get_tipo_movimiento?"+c.stringify(e),t).pipe(Object(m.a)(l.a.reintentos),Object(s.a)(this.srvcErrHndl.errorHandler))},e.ctorParameters=function(){return[{type:a.a},{type:d.a}]},e=o.c([Object(r.Injectable)({providedIn:"root"})],e)}()},PYui:function(e,t,n){"use strict";n.r(t),t.default='<div class="row">\n    <div class="col m5 s12">\n        <app-lista-orden-compra #lstOrdenCompra (getOrdenCompraEv)="setOrdenCompra($event)"></app-lista-orden-compra>\n    </div>\n    <div class="col m7 s12">\n        <app-form-orden-compra #frmOrdenCompra [ordenCompra]="ordenCompra"\n            (ordenCompraSavedEv)="refreshOrdenCompraList()"></app-form-orden-compra>\n    </div>\n</div>'},"Wc/8":function(e,t,n){"use strict";n.r(t);var o=n("mrSG"),r=n("CcnG"),a=n("Ip0R"),l=n("t/Na"),i=n("gIcY"),d=n("PCNd"),m=n("0/Q6"),s=n("SMsm"),c=n("seP3"),p=n("b716"),u=n("FVSy"),h=n("LC5p"),f=n("La40"),C=n("BHnd"),g=n("uGex"),v=n("de3e"),b=n("UodH"),O=n("vARd"),y=n("8mMr"),_=n("mVsa"),D=n("r43C"),S=n("4epT"),I=n("o3x0"),w=n("Nsh5"),k=n("J12g"),M=n("vnWn"),F=n("drcI"),j=n("ZYCi"),T=n("0T/Q"),x=n("FY0D"),z=n("sKxO"),H=function(){function e(e){var t=this;this.ls=e,this.setOrdenCompra=function(e){t.ordenCompra=e,t.frmOrdenCompra.loadDetalleOrdenCompra(+t.ordenCompra.orden_compra)},this.refreshOrdenCompraList=function(){t.lstOrdenCompraComponent.loadOrdenesCompra()},this.ordenCompra={orden_compra:null,proveedor:null,usuario:this.ls.get(z.a.usrTokenVar).idusr||0,notas:null,estatus_movimiento:1,bodega:null,tipo_movimiento:null}}return e.prototype.ngOnInit=function(){},e.ctorParameters=function(){return[{type:x.a}]},o.c([Object(r.ViewChild)("lstOrdenCompra",{static:!1})],e.prototype,"lstOrdenCompraComponent",void 0),o.c([Object(r.ViewChild)("frmOrdenCompra",{static:!1})],e.prototype,"frmOrdenCompra",void 0),e=o.c([Object(r.Component)({selector:"app-orden-compra",template:o.f(n("PYui")).default,styles:[o.f(n("yTCc")).default]})],e)}(),E=[{path:"ordcomp",component:H,canActivate:[T.a]},{path:"**",redirectTo:"/admin/dashboard",pathMatch:"full"}],A=function(){function e(){}return e=o.c([Object(r.NgModule)({imports:[j.b.forChild(E)],exports:[j.b]})],e)}(),W=n("R5jZ"),N=n("5tAl"),P=n("9Z1F"),V=n("Qyje"),G=function(){function e(e,t){this.http=e,this.ls=t,this.ordenCompraUrl="compra",this.usrToken=null,this.srvcErrHndl=new W.a,this.usrToken=this.ls.get(z.a.usrTokenVar)?this.ls.get(z.a.usrTokenVar).token:null}return e.prototype.get=function(e){void 0===e&&(e={});var t={headers:new l.c({Authorization:this.usrToken})};return this.http.get(z.a.urlWms+"/"+this.ordenCompraUrl+"/buscar?"+V.stringify(e),t).pipe(Object(N.a)(z.a.reintentos),Object(P.a)(this.srvcErrHndl.errorHandler))},e.prototype.save=function(e){var t={headers:new l.c({Authorization:this.usrToken})};return this.http.post(z.a.urlWms+"/"+this.ordenCompraUrl+"/guardar"+(+e.orden_compra>0?"/"+e.orden_compra:""),e,t).pipe(Object(N.a)(z.a.reintentos),Object(P.a)(this.srvcErrHndl.errorHandler))},e.prototype.getDetalle=function(e,t){void 0===t&&(t={});var n={headers:new l.c({Authorization:this.usrToken})};return this.http.get(z.a.urlWms+"/"+this.ordenCompraUrl+"/buscar_detalle/"+e+"?"+V.stringify(t),n).pipe(Object(N.a)(z.a.reintentos),Object(P.a)(this.srvcErrHndl.errorHandler))},e.prototype.saveDetalle=function(e){var t={headers:new l.c({Authorization:this.usrToken})};return this.http.post(z.a.urlWms+"/"+this.ordenCompraUrl+"/guardar_detalle/"+e.orden_compra+(+e.orden_compra_detalle>0?"/"+e.orden_compra_detalle:""),e,t).pipe(Object(N.a)(z.a.reintentos),Object(P.a)(this.srvcErrHndl.errorHandler))},e.ctorParameters=function(){return[{type:l.a},{type:x.a}]},e=o.c([Object(r.Injectable)({providedIn:"root"})],e)}(),B=function(){function e(e){var t=this;this.ordenCompraSrvc=e,this.getOrdenCompraEv=new r.EventEmitter,this.length=0,this.pageSize=5,this.pageSizeOptions=[5,10,15],this.pageIndex=0,this.txtFiltro="",this.loadOrdenesCompra=function(){t.ordenCompraSrvc.get().subscribe((function(e){e&&e.length>0&&(t.lstOrdenesCompra=e,t.applyFilter())}))},this.getOrdenCompra=function(e){t.getOrdenCompraEv.emit({orden_compra:e.orden_compra,proveedor:e.proveedor||0,fecha:e.fecha,usuario:e.usuario||0,notas:e.notas,estatus_movimiento:e.estatus_movimiento||1})},this.pageChange=function(e){t.pageSize=e.pageSize,t.pageIndex=e.pageIndex,t.applyFilter()}}return e.prototype.ngOnInit=function(){this.loadOrdenesCompra()},e.prototype.applyFilter=function(){if(this.txtFiltro.length>0){var e=Object(z.b)(this.lstOrdenesCompra,this.txtFiltro);this.length=e.length,this.lstOrdenesCompraPaged=Object(z.c)(e,this.pageSize,this.pageIndex+1)}else this.length=this.lstOrdenesCompra.length,this.lstOrdenesCompraPaged=Object(z.c)(this.lstOrdenesCompra,this.pageSize,this.pageIndex+1)},e.ctorParameters=function(){return[{type:G}]},o.c([Object(r.Output)()],e.prototype,"getOrdenCompraEv",void 0),e=o.c([Object(r.Component)({selector:"app-lista-orden-compra",template:o.f(n("rR3N")).default,styles:[o.f(n("rqBJ")).default]})],e)}(),R=n("50cD"),q=n("NGYs"),Y=n("3e6T"),Z=n("u5dX"),U=function(){function e(e,t,n,o,a,l,i){var d=this;this._snackBar=e,this.ls=t,this.ordenCompraSrvc=n,this.proveedorSrvc=o,this.articuloSrvc=a,this.tipoMovimientoSrvc=l,this.bodegaSrvc=i,this.ordenCompraSavedEv=new r.EventEmitter,this.showOrdenCompraForm=!0,this.showDetalleOrdenCompraForm=!0,this.detallesOrdenCompra=[],this.displayedColumns=["articulo","cantidad","monto","total","editItem"],this.proveedores=[],this.articulos=[],this.tiposMovimiento=[],this.bodegas=[],this.esMovil=!1,this.loadProveedores=function(){d.proveedorSrvc.get().subscribe((function(e){e&&(d.proveedores=e)}))},this.loadTiposMovimiento=function(){d.tipoMovimientoSrvc.get().subscribe((function(e){e&&(d.tiposMovimiento=e)}))},this.loadBodegas=function(){d.bodegaSrvc.get().subscribe((function(e){e&&(d.bodegas=e)}))},this.resetOrdenCompra=function(){d.ordenCompra={orden_compra:null,proveedor:null,usuario:d.ls.get(z.a.usrTokenVar).idusr||0,notas:null,estatus_movimiento:1,bodega:null,tipo_movimiento:null},d.resetDetalleOrdenCompra()},this.onSubmit=function(){d.ordenCompraSrvc.save(d.ordenCompra).subscribe((function(e){e.exito&&(d.ordenCompraSavedEv.emit(),d.resetOrdenCompra(),d.ordenCompra={orden_compra:+e.compra.orden_compra,proveedor:e.compra.proveedor,fecha:e.compra.fecha,usuario:e.compra.usuario,notas:e.compra.notas,estatus_movimiento:1},d.loadDetalleOrdenCompra(d.ordenCompra.orden_compra))}))},this.loadArticulos=function(){d.articuloSrvc.getArticulos().subscribe((function(e){e&&(d.articulos=e)}))},this.resetDetalleOrdenCompra=function(){return d.detalleOrdenCompra={orden_compra_detalle:null,orden_compra:d.ordenCompra.orden_compra?d.ordenCompra.orden_compra:null,articulo:null,cantidad:null,monto:null,total:null}},this.loadDetalleOrdenCompra=function(e){void 0===e&&(e=+d.ordenCompra.orden_compra),d.ordenCompraSrvc.getDetalle(e,{orden_compra:e}).subscribe((function(e){e&&(d.detallesOrdenCompra=e,d.updateTableDataSource())}))},this.getDetalleOrdenCompra=function(e,t){void 0===e&&(e=+d.ordenCompra.orden_compra),d.ordenCompraSrvc.getDetalle(e,{orden_compra_detalle:t}).subscribe((function(e){e&&(d.detalleOrdenCompra={orden_compra_detalle:e[0].orden_compra_detalle,orden_compra:e[0].orden_compra,articulo:e[0].articulo.articulo,cantidad:+e[0].cantidad,monto:+e[0].monto,total:+e[0].total},d.showDetalleOrdenCompraForm=!0)}))},this.onSubmitDetail=function(){d.detalleOrdenCompra.orden_compra=d.ordenCompra.orden_compra,d.ordenCompraSrvc.saveDetalle(d.detalleOrdenCompra).subscribe((function(e){e&&(d.loadDetalleOrdenCompra(),d.resetDetalleOrdenCompra())}))},this.updateTableDataSource=function(){return d.dataSource=new C.a(d.detallesOrdenCompra)},this.generarIngreso=function(){d.ordenCompra.estatus_movimiento=2,d.onSubmit()}}return e.prototype.ngOnInit=function(){this.esMovil=this.ls.get(z.a.usrTokenVar).enmovil||!1,this.resetOrdenCompra(),this.loadProveedores(),this.loadArticulos(),this.loadBodegas(),this.loadTiposMovimiento()},e.ctorParameters=function(){return[{type:O.a},{type:x.a},{type:G},{type:R.a},{type:q.a},{type:Y.a},{type:Z.a}]},o.c([Object(r.Input)()],e.prototype,"ordenCompra",void 0),o.c([Object(r.Output)()],e.prototype,"ordenCompraSavedEv",void 0),e=o.c([Object(r.Component)({selector:"app-form-orden-compra",template:o.f(n("n7A6")).default,styles:[o.f(n("pM9h")).default]})],e)}();n.d(t,"OrdenCompraModule",(function(){return J}));var J=function(){function e(){}return e=o.c([Object(r.NgModule)({declarations:[H,B,U],imports:[a.CommonModule,A,d.a,l.b,i.FormsModule,m.a,s.a,c.c,p.b,u.a,h.a,f.a,C.b,g.a,v.a,b.b,O.b,y.a,_.a,D.a,S.b,I.c,M.a,w.a,k.a,F.NgVirtualKeyboardModule]})],e)}()},n7A6:function(e,t,n){"use strict";n.r(t),t.default='<mat-card class="mat-elevation-z4 fullWidth">\n    <mat-card-title>\n        <h4>\n            Orden de compra{{!!ordenCompra.orden_compra ? (\' No. \' + ordenCompra.orden_compra) : \'\'}}\n            <button mat-icon-button type="button" color="accent" (click)="showOrdenCompraForm = true;"\n                *ngIf="!showOrdenCompraForm">\n                <mat-icon class="iconFontSize">expand_more</mat-icon>\n            </button>\n            <button mat-icon-button type="button" color="accent" (click)="showOrdenCompraForm = false;"\n                *ngIf="showOrdenCompraForm">\n                <mat-icon class="iconFontSize">expand_less</mat-icon>\n            </button>\n        </h4>\n    </mat-card-title>\n    <mat-card-content>\n        <form #frmOrdenCompra="ngForm" *ngIf="showOrdenCompraForm" (ngSubmit)="frmOrdenCompra.form.valid && onSubmit()" novalidate>\n            <mat-form-field class="fullWidth">\n                <mat-label>Proveedor</mat-label>\n                <mat-select name="proveedor" [(ngModel)]="ordenCompra.proveedor" required>\n                    <mat-option *ngFor="let prov of proveedores" [value]="prov.proveedor">\n                        ({{prov.nit}}) {{prov.razon_social}}\n                    </mat-option>\n                </mat-select>\n            </mat-form-field>\n            <mat-form-field class="fullWidth" *ngIf="esMovil">\n                <input matInput placeholder="Notas" name="notas" [(ngModel)]="ordenCompra.notas">\n            </mat-form-field>\n            <mat-form-field class="fullWidth" *ngIf="!esMovil">\n                <input matInput ng-virtual-keyboard ng-virtual-keyboard-layout="alphanumeric"\n                    ng-virtual-keyboard-placeholder="Notas" placeholder="Notas" name="notas"\n                    [(ngModel)]="ordenCompra.notas">\n            </mat-form-field>\n            <mat-form-field class="fullWidth">\n                <mat-label>Tipo de movimiento</mat-label>\n                <mat-select name="tipo_movimiento" [(ngModel)]="ordenCompra.tipo_movimiento">\n                    <mat-option *ngFor="let tm of tiposMovimiento" [value]="tm.tipo_movimiento">\n                        {{tm.descripcion}}\n                    </mat-option>\n                </mat-select>\n            </mat-form-field>\n            <mat-form-field class="fullWidth">\n                <mat-label>Bodega</mat-label>\n                <mat-select name="bodega" [(ngModel)]="ordenCompra.bodega">\n                    <mat-option *ngFor="let bode of bodegas" [value]="bode.bodega">\n                        {{bode.descripcion}}\n                    </mat-option>\n                </mat-select>\n            </mat-form-field>\n            <div align="end">\n                <button mat-raised-button type="submit" color="accent" class="btnAccion"\n                    [disabled]="!frmOrdenCompra.form.valid || [2, 3].indexOf(+ordenCompra.estatus_movimiento) >= 0">\n                    Guardar\n                </button>\n                <button mat-raised-button type="button" color="accent" class="btnAccion" (click)="generarIngreso()"\n                    *ngIf="ordenCompra.orden_compra && detallesOrdenCompra.length > 0"\n                    [disabled]="!frmOrdenCompra.form.valid || [2, 3].indexOf(+ordenCompra.estatus_movimiento) >= 0 || !ordenCompra.bodega || !ordenCompra.tipo_movimiento">\n                    Generar ingreso\n                </button>\n                <button mat-raised-button type="button" color="accent" (click)="resetOrdenCompra()"\n                    *ngIf="ordenCompra.orden_compra">\n                    Nueva\n                </button>\n            </div>\n        </form>\n    </mat-card-content>\n</mat-card>\n<hr *ngIf="ordenCompra.orden_compra" />\n<mat-card class="mat-elevation-z4 fullWidth" *ngIf="ordenCompra.orden_compra">\n    <mat-card-title>\n        <h4>\n            Detalle de orden de compra No. {{ordenCompra.orden_compra}}\n            <button mat-icon-button type="button" color="accent" (click)="showDetalleOrdenCompraForm = true;"\n                *ngIf="!showDetalleOrdenCompraForm">\n                <mat-icon class="iconFontSize">expand_more</mat-icon>\n            </button>\n            <button mat-icon-button type="button" color="accent" (click)="showDetalleOrdenCompraForm = false;"\n                *ngIf="showDetalleOrdenCompraForm">\n                <mat-icon class="iconFontSize">expand_less</mat-icon>\n            </button>\n        </h4>\n    </mat-card-title>\n    <mat-card-content>\n        <form #frmDetalleOrdenCompra="ngForm" *ngIf="showDetalleOrdenCompraForm" (ngSubmit)="frmDetalleOrdenCompra.form.valid && onSubmitDetail()" novalidate>\n            <mat-form-field class="fullWidth">\n                <mat-label>Artículo</mat-label>\n                <mat-select name="articulo" [(ngModel)]="detalleOrdenCompra.articulo" required>\n                    <mat-option *ngFor="let a of articulos" [value]="a.articulo">\n                        {{a.descripcion}}\n                    </mat-option>\n                </mat-select>\n            </mat-form-field>\n            <mat-form-field class="fullWidth" *ngIf="esMovil">\n                <input matInput placeholder="Cantidad" name="cantidad" [(ngModel)]="detalleOrdenCompra.cantidad"\n                    (change)="detalleOrdenCompra.total = +detalleOrdenCompra.monto * +detalleOrdenCompra.cantidad"\n                    required>\n            </mat-form-field>\n            <mat-form-field class="fullWidth" *ngIf="!esMovil">\n                <input matInput ng-virtual-keyboard ng-virtual-keyboard-layout="numeric"\n                    ng-virtual-keyboard-placeholder="Cantidad" placeholder="Cantidad" name="cantidad"\n                    [(ngModel)]="detalleOrdenCompra.cantidad"\n                    (change)="detalleOrdenCompra.total = +detalleOrdenCompra.monto * +detalleOrdenCompra.cantidad"\n                    required>\n            </mat-form-field>\n            <mat-form-field class="fullWidth" *ngIf="esMovil">\n                <input matInput placeholder="Monto" name="monto" [(ngModel)]="detalleOrdenCompra.monto"\n                    (change)="detalleOrdenCompra.total = +detalleOrdenCompra.monto * +detalleOrdenCompra.cantidad"\n                    required>\n            </mat-form-field>\n            <mat-form-field class="fullWidth" *ngIf="!esMovil">\n                <input matInput ng-virtual-keyboard ng-virtual-keyboard-layout="numeric"\n                    ng-virtual-keyboard-placeholder="Monto" placeholder="Monto" name="monto"\n                    [(ngModel)]="detalleOrdenCompra.monto"\n                    (change)="detalleOrdenCompra.total = +detalleOrdenCompra.monto * +detalleOrdenCompra.cantidad"\n                    required>\n            </mat-form-field>\n            <div align="end">\n                <button mat-raised-button type="submit" color="accent" class="btnAccion"\n                    [disabled]="!frmDetalleOrdenCompra.form.valid || [2, 3].indexOf(+ordenCompra.estatus_movimiento) >= 0">\n                    Guardar\n                </button>\n                <button mat-raised-button type="button" color="accent" (click)="resetDetalleOrdenCompra()"\n                    *ngIf="detalleOrdenCompra.orden_compra_detalle">\n                    Nuevo\n                </button>\n            </div>\n        </form>\n        <hr *ngIf="detallesOrdenCompra.length > 0" />\n        <table mat-table [dataSource]="dataSource" class="mat-elevation-z4 full-width"\n            *ngIf="detallesOrdenCompra.length > 0">\n            <ng-container matColumnDef="articulo">\n                <th mat-header-cell *matHeaderCellDef>Artículo</th>\n                <td mat-cell *matCellDef="let element" class="text-wrap">{{element.articulo.descripcion}}</td>\n            </ng-container>\n            <ng-container matColumnDef="cantidad">\n                <th mat-header-cell *matHeaderCellDef class="text-right">Cantidad</th>\n                <td mat-cell *matCellDef="let element" class="text-right">{{element.cantidad | number:\'1.2-2\'}}</td>\n            </ng-container>\n            <ng-container matColumnDef="monto">\n                <th mat-header-cell *matHeaderCellDef class="text-right">Monto</th>\n                <td mat-cell *matCellDef="let element" class="text-right">{{element.monto | number:\'1.2-2\'}}</td>\n            </ng-container>\n            <ng-container matColumnDef="total">\n                <th mat-header-cell *matHeaderCellDef class="text-right">Total</th>\n                <td mat-cell *matCellDef="let element" class="text-right">{{element.total | number:\'1.2-2\'}}</td>\n            </ng-container>\n            <ng-container matColumnDef="editItem">\n                <th mat-header-cell *matHeaderCellDef>&nbsp;</th>\n                <td mat-cell *matCellDef="let element" class="text-wrap">\n                    <button mat-raised-button type="button" color="accent"\n                        (click)="getDetalleOrdenCompra(element.orden_compra, element.orden_compra_detalle)"\n                        [disabled]="[2, 3].indexOf(+ordenCompra.estatus_movimiento) >= 0">\n                        Editar\n                    </button>\n                </td>\n            </ng-container>\n            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>\n            <tr mat-row *matRowDef="let row; columns: displayedColumns;">\n            </tr>\n        </table>\n    </mat-card-content>\n</mat-card>'},pM9h:function(e,t,n){"use strict";n.r(t),t.default=".full-width {\n    width: 100%;\n}\n\n.iconFontSize {\n    font-size: 24pt;\n}"},rR3N:function(e,t,n){"use strict";n.r(t),t.default='<mat-card class="mat-elevation-z4 fullWidth">\n    <mat-card-content>\n        <mat-form-field class="fullWidth">\n            <input matInput (keyup)="applyFilter()" placeholder="Buscar..." [(ngModel)]="txtFiltro" [ngModelOptions]="{standalone: true}">\n        </mat-form-field>\n        <mat-nav-list>\n            <mat-list-item *ngFor="let element of lstOrdenesCompraPaged" (click)="getOrdenCompra(element)">\n                <mat-icon mat-list-icon>description</mat-icon>\n                <h5 mat-line>No. {{element.orden_compra}}</h5><br/>\n                <p mat-line>\n                    Fecha: {{element.fecha | date: \'dd/MM/yyyy\'}}\n                </p>\n            </mat-list-item>\n        </mat-nav-list>\n        <mat-paginator [length]="length" [pageSize]="pageSize" [pageSizeOptions]="pageSizeOptions" (page)="pageChange($event)" showFirstLastButtons>\n        </mat-paginator>\n    </mat-card-content>\n</mat-card>\n'},rqBJ:function(e,t,n){"use strict";n.r(t),t.default=".fullWidth {\n    width: 100% !important;\n}\n\ntable {\n    width: 100% !important;\n}"},u5dX:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var o=n("mrSG"),r=n("CcnG"),a=n("t/Na"),l=n("sKxO"),i=n("R5jZ"),d=n("FY0D"),m=n("5tAl"),s=n("9Z1F"),c=n("Qyje"),p=function(){function e(e,t){this.http=e,this.ls=t,this.usrToken=null,this.srvcErrHndl=new i.a,this.usrToken=this.ls.get(l.a.usrTokenVar)?this.ls.get(l.a.usrTokenVar).token:null}return e.prototype.get=function(e){void 0===e&&(e={});var t={headers:new a.c({Authorization:this.usrToken})};return this.http.get(l.a.urlCatalogos+"/get_bodega?"+c.stringify(e),t).pipe(Object(m.a)(l.a.reintentos),Object(s.a)(this.srvcErrHndl.errorHandler))},e.ctorParameters=function(){return[{type:a.a},{type:d.a}]},e=o.c([Object(r.Injectable)({providedIn:"root"})],e)}()},yTCc:function(e,t,n){"use strict";n.r(t),t.default=""}}]);