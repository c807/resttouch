(window.webpackJsonp=window.webpackJsonp||[]).push([[1,9],{"3e6T":function(t,e,o){"use strict";o.d(e,"a",function(){return b});var i=o("sKxO"),n=o("R5jZ"),c=o("un/a"),r=o("JIr8"),a=o("Qyje"),s=o("fXoL"),l=o("tk/3");let b=(()=>{class t{constructor(t){this.http=t,this.srvcErrHndl=new n.a}get(t={}){return this.http.get(`${i.a.urlCatalogos}/get_tipo_movimiento?${a.stringify(t)}`).pipe(Object(c.a)(i.a.reintentos),Object(r.a)(this.srvcErrHndl.errorHandler))}}return t.\u0275fac=function(e){return new(e||t)(s.Xb(l.b))},t.\u0275prov=s.Jb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},FHMA:function(t,e,o){"use strict";o.d(e,"a",function(){return b});var i=o("tk/3"),n=o("sKxO"),c=o("R5jZ"),r=o("un/a"),a=o("JIr8"),s=o("fXoL"),l=o("FY0D");let b=(()=>{class t{constructor(t,e){this.http=t,this.ls=e,this.usrToken=null,this.httpOptions={responseType:"blob"},this.srvcErrHndl=new c.a,this.usrToken=this.ls.get(n.a.usrTokenVar)?this.ls.get(n.a.usrTokenVar).token:null,this.httpOptions.headers=new i.d({Authorization:this.usrToken,Accept:"application/pdf"})}getReporteCaja(t){return this.http.post(`${n.a.urlAppRestaurante}/reporte/caja`,t,this.httpOptions).pipe(Object(r.a)(n.a.reintentos),Object(a.a)(this.srvcErrHndl.errorHandler))}getReporteExistencia(t){return this.httpOptions.params=t,this.http.get(`${n.a.urlWms}/reporte/existencia`,this.httpOptions).pipe(Object(r.a)(n.a.reintentos),Object(a.a)(this.srvcErrHndl.errorHandler))}getReporteValorizado(t){return this.httpOptions.params=t,this.http.get(`${n.a.urlWms}/reporte/valorizado`,this.httpOptions).pipe(Object(r.a)(n.a.reintentos),Object(a.a)(this.srvcErrHndl.errorHandler))}imprimirInventarioFisico(t,e){return this.httpOptions.params=e,this.http.get(`${n.a.urlWms}/fisico/imprimir/${t}`,this.httpOptions).pipe(Object(r.a)(n.a.reintentos),Object(a.a)(this.srvcErrHndl.errorHandler))}imprimirReceta(t){return this.http.get(`${n.a.urlMantenimientos}/articulo/imprimir_receta/${t}`,this.httpOptions).pipe(Object(r.a)(n.a.reintentos),Object(a.a)(this.srvcErrHndl.errorHandler))}getReporteKardex(t){return this.httpOptions.params=t,this.http.get(`${n.a.urlWms}/reporte/kardex`,this.httpOptions).pipe(Object(r.a)(n.a.reintentos),Object(a.a)(this.srvcErrHndl.errorHandler))}getReporteFactura(t){return this.httpOptions.params=t,this.http.get(`${n.a.urlAppRestaurante}/reporte/factura`,this.httpOptions).pipe(Object(r.a)(n.a.reintentos),Object(a.a)(this.srvcErrHndl.errorHandler))}getReportePropina(t){return this.httpOptions.params=t,this.http.get(`${n.a.urlAppRestaurante}/reporte/distribucion_propina`,this.httpOptions).pipe(Object(r.a)(n.a.reintentos),Object(a.a)(this.srvcErrHndl.errorHandler))}getComanda(t){return this.http.get(`${n.a.urlAppRestaurante}/comanda/imprimir/${t}/1`,this.httpOptions).pipe(Object(r.a)(n.a.reintentos),Object(a.a)(this.srvcErrHndl.errorHandler))}}return t.\u0275fac=function(e){return new(e||t)(s.Xb(i.b),s.Xb(l.a))},t.\u0275prov=s.Jb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},IJgu:function(t,e,o){"use strict";o.d(e,"b",function(){return C}),o.d(e,"a",function(){return S});var i=o("0IaG"),n=o("fXoL"),c=o("ofXK"),r=o("bTqV"),a=o("kmnG"),s=o("d3UM"),l=o("3Pt+"),b=o("FKr1"),d=o("qFsG");function u(t,e){if(1&t&&(n.Tb(0,"mat-option",11),n.Dc(1),n.Sb()),2&t){const t=e.$implicit,o=n.fc(2).$implicit;n.lc("value",t[o.id]),n.Cb(1),n.Fc(" ",t[o.descripcion]," ")}}const g=function(){return{standalone:!0}};function f(t,e){if(1&t){const t=n.Ub();n.Tb(0,"mat-form-field",8),n.Tb(1,"mat-label"),n.Dc(2),n.Sb(),n.Tb(3,"mat-select",9),n.bc("ngModelChange",function(e){return n.wc(t),n.fc().$implicit.valor=e}),n.Cc(4,u,2,2,"mat-option",10),n.Sb(),n.Sb()}if(2&t){const t=n.fc().$implicit;n.Cb(2),n.Ec(t.label),n.Cb(1),n.lc("ngModel",t.valor)("ngModelOptions",n.nc(5,g))("required",t.requerido),n.Cb(1),n.lc("ngForOf",t.datos)}}function m(t,e){if(1&t){const t=n.Ub();n.Tb(0,"mat-form-field",8),n.Tb(1,"input",12),n.bc("ngModelChange",function(e){return n.wc(t),n.fc().$implicit.valor=e}),n.Sb(),n.Sb()}if(2&t){const t=n.fc().$implicit;n.Cb(1),n.lc("placeholder",t.label)("name",t.label)("ngModel",t.valor)("required",t.requerido)}}function p(t,e){if(1&t&&(n.Tb(0,"p"),n.Cc(1,f,5,6,"mat-form-field",7),n.Cc(2,m,2,4,"mat-form-field",7),n.Sb()),2&t){const t=e.$implicit;n.Cb(1),n.lc("ngIf",t.select),n.Cb(1),n.lc("ngIf",!t.select)}}function h(t,e){if(1&t&&(n.Tb(0,"div"),n.Cc(1,p,3,2,"p",6),n.Sb()),2&t){const t=n.fc();n.Cb(1),n.lc("ngForOf",t.config.input)}}class C{constructor(t,e,o,i,n=null){this.title=t,this.message=e,this.lblBtnConfirm=o,this.lblBtnDeny=i,this.config=n}}let S=(()=>{class t{constructor(t,e){this.dialogRef=t,this.data=e,this.title=e.title,this.message=e.message,this.lblBtnConfirm=e.lblBtnConfirm,this.lblBtnDeny=e.lblBtnDeny,this.config=e.config}ngOnInit(){}onConfirm(){this.dialogRef.close(null===this.config||{resultado:!0,config:this.config})}onDismiss(){this.dialogRef.close(null!==this.config&&{resultado:!1,config:this.config})}}return t.\u0275fac=function(e){return new(e||t)(n.Nb(i.f),n.Nb(i.a))},t.\u0275cmp=n.Hb({type:t,selectors:[["app-confirm-dialog"]],decls:11,vars:5,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[4,"ngIf"],["mat-dialog-actions","","align","center"],["mat-raised-button","",1,"btnConfig",3,"click"],["mat-raised-button","","color","accent",1,"btnConfig",3,"click"],[4,"ngFor","ngForOf"],["class","fullWidth",4,"ngIf"],[1,"fullWidth"],["name","input.label",3,"ngModel","ngModelOptions","required","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["matInput","","type","text",3,"placeholder","name","ngModel","required","ngModelChange"]],template:function(t,e){1&t&&(n.Tb(0,"h1",0),n.Dc(1),n.Sb(),n.Tb(2,"div",1),n.Tb(3,"p"),n.Dc(4),n.Sb(),n.Cc(5,h,2,1,"div",2),n.Sb(),n.Tb(6,"div",3),n.Tb(7,"button",4),n.bc("click",function(){return e.onDismiss()}),n.Dc(8),n.Sb(),n.Tb(9,"button",5),n.bc("click",function(){return e.onConfirm()}),n.Dc(10),n.Sb(),n.Sb()),2&t&&(n.Cb(1),n.Fc(" ",e.title,"\n"),n.Cb(3),n.Ec(e.message),n.Cb(1),n.lc("ngIf",e.config&&e.config.input),n.Cb(3),n.Ec(e.lblBtnDeny),n.Cb(2),n.Ec(e.lblBtnConfirm))},directives:[i.g,i.d,c.m,i.c,r.a,c.l,a.b,a.e,s.a,l.k,l.n,l.p,b.k,d.b,l.c],styles:[".btnConfig[_ngcontent-%COMP%]{width:70px;height:48px}"]}),t})()},Iab2:function(t,e,o){var i,n;void 0===(n="function"==typeof(i=function(){"use strict";function e(t,e,o){var i=new XMLHttpRequest;i.open("GET",t),i.responseType="blob",i.onload=function(){r(i.response,e,o)},i.onerror=function(){console.error("could not download file")},i.send()}function o(t){var e=new XMLHttpRequest;e.open("HEAD",t,!1);try{e.send()}catch(t){}return 200<=e.status&&299>=e.status}function i(t){try{t.dispatchEvent(new MouseEvent("click"))}catch(e){var o=document.createEvent("MouseEvents");o.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(o)}}var n="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof global&&global.global===global?global:void 0,c=n.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),r=n.saveAs||("object"!=typeof window||window!==n?function(){}:"download"in HTMLAnchorElement.prototype&&!c?function(t,c,r){var a=n.URL||n.webkitURL,s=document.createElement("a");s.download=c=c||t.name||"download",s.rel="noopener","string"==typeof t?(s.href=t,s.origin===location.origin?i(s):o(s.href)?e(t,c,r):i(s,s.target="_blank")):(s.href=a.createObjectURL(t),setTimeout(function(){a.revokeObjectURL(s.href)},4e4),setTimeout(function(){i(s)},0))}:"msSaveOrOpenBlob"in navigator?function(t,n,c){if(n=n||t.name||"download","string"!=typeof t)navigator.msSaveOrOpenBlob(function(t,e){return void 0===e?e={autoBom:!1}:"object"!=typeof e&&(console.warn("Deprecated: Expected third argument to be a object"),e={autoBom:!e}),e.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(t.type)?new Blob(["\ufeff",t],{type:t.type}):t}(t,c),n);else if(o(t))e(t,n,c);else{var r=document.createElement("a");r.href=t,r.target="_blank",setTimeout(function(){i(r)})}}:function(t,o,i,r){if((r=r||open("","_blank"))&&(r.document.title=r.document.body.innerText="downloading..."),"string"==typeof t)return e(t,o,i);var a="application/octet-stream"===t.type,s=/constructor/i.test(n.HTMLElement)||n.safari,l=/CriOS\/[\d]+/.test(navigator.userAgent);if((l||a&&s||c)&&"undefined"!=typeof FileReader){var b=new FileReader;b.onloadend=function(){var t=b.result;t=l?t:t.replace(/^data:[^;]*;/,"data:attachment/file;"),r?r.location.href=t:location=t,r=null},b.readAsDataURL(t)}else{var d=n.URL||n.webkitURL,u=d.createObjectURL(t);r?r.location=u:location.href=u,r=null,setTimeout(function(){d.revokeObjectURL(u)},4e4)}});n.saveAs=r.saveAs=r,t.exports=r})?i.apply(e,[]):i)||(t.exports=n)},NU9O:function(t,e,o){"use strict";o.d(e,"a",function(){return l});var i=o("fXoL"),n=o("ofXK"),c=o("bTqV");function r(t,e){if(1&t){const t=i.Ub();i.Tb(0,"button",3),i.bc("click",function(){return i.wc(t),i.fc().onHtmlClick()}),i.Dc(1," Generar "),i.Sb()}if(2&t){const t=i.fc();i.lc("disabled",t.configuracion.isHtmlDisabled)}}function a(t,e){if(1&t){const t=i.Ub();i.Tb(0,"button",3),i.bc("click",function(){return i.wc(t),i.fc().onPdfClick()}),i.Dc(1," PDF "),i.Sb()}if(2&t){const t=i.fc();i.lc("disabled",t.configuracion.isPdfDisabled)}}function s(t,e){if(1&t){const t=i.Ub();i.Tb(0,"button",3),i.bc("click",function(){return i.wc(t),i.fc().onExcelClick()}),i.Dc(1," Excel "),i.Sb()}if(2&t){const t=i.fc();i.lc("disabled",t.configuracion.isExcelDisabled)}}let l=(()=>{class t{constructor(){this.htmlClick=new i.o,this.pdfClick=new i.o,this.excelClick=new i.o,this.resetParamsClick=new i.o,this.configuracion={isHtmlDisabled:!1,isPdfDisabled:!1,isExcelDisabled:!1,showHtml:!0,showPdf:!0,showExcel:!0},this.onHtmlClick=()=>this.htmlClick.emit(),this.onPdfClick=()=>this.pdfClick.emit(),this.onExcelClick=()=>this.excelClick.emit(),this.onResetParamsClick=()=>this.resetParamsClick.emit()}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=i.Hb({type:t,selectors:[["app-rpt-botones"]],inputs:{configuracion:"configuracion"},outputs:{htmlClick:"htmlClick",pdfClick:"pdfClick",excelClick:"excelClick",resetParamsClick:"resetParamsClick"},decls:6,vars:3,consts:[["align","end"],["mat-raised-button","","type","button","class","btnAccion","color","accent",3,"disabled","click",4,"ngIf"],["mat-raised-button","","type","button","color","accent",3,"click"],["mat-raised-button","","type","button","color","accent",1,"btnAccion",3,"disabled","click"]],template:function(t,e){1&t&&(i.Tb(0,"div",0),i.Cc(1,r,2,1,"button",1),i.Cc(2,a,2,1,"button",1),i.Cc(3,s,2,1,"button",1),i.Tb(4,"button",2),i.bc("click",function(){return e.onResetParamsClick()}),i.Dc(5," Restaurar "),i.Sb(),i.Sb()),2&t&&(i.Cb(1),i.lc("ngIf",e.configuracion.showHtml),i.Cb(1),i.lc("ngIf",e.configuracion.showPdf),i.Cb(1),i.lc("ngIf",e.configuracion.showExcel))},directives:[n.m,c.a],styles:[""]}),t})()},TOq3:function(t,e,o){"use strict";o.d(e,"a",function(){return n});var i=o("fXoL");let n=(()=>{class t{constructor(){this.configuracion={w:150,h:150,align:"center",size:100}}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=i.Hb({type:t,selectors:[["app-cargando"]],inputs:{configuracion:"configuracion"},decls:2,vars:7,consts:[[3,"align"],["id","imgCargando","src","/assets/img/loading.gif","alt","Cargando..."]],template:function(t,e){1&t&&(i.Tb(0,"div",0),i.Ob(1,"img",1),i.Sb()),2&t&&(i.zc("width",e.configuracion.size,"%"),i.lc("align",e.configuracion.align),i.Cb(1),i.zc("width",e.configuracion.w,"px")("height",e.configuracion.h,"px"))},styles:[""]}),t})()},vtFA:function(t,e,o){"use strict";o.r(e),o.d(e,"WmsModule",function(){return Jn});var i=o("ofXK"),n=o("tk/3"),c=o("3Pt+"),r=o("PCNd"),a=o("MutI"),s=o("NFeN"),l=o("kmnG"),b=o("qFsG"),d=o("Wp6s"),u=o("f0Cb"),g=o("wZkO"),f=o("+0xr"),m=o("d3UM"),p=o("bSwM"),h=o("bTqV"),C=o("dNgK"),S=o("/t3+"),v=o("STbY"),T=o("zkoq"),D=o("M9IT"),M=o("0IaG"),I=o("XhcP"),w=o("8yBR"),_=o("/1cH"),k=o("tyNb"),O=o("0T/Q"),F=o("sKxO"),x=o("wd/R"),y=o("fXoL"),E=o("FY0D"),A=o("R5jZ"),P=o("un/a"),B=o("JIr8"),$=o("Qyje");let R=(()=>{class t{constructor(t){this.http=t,this.ingresoUrl="ingreso",this.srvcErrHndl=new A.a}get(t={}){return this.http.get(`${F.a.urlWms}/${this.ingresoUrl}/buscar_ingreso?${$.stringify(t)}`).pipe(Object(P.a)(F.a.reintentos),Object(B.a)(this.srvcErrHndl.errorHandler))}save(t){return this.http.post(`${F.a.urlWms}/${this.ingresoUrl}/guardar${+t.ingreso>0?"/"+t.ingreso:""}`,t).pipe(Object(P.a)(F.a.reintentos),Object(B.a)(this.srvcErrHndl.errorHandler))}getDetalle(t,e={}){return this.http.get(`${F.a.urlWms}/${this.ingresoUrl}/buscar_detalle/${t}?${$.stringify(e)}`).pipe(Object(P.a)(F.a.reintentos),Object(B.a)(this.srvcErrHndl.errorHandler))}saveDetalle(t){return this.http.post(`${F.a.urlWms}/${this.ingresoUrl}/guardar_detalle/${t.ingreso}${+t.ingreso_detalle>0?"/"+t.ingreso_detalle:""}`,t).pipe(Object(P.a)(F.a.reintentos),Object(B.a)(this.srvcErrHndl.errorHandler))}}return t.\u0275fac=function(e){return new(e||t)(y.Xb(n.b))},t.\u0275prov=y.Jb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var U=o("FKr1");function N(t,e){if(1&t){const t=y.Ub();y.Tb(0,"mat-list-item",5),y.bc("click",function(){y.wc(t);const o=e.$implicit;return y.fc().getIngreso(o)}),y.Tb(1,"mat-icon",6),y.Dc(2,"trending_up"),y.Sb(),y.Tb(3,"h5",7),y.Dc(4),y.Sb(),y.Ob(5,"br"),y.Tb(6,"p",7),y.Dc(7),y.gc(8,"date"),y.Ob(9,"br"),y.Dc(10),y.Ob(11,"br"),y.Sb(),y.Tb(12,"p",7),y.Dc(13),y.Sb(),y.Sb()}if(2&t){const t=e.$implicit;y.Cb(4),y.Fc("No. ",t.ingreso,""),y.Cb(3),y.Fc(" Fecha: ",y.ic(8,4,t.fecha,"dd/MM/yyyy"),""),y.Cb(3),y.Fc(" Bodega: ",t.bodega.descripcion,""),y.Cb(3),y.Fc(" Proveedor: ",t.proveedor.razon_social," ")}}const H=function(){return{standalone:!0}};let j=(()=>{class t{constructor(t){this.ingresoSrvc=t,this.getIngresoEv=new y.o,this.length=0,this.pageSize=5,this.pageSizeOptions=[5,10,15],this.pageIndex=0,this.txtFiltro="",this.loadIngresos=()=>{this.ingresoSrvc.get().subscribe(t=>{t&&t.length>0&&(this.lstIngresos=t,this.applyFilter())})},this.getIngreso=t=>{this.getIngresoEv.emit({ingreso:t.ingreso,tipo_movimiento:t.tipo_movimiento.tipo_movimiento,fecha:t.fecha,bodega_origen:t.bodega_origen&&t.bodega_origen.bodega?t.bodega_origen.bodega:null,bodega:t.bodega.bodega,usuario:t.usuario.usuario,comentario:t.comentario,proveedor:t.proveedor.proveedor})},this.pageChange=t=>{this.pageSize=t.pageSize,this.pageIndex=t.pageIndex,this.applyFilter()}}ngOnInit(){this.loadIngresos()}applyFilter(){if(this.txtFiltro.length>0){const t=Object(F.b)(this.lstIngresos,this.txtFiltro);this.length=t.length,this.lstIngresosPaged=Object(F.c)(t,this.pageSize,this.pageIndex+1)}else this.length=this.lstIngresos.length,this.lstIngresosPaged=Object(F.c)(this.lstIngresos,this.pageSize,this.pageIndex+1)}}return t.\u0275fac=function(e){return new(e||t)(y.Nb(R))},t.\u0275cmp=y.Hb({type:t,selectors:[["app-lista-ingreso"]],outputs:{getIngresoEv:"getIngresoEv"},decls:7,vars:7,consts:[[1,"mat-elevation-z4","fullWidth",2,"height","100% important"],[1,"fullWidth"],["matInput","","placeholder","Buscar...",3,"ngModel","ngModelOptions","keyup","ngModelChange"],[3,"click",4,"ngFor","ngForOf"],["showFirstLastButtons","",3,"length","pageSize","pageSizeOptions","page"],[3,"click"],["mat-list-icon",""],["mat-line",""]],template:function(t,e){1&t&&(y.Tb(0,"mat-card",0),y.Tb(1,"mat-card-content"),y.Tb(2,"mat-form-field",1),y.Tb(3,"input",2),y.bc("keyup",function(){return e.applyFilter()})("ngModelChange",function(t){return e.txtFiltro=t}),y.Sb(),y.Sb(),y.Tb(4,"mat-nav-list"),y.Cc(5,N,14,7,"mat-list-item",3),y.Sb(),y.Tb(6,"mat-paginator",4),y.bc("page",function(t){return e.pageChange(t)}),y.Sb(),y.Sb(),y.Sb()),2&t&&(y.Cb(3),y.lc("ngModel",e.txtFiltro)("ngModelOptions",y.nc(6,H)),y.Cb(2),y.lc("ngForOf",e.lstIngresosPaged),y.Cb(1),y.lc("length",e.length)("pageSize",e.pageSize)("pageSizeOptions",e.pageSizeOptions))},directives:[d.a,d.c,l.b,b.b,c.c,c.k,c.n,a.e,i.l,D.a,a.c,s.a,a.b,U.h],pipes:[i.e],styles:[".fullWidth[_ngcontent-%COMP%], table[_ngcontent-%COMP%]{width:100%!important}"]}),t})();var z=o("50cD"),G=o("3e6T"),q=o("u5dX"),W=o("NGYs"),L=o("C5NV");function V(t,e){if(1&t){const t=y.Ub();y.Tb(0,"button",5),y.bc("click",function(){return y.wc(t),y.fc().showIngresoForm=!0}),y.Tb(1,"mat-icon",6),y.Dc(2,"expand_more"),y.Sb(),y.Sb()}}function Q(t,e){if(1&t){const t=y.Ub();y.Tb(0,"button",5),y.bc("click",function(){return y.wc(t),y.fc().showIngresoForm=!1}),y.Tb(1,"mat-icon",6),y.Dc(2,"expand_less"),y.Sb(),y.Sb()}}function X(t,e){if(1&t&&(y.Tb(0,"mat-option",18),y.Dc(1),y.Sb()),2&t){const t=e.$implicit;y.lc("value",t.tipo_movimiento),y.Cb(1),y.Fc(" ",t.descripcion," ")}}function K(t,e){if(1&t){const t=y.Ub();y.Tb(0,"mat-form-field",10),y.Tb(1,"mat-label"),y.Dc(2,"Tipo de movimiento"),y.Sb(),y.Tb(3,"mat-select",17),y.bc("ngModelChange",function(e){return y.wc(t),y.fc(2).ingreso.tipo_movimiento=e}),y.Cc(4,X,2,2,"mat-option",13),y.Sb(),y.Sb()}if(2&t){const t=y.fc(2);y.Cb(3),y.lc("ngModel",t.ingreso.tipo_movimiento),y.Cb(1),y.lc("ngForOf",t.tiposMovimiento)}}function J(t,e){if(1&t&&(y.Tb(0,"mat-option",18),y.Dc(1),y.Sb()),2&t){const t=e.$implicit;y.lc("value",t.bodega),y.Cb(1),y.Fc(" ",t.descripcion," ")}}function Z(t,e){if(1&t&&(y.Tb(0,"mat-option",18),y.Dc(1),y.Sb()),2&t){const t=e.$implicit;y.lc("value",t.bodega),y.Cb(1),y.Fc(" ",t.descripcion," ")}}function Y(t,e){if(1&t){const t=y.Ub();y.Tb(0,"button",21),y.bc("click",function(){return y.wc(t),y.fc(3).ingreso.bodega_origen=void 0}),y.Tb(1,"mat-icon",6),y.Dc(2,"close"),y.Sb(),y.Sb()}}function tt(t,e){if(1&t){const t=y.Ub();y.Tb(0,"mat-form-field",10),y.Tb(1,"mat-label"),y.Dc(2,"Bodega de origen"),y.Sb(),y.Tb(3,"mat-select",19),y.bc("ngModelChange",function(e){return y.wc(t),y.fc(2).ingreso.bodega_origen=e}),y.Cc(4,Z,2,2,"mat-option",13),y.Sb(),y.Cc(5,Y,3,0,"button",20),y.Sb()}if(2&t){const t=y.fc(2);y.Cb(3),y.lc("ngModel",t.ingreso.bodega_origen),y.Cb(1),y.lc("ngForOf",t.bodegas),y.Cb(1),y.lc("ngIf",t.ingreso.bodega_origen)}}function et(t,e){if(1&t&&(y.Tb(0,"mat-option",18),y.Dc(1),y.Sb()),2&t){const t=e.$implicit;y.lc("value",t),y.Cb(1),y.Gc(" (",t.nit,") ",t.razon_social," ")}}const ot=function(){return{standalone:!0}};function it(t,e){if(1&t){const t=y.Ub();y.Tb(0,"mat-form-field",10),y.Tb(1,"mat-label"),y.Dc(2,"Proveedor"),y.Sb(),y.Tb(3,"input",22),y.bc("ngModelChange",function(e){return y.wc(t),y.fc(2).txtProveedorSelected=e})("keyup",function(){y.wc(t);const e=y.fc(2);return e.filtrarProveedores(e.txtProveedorSelected)}),y.Sb(),y.Tb(4,"mat-autocomplete",23,24),y.Cc(6,et,2,3,"mat-option",13),y.Sb(),y.Sb()}if(2&t){const t=y.tc(5),e=y.fc(2);y.Cb(3),y.lc("ngModel",e.txtProveedorSelected)("ngModelOptions",y.nc(5,ot))("matAutocomplete",t),y.Cb(1),y.lc("displayWith",e.displayProveedor),y.Cb(2),y.lc("ngForOf",e.filteredProveedores)}}function nt(t,e){if(1&t){const t=y.Ub();y.Tb(0,"mat-form-field",10),y.Tb(1,"input",25),y.bc("ngModelChange",function(e){return y.wc(t),y.fc(2).ingreso.comentario=e}),y.Sb(),y.Sb()}if(2&t){const t=y.fc(2);y.Cb(1),y.lc("ngModel",t.ingreso.comentario)}}function ct(t,e){if(1&t&&(y.Tb(0,"button",26),y.Dc(1," Guardar "),y.Sb()),2&t){y.fc();const t=y.tc(1),e=y.fc();y.lc("disabled",!t.form.valid||e.bloqueoBotones)}}function rt(t,e){if(1&t){const t=y.Ub();y.Tb(0,"button",27),y.bc("click",function(){return y.wc(t),y.fc(2).resetIngreso()}),y.Dc(1," Nuevo "),y.Sb()}}function at(t,e){if(1&t){const t=y.Ub();y.Tb(0,"form",7,8),y.bc("ngSubmit",function(){y.wc(t);const e=y.tc(1),o=y.fc();return e.form.valid&&o.onSubmit()}),y.Cc(2,K,5,2,"mat-form-field",9),y.Tb(3,"mat-form-field",10),y.Tb(4,"input",11),y.bc("ngModelChange",function(e){return y.wc(t),y.fc().ingreso.fecha=e}),y.Sb(),y.Sb(),y.Tb(5,"mat-form-field",10),y.Tb(6,"mat-label"),y.Dc(7,"Bodega"),y.Sb(),y.Tb(8,"mat-select",12),y.bc("ngModelChange",function(e){return y.wc(t),y.fc().ingreso.bodega=e}),y.Cc(9,J,2,2,"mat-option",13),y.Sb(),y.Sb(),y.Cc(10,tt,6,3,"mat-form-field",9),y.Cc(11,it,7,6,"mat-form-field",9),y.Cc(12,nt,2,1,"mat-form-field",9),y.Tb(13,"div",14),y.Cc(14,ct,2,1,"button",15),y.Cc(15,rt,2,0,"button",16),y.Sb(),y.Sb()}if(2&t){const t=y.fc();y.Cb(2),y.lc("ngIf",t.saveToDB),y.Cb(2),y.lc("ngModel",t.ingreso.fecha),y.Cb(4),y.lc("ngModel",t.ingreso.bodega),y.Cb(1),y.lc("ngForOf",t.bodegas),y.Cb(1),y.lc("ngIf",t.saveToDB),y.Cb(1),y.lc("ngIf",t.saveToDB),y.Cb(1),y.lc("ngIf",t.esMovil),y.Cb(2),y.lc("ngIf",t.saveToDB),y.Cb(1),y.lc("ngIf",t.ingreso.ingreso)}}function st(t,e){1&t&&y.Ob(0,"hr")}function lt(t,e){if(1&t){const t=y.Ub();y.Tb(0,"button",5),y.bc("click",function(){return y.wc(t),y.fc(2).showDetalleIngresoForm=!0}),y.Tb(1,"mat-icon",6),y.Dc(2,"expand_more"),y.Sb(),y.Sb()}}function bt(t,e){if(1&t){const t=y.Ub();y.Tb(0,"button",5),y.bc("click",function(){return y.wc(t),y.fc(2).showDetalleIngresoForm=!1}),y.Tb(1,"mat-icon",6),y.Dc(2,"expand_less"),y.Sb(),y.Sb()}}function dt(t,e){if(1&t&&(y.Tb(0,"mat-option",18),y.Dc(1),y.Sb()),2&t){const t=e.$implicit;y.lc("value",t),y.Cb(1),y.Fc(" ",t.descripcion," ")}}function ut(t,e){if(1&t&&(y.Tb(0,"mat-option",18),y.Dc(1),y.Sb()),2&t){const t=e.$implicit;y.lc("value",t.presentacion),y.Cb(1),y.Fc(" ",t.descripcion," ")}}function gt(t,e){if(1&t){const t=y.Ub();y.Tb(0,"mat-form-field",10),y.Tb(1,"input",36),y.bc("ngModelChange",function(e){return y.wc(t),y.fc(3).detalleIngreso.cantidad=e})("change",function(){y.wc(t);const e=y.fc(3);return e.detalleIngreso.precio_total=+e.detalleIngreso.precio_unitario*+e.detalleIngreso.cantidad}),y.Sb(),y.Sb()}if(2&t){const t=y.fc(3);y.Cb(1),y.lc("ngModel",t.detalleIngreso.cantidad)}}function ft(t,e){if(1&t){const t=y.Ub();y.Tb(0,"mat-form-field",10),y.Tb(1,"input",37),y.bc("ngModelChange",function(e){return y.wc(t),y.fc(3).detalleIngreso.precio_unitario=e})("change",function(){y.wc(t);const e=y.fc(3);return e.detalleIngreso.precio_total=+e.detalleIngreso.precio_unitario*+e.detalleIngreso.cantidad}),y.Sb(),y.Sb()}if(2&t){const t=y.fc(3);y.Cb(1),y.lc("ngModel",t.detalleIngreso.precio_unitario)}}function mt(t,e){if(1&t&&(y.Tb(0,"button",26),y.Dc(1," Guardar "),y.Sb()),2&t){y.fc();const t=y.tc(1),e=y.fc(2);y.lc("disabled",!t.form.valid||e.bloqueoBotones)}}const pt=function(){return[2,3]};function ht(t,e){if(1&t){const t=y.Ub();y.Tb(0,"button",38),y.bc("click",function(){return y.wc(t),y.fc(3).addToDetail()}),y.Dc(1," Nuevo "),y.Sb()}if(2&t){y.fc();const t=y.tc(1),e=y.fc(2);y.lc("disabled",!t.form.valid||y.nc(1,pt).indexOf(+e.ingreso.estatus_movimiento)>=0)}}function Ct(t,e){if(1&t){const t=y.Ub();y.Tb(0,"button",27),y.bc("click",function(){return y.wc(t),y.fc(3).resetDetalleIngreso()}),y.Dc(1," Nuevo "),y.Sb()}}function St(t,e){if(1&t){const t=y.Ub();y.Tb(0,"form",7,30),y.bc("ngSubmit",function(){y.wc(t);const e=y.tc(1),o=y.fc(2);return e.form.valid&&o.onSubmitDetail()}),y.Tb(2,"mat-form-field",10),y.Tb(3,"mat-label"),y.Dc(4,"Art\xedculo"),y.Sb(),y.Tb(5,"input",31),y.bc("ngModelChange",function(e){return y.wc(t),y.fc(2).txtArticuloSelected=e})("keyup",function(){y.wc(t);const e=y.fc(2);return e.filtrarArticulos(e.txtArticuloSelected)}),y.Sb(),y.Tb(6,"mat-autocomplete",32,33),y.bc("optionSelected",function(){return y.wc(t),y.fc(2).setPresentaciones()}),y.Cc(8,dt,2,2,"mat-option",13),y.Sb(),y.Sb(),y.Tb(9,"mat-form-field",10),y.Tb(10,"mat-label"),y.Dc(11,"Presentaci\xf3n"),y.Sb(),y.Tb(12,"mat-select",34),y.bc("ngModelChange",function(e){return y.wc(t),y.fc(2).detalleIngreso.presentacion=e}),y.Cc(13,ut,2,2,"mat-option",13),y.Sb(),y.Sb(),y.Cc(14,gt,2,1,"mat-form-field",9),y.Cc(15,ft,2,1,"mat-form-field",9),y.Tb(16,"div",14),y.Cc(17,mt,2,1,"button",15),y.Cc(18,ht,2,2,"button",35),y.Cc(19,Ct,2,0,"button",16),y.Sb(),y.Sb()}if(2&t){const t=y.tc(7),e=y.fc(2);y.Cb(5),y.lc("ngModel",e.txtArticuloSelected)("ngModelOptions",y.nc(12,ot))("matAutocomplete",t),y.Cb(1),y.lc("displayWith",e.displayArticulo),y.Cb(2),y.lc("ngForOf",e.filteredArticulos),y.Cb(4),y.lc("ngModel",e.detalleIngreso.presentacion),y.Cb(1),y.lc("ngForOf",e.fltrPresentaciones),y.Cb(1),y.lc("ngIf",e.esMovil),y.Cb(1),y.lc("ngIf",e.esMovil&&e.saveToDB),y.Cb(2),y.lc("ngIf",e.saveToDB),y.Cb(1),y.lc("ngIf",!e.saveToDB),y.Cb(1),y.lc("ngIf",e.detalleIngreso.ingreso_detalle)}}function vt(t,e){1&t&&y.Ob(0,"hr")}function Tt(t,e){1&t&&(y.Tb(0,"th",52),y.Dc(1,"Art\xedculo"),y.Sb())}function Dt(t,e){if(1&t&&(y.Tb(0,"td",53),y.Dc(1),y.Sb()),2&t){const t=e.$implicit,o=y.fc(3);y.Cb(1),y.Fc(" ",o.saveToDB?t.articulo.descripcion:o.getDescripcionArticulo(t.articulo),"")}}function Mt(t,e){1&t&&(y.Tb(0,"th",52),y.Dc(1,"Presentaci\xf3n"),y.Sb())}function It(t,e){if(1&t&&(y.Tb(0,"td",53),y.Dc(1),y.Sb()),2&t){const t=e.$implicit,o=y.fc(3);y.Cb(1),y.Fc(" ",o.saveToDB?t.presentacion.descripcion:o.getDescripcionPresentacion(t.presentacion)," ")}}function wt(t,e){1&t&&(y.Tb(0,"th",54),y.Dc(1,"Cantidad"),y.Sb())}function _t(t,e){if(1&t&&(y.Tb(0,"td",55),y.Dc(1),y.gc(2,"number"),y.Sb()),2&t){const t=e.$implicit;y.Cb(1),y.Ec(y.ic(2,1,t.cantidad,"1.2-2"))}}function kt(t,e){1&t&&(y.Tb(0,"th",54),y.Dc(1,"Costo Unitario Con IVA"),y.Sb())}function Ot(t,e){if(1&t&&(y.Tb(0,"td",55),y.Dc(1),y.gc(2,"number"),y.Sb()),2&t){const t=e.$implicit;y.Cb(1),y.Fc("",y.ic(2,1,t.precio_unitario,"1.2-2")," ")}}function Ft(t,e){1&t&&(y.Tb(0,"th",54),y.Dc(1,"Costo Total con IVA"),y.Sb())}function xt(t,e){if(1&t&&(y.Tb(0,"td",55),y.Dc(1),y.gc(2,"number"),y.Sb()),2&t){const t=e.$implicit;y.Cb(1),y.Ec(y.ic(2,1,t.precio_total,"1.2-2"))}}function yt(t,e){1&t&&(y.Tb(0,"th",52),y.Dc(1,"\xa0"),y.Sb())}function Et(t,e){if(1&t){const t=y.Ub();y.Tb(0,"button",38),y.bc("click",function(){y.wc(t);const e=y.fc().$implicit;return y.fc(3).getDetalleIngreso(e.ingreso,e.ingreso_detalle)}),y.Dc(1," Editar "),y.Sb()}if(2&t){const t=y.fc(4);y.lc("disabled",t.bloqueoBotones)}}function At(t,e){if(1&t){const t=y.Ub();y.Tb(0,"button",38),y.bc("click",function(){y.wc(t);const e=y.fc().$implicit;return y.fc(3).removeFromDetail(e.articulo)}),y.Dc(1," Editar "),y.Sb()}if(2&t){const t=y.fc(4);y.lc("disabled",y.nc(1,pt).indexOf(+t.ingreso.estatus_movimiento)>=0||t.bloqueoBotones)}}function Pt(t,e){if(1&t&&(y.Tb(0,"td",53),y.Cc(1,Et,2,1,"button",35),y.Cc(2,At,2,2,"button",35),y.Sb()),2&t){const t=y.fc(3);y.Cb(1),y.lc("ngIf",t.saveToDB),y.Cb(1),y.lc("ngIf",!t.saveToDB)}}function Bt(t,e){1&t&&y.Ob(0,"tr",56)}function $t(t,e){1&t&&y.Ob(0,"tr",57)}function Rt(t,e){if(1&t&&(y.Tb(0,"table",39),y.Rb(1,40),y.Cc(2,Tt,2,0,"th",41),y.Cc(3,Dt,2,1,"td",42),y.Qb(),y.Rb(4,43),y.Cc(5,Mt,2,0,"th",41),y.Cc(6,It,2,1,"td",42),y.Qb(),y.Rb(7,44),y.Cc(8,wt,2,0,"th",45),y.Cc(9,_t,3,4,"td",46),y.Qb(),y.Rb(10,47),y.Cc(11,kt,2,0,"th",45),y.Cc(12,Ot,3,4,"td",46),y.Qb(),y.Rb(13,48),y.Cc(14,Ft,2,0,"th",45),y.Cc(15,xt,3,4,"td",46),y.Qb(),y.Rb(16,49),y.Cc(17,yt,2,0,"th",41),y.Cc(18,Pt,3,2,"td",42),y.Qb(),y.Cc(19,Bt,1,0,"tr",50),y.Cc(20,$t,1,0,"tr",51),y.Sb()),2&t){const t=y.fc(2);y.lc("dataSource",t.dataSource),y.Cb(19),y.lc("matHeaderRowDef",t.displayedColumns),y.Cb(1),y.lc("matRowDefColumns",t.displayedColumns)}}function Ut(t,e){if(1&t){const t=y.Ub();y.Tb(0,"mat-card",0),y.Tb(1,"mat-card-title"),y.Tb(2,"h4"),y.Dc(3),y.Cc(4,lt,3,0,"button",1),y.Cc(5,bt,3,0,"button",1),y.Sb(),y.Sb(),y.Tb(6,"mat-card-content"),y.Cc(7,St,20,13,"form",2),y.Cc(8,vt,1,0,"hr",3),y.Tb(9,"mat-form-field",10),y.Tb(10,"input",28),y.bc("keyup",function(e){return y.wc(t),y.fc().applyFilter(e.target.value)}),y.Sb(),y.Sb(),y.Cc(11,Rt,21,3,"table",29),y.Sb(),y.Sb()}if(2&t){const t=y.fc();y.Cb(3),y.Gc(" Detalle del ingreso ",t.saveToDB?"No.":""," ",t.ingreso.ingreso," "),y.Cb(1),y.lc("ngIf",!t.showDetalleIngresoForm),y.Cb(1),y.lc("ngIf",t.showDetalleIngresoForm),y.Cb(2),y.lc("ngIf",t.showDetalleIngresoForm),y.Cb(1),y.lc("ngIf",t.detallesIngreso.length>0),y.Cb(3),y.lc("ngIf",t.detallesIngreso.length>0)}}let Nt=(()=>{class t{constructor(t,e,o,i,n,c,r,a){this.snackBar=t,this.ls=e,this.ingresoSrvc=o,this.proveedorSrvc=i,this.tipoMovimientoSrvc=n,this.bodegaSrvc=c,this.articuloSrvc=r,this.presentacinSrvc=a,this.saveToDB=!0,this.ingresoSavedEv=new y.o,this.showIngresoForm=!0,this.showDetalleIngresoForm=!0,this.detallesIngreso=[],this.displayedColumns=["articulo","presentacion","cantidad","costo_unitario","costo_total","deleteItem"],this.tiposMovimiento=[],this.proveedores=[],this.filteredProveedores=[],this.bodegas=[],this.articulos=[],this.filteredArticulos=[],this.presentaciones=[],this.fltrPresentaciones=[],this.esMovil=!1,this.bloqueoBotones=!1,this.txtArticuloSelected=void 0,this.txtProveedorSelected=void 0,this.loadTiposMovimiento=()=>{this.tipoMovimientoSrvc.get({ingreso:1}).subscribe(t=>{t&&(this.tiposMovimiento=t)})},this.loadProveedores=()=>{this.proveedorSrvc.get().subscribe(t=>{t&&(this.proveedores=t)})},this.loadBodegas=()=>{this.bodegaSrvc.get({sede:+this.ls.get(F.a.usrTokenVar).sede||0}).subscribe(t=>{t&&(this.bodegas=t)})},this.loadPresentaciones=()=>{this.presentacinSrvc.get().subscribe(t=>{t&&(this.presentaciones=t)})},this.resetIngreso=()=>{this.ingreso={ingreso:null,tipo_movimiento:null,fecha:x().format(F.a.dbDateFormat),bodega:null,usuario:this.ls.get(F.a.usrTokenVar).idusr||0,comentario:null,proveedor:null,estatus_movimiento:1},this.resetDetalleIngreso(),this.detallesIngreso=[],this.updateTableDataSource(),this.txtProveedorSelected=void 0},this.onSubmit=()=>{this.bloqueoBotones=!0,this.ingresoSrvc.save(this.ingreso).subscribe(t=>{this.resetIngreso(),t.exito&&(this.ingreso=t.ingreso,this.setProveedor(+this.ingreso.proveedor)),this.ingresoSavedEv.emit(),this.bloqueoBotones=!1})},this.loadArticulos=()=>{this.articuloSrvc.getArticulosIngreso().subscribe(t=>{t&&(this.articulos=t)})},this.resetDetalleIngreso=()=>{this.detalleIngreso={ingreso_detalle:null,ingreso:this.ingreso.ingreso?this.ingreso.ingreso:null,articulo:null,cantidad:null,precio_unitario:null,precio_total:null,presentacion:0},this.txtArticuloSelected=void 0},this.loadDetalleIngreso=(t=+this.ingreso.ingreso)=>{this.ingresoSrvc.getDetalle(t,{ingreso:t}).subscribe(t=>{t&&(this.detallesIngreso=t,this.updateTableDataSource())})},this.getDetalleIngreso=(t=+this.ingreso.ingreso,e)=>{this.ingresoSrvc.getDetalle(t,{ingreso_detalle:e}).subscribe(t=>{t&&(this.detalleIngreso={ingreso_detalle:t[0].ingreso_detalle,ingreso:t[0].ingreso,articulo:t[0].articulo.articulo,cantidad:+t[0].cantidad,precio_unitario:+t[0].precio_unitario,precio_total:+t[0].precio_total,presentacion:t[0].presentacion.presentacion},this.setPresentaciones(),this.txtArticuloSelected=t[0].articulo,this.showDetalleIngresoForm=!0)})},this.onSubmitDetail=()=>{this.bloqueoBotones=!0,this.detalleIngreso.ingreso=this.ingreso.ingreso,this.detalleIngreso.precio_total=+this.detalleIngreso.cantidad*+this.detalleIngreso.precio_unitario,this.ingresoSrvc.saveDetalle(this.detalleIngreso).subscribe(t=>{t&&(this.loadDetalleIngreso(),this.resetDetalleIngreso()),this.bloqueoBotones=!1})},this.addToDetail=()=>{this.detallesIngreso.push(this.detalleIngreso),this.resetDetalleIngreso(),this.updateTableDataSource()},this.removeFromDetail=t=>this.detallesIngreso.splice(this.detallesIngreso.findIndex(e=>+e.articulo==+t),1),this.getDescripcionArticulo=t=>this.articulos.find(e=>+e.articulo==+t).descripcion||"",this.getDescripcionPresentacion=t=>this.presentaciones.find(e=>+e.presentacion==+t).descripcion||"",this.updateTableDataSource=()=>{this.dataSource=new f.k(this.detallesIngreso),this.dataSource.filterPredicate=(t,e)=>t.articulo.descripcion.toLowerCase().includes(e)},this.eliminarArticulo=t=>{this.detallesIngreso.splice(this.detallesIngreso.findIndex(e=>e.ingreso_detalle===t.ingreso_detalle),1),this.updateTableDataSource()},this.filtrarArticulos=t=>{if(t&&"string"==typeof t){const e=t.toLowerCase();this.filteredArticulos=this.articulos.filter(t=>t.descripcion.toLowerCase().includes(e))}else this.filteredArticulos=this.articulos},this.displayArticulo=t=>{if(t)return this.detalleIngreso.articulo=t.articulo,t.descripcion},this.filtrarProveedores=t=>{if(t&&"string"==typeof t){const e=t.toLowerCase();this.filteredProveedores=this.proveedores.filter(t=>t.razon_social.toLowerCase().includes(e)||t.nit.toLowerCase().includes(e))}else this.filteredProveedores=this.proveedores},this.displayProveedor=t=>{if(t)return this.ingreso.proveedor=t.proveedor,`(${t.nit}) ${t.razon_social}`},this.setPresentaciones=()=>{this.fltrPresentaciones=[];const t=this.articulos.findIndex(t=>+t.articulo==+this.detalleIngreso.articulo),e=this.articulos[t];this.fltrPresentaciones=this.presentaciones.filter(t=>+t.medida.medida==+e.presentacion.medida)},this.setProveedor=t=>this.txtProveedorSelected=this.proveedores.find(e=>+e.proveedor===t),this.applyFilter=t=>{this.dataSource.filter=t.toLocaleLowerCase()}}ngOnInit(){this.esMovil=this.ls.get(F.a.usrTokenVar).enmovil||!1,this.resetIngreso(),this.loadTiposMovimiento(),this.loadProveedores(),this.loadBodegas(),this.loadArticulos(),this.loadPresentaciones()}}return t.\u0275fac=function(e){return new(e||t)(y.Nb(C.a),y.Nb(E.a),y.Nb(R),y.Nb(z.a),y.Nb(G.a),y.Nb(q.a),y.Nb(W.a),y.Nb(L.a))},t.\u0275cmp=y.Hb({type:t,selectors:[["app-form-ingreso"]],inputs:{ingreso:"ingreso",saveToDB:"saveToDB"},outputs:{ingresoSavedEv:"ingresoSavedEv"},decls:10,vars:6,consts:[[1,"mat-elevation-z4","fullWidth"],["mat-icon-button","","type","button","color","accent",3,"click",4,"ngIf"],["novalidate","",3,"ngSubmit",4,"ngIf"],[4,"ngIf"],["class","mat-elevation-z4 fullWidth",4,"ngIf"],["mat-icon-button","","type","button","color","accent",3,"click"],[1,"iconFontSize"],["novalidate","",3,"ngSubmit"],["frmIngreso","ngForm"],["class","fullWidth",4,"ngIf"],[1,"fullWidth"],["matInput","","type","date","placeholder","Fecha","name","fecha","required","",3,"ngModel","ngModelChange"],["name","bodega","required","",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["align","end"],["mat-raised-button","","type","submit","color","accent","class","btnAccion",3,"disabled",4,"ngIf"],["mat-raised-button","","type","button","color","accent",3,"click",4,"ngIf"],["name","tipo_movimiento","required","",3,"ngModel","ngModelChange"],[3,"value"],["name","bodega_origen",3,"ngModel","ngModelChange"],["type","button","mat-button","","matSuffix","","mat-icon-button","","aria-label","Clear",3,"click",4,"ngIf"],["type","button","mat-button","","matSuffix","","mat-icon-button","","aria-label","Clear",3,"click"],["type","text","placeholder","Proveedor","matInput","","required","",3,"ngModel","ngModelOptions","matAutocomplete","ngModelChange","keyup"],[3,"displayWith"],["autoProveedores","matAutocomplete"],["matInput","","placeholder","Comentarios","name","comentario",3,"ngModel","ngModelChange"],["mat-raised-button","","type","submit","color","accent",1,"btnAccion",3,"disabled"],["mat-raised-button","","type","button","color","accent",3,"click"],["matInput","","placeholder","Buscar",3,"keyup"],["mat-table","","class","mat-elevation-z4 full-width",3,"dataSource",4,"ngIf"],["frmDetalleIngreso","ngForm"],["type","text","placeholder","Art\xedculo","matInput","","required","",3,"ngModel","ngModelOptions","matAutocomplete","ngModelChange","keyup"],[3,"displayWith","optionSelected"],["autoArticulos","matAutocomplete"],["name","presentacion","required","",3,"ngModel","ngModelChange"],["mat-raised-button","","type","button","color","accent",3,"disabled","click",4,"ngIf"],["matInput","","placeholder","Cantidad","name","cantidad","required","",3,"ngModel","ngModelChange","change"],["matInput","","placeholder","Costo unitario Con IVA","name","precio_unitario","required","",3,"ngModel","ngModelChange","change"],["mat-raised-button","","type","button","color","accent",3,"disabled","click"],["mat-table","",1,"mat-elevation-z4","full-width",3,"dataSource"],["matColumnDef","articulo"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","","class","text-wrap",4,"matCellDef"],["matColumnDef","presentacion"],["matColumnDef","cantidad"],["mat-header-cell","","class","text-right",4,"matHeaderCellDef"],["mat-cell","","class","text-right",4,"matCellDef"],["matColumnDef","costo_unitario"],["matColumnDef","costo_total"],["matColumnDef","deleteItem"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell","",1,"text-wrap"],["mat-header-cell","",1,"text-right"],["mat-cell","",1,"text-right"],["mat-header-row",""],["mat-row",""]],template:function(t,e){1&t&&(y.Tb(0,"mat-card",0),y.Tb(1,"mat-card-title"),y.Tb(2,"h4"),y.Dc(3),y.Cc(4,V,3,0,"button",1),y.Cc(5,Q,3,0,"button",1),y.Sb(),y.Sb(),y.Tb(6,"mat-card-content"),y.Cc(7,at,16,9,"form",2),y.Sb(),y.Sb(),y.Cc(8,st,1,0,"hr",3),y.Cc(9,Ut,12,7,"mat-card",4)),2&t&&(y.Cb(3),y.Fc(" Ingreso",e.ingreso.ingreso?" No. "+e.ingreso.ingreso:""," "),y.Cb(1),y.lc("ngIf",!e.showIngresoForm),y.Cb(1),y.lc("ngIf",e.showIngresoForm),y.Cb(2),y.lc("ngIf",e.showIngresoForm),y.Cb(1),y.lc("ngIf",e.ingreso.ingreso||!e.saveToDB),y.Cb(1),y.lc("ngIf",e.ingreso.ingreso||!e.saveToDB))},directives:[d.a,d.h,i.m,d.c,h.a,s.a,c.r,c.l,c.m,l.b,b.b,c.c,c.p,c.k,c.n,l.e,m.a,i.l,U.k,l.f,_.c,_.a,f.j,f.c,f.e,f.b,f.g,f.i,f.d,f.a,f.f,f.h],pipes:[i.f],styles:[".full-width[_ngcontent-%COMP%]{width:100%}.iconFontSize[_ngcontent-%COMP%]{font-size:24pt}"]}),t})();const Ht=["lstIngreso"],jt=["frmIngreso"];let zt=(()=>{class t{constructor(t){this.ls=t,this.breakpoint=2,this.onWindowResize=t=>{this.breakpoint=t.target.innerWidth<=360?1:2},this.setIngreso=t=>{this.ingreso=t,this.frmIngreso.setProveedor(+this.ingreso.proveedor),this.frmIngreso.loadDetalleIngreso(+this.ingreso.ingreso),this.frmIngreso.resetDetalleIngreso()},this.refreshIngresoList=()=>{this.lstIngresoComponent.loadIngresos()},this.ingreso={ingreso:null,tipo_movimiento:null,fecha:x().format(F.a.dbDateFormat),bodega:null,usuario:this.ls.get(F.a.usrTokenVar).idusr||0,comentario:null,proveedor:null}}ngOnInit(){this.breakpoint=window.innerWidth<=360?1:2}}return t.\u0275fac=function(e){return new(e||t)(y.Nb(E.a))},t.\u0275cmp=y.Hb({type:t,selectors:[["app-ingreso"]],viewQuery:function(t,e){if(1&t&&(y.Ic(Ht,1),y.Ic(jt,1)),2&t){let t;y.sc(t=y.cc())&&(e.lstIngresoComponent=t.first),y.sc(t=y.cc())&&(e.frmIngreso=t.first)}},decls:7,vars:1,consts:[[1,"row"],[1,"col","m5","s12"],[3,"getIngresoEv"],["lstIngreso",""],[1,"col","m7","s12"],[3,"ingreso","ingresoSavedEv"],["frmIngreso",""]],template:function(t,e){1&t&&(y.Tb(0,"div",0),y.Tb(1,"div",1),y.Tb(2,"app-lista-ingreso",2,3),y.bc("getIngresoEv",function(t){return e.setIngreso(t)}),y.Sb(),y.Sb(),y.Tb(4,"div",4),y.Tb(5,"app-form-ingreso",5,6),y.bc("ingresoSavedEv",function(){return e.refreshIngresoList()}),y.Sb(),y.Sb(),y.Sb()),2&t&&(y.Cb(5),y.lc("ingreso",e.ingreso))},directives:[j,Nt],styles:[""]}),t})(),Gt=(()=>{class t{constructor(t){this.http=t,this.egresoUrl="egreso",this.srvcErrHndl=new A.a}get(t={}){return this.http.get(`${F.a.urlWms}/${this.egresoUrl}/buscar_egreso?${$.stringify(t)}`).pipe(Object(P.a)(F.a.reintentos),Object(B.a)(this.srvcErrHndl.errorHandler))}save(t){return this.http.post(`${F.a.urlWms}/${this.egresoUrl}/guardar${+t.egreso>0?"/"+t.egreso:""}`,t).pipe(Object(P.a)(F.a.reintentos),Object(B.a)(this.srvcErrHndl.errorHandler))}getDetalle(t,e={}){return this.http.get(`${F.a.urlWms}/${this.egresoUrl}/buscar_detalle/${t}?${$.stringify(e)}`).pipe(Object(P.a)(F.a.reintentos),Object(B.a)(this.srvcErrHndl.errorHandler))}saveDetalle(t){return this.http.post(`${F.a.urlWms}/${this.egresoUrl}/guardar_detalle/${t.egreso}${+t.egreso_detalle>0?"/"+t.egreso_detalle:""}`,t).pipe(Object(P.a)(F.a.reintentos),Object(B.a)(this.srvcErrHndl.errorHandler))}}return t.\u0275fac=function(e){return new(e||t)(y.Xb(n.b))},t.\u0275prov=y.Jb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function qt(t,e){if(1&t){const t=y.Ub();y.Tb(0,"mat-list-item",5),y.bc("click",function(){y.wc(t);const o=e.$implicit;return y.fc().getEgreso(o)}),y.Tb(1,"mat-icon",6),y.Dc(2,"trending_down"),y.Sb(),y.Tb(3,"h5",7),y.Dc(4),y.Sb(),y.Ob(5,"br"),y.Tb(6,"p",7),y.Dc(7),y.gc(8,"date"),y.Ob(9,"br"),y.Dc(10),y.Ob(11,"br"),y.Sb(),y.Sb()}if(2&t){const t=e.$implicit;y.Cb(4),y.Fc("No. ",t.egreso,""),y.Cb(3),y.Fc(" Fecha: ",y.ic(8,3,t.fecha,"dd/MM/yyyy"),""),y.Cb(3),y.Fc(" Bodega: ",t.bodega.descripcion,"")}}const Wt=function(){return{standalone:!0}};let Lt=(()=>{class t{constructor(t){this.egresoSrvc=t,this.getEgresoEv=new y.o,this.length=0,this.pageSize=5,this.pageSizeOptions=[5,10,15],this.pageIndex=0,this.txtFiltro="",this.loadEgresos=()=>{this.egresoSrvc.get().subscribe(t=>{t&&t.length>0&&(this.lstEgresos=t,this.applyFilter())})},this.getEgreso=t=>{this.getEgresoEv.emit({egreso:t.egreso,tipo_movimiento:t.tipo_movimiento.tipo_movimiento,bodega:t.bodega.bodega,fecha:t.fecha,usuario:t.usuario.usuario,estatus_movimiento:t.estatus_movimiento||1,traslado:t.traslado||0})},this.pageChange=t=>{this.pageSize=t.pageSize,this.pageIndex=t.pageIndex,this.applyFilter()}}ngOnInit(){this.loadEgresos()}applyFilter(){if(this.txtFiltro.length>0){const t=Object(F.b)(this.lstEgresos,this.txtFiltro);this.length=t.length,this.lstEgresosPaged=Object(F.c)(t,this.pageSize,this.pageIndex+1)}else this.length=this.lstEgresos.length,this.lstEgresosPaged=Object(F.c)(this.lstEgresos,this.pageSize,this.pageIndex+1)}}return t.\u0275fac=function(e){return new(e||t)(y.Nb(Gt))},t.\u0275cmp=y.Hb({type:t,selectors:[["app-lista-egreso"]],outputs:{getEgresoEv:"getEgresoEv"},decls:7,vars:7,consts:[[1,"mat-elevation-z4","fullWidth"],[1,"fullWidth"],["matInput","","placeholder","Buscar...",3,"ngModel","ngModelOptions","keyup","ngModelChange"],[3,"click",4,"ngFor","ngForOf"],["showFirstLastButtons","",3,"length","pageSize","pageSizeOptions","page"],[3,"click"],["mat-list-icon",""],["mat-line",""]],template:function(t,e){1&t&&(y.Tb(0,"mat-card",0),y.Tb(1,"mat-card-content"),y.Tb(2,"mat-form-field",1),y.Tb(3,"input",2),y.bc("keyup",function(){return e.applyFilter()})("ngModelChange",function(t){return e.txtFiltro=t}),y.Sb(),y.Sb(),y.Tb(4,"mat-nav-list"),y.Cc(5,qt,12,6,"mat-list-item",3),y.Sb(),y.Tb(6,"mat-paginator",4),y.bc("page",function(t){return e.pageChange(t)}),y.Sb(),y.Sb(),y.Sb()),2&t&&(y.Cb(3),y.lc("ngModel",e.txtFiltro)("ngModelOptions",y.nc(6,Wt)),y.Cb(2),y.lc("ngForOf",e.lstEgresosPaged),y.Cb(1),y.lc("length",e.length)("pageSize",e.pageSize)("pageSizeOptions",e.pageSizeOptions))},directives:[d.a,d.c,l.b,b.b,c.c,c.k,c.n,a.e,i.l,D.a,a.c,s.a,a.b,U.h],pipes:[i.e],styles:[".fullWidth[_ngcontent-%COMP%], table[_ngcontent-%COMP%]{width:100%!important}"]}),t})(),Vt=(()=>{class t{constructor(t){this.http=t,this.conversorUrl="conversor",this.srvcErrHndl=new A.a}transformar(t){return this.http.post(`${F.a.urlWms}/${this.conversorUrl}/transformar`,t).pipe(Object(P.a)(F.a.reintentos),Object(B.a)(this.srvcErrHndl.errorHandler))}producir(t){return this.http.post(`${F.a.urlWms}/${this.conversorUrl}/producir`,t).pipe(Object(P.a)(F.a.reintentos),Object(B.a)(this.srvcErrHndl.errorHandler))}}return t.\u0275fac=function(e){return new(e||t)(y.Xb(n.b))},t.\u0275prov=y.Jb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function Qt(t,e){if(1&t){const t=y.Ub();y.Tb(0,"button",5),y.bc("click",function(){return y.wc(t),y.fc().showEgresoForm=!0}),y.Tb(1,"mat-icon",6),y.Dc(2,"expand_more"),y.Sb(),y.Sb()}}function Xt(t,e){if(1&t){const t=y.Ub();y.Tb(0,"button",5),y.bc("click",function(){return y.wc(t),y.fc().showEgresoForm=!1}),y.Tb(1,"mat-icon",6),y.Dc(2,"expand_less"),y.Sb(),y.Sb()}}function Kt(t,e){if(1&t&&(y.Tb(0,"mat-option",20),y.Dc(1),y.Sb()),2&t){const t=e.$implicit;y.lc("value",t.tipo_movimiento),y.Cb(1),y.Fc(" ",t.descripcion," ")}}function Jt(t,e){if(1&t){const t=y.Ub();y.Tb(0,"mat-form-field",10),y.Tb(1,"mat-label"),y.Dc(2,"Tipo de movimiento"),y.Sb(),y.Tb(3,"mat-select",19),y.bc("ngModelChange",function(e){return y.wc(t),y.fc(2).egreso.tipo_movimiento=e}),y.Cc(4,Kt,2,2,"mat-option",13),y.Sb(),y.Sb()}if(2&t){const t=y.fc(2);y.Cb(3),y.lc("ngModel",t.egreso.tipo_movimiento),y.Cb(1),y.lc("ngForOf",t.tiposMovimiento)}}function Zt(t,e){if(1&t&&(y.Tb(0,"mat-option",20),y.Dc(1),y.Sb()),2&t){const t=e.$implicit;y.lc("value",t.bodega),y.Cb(1),y.Fc(" ",t.descripcion," ")}}function Yt(t,e){if(1&t){const t=y.Ub();y.Tb(0,"mat-checkbox",21),y.bc("ngModelChange",function(e){return y.wc(t),+(y.fc(2).egreso.traslado=e)}),y.Dc(1,"\xbfEs traslado entre bodegas de la misma sede? "),y.Sb()}if(2&t){const t=y.fc(2);y.lc("ngModel",+t.egreso.traslado)}}function te(t,e){if(1&t&&(y.Tb(0,"mat-option",20),y.Dc(1),y.Sb()),2&t){const t=e.$implicit;y.lc("value",t.bodega),y.Cb(1),y.Fc(" ",t.descripcion," ")}}function ee(t,e){if(1&t){const t=y.Ub();y.Tb(0,"mat-form-field",10),y.Tb(1,"mat-label"),y.Dc(2,"Bodega destino"),y.Sb(),y.Tb(3,"mat-select",22),y.bc("ngModelChange",function(e){return y.wc(t),y.fc(2).egreso.bodega_destino=e}),y.Cc(4,te,2,2,"mat-option",13),y.Sb(),y.Sb()}if(2&t){const t=y.fc(2);y.Cb(3),y.lc("ngModel",t.egreso.bodega_destino)("required",1==+t.egreso.traslado),y.Cb(1),y.lc("ngForOf",t.bodegas)}}function oe(t,e){if(1&t&&(y.Tb(0,"mat-option",20),y.Dc(1),y.Sb()),2&t){const t=e.$implicit;y.lc("value",t.tipo_movimiento),y.Cb(1),y.Fc(" ",t.descripcion," ")}}function ie(t,e){if(1&t){const t=y.Ub();y.Tb(0,"mat-form-field",10),y.Tb(1,"mat-label"),y.Dc(2,"Tipo de movimiento destino"),y.Sb(),y.Tb(3,"mat-select",23),y.bc("ngModelChange",function(e){return y.wc(t),y.fc(2).egreso.tipo_movimiento_destino=e}),y.Cc(4,oe,2,2,"mat-option",13),y.Sb(),y.Sb()}if(2&t){const t=y.fc(2);y.Cb(3),y.lc("ngModel",t.egreso.tipo_movimiento_destino)("required",1==+t.egreso.traslado),y.Cb(1),y.lc("ngForOf",t.tiposMovimientoIngreso)}}function ne(t,e){if(1&t&&(y.Tb(0,"mat-option",20),y.Dc(1),y.Sb()),2&t){const t=e.$implicit;y.lc("value",t),y.Cb(1),y.Gc(" (",t.nit,") ",t.razon_social," ")}}const ce=function(){return{standalone:!0}};function re(t,e){if(1&t){const t=y.Ub();y.Tb(0,"mat-form-field",10),y.Tb(1,"mat-label"),y.Dc(2,"Proveedor"),y.Sb(),y.Tb(3,"input",24),y.bc("ngModelChange",function(e){return y.wc(t),y.fc(2).txtProveedorSelected=e})("keyup",function(){y.wc(t);const e=y.fc(2);return e.filtrarProveedores(e.txtProveedorSelected)}),y.Sb(),y.Tb(4,"mat-autocomplete",25,26),y.Cc(6,ne,2,3,"mat-option",13),y.Sb(),y.Sb()}if(2&t){const t=y.tc(5),e=y.fc(2);y.Cb(3),y.lc("ngModel",e.txtProveedorSelected)("ngModelOptions",y.nc(5,ce))("matAutocomplete",t),y.Cb(1),y.lc("displayWith",e.displayProveedor),y.Cb(2),y.lc("ngForOf",e.filteredProveedores)}}const ae=function(){return[2,3]};function se(t,e){if(1&t&&(y.Tb(0,"button",27),y.Dc(1," Guardar "),y.Sb()),2&t){y.fc();const t=y.tc(1),e=y.fc();y.lc("disabled",!t.form.valid||y.nc(1,ae).indexOf(+e.egreso.estatus_movimiento)>=0||e.bloqueoBotones)}}function le(t,e){if(1&t){const t=y.Ub();y.Tb(0,"button",28),y.bc("click",function(){return y.wc(t),y.fc(2).confirmarEgreso()}),y.Dc(1," Confirmar "),y.Sb()}if(2&t){y.fc();const t=y.tc(1),e=y.fc();y.lc("disabled",!t.form.valid||y.nc(1,ae).indexOf(+e.egreso.estatus_movimiento)>=0)}}function be(t,e){if(1&t){const t=y.Ub();y.Tb(0,"button",29),y.bc("click",function(){return y.wc(t),y.fc(2).resetEgreso()}),y.Dc(1," Nuevo "),y.Sb()}}function de(t,e){if(1&t){const t=y.Ub();y.Tb(0,"form",7,8),y.bc("ngSubmit",function(){y.wc(t);const e=y.tc(1),o=y.fc();return e.form.valid&&o.onSubmit()}),y.Cc(2,Jt,5,2,"mat-form-field",9),y.Tb(3,"mat-form-field",10),y.Tb(4,"input",11),y.bc("ngModelChange",function(e){return y.wc(t),y.fc().egreso.fecha=e}),y.Sb(),y.Sb(),y.Tb(5,"mat-form-field",10),y.Tb(6,"mat-label"),y.Dc(7,"Bodega"),y.Sb(),y.Tb(8,"mat-select",12),y.bc("ngModelChange",function(e){return y.wc(t),y.fc().egreso.bodega=e}),y.Cc(9,Zt,2,2,"mat-option",13),y.Sb(),y.Sb(),y.Cc(10,Yt,2,1,"mat-checkbox",14),y.Cc(11,ee,5,3,"mat-form-field",9),y.Cc(12,ie,5,3,"mat-form-field",9),y.Cc(13,re,7,6,"mat-form-field",9),y.Tb(14,"div",15),y.Cc(15,se,2,2,"button",16),y.Cc(16,le,2,2,"button",17),y.Cc(17,be,2,0,"button",18),y.Sb(),y.Sb()}if(2&t){const t=y.fc();y.Cb(2),y.lc("ngIf",t.saveToDB),y.Cb(2),y.lc("ngModel",t.egreso.fecha),y.Cb(4),y.lc("ngModel",t.egreso.bodega),y.Cb(1),y.lc("ngForOf",t.bodegas),y.Cb(1),y.lc("ngIf",t.saveToDB),y.Cb(1),y.lc("ngIf",1==+t.egreso.traslado&&y.nc(11,ae).indexOf(+t.egreso.estatus_movimiento)<0),y.Cb(1),y.lc("ngIf",1==+t.egreso.traslado&&y.nc(12,ae).indexOf(+t.egreso.estatus_movimiento)<0),y.Cb(1),y.lc("ngIf",1==+t.egreso.traslado&&y.nc(13,ae).indexOf(+t.egreso.estatus_movimiento)<0),y.Cb(2),y.lc("ngIf",t.saveToDB),y.Cb(1),y.lc("ngIf",t.egreso.egreso&&t.detallesEgreso.length>0),y.Cb(1),y.lc("ngIf",t.egreso.egreso)}}function ue(t,e){1&t&&y.Ob(0,"hr")}function ge(t,e){if(1&t){const t=y.Ub();y.Tb(0,"button",5),y.bc("click",function(){return y.wc(t),y.fc(2).showDetalleEgresoForm=!0}),y.Tb(1,"mat-icon",6),y.Dc(2,"expand_more"),y.Sb(),y.Sb()}}function fe(t,e){if(1&t){const t=y.Ub();y.Tb(0,"button",5),y.bc("click",function(){return y.wc(t),y.fc(2).showDetalleEgresoForm=!1}),y.Tb(1,"mat-icon",6),y.Dc(2,"expand_less"),y.Sb(),y.Sb()}}function me(t,e){if(1&t&&(y.Tb(0,"mat-option",20),y.Dc(1),y.Sb()),2&t){const t=e.$implicit;y.lc("value",t),y.Cb(1),y.Fc(" ",t.descripcion," ")}}function pe(t,e){if(1&t&&(y.Tb(0,"mat-option",20),y.Dc(1),y.Sb()),2&t){const t=e.$implicit;y.lc("value",t.presentacion),y.Cb(1),y.Fc(" ",t.descripcion," ")}}function he(t,e){if(1&t){const t=y.Ub();y.Tb(0,"mat-form-field",10),y.Tb(1,"input",38),y.bc("ngModelChange",function(e){return y.wc(t),y.fc(3).detalleEgreso.cantidad=e})("change",function(){y.wc(t);const e=y.fc(3);return e.detalleEgreso.precio_total=+e.detalleEgreso.precio_unitario*+e.detalleEgreso.cantidad}),y.Sb(),y.Sb()}if(2&t){const t=y.fc(3);y.Cb(1),y.lc("ngModel",t.detalleEgreso.cantidad)}}function Ce(t,e){if(1&t&&(y.Tb(0,"button",27),y.Dc(1," Guardar "),y.Sb()),2&t){y.fc();const t=y.tc(1),e=y.fc(2);y.lc("disabled",!t.form.valid||y.nc(1,ae).indexOf(+e.egreso.estatus_movimiento)>=0||e.bloqueoBotones)}}function Se(t,e){if(1&t){const t=y.Ub();y.Tb(0,"button",39),y.bc("click",function(){return y.wc(t),y.fc(3).addToDetail()}),y.Dc(1," Nuevo "),y.Sb()}if(2&t){y.fc();const t=y.tc(1),e=y.fc(2);y.lc("disabled",!t.form.valid||y.nc(1,ae).indexOf(+e.egreso.estatus_movimiento)>=0)}}function ve(t,e){if(1&t){const t=y.Ub();y.Tb(0,"button",29),y.bc("click",function(){return y.wc(t),y.fc(3).resetDetalleEgreso()}),y.Dc(1," Nuevo "),y.Sb()}}function Te(t,e){if(1&t){const t=y.Ub();y.Tb(0,"form",7,32),y.bc("ngSubmit",function(){y.wc(t);const e=y.tc(1),o=y.fc(2);return e.form.valid&&o.onSubmitDetail()}),y.Tb(2,"mat-form-field",10),y.Tb(3,"mat-label"),y.Dc(4,"Art\xedculo"),y.Sb(),y.Tb(5,"input",33),y.bc("ngModelChange",function(e){return y.wc(t),y.fc(2).txtArticuloSelected=e})("keyup",function(){y.wc(t);const e=y.fc(2);return e.filtrarArticulos(e.txtArticuloSelected)}),y.Sb(),y.Tb(6,"mat-autocomplete",34,35),y.bc("optionSelected",function(){return y.wc(t),y.fc(2).setPresentaciones()}),y.Cc(8,me,2,2,"mat-option",13),y.Sb(),y.Sb(),y.Tb(9,"mat-form-field",10),y.Tb(10,"mat-label"),y.Dc(11,"Presentaci\xf3n"),y.Sb(),y.Tb(12,"mat-select",36),y.bc("ngModelChange",function(e){return y.wc(t),y.fc(2).detalleEgreso.presentacion=e}),y.Cc(13,pe,2,2,"mat-option",13),y.Sb(),y.Sb(),y.Cc(14,he,2,1,"mat-form-field",9),y.Tb(15,"div",15),y.Cc(16,Ce,2,2,"button",16),y.Cc(17,Se,2,2,"button",37),y.Cc(18,ve,2,0,"button",18),y.Sb(),y.Sb()}if(2&t){const t=y.tc(7),e=y.fc(2);y.Cb(5),y.lc("ngModel",e.txtArticuloSelected)("ngModelOptions",y.nc(11,ce))("matAutocomplete",t),y.Cb(1),y.lc("displayWith",e.displayArticulo),y.Cb(2),y.lc("ngForOf",e.filteredArticulos),y.Cb(4),y.lc("ngModel",e.detalleEgreso.presentacion),y.Cb(1),y.lc("ngForOf",e.fltrPresentaciones),y.Cb(1),y.lc("ngIf",e.esMovil),y.Cb(2),y.lc("ngIf",e.saveToDB),y.Cb(1),y.lc("ngIf",!e.saveToDB),y.Cb(1),y.lc("ngIf",e.detalleEgreso.egreso_detalle)}}function De(t,e){1&t&&y.Ob(0,"hr")}function Me(t,e){1&t&&(y.Tb(0,"th",53),y.Dc(1,"Art\xedculo"),y.Sb())}function Ie(t,e){if(1&t&&(y.Tb(0,"td",54),y.Dc(1),y.Sb()),2&t){const t=e.$implicit,o=y.fc(3);y.Cb(1),y.Fc(" ",o.saveToDB?t.articulo.descripcion:o.getDescripcionArticulo(t.articulo),"")}}function we(t,e){1&t&&(y.Tb(0,"th",53),y.Dc(1,"Presentaci\xf3n"),y.Sb())}function _e(t,e){if(1&t&&(y.Tb(0,"td",54),y.Dc(1),y.Sb()),2&t){const t=e.$implicit,o=y.fc(3);y.Cb(1),y.Fc(" ",o.saveToDB?t.presentacion.descripcion:o.getDescripcionPresentacion(t.presentacion)," ")}}function ke(t,e){1&t&&(y.Tb(0,"th",55),y.Dc(1,"Cantidad"),y.Sb())}function Oe(t,e){if(1&t&&(y.Tb(0,"td",56),y.Dc(1),y.gc(2,"number"),y.Sb()),2&t){const t=e.$implicit;y.Cb(1),y.Ec(y.ic(2,1,t.cantidad,"1.2-2"))}}function Fe(t,e){1&t&&(y.Tb(0,"th",55),y.Dc(1,"Costo Unitario"),y.Sb())}function xe(t,e){if(1&t&&(y.Tb(0,"td",56),y.Dc(1),y.gc(2,"number"),y.Sb()),2&t){const t=e.$implicit;y.Cb(1),y.Fc("",y.ic(2,1,t.precio_unitario,"1.2-2")," ")}}function ye(t,e){1&t&&(y.Tb(0,"th",55),y.Dc(1,"Costo Total"),y.Sb())}function Ee(t,e){if(1&t&&(y.Tb(0,"td",56),y.Dc(1),y.gc(2,"number"),y.Sb()),2&t){const t=e.$implicit;y.Cb(1),y.Ec(y.ic(2,1,t.precio_total,"1.2-2"))}}function Ae(t,e){1&t&&(y.Tb(0,"th",53),y.Dc(1,"\xa0"),y.Sb())}function Pe(t,e){if(1&t){const t=y.Ub();y.Tb(0,"button",28),y.bc("click",function(){y.wc(t);const e=y.fc().$implicit;return y.fc(3).getDetalleEgreso(e.egreso,e.egreso_detalle)}),y.Dc(1," Editar "),y.Sb()}if(2&t){const t=y.fc(4);y.lc("disabled",y.nc(1,ae).indexOf(+t.egreso.estatus_movimiento)>=0||t.bloqueoBotones)}}function Be(t,e){if(1&t){const t=y.Ub();y.Tb(0,"button",39),y.bc("click",function(){y.wc(t);const e=y.fc().$implicit;return y.fc(3).removeFromDetail(e.articulo)}),y.Dc(1," Eliminar "),y.Sb()}if(2&t){const t=y.fc(4);y.lc("disabled",y.nc(1,ae).indexOf(+t.egreso.estatus_movimiento)>=0||t.bloqueoBotones)}}function $e(t,e){if(1&t&&(y.Tb(0,"td",54),y.Cc(1,Pe,2,2,"button",17),y.Cc(2,Be,2,2,"button",37),y.Sb()),2&t){const t=y.fc(3);y.Cb(1),y.lc("ngIf",t.saveToDB),y.Cb(1),y.lc("ngIf",!t.saveToDB)}}function Re(t,e){1&t&&y.Ob(0,"tr",57)}function Ue(t,e){1&t&&y.Ob(0,"tr",58)}function Ne(t,e){if(1&t&&(y.Tb(0,"table",40),y.Rb(1,41),y.Cc(2,Me,2,0,"th",42),y.Cc(3,Ie,2,1,"td",43),y.Qb(),y.Rb(4,44),y.Cc(5,we,2,0,"th",42),y.Cc(6,_e,2,1,"td",43),y.Qb(),y.Rb(7,45),y.Cc(8,ke,2,0,"th",46),y.Cc(9,Oe,3,4,"td",47),y.Qb(),y.Rb(10,48),y.Cc(11,Fe,2,0,"th",46),y.Cc(12,xe,3,4,"td",47),y.Qb(),y.Rb(13,49),y.Cc(14,ye,2,0,"th",46),y.Cc(15,Ee,3,4,"td",47),y.Qb(),y.Rb(16,50),y.Cc(17,Ae,2,0,"th",42),y.Cc(18,$e,3,2,"td",43),y.Qb(),y.Cc(19,Re,1,0,"tr",51),y.Cc(20,Ue,1,0,"tr",52),y.Sb()),2&t){const t=y.fc(2);y.lc("dataSource",t.dataSource),y.Cb(19),y.lc("matHeaderRowDef",t.displayedColumns),y.Cb(1),y.lc("matRowDefColumns",t.displayedColumns)}}function He(t,e){if(1&t){const t=y.Ub();y.Tb(0,"mat-card",0),y.Tb(1,"mat-card-title"),y.Tb(2,"h4"),y.Dc(3),y.Cc(4,ge,3,0,"button",1),y.Cc(5,fe,3,0,"button",1),y.Sb(),y.Sb(),y.Tb(6,"mat-card-content"),y.Cc(7,Te,19,12,"form",2),y.Cc(8,De,1,0,"hr",3),y.Tb(9,"mat-form-field",10),y.Tb(10,"input",30),y.bc("keyup",function(e){return y.wc(t),y.fc().applyFilter(e.target.value)}),y.Sb(),y.Sb(),y.Cc(11,Ne,21,3,"table",31),y.Sb(),y.Sb()}if(2&t){const t=y.fc();y.Cb(3),y.Gc(" Detalle del egreso ",t.saveToDB?"No.":""," ",t.egreso.egreso," "),y.Cb(1),y.lc("ngIf",!t.showDetalleEgresoForm),y.Cb(1),y.lc("ngIf",t.showDetalleEgresoForm),y.Cb(2),y.lc("ngIf",t.showDetalleEgresoForm),y.Cb(1),y.lc("ngIf",t.detallesEgreso.length>0),y.Cb(3),y.lc("ngIf",t.detallesEgreso.length>0)}}function je(t,e){1&t&&y.Ob(0,"hr")}function ze(t,e){if(1&t){const t=y.Ub();y.Tb(0,"button",5),y.bc("click",function(){return y.wc(t),y.fc(2).showDetalleEgresoForm=!0}),y.Tb(1,"mat-icon",6),y.Dc(2,"expand_more"),y.Sb(),y.Sb()}}function Ge(t,e){if(1&t){const t=y.Ub();y.Tb(0,"button",5),y.bc("click",function(){return y.wc(t),y.fc(2).showDetalleEgresoForm=!1}),y.Tb(1,"mat-icon",6),y.Dc(2,"expand_less"),y.Sb(),y.Sb()}}function qe(t,e){if(1&t&&(y.Tb(0,"mat-option",20),y.Dc(1),y.Sb()),2&t){const t=e.$implicit;y.lc("value",t),y.Cb(1),y.Fc(" ",t.descripcion," ")}}function We(t,e){if(1&t&&(y.Tb(0,"mat-option",20),y.Dc(1),y.Sb()),2&t){const t=e.$implicit;y.lc("value",t.presentacion),y.Cb(1),y.Fc(" ",t.descripcion," ")}}function Le(t,e){if(1&t){const t=y.Ub();y.Tb(0,"mat-form-field",10),y.Tb(1,"input",38),y.bc("ngModelChange",function(e){return y.wc(t),y.fc(3).detalleMerma.cantidad=e})("change",function(){y.wc(t);const e=y.fc(3);return e.detalleMerma.precio_total=+e.detalleMerma.precio_unitario*+e.detalleMerma.cantidad}),y.Sb(),y.Sb()}if(2&t){const t=y.fc(3);y.Cb(1),y.lc("ngModel",t.detalleMerma.cantidad)}}function Ve(t,e){if(1&t){const t=y.Ub();y.Tb(0,"mat-form-field",10),y.Tb(1,"input",60),y.bc("ngModelChange",function(e){return y.wc(t),y.fc(3).detalleMerma.precio_unitario=e})("change",function(){y.wc(t);const e=y.fc(3);return e.detalleMerma.precio_total=+e.detalleMerma.precio_unitario*+e.detalleMerma.cantidad}),y.Sb(),y.Sb()}if(2&t){const t=y.fc(3);y.Cb(1),y.lc("ngModel",t.detalleMerma.precio_unitario)}}function Qe(t,e){if(1&t){const t=y.Ub();y.Tb(0,"button",39),y.bc("click",function(){return y.wc(t),y.fc(3).addToDetailMerma()}),y.Dc(1," Nuevo "),y.Sb()}if(2&t){y.fc();const t=y.tc(1),e=y.fc(2);y.lc("disabled",!t.form.valid||y.nc(1,ae).indexOf(+e.egreso.estatus_movimiento)>=0)}}function Xe(t,e){if(1&t){const t=y.Ub();y.Tb(0,"form",7,59),y.bc("ngSubmit",function(){y.wc(t);const e=y.tc(1),o=y.fc(2);return e.form.valid&&o.onSubmitDetail()}),y.Tb(2,"mat-form-field",10),y.Tb(3,"mat-label"),y.Dc(4,"Art\xedculo"),y.Sb(),y.Tb(5,"input",33),y.bc("ngModelChange",function(e){return y.wc(t),y.fc(2).txtArticuloSelected=e})("keyup",function(){y.wc(t);const e=y.fc(2);return e.filtrarArticulos(e.txtArticuloSelected)}),y.Sb(),y.Tb(6,"mat-autocomplete",34,35),y.bc("optionSelected",function(){return y.wc(t),y.fc(2).setPresentacionesMerma()}),y.Cc(8,qe,2,2,"mat-option",13),y.Sb(),y.Sb(),y.Tb(9,"mat-form-field",10),y.Tb(10,"mat-label"),y.Dc(11,"Presentaci\xf3n"),y.Sb(),y.Tb(12,"mat-select",36),y.bc("ngModelChange",function(e){return y.wc(t),y.fc(2).detalleMerma.presentacion=e}),y.Cc(13,We,2,2,"mat-option",13),y.Sb(),y.Sb(),y.Cc(14,Le,2,1,"mat-form-field",9),y.Cc(15,Ve,2,1,"mat-form-field",9),y.Tb(16,"div",15),y.Cc(17,Qe,2,2,"button",37),y.Sb(),y.Sb()}if(2&t){const t=y.tc(7),e=y.fc(2);y.Cb(5),y.lc("ngModel",e.txtArticuloSelected)("ngModelOptions",y.nc(10,ce))("matAutocomplete",t),y.Cb(1),y.lc("displayWith",e.displayArticuloMerma),y.Cb(2),y.lc("ngForOf",e.filteredArticulos),y.Cb(4),y.lc("ngModel",e.detalleMerma.presentacion),y.Cb(1),y.lc("ngForOf",e.fltrPresentacionesMerma),y.Cb(1),y.lc("ngIf",e.esMovil),y.Cb(1),y.lc("ngIf",e.esMovil),y.Cb(2),y.lc("ngIf",!e.saveToDB)}}function Ke(t,e){1&t&&y.Ob(0,"hr")}function Je(t,e){1&t&&(y.Tb(0,"th",53),y.Dc(1,"Art\xedculo"),y.Sb())}function Ze(t,e){if(1&t&&(y.Tb(0,"td",54),y.Dc(1),y.Sb()),2&t){const t=e.$implicit,o=y.fc(3);y.Cb(1),y.Fc(" ",o.saveToDB?t.articulo.descripcion:o.getDescripcionArticulo(t.articulo),"")}}function Ye(t,e){1&t&&(y.Tb(0,"th",53),y.Dc(1,"Presentaci\xf3n"),y.Sb())}function to(t,e){if(1&t&&(y.Tb(0,"td",54),y.Dc(1),y.Sb()),2&t){const t=e.$implicit,o=y.fc(3);y.Cb(1),y.Fc(" ",o.saveToDB?t.presentacion.descripcion:o.getDescripcionPresentacion(t.presentacion)," ")}}function eo(t,e){1&t&&(y.Tb(0,"th",55),y.Dc(1,"Cantidad"),y.Sb())}function oo(t,e){if(1&t&&(y.Tb(0,"td",56),y.Dc(1),y.gc(2,"number"),y.Sb()),2&t){const t=e.$implicit;y.Cb(1),y.Ec(y.ic(2,1,t.cantidad,"1.2-2"))}}function io(t,e){1&t&&(y.Tb(0,"th",55),y.Dc(1,"Costo Unitario"),y.Sb())}function no(t,e){if(1&t&&(y.Tb(0,"td",56),y.Dc(1),y.gc(2,"number"),y.Sb()),2&t){const t=e.$implicit;y.Cb(1),y.Fc("",y.ic(2,1,t.precio_unitario,"1.2-2")," ")}}function co(t,e){1&t&&(y.Tb(0,"th",55),y.Dc(1,"Costo Total"),y.Sb())}function ro(t,e){if(1&t&&(y.Tb(0,"td",56),y.Dc(1),y.gc(2,"number"),y.Sb()),2&t){const t=e.$implicit;y.Cb(1),y.Ec(y.ic(2,1,t.precio_total,"1.2-2"))}}function ao(t,e){1&t&&(y.Tb(0,"th",53),y.Dc(1,"\xa0"),y.Sb())}function so(t,e){if(1&t){const t=y.Ub();y.Tb(0,"button",28),y.bc("click",function(){y.wc(t);const e=y.fc().$implicit;return y.fc(3).getDetalleEgreso(e.egreso,e.egreso_detalle)}),y.Dc(1," Editar "),y.Sb()}if(2&t){const t=y.fc(4);y.lc("disabled",y.nc(1,ae).indexOf(+t.egreso.estatus_movimiento)>=0||t.bloqueoBotones)}}function lo(t,e){if(1&t){const t=y.Ub();y.Tb(0,"button",39),y.bc("click",function(){y.wc(t);const e=y.fc().$implicit;return y.fc(3).removeFromDetail(e.articulo)}),y.Dc(1," Eliminar "),y.Sb()}if(2&t){const t=y.fc(4);y.lc("disabled",y.nc(1,ae).indexOf(+t.egreso.estatus_movimiento)>=0||t.bloqueoBotones)}}function bo(t,e){if(1&t&&(y.Tb(0,"td",54),y.Cc(1,so,2,2,"button",17),y.Cc(2,lo,2,2,"button",37),y.Sb()),2&t){const t=y.fc(3);y.Cb(1),y.lc("ngIf",t.saveToDB),y.Cb(1),y.lc("ngIf",!t.saveToDB)}}function uo(t,e){1&t&&y.Ob(0,"tr",57)}function go(t,e){1&t&&y.Ob(0,"tr",58)}function fo(t,e){if(1&t&&(y.Tb(0,"table",40),y.Rb(1,41),y.Cc(2,Je,2,0,"th",42),y.Cc(3,Ze,2,1,"td",43),y.Qb(),y.Rb(4,44),y.Cc(5,Ye,2,0,"th",42),y.Cc(6,to,2,1,"td",43),y.Qb(),y.Rb(7,45),y.Cc(8,eo,2,0,"th",46),y.Cc(9,oo,3,4,"td",47),y.Qb(),y.Rb(10,48),y.Cc(11,io,2,0,"th",46),y.Cc(12,no,3,4,"td",47),y.Qb(),y.Rb(13,49),y.Cc(14,co,2,0,"th",46),y.Cc(15,ro,3,4,"td",47),y.Qb(),y.Rb(16,50),y.Cc(17,ao,2,0,"th",42),y.Cc(18,bo,3,2,"td",43),y.Qb(),y.Cc(19,uo,1,0,"tr",51),y.Cc(20,go,1,0,"tr",52),y.Sb()),2&t){const t=y.fc(2);y.lc("dataSource",t.dataSource),y.Cb(19),y.lc("matHeaderRowDef",t.displayedColumns),y.Cb(1),y.lc("matRowDefColumns",t.displayedColumns)}}function mo(t,e){if(1&t&&(y.Tb(0,"mat-card",0),y.Tb(1,"mat-card-title"),y.Tb(2,"h4"),y.Dc(3),y.Cc(4,ze,3,0,"button",1),y.Cc(5,Ge,3,0,"button",1),y.Sb(),y.Sb(),y.Tb(6,"mat-card-content"),y.Cc(7,Xe,18,11,"form",2),y.Cc(8,Ke,1,0,"hr",3),y.Cc(9,fo,21,3,"table",31),y.Sb(),y.Sb()),2&t){const t=y.fc();y.Cb(3),y.Gc(" Merma ",t.saveToDB?"No.":""," ",t.egreso.egreso," "),y.Cb(1),y.lc("ngIf",!t.showDetalleEgresoForm),y.Cb(1),y.lc("ngIf",t.showDetalleEgresoForm),y.Cb(2),y.lc("ngIf",t.showDetalleEgresoForm),y.Cb(1),y.lc("ngIf",t.detallesMerma.length>0),y.Cb(1),y.lc("ngIf",t.detallesMerma.length>0)}}let po=(()=>{class t{constructor(t,e,o,i,n,c,r,a,s){this.snackBar=t,this.ls=e,this.egresoSrvc=o,this.tipoMovimientoSrvc=i,this.bodegaSrvc=n,this.articuloSrvc=c,this.proveedorSrvc=r,this.transformacionSrvc=a,this.presentacionSrvc=s,this.saveToDB=!0,this.egresoSavedEv=new y.o,this.showEgresoForm=!0,this.showDetalleEgresoForm=!0,this.detallesEgreso=[],this.detallesMerma=[],this.displayedColumns=["articulo","presentacion","cantidad","precio_unitario","precio_total","editItem"],this.tiposMovimiento=[],this.tiposMovimientoIngreso=[],this.bodegas=[],this.articulos=[],this.filteredArticulos=[],this.proveedores=[],this.filteredProveedores=[],this.presentaciones=[],this.fltrPresentaciones=[],this.fltrPresentacionesMerma=[],this.esMovil=!1,this.bloqueoBotones=!1,this.txtArticuloSelected=void 0,this.txtProveedorSelected=void 0,this.loadTiposMovimiento=(t=!0)=>{this.tipoMovimientoSrvc.get(t?{egreso:1}:{ingreso:1}).subscribe(e=>{e&&(t?this.tiposMovimiento=e:this.tiposMovimientoIngreso=e)})},this.loadBodegas=()=>{this.bodegaSrvc.get({sede:this.ls.get(F.a.usrTokenVar).sede||0}).subscribe(t=>{t&&(this.bodegas=t)})},this.loadProveedores=()=>{this.proveedorSrvc.get().subscribe(t=>{t&&(this.proveedores=t)})},this.loadPresentaciones=()=>{this.presentacionSrvc.get().subscribe(t=>{t&&(this.presentaciones=t)})},this.resetEgreso=()=>{this.egreso={egreso:null,tipo_movimiento:null,bodega:null,fecha:x().format(F.a.dbDateFormat),usuario:this.ls.get(F.a.usrTokenVar).idusr||0,estatus_movimiento:1,traslado:0},this.resetDetalleEgreso(),this.updateTableDataSource(),this.resetDetalleMerma(),this.updateTableDataSourceM()},this.onSubmit=()=>{this.bloqueoBotones=!0,this.egresoSrvc.save(this.egreso).subscribe(t=>{t.exito&&(this.egresoSavedEv.emit(),this.resetEgreso(),this.egreso={egreso:t.egreso.egreso,tipo_movimiento:t.egreso.tipo_movimiento,fecha:t.egreso.fecha,bodega:t.egreso.bodega,creacion:t.egreso.creacion,usuario:t.egreso.usuario,estatus_movimiento:t.egreso.estatus_movimiento,traslado:t.egreso.traslado},this.loadDetalleEgreso(this.egreso.egreso)),this.bloqueoBotones=!1})},this.confirmarEgreso=()=>{this.egreso.estatus_movimiento=2,this.onSubmit()},this.loadArticulos=()=>{this.articuloSrvc.getArticulosIngreso().subscribe(t=>{t&&(this.articulos=t)})},this.resetDetalleEgreso=()=>{this.detalleEgreso={egreso_detalle:null,egreso:this.egreso.egreso?this.egreso.egreso:null,articulo:null,cantidad:null,precio_unitario:null,precio_total:null,presentacion:0},this.txtArticuloSelected=void 0},this.resetDetalleMerma=()=>this.detalleMerma={egreso_detalle:null,egreso:this.egreso.egreso?this.egreso.egreso:null,articulo:null,cantidad:null,precio_unitario:null,precio_total:null,presentacion:0},this.loadDetalleEgreso=(t=+this.egreso.egreso)=>{this.egresoSrvc.getDetalle(t,{egreso:t}).subscribe(t=>{t&&(this.detallesEgreso=t,this.updateTableDataSource())})},this.getDetalleEgreso=(t=+this.egreso.egreso,e)=>{this.egresoSrvc.getDetalle(t,{egreso_detalle:e}).subscribe(t=>{t&&(this.detalleEgreso={egreso_detalle:t[0].egreso_detalle,egreso:t[0].egreso,articulo:t[0].articulo.articulo,cantidad:+t[0].cantidad,precio_unitario:+t[0].precio_unitario,precio_total:+t[0].precio_total,presentacion:t[0].presentacion.presentacion},this.setPresentaciones(),this.saveToDB||this.setPresentacionesMerma(),this.txtArticuloSelected=t[0].articulo,this.showDetalleEgresoForm=!0)})},this.onSubmitDetail=()=>{this.bloqueoBotones=!0,this.detalleEgreso.egreso=this.egreso.egreso,this.egresoSrvc.saveDetalle(this.detalleEgreso).subscribe(t=>{t.exito?(this.loadDetalleEgreso(),this.resetDetalleEgreso(),this.snackBar.open("Egreso guardado con \xe9xito...","Egreso",{duration:3e3})):this.snackBar.open(`ERROR: ${t.mensaje}`,"Egreso",{duration:3e3}),this.bloqueoBotones=!1})},this.addToDetail=()=>{this.detallesEgreso.push(this.detalleEgreso),this.resetDetalleEgreso(),this.updateTableDataSource()},this.addToDetailMerma=()=>{this.detallesMerma.push(this.detalleMerma),this.resetDetalleMerma(),this.updateTableDataSourceM()},this.removeFromDetail=t=>this.detallesEgreso.splice(this.detallesEgreso.findIndex(e=>+e.articulo==+t),1),this.getDescripcionArticulo=t=>this.articulos.find(e=>+e.articulo==+t).descripcion||"",this.getDescripcionPresentacion=t=>this.presentaciones.find(e=>+e.presentacion==+t).descripcion||"",this.updateTableDataSource=()=>{this.dataSource=new f.k(this.detallesEgreso),this.dataSource.filterPredicate=(t,e)=>t.articulo.descripcion.toLowerCase().includes(e)},this.updateTableDataSourceM=()=>this.dataSource=new f.k(this.detallesMerma),this.filtrarArticulos=t=>{if(t&&"string"==typeof t){const e=t.toLowerCase();this.filteredArticulos=this.articulos.filter(t=>t.descripcion.toLowerCase().includes(e))}else this.filteredArticulos=this.articulos},this.setPresentaciones=()=>{this.fltrPresentaciones=[];const t=this.articulos.findIndex(t=>+t.articulo==+this.detalleEgreso.articulo),e=this.articulos[t];this.fltrPresentaciones=this.presentaciones.filter(t=>+t.medida.medida==+e.presentacion.medida)},this.setPresentacionesMerma=()=>{this.fltrPresentacionesMerma=[];const t=this.articulos.findIndex(t=>+t.articulo==+this.detalleMerma.articulo),e=this.articulos[t];this.fltrPresentacionesMerma=this.presentaciones.filter(t=>+t.medida.medida==+e.presentacion.medida)},this.displayArticulo=t=>{if(t)return this.detalleEgreso.articulo=t.articulo,t.descripcion},this.displayArticuloMerma=t=>{if(t)return this.detalleMerma.articulo=t.articulo,t.descripcion},this.filtrarProveedores=t=>{if(t&&"string"==typeof t){const e=t.toLowerCase();this.filteredProveedores=this.proveedores.filter(t=>t.razon_social.toLowerCase().includes(e)||t.nit.toLowerCase().includes(e))}else this.filteredProveedores=this.proveedores},this.displayProveedor=t=>{if(t)return this.egreso.proveedor=t.proveedor,`(${t.nit}) ${t.razon_social}`},this.applyFilter=t=>{this.dataSource.filter=t}}ngOnInit(){this.esMovil=this.ls.get(F.a.usrTokenVar).enmovil||!1,this.resetEgreso(),this.loadTiposMovimiento(),this.loadTiposMovimiento(!1),this.loadBodegas(),this.loadArticulos(),this.loadProveedores(),this.loadPresentaciones()}}return t.\u0275fac=function(e){return new(e||t)(y.Nb(C.a),y.Nb(E.a),y.Nb(Gt),y.Nb(G.a),y.Nb(q.a),y.Nb(W.a),y.Nb(z.a),y.Nb(Vt),y.Nb(L.a))},t.\u0275cmp=y.Hb({type:t,selectors:[["app-form-egreso"]],inputs:{egreso:"egreso",saveToDB:"saveToDB"},outputs:{egresoSavedEv:"egresoSavedEv"},decls:12,vars:8,consts:[[1,"mat-elevation-z4","fullWidth"],["mat-icon-button","","type","button","color","accent",3,"click",4,"ngIf"],["novalidate","",3,"ngSubmit",4,"ngIf"],[4,"ngIf"],["class","mat-elevation-z4 fullWidth",4,"ngIf"],["mat-icon-button","","type","button","color","accent",3,"click"],[1,"iconFontSize"],["novalidate","",3,"ngSubmit"],["frmEgreso","ngForm"],["class","fullWidth",4,"ngIf"],[1,"fullWidth"],["matInput","","type","date","placeholder","Fecha","name","fecha","required","",3,"ngModel","ngModelChange"],["name","bodega","required","",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["name","traslado","class","fullWidth",3,"ngModel","ngModelChange",4,"ngIf"],["align","end"],["mat-raised-button","","type","submit","color","accent","class","btnAccion",3,"disabled",4,"ngIf"],["mat-raised-button","","type","button","color","accent","class","btnAccion",3,"disabled","click",4,"ngIf"],["mat-raised-button","","type","button","color","accent",3,"click",4,"ngIf"],["name","tipo_movimiento","required","",3,"ngModel","ngModelChange"],[3,"value"],["name","traslado",1,"fullWidth",3,"ngModel","ngModelChange"],["name","bodega_destino",3,"ngModel","required","ngModelChange"],["name","tipo_movimiento_destino",3,"ngModel","required","ngModelChange"],["type","text","placeholder","Proveedor","matInput","","required","",3,"ngModel","ngModelOptions","matAutocomplete","ngModelChange","keyup"],[3,"displayWith"],["autoProveedores","matAutocomplete"],["mat-raised-button","","type","submit","color","accent",1,"btnAccion",3,"disabled"],["mat-raised-button","","type","button","color","accent",1,"btnAccion",3,"disabled","click"],["mat-raised-button","","type","button","color","accent",3,"click"],["matInput","","placeholder","Buscar",3,"keyup"],["mat-table","","class","mat-elevation-z4 full-width",3,"dataSource",4,"ngIf"],["frmDetalleEgreso","ngForm"],["type","text","placeholder","Art\xedculo","matInput","","required","",3,"ngModel","ngModelOptions","matAutocomplete","ngModelChange","keyup"],[3,"displayWith","optionSelected"],["autoArticulos","matAutocomplete"],["name","presentacion","required","",3,"ngModel","ngModelChange"],["mat-raised-button","","type","button","color","accent",3,"disabled","click",4,"ngIf"],["matInput","","placeholder","Cantidad","name","cantidad","required","",3,"ngModel","ngModelChange","change"],["mat-raised-button","","type","button","color","accent",3,"disabled","click"],["mat-table","",1,"mat-elevation-z4","full-width",3,"dataSource"],["matColumnDef","articulo"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","","class","text-wrap",4,"matCellDef"],["matColumnDef","presentacion"],["matColumnDef","cantidad"],["mat-header-cell","","class","text-right",4,"matHeaderCellDef"],["mat-cell","","class","text-right",4,"matCellDef"],["matColumnDef","precio_unitario"],["matColumnDef","precio_total"],["matColumnDef","editItem"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell","",1,"text-wrap"],["mat-header-cell","",1,"text-right"],["mat-cell","",1,"text-right"],["mat-header-row",""],["mat-row",""],["frmMerma","ngForm"],["matInput","","placeholder","Costo unitario","name","precio_unitario","required","",3,"ngModel","ngModelChange","change"]],template:function(t,e){1&t&&(y.Tb(0,"mat-card",0),y.Tb(1,"mat-card-title"),y.Tb(2,"h4"),y.Dc(3),y.Cc(4,Qt,3,0,"button",1),y.Cc(5,Xt,3,0,"button",1),y.Sb(),y.Sb(),y.Tb(6,"mat-card-content"),y.Cc(7,de,18,14,"form",2),y.Sb(),y.Sb(),y.Cc(8,ue,1,0,"hr",3),y.Cc(9,He,12,7,"mat-card",4),y.Cc(10,je,1,0,"hr",3),y.Cc(11,mo,10,7,"mat-card",4)),2&t&&(y.Cb(3),y.Fc(" Egreso",e.egreso.egreso?" No. "+e.egreso.egreso:""," "),y.Cb(1),y.lc("ngIf",!e.showEgresoForm),y.Cb(1),y.lc("ngIf",e.showEgresoForm),y.Cb(2),y.lc("ngIf",e.showEgresoForm),y.Cb(1),y.lc("ngIf",e.egreso.egreso||!e.saveToDB),y.Cb(1),y.lc("ngIf",e.egreso.egreso||!e.saveToDB),y.Cb(1),y.lc("ngIf",e.egreso.egreso||!e.saveToDB),y.Cb(1),y.lc("ngIf",!e.saveToDB))},directives:[d.a,d.h,i.m,d.c,h.a,s.a,c.r,c.l,c.m,l.b,b.b,c.c,c.p,c.k,c.n,l.e,m.a,i.l,U.k,p.a,_.c,_.a,f.j,f.c,f.e,f.b,f.g,f.i,f.d,f.a,f.f,f.h],pipes:[i.f],styles:[".full-width[_ngcontent-%COMP%]{width:100%}.iconFontSize[_ngcontent-%COMP%]{font-size:24pt}"]}),t})();const ho=["lstEgreso"],Co=["frmEgreso"];let So=(()=>{class t{constructor(t){this.ls=t,this.setEgreso=t=>{this.egreso=t,this.frmEgreso.resetDetalleEgreso(),this.frmEgreso.loadDetalleEgreso(+this.egreso.egreso)},this.refreshEgresoList=()=>{this.lstEgresoComponent.loadEgresos()},this.egreso={egreso:null,tipo_movimiento:null,bodega:null,fecha:x().format(F.a.dbDateFormat),usuario:this.ls.get(F.a.usrTokenVar).idusr||0,estatus_movimiento:1,traslado:0}}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)(y.Nb(E.a))},t.\u0275cmp=y.Hb({type:t,selectors:[["app-egreso"]],viewQuery:function(t,e){if(1&t&&(y.Ic(ho,1),y.Ic(Co,1)),2&t){let t;y.sc(t=y.cc())&&(e.lstEgresoComponent=t.first),y.sc(t=y.cc())&&(e.frmEgreso=t.first)}},decls:7,vars:1,consts:[[1,"row"],[1,"col","m5","s12"],[3,"getEgresoEv"],["lstEgreso",""],[1,"col","m7","s12"],[3,"egreso","egresoSavedEv"],["frmEgreso",""]],template:function(t,e){1&t&&(y.Tb(0,"div",0),y.Tb(1,"div",1),y.Tb(2,"app-lista-egreso",2,3),y.bc("getEgresoEv",function(t){return e.setEgreso(t)}),y.Sb(),y.Sb(),y.Tb(4,"div",4),y.Tb(5,"app-form-egreso",5,6),y.bc("egresoSavedEv",function(){return e.refreshEgresoList()}),y.Sb(),y.Sb(),y.Sb()),2&t&&(y.Cb(5),y.lc("egreso",e.egreso))},directives:[Lt,po],styles:[""]}),t})();function vo(t,e){if(1&t){const t=y.Ub();y.Tb(0,"div"),y.Tb(1,"div",1),y.Tb(2,"button",2),y.bc("click",function(){y.wc(t);const e=y.fc();return e.showCategoriasForm=!0,e.resetCategoria()}),y.Tb(3,"mat-icon",3),y.Dc(4,"expand_more"),y.Sb(),y.Dc(5,"\xa0Categor\xedas y sub-categor\xedas "),y.Sb(),y.Sb(),y.Sb()}}function To(t,e){if(1&t){const t=y.Ub();y.Tb(0,"div"),y.Tb(1,"div",1),y.Tb(2,"button",2),y.bc("click",function(){y.wc(t);const e=y.fc();return e.showCategoriasForm=!1,e.resetCategoria()}),y.Tb(3,"mat-icon",3),y.Dc(4,"expand_less"),y.Sb(),y.Dc(5,"\xa0Categor\xedas y sub-categor\xedas "),y.Sb(),y.Sb(),y.Sb()}}function Do(t,e){if(1&t&&(y.Tb(0,"mat-option",12),y.Dc(1),y.Sb()),2&t){const t=e.$implicit;y.lc("value",t),y.Cb(1),y.Fc(" ",t.descripcion," ")}}function Mo(t,e){if(1&t){const t=y.Ub();y.Tb(0,"button",13),y.bc("click",function(){return y.wc(t),y.fc(3).editCategoriaMode=!0}),y.Dc(1," Editar "),y.Sb()}}function Io(t,e){if(1&t){const t=y.Ub();y.Tb(0,"button",14),y.bc("click",function(){y.wc(t);const e=y.fc(3);return e.resetCategoria(),e.editCategoriaMode=!0}),y.Dc(1," Nueva "),y.Sb()}}function wo(t,e){if(1&t){const t=y.Ub();y.Tb(0,"mat-form-field",7),y.Tb(1,"mat-label"),y.Dc(2,"Categor\xeda"),y.Sb(),y.Tb(3,"mat-select",8),y.bc("ngModelChange",function(e){return y.wc(t),y.fc(2).categoria=e})("selectionChange",function(e){return y.wc(t),y.fc(2).onCategoriaSelected(e)}),y.Cc(4,Do,2,2,"mat-option",9),y.Sb(),y.Cc(5,Mo,2,0,"button",10),y.Cc(6,Io,2,0,"button",11),y.Sb()}if(2&t){const t=y.fc(2);y.Cb(3),y.lc("ngModel",t.categoria),y.Cb(1),y.lc("ngForOf",t.categorias),y.Cb(1),y.lc("ngIf",!t.editCategoriaMode&&+t.categoria.categoria>0),y.Cb(1),y.lc("ngIf",!t.editCategoriaMode)}}function _o(t,e){if(1&t){const t=y.Ub();y.Tb(0,"button",18),y.bc("click",function(){return y.wc(t),y.fc(3).onSubmitCategoria()}),y.Dc(1," Guardar "),y.Sb()}if(2&t){y.fc(2);const t=y.tc(3);y.lc("disabled",!t.form.valid)}}function ko(t,e){if(1&t){const t=y.Ub();y.Tb(0,"button",19),y.bc("click",function(){return y.wc(t),y.fc(3).resetCategoria()}),y.Dc(1," Cancelar "),y.Sb()}}function Oo(t,e){if(1&t){const t=y.Ub();y.Tb(0,"mat-form-field",7),y.Tb(1,"input",15),y.bc("ngModelChange",function(e){return y.wc(t),y.fc(2).categoria.descripcion=e}),y.Sb(),y.Cc(2,_o,2,1,"button",16),y.Cc(3,ko,2,0,"button",17),y.Sb()}if(2&t){const t=y.fc(2);y.Cb(1),y.lc("ngModel",t.categoria.descripcion)("required",t.editCategoriaMode),y.Cb(1),y.lc("ngIf",t.editCategoriaMode),y.Cb(1),y.lc("ngIf",t.editCategoriaMode)}}function Fo(t,e){if(1&t){const t=y.Ub();y.Tb(0,"button",18),y.bc("click",function(){return y.wc(t),y.fc(3).onSubmitCategoria()}),y.Dc(1," Guardar "),y.Sb()}if(2&t){y.fc(2);const t=y.tc(3);y.lc("disabled",!t.form.valid)}}function xo(t,e){if(1&t){const t=y.Ub();y.Tb(0,"button",19),y.bc("click",function(){return y.wc(t),y.fc(3).resetCategoria()}),y.Dc(1," Cancelar "),y.Sb()}}function yo(t,e){if(1&t){const t=y.Ub();y.Tb(0,"mat-form-field",7),y.Tb(1,"input",20),y.bc("ngModelChange",function(e){return y.wc(t),y.fc(2).categoria.descripcion=e}),y.Sb(),y.Cc(2,Fo,2,1,"button",16),y.Cc(3,xo,2,0,"button",17),y.Sb()}if(2&t){const t=y.fc(2);y.Cb(1),y.lc("ngModel",t.categoria.descripcion)("required",t.editCategoriaMode),y.Cb(1),y.lc("ngIf",t.editCategoriaMode),y.Cb(1),y.lc("ngIf",t.editCategoriaMode)}}function Eo(t,e){if(1&t&&(y.Tb(0,"div"),y.Tb(1,"div"),y.Tb(2,"form",4,5),y.Cc(4,wo,7,4,"mat-form-field",6),y.Cc(5,Oo,4,4,"mat-form-field",6),y.Cc(6,yo,4,4,"mat-form-field",6),y.Sb(),y.Sb(),y.Sb()),2&t){const t=y.fc();y.Cb(4),y.lc("ngIf",!t.editCategoriaMode),y.Cb(1),y.lc("ngIf",t.esMovil&&t.editCategoriaMode),y.Cb(1),y.lc("ngIf",!t.esMovil&&t.editCategoriaMode)}}function Ao(t,e){if(1&t&&(y.Tb(0,"mat-option",12),y.Dc(1),y.Sb()),2&t){const t=e.$implicit;y.lc("value",t.categoria_grupo),y.Cb(1),y.Fc(" ",t.descripcion," ")}}function Po(t,e){if(1&t&&(y.Tb(0,"mat-option",12),y.Dc(1),y.Sb()),2&t){const t=e.$implicit;y.lc("value",t),y.Cb(1),y.Fc(" ",t.descripcion," ")}}function Bo(t,e){if(1&t){const t=y.Ub();y.Tb(0,"button",13),y.bc("click",function(){return y.wc(t),y.fc(3).editSubCategoriaMode=!0}),y.Dc(1," Editar "),y.Sb()}}function $o(t,e){if(1&t){const t=y.Ub();y.Tb(0,"button",14),y.bc("click",function(){y.wc(t);const e=y.fc(3);return e.resetCategoriaGrupo(),e.editSubCategoriaMode=!0}),y.Dc(1," Nueva "),y.Sb()}}function Ro(t,e){if(1&t){const t=y.Ub();y.Tb(0,"mat-form-field",7),y.Tb(1,"mat-label"),y.Dc(2,"Sub-categor\xeda"),y.Sb(),y.Tb(3,"mat-select",24),y.bc("ngModelChange",function(e){return y.wc(t),y.fc(2).categoriaGrupo=e})("selectionChange",function(e){return y.wc(t),y.fc(2).onSubCategoriaSelected(e)}),y.Cc(4,Po,2,2,"mat-option",9),y.Sb(),y.Cc(5,Bo,2,0,"button",10),y.Cc(6,$o,2,0,"button",11),y.Sb()}if(2&t){const t=y.fc(2);y.Cb(3),y.lc("ngModel",t.categoriaGrupo),y.Cb(1),y.lc("ngForOf",t.categoriasGrupos),y.Cb(1),y.lc("ngIf",!t.editSubCategoriaMode&&+t.categoriaGrupo.categoria_grupo>0),y.Cb(1),y.lc("ngIf",!t.editSubCategoriaMode)}}function Uo(t,e){if(1&t){const t=y.Ub();y.Tb(0,"mat-form-field",7),y.Tb(1,"input",25),y.bc("ngModelChange",function(e){return y.wc(t),y.fc(2).categoriaGrupo.descripcion=e}),y.Sb(),y.Sb()}if(2&t){const t=y.fc(2);y.Cb(1),y.lc("ngModel",t.categoriaGrupo.descripcion)("required",t.editCategoriaMode)}}function No(t,e){if(1&t){const t=y.Ub();y.Tb(0,"mat-form-field",7),y.Tb(1,"input",26),y.bc("ngModelChange",function(e){return y.wc(t),y.fc(2).categoriaGrupo.descripcion=e}),y.Sb(),y.Sb()}if(2&t){const t=y.fc(2);y.Cb(1),y.lc("ngModel",t.categoriaGrupo.descripcion)("required",t.editCategoriaMode)}}function Ho(t,e){if(1&t&&(y.Tb(0,"mat-option",12),y.Dc(1),y.Sb()),2&t){const t=e.$implicit;y.lc("value",t.impresora),y.Cb(1),y.Fc(" ",t.nombre," ")}}function jo(t,e){if(1&t){const t=y.Ub();y.Tb(0,"button",18),y.bc("click",function(){return y.wc(t),y.fc(3).onSubmitSubCategoria()}),y.Dc(1," Guardar "),y.Sb()}if(2&t){y.fc(2);const t=y.tc(2);y.lc("disabled",!t.form.valid)}}function zo(t,e){if(1&t){const t=y.Ub();y.Tb(0,"button",19),y.bc("click",function(){return y.wc(t),y.fc(3).resetCategoriaGrupo()}),y.Dc(1," Cancelar "),y.Sb()}}function Go(t,e){if(1&t){const t=y.Ub();y.Tb(0,"mat-form-field",7),y.Tb(1,"mat-label"),y.Dc(2,"Impresora"),y.Sb(),y.Tb(3,"mat-select",27),y.bc("ngModelChange",function(e){return y.wc(t),y.fc(2).categoriaGrupo.impresora=e}),y.Cc(4,Ho,2,2,"mat-option",9),y.Sb(),y.Cc(5,jo,2,1,"button",16),y.Cc(6,zo,2,0,"button",17),y.Sb()}if(2&t){const t=y.fc(2);y.Cb(3),y.lc("ngModel",t.categoriaGrupo.impresora),y.Cb(1),y.lc("ngForOf",t.impresoras),y.Cb(1),y.lc("ngIf",t.editSubCategoriaMode),y.Cb(1),y.lc("ngIf",t.editSubCategoriaMode)}}function qo(t,e){if(1&t){const t=y.Ub();y.Tb(0,"div"),y.Tb(1,"form",4,21),y.Tb(3,"mat-form-field",7),y.Tb(4,"mat-label"),y.Dc(5,"Sub-categor\xeda Padre"),y.Sb(),y.Tb(6,"mat-select",22),y.bc("ngModelChange",function(e){return y.wc(t),y.fc().categoriaGrupo.categoria_grupo_grupo=e})("selectionChange",function(e){return y.wc(t),y.fc().onSubCategoriaPadreSelected(e)}),y.Cc(7,Ao,2,2,"mat-option",9),y.Sb(),y.Sb(),y.Cc(8,Ro,7,4,"mat-form-field",6),y.Cc(9,Uo,2,2,"mat-form-field",6),y.Cc(10,No,2,2,"mat-form-field",6),y.Tb(11,"mat-checkbox",23),y.bc("ngModelChange",function(e){return y.wc(t),+(y.fc().categoriaGrupo.descuento=e)}),y.Dc(12,"\xbfAplica Descuento? "),y.Sb(),y.Cc(13,Go,7,4,"mat-form-field",6),y.Sb(),y.Sb()}if(2&t){const t=y.fc();y.Cb(6),y.lc("ngModel",t.categoriaGrupo.categoria_grupo_grupo),y.Cb(1),y.lc("ngForOf",t.categoriasGruposPadre),y.Cb(1),y.lc("ngIf",!t.editSubCategoriaMode),y.Cb(1),y.lc("ngIf",t.esMovil&&t.editSubCategoriaMode),y.Cb(1),y.lc("ngIf",!t.esMovil&&t.editSubCategoriaMode),y.Cb(1),y.lc("ngModel",+t.categoriaGrupo.descuento),y.Cb(2),y.lc("ngIf",t.editSubCategoriaMode)}}let Wo=(()=>{class t{constructor(t,e,o){this._snackBar=t,this.ls=e,this.articuloSrvc=o,this.categoriaGrupoSvd=new y.o,this.onChangeSubCategoriaEv=new y.o,this.categorias=[],this.categoriasGruposPadre=[],this.categoriasGrupos=[],this.editCategoriaMode=!1,this.editSubCategoriaMode=!1,this.showCategoriasForm=!1,this.esMovil=!1,this.impresoras=[],this.resetCategoria=()=>{this.categoria={categoria:null,sede:this.ls.get(F.a.usrTokenVar).sede||0,descripcion:null},this.resetCategoriaGrupo(),this.editCategoriaMode=!1},this.resetCategoriaGrupo=()=>{this.categoriaGrupo={categoria_grupo:null,categoria:this.categoria.categoria,categoria_grupo_grupo:null,descripcion:null,receta:0,impresora:null,descuento:0,antecesores:null},this.editSubCategoriaMode=!1},this.loadCategorias=()=>{this.articuloSrvc.getCategorias({sede:+this.ls.get(F.a.usrTokenVar).sede||0}).subscribe(t=>{t&&(this.categorias=t)})},this.onCategoriaSelected=t=>this.loadSubCategorias(+t.value.categoria),this.loadSubCategorias=t=>{this.articuloSrvc.getCategoriasGrupos({categoria:+t}).subscribe(t=>{t&&(this.categoriasGruposPadre=this.articuloSrvc.adaptCategoriaGrupoResponse(t),this.categoriasGrupos=this.categoriasGruposPadre)})},this.loadImpresoras=()=>{this.articuloSrvc.getImpresoras({sede:+this.ls.get(F.a.usrTokenVar).sede||0}).subscribe(t=>{t&&(this.impresoras=t)})},this.onSubCategoriaPadreSelected=t=>this.loadSubCategoriasSubcategorias(+t.value),this.loadSubCategoriasSubcategorias=t=>{this.articuloSrvc.getCategoriasGrupos({categoria_grupo_grupo:t}).subscribe(t=>{t&&(this.categoriasGrupos=this.articuloSrvc.adaptCategoriaGrupoResponse(t))})},this.onSubmitCategoria=()=>{this.articuloSrvc.saveCategoria(this.categoria).subscribe(t=>{t.exito?(this.editCategoriaMode=!1,this.resetCategoria(),this.loadCategorias(),this.categoriaGrupoSvd.emit(),this._snackBar.open("Grabada con \xe9xito.","Categor\xeda",{duration:5e3})):this._snackBar.open(`ERROR: ${t.mensaje}`,"Categor\xeda",{duration:5e3})})},this.onSubCategoriaSelected=t=>this.onChangeSubCategoriaEv.emit(+t.value.categoria_grupo),this.onSubmitSubCategoria=()=>{this.articuloSrvc.saveCategoriaGrupo(this.categoriaGrupo).subscribe(t=>{t.exito?(this.resetCategoriaGrupo(),this.loadSubCategorias(+this.categoria.categoria),this.categoriaGrupoSvd.emit(),this._snackBar.open("Grabada con \xe9xito.","Sub - Categor\xeda",{duration:5e3})):this._snackBar.open(`ERROR: ${t.mensaje}`,"Sub - Categor\xeda",{duration:5e3})})}}ngOnInit(){this.esMovil=this.ls.get(F.a.usrTokenVar).enmovil||!1,this.resetCategoria(),this.loadCategorias(),this.loadImpresoras()}}return t.\u0275fac=function(e){return new(e||t)(y.Nb(C.a),y.Nb(E.a),y.Nb(W.a))},t.\u0275cmp=y.Hb({type:t,selectors:[["app-categoria-producto"]],outputs:{categoriaGrupoSvd:"categoriaGrupoSvd",onChangeSubCategoriaEv:"onChangeSubCategoriaEv"},decls:5,vars:4,consts:[[4,"ngIf"],["align","center"],["mat-button","","type","button","color","accent",3,"click"],[1,"iconFontSize"],["novalidate",""],["frmCategoria","ngForm"],["class","fullWidth",4,"ngIf"],[1,"fullWidth"],["name","categoria",3,"ngModel","ngModelChange","selectionChange"],[3,"value",4,"ngFor","ngForOf"],["mat-raised-button","","type","button","matSuffix","","color","accent","class","btnAccion",3,"click",4,"ngIf"],["mat-raised-button","","type","button","matSuffix","","color","accent",3,"click",4,"ngIf"],[3,"value"],["mat-raised-button","","type","button","matSuffix","","color","accent",1,"btnAccion",3,"click"],["mat-raised-button","","type","button","matSuffix","","color","accent",3,"click"],["matInput","","placeholder","Descripcion de la categor\xeda","name","descripcion",3,"ngModel","required","ngModelChange"],["mat-raised-button","","type","button","matSuffix","","color","accent","class","btnAccion",3,"disabled","click",4,"ngIf"],["mat-raised-button","","type","button","matSuffix","","color","warn",3,"click",4,"ngIf"],["mat-raised-button","","type","button","matSuffix","","color","accent",1,"btnAccion",3,"disabled","click"],["mat-raised-button","","type","button","matSuffix","","color","warn",3,"click"],["matInput","","ng-virtual-keyboard","","ng-virtual-keyboard-layout","alphanumeric","ng-virtual-keyboard-placeholder","Descripcion de la categor\xeda","placeholder","Descripcion de la categor\xeda","name","descripcion",3,"ngModel","required","ngModelChange"],["frmCategoriaGrupo","ngForm"],["name","categoriaGrupoPadre",3,"ngModel","ngModelChange","selectionChange"],["name","descuento",1,"fullWidth",3,"ngModel","ngModelChange"],["name","categoriaGrupo",3,"ngModel","ngModelChange","selectionChange"],["matInput","","placeholder","Descripcion de la sub - categor\xeda","name","descripcion",3,"ngModel","required","ngModelChange"],["matInput","","ng-virtual-keyboard","","ng-virtual-keyboard-layout","alphanumeric","ng-virtual-keyboard-placeholder","Descripcion de la sub - categor\xeda","placeholder","Descripcion de la sub - categor\xeda","name","descripcion",3,"ngModel","required","ngModelChange"],["name","impresora","im","",3,"ngModel","ngModelChange"]],template:function(t,e){1&t&&(y.Tb(0,"div"),y.Cc(1,vo,6,0,"div",0),y.Cc(2,To,6,0,"div",0),y.Sb(),y.Cc(3,Eo,7,3,"div",0),y.Cc(4,qo,14,7,"div",0)),2&t&&(y.Cb(1),y.lc("ngIf",!e.showCategoriasForm),y.Cb(1),y.lc("ngIf",e.showCategoriasForm),y.Cb(1),y.lc("ngIf",e.showCategoriasForm),y.Cb(1),y.lc("ngIf",e.showCategoriasForm))},directives:[i.m,h.a,s.a,c.r,c.l,c.m,l.b,l.e,m.a,c.k,c.n,i.l,U.k,l.f,b.b,c.c,c.p,p.a],styles:[".fullWidth[_ngcontent-%COMP%]{width:100%}.iconFontSize[_ngcontent-%COMP%]{font-size:18pt}"]}),t})();var Lo=o("FvrZ");function Vo(t,e){if(1&t&&(y.Tb(0,"span"),y.Dc(1),y.Sb()),2&t){const t=y.fc().$implicit;y.Cb(1),y.Ec(t.nombre)}}function Qo(t,e){if(1&t){const t=y.Ub();y.Tb(0,"button",8),y.bc("click",function(){y.wc(t);const e=y.fc().$implicit;return y.fc().onProductoClicked(e)}),y.Dc(1),y.Sb()}if(2&t){const t=y.fc().$implicit;y.Cb(1),y.Ec(t.nombre)}}function Xo(t,e){if(1&t&&(y.Tb(0,"mat-tree-node",3),y.Tb(1,"li",4),y.Ob(2,"button",5),y.Cc(3,Vo,2,1,"span",6),y.Cc(4,Qo,2,1,"button",7),y.Sb(),y.Sb()),2&t){const t=e.$implicit,o=y.fc();y.Cb(3),y.lc("ngIf",o.tieneHijos(t)),y.Cb(1),y.lc("ngIf",!o.tieneHijos(t))}}function Ko(t,e){if(1&t&&(y.Tb(0,"span"),y.Dc(1),y.Sb()),2&t){const t=y.fc().$implicit;y.Cb(1),y.Ec(t.nombre)}}function Jo(t,e){if(1&t){const t=y.Ub();y.Tb(0,"button",8),y.bc("click",function(){y.wc(t);const e=y.fc().$implicit;return y.fc().onProductoClicked(e)}),y.Dc(1),y.Sb()}if(2&t){const t=y.fc().$implicit;y.Cb(1),y.Ec(t.nombre)}}function Zo(t,e){if(1&t&&(y.Tb(0,"mat-nested-tree-node"),y.Tb(1,"li"),y.Tb(2,"div",4),y.Tb(3,"button",9),y.Tb(4,"mat-icon",10),y.Dc(5),y.Sb(),y.Sb(),y.Cc(6,Ko,2,1,"span",6),y.Cc(7,Jo,2,1,"button",7),y.Sb(),y.Tb(8,"ul"),y.Pb(9,11),y.Sb(),y.Sb(),y.Sb()),2&t){const t=e.$implicit,o=y.fc();y.Cb(3),y.Db("aria-label","toggle "+t.nombre),y.Cb(2),y.Fc(" ",o.treeControl.isExpanded(t)?"expand_more":"chevron_right"," "),y.Cb(1),y.lc("ngIf",o.tieneHijos(t)),y.Cb(1),y.lc("ngIf",!o.tieneHijos(t)),y.Cb(1),y.Fb("example-tree-invisible",!o.treeControl.isExpanded(t))}}let Yo=(()=>{class t{constructor(t,e){this.ls=t,this.articuloSrvc=e,this.treeHeight="450px",this.productoClickedEv=new y.o,this.treeControl=new Lo.j(t=>t.hijos),this.dataSource=new w.d,this.hasChild=(t,e)=>!!e.hijos&&e.hijos.length>0,this.tieneHijos=t=>!!t.hijos&&t.hijos.length>0}ngOnInit(){this.loadArbolArticulos()}onProductoClicked(t){this.productoClickedEv.emit(t)}loadArbolArticulos(){this.articuloSrvc.getArbolArticulosMante(this.ls.get(F.a.usrTokenVar).sede||0).subscribe(t=>{t&&(this.arbol=this.articuloSrvc.convertToArbolNodoProducto(t),this.dataSource.data=this.arbol)})}}return t.\u0275fac=function(e){return new(e||t)(y.Nb(E.a),y.Nb(W.a))},t.\u0275cmp=y.Hb({type:t,selectors:[["app-lista-producto"]],inputs:{treeHeight:"treeHeight"},outputs:{productoClickedEv:"productoClickedEv"},decls:3,vars:5,consts:[[1,"example-tree",3,"dataSource","treeControl"],["matTreeNodeToggle","",4,"matTreeNodeDef"],[4,"matTreeNodeDef","matTreeNodeDefWhen"],["matTreeNodeToggle",""],[1,"mat-tree-node"],["mat-icon-button","","disabled",""],[4,"ngIf"],["mat-raised-button","","type","button",3,"click",4,"ngIf"],["mat-raised-button","","type","button",3,"click"],["mat-icon-button","","matTreeNodeToggle",""],[1,"mat-icon-rtl-mirror",2,"font-size","24pt !important"],["matTreeNodeOutlet",""]],template:function(t,e){1&t&&(y.Tb(0,"mat-tree",0),y.Cc(1,Xo,5,2,"mat-tree-node",1),y.Cc(2,Zo,10,6,"mat-nested-tree-node",2),y.Sb()),2&t&&(y.zc("height",e.treeHeight),y.lc("dataSource",e.dataSource)("treeControl",e.treeControl),y.Cb(2),y.lc("matTreeNodeDefWhen",e.hasChild))},directives:[w.b,w.f,w.e,w.h,h.a,i.m,w.a,s.a,w.g],styles:[".example-tree-invisible[_ngcontent-%COMP%]{display:none}.example-tree[_ngcontent-%COMP%]   li[_ngcontent-%COMP%], .example-tree[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{margin-top:0;margin-bottom:0;list-style-type:none}.tabulacion[_ngcontent-%COMP%]{padding-left:10px!important}"]}),t})();var ti=o("Iab2"),ei=o("IJgu"),oi=o("IHy4"),ii=o("TOq3");function ni(t,e){if(1&t&&(y.Tb(0,"mat-option",11),y.Dc(1),y.Sb()),2&t){const t=e.$implicit,o=y.fc();y.lc("value",t.sede)("disabled",+t.sede==+o.miSede),y.Cb(1),y.Fc(" ",t.nombre," ")}}function ci(t,e){1&t&&y.Ob(0,"app-cargando")}let ri=(()=>{class t{constructor(t,e,o,i,n){this.sedeSrvc=t,this.ls=e,this.snackBar=o,this.dialog=i,this.articuloSrvc=n,this.articulo=null,this.cargando=!1,this.sedes=[],this.params={},this.miSede=0,this.loadSedes=()=>{this.sedeSrvc.get().subscribe(t=>{t&&(this.sedes=t)})},this.onSubmit=()=>{this.dialog.open(ei.a,{maxWidth:"400px",data:new ei.b("Replicar art\xedculos","Este proceso replicar\xe1 TODOS los art\xedculos a las sedes seleccionadas. \xbfDesea continuar?","S\xed","No")}).afterClosed().subscribe(t=>{if(t){this.cargando=!0;const t={sedes:[],articulo:null};this.params.sede.forEach(e=>t.sedes.push({sede:+e})),this.articulo&&(t.articulo=+this.articulo.articulo),this.articuloSrvc.replicaArticulosEnSedes(t).subscribe(t=>{t.exito?this.snackBar.open(t.mensaje,"Replicar art\xedculos",{duration:3e3}):this.snackBar.open(`ERROR: ${t.mensaje}`,"Replicar art\xedculos",{duration:7e3}),this.params={},this.cargando=!1})}})}}ngOnInit(){this.miSede=this.ls.get(F.a.usrTokenVar).sede||0,this.loadSedes()}}return t.\u0275fac=function(e){return new(e||t)(y.Nb(oi.a),y.Nb(E.a),y.Nb(C.a),y.Nb(M.b),y.Nb(W.a))},t.\u0275cmp=y.Hb({type:t,selectors:[["app-replicar-asedes"]],inputs:{articulo:"articulo"},decls:18,vars:5,consts:[[1,"row"],[1,"col","m12","s12"],[1,"mat-elevation-z4","fullWidth"],["novalidate","",3,"ngSubmit"],["frmReplicaArticulosSedes","ngForm"],[1,"fullWidth"],["name","sede","multiple","","required","",3,"ngModel","ngModelChange"],[3,"value","disabled",4,"ngFor","ngForOf"],["align","end"],["mat-raised-button","","type","submit","color","accent",1,"btnAccion",3,"disabled"],[4,"ngIf"],[3,"value","disabled"]],template:function(t,e){if(1&t){const t=y.Ub();y.Tb(0,"div",0),y.Tb(1,"div",1),y.Tb(2,"mat-card",2),y.Tb(3,"mat-card-title"),y.Tb(4,"h4"),y.Dc(5),y.Sb(),y.Sb(),y.Tb(6,"mat-card-content"),y.Tb(7,"form",3,4),y.bc("ngSubmit",function(){return y.wc(t),y.tc(8).form.valid&&e.onSubmit()}),y.Tb(9,"mat-form-field",5),y.Tb(10,"mat-label"),y.Dc(11,"Sede"),y.Sb(),y.Tb(12,"mat-select",6),y.bc("ngModelChange",function(t){return e.params.sede=t}),y.Cc(13,ni,2,3,"mat-option",7),y.Sb(),y.Sb(),y.Tb(14,"div",8),y.Tb(15,"button",9),y.Dc(16," Replicar "),y.Sb(),y.Sb(),y.Sb(),y.Cc(17,ci,1,0,"app-cargando",10),y.Sb(),y.Sb(),y.Sb(),y.Sb()}if(2&t){const t=y.tc(8);y.Cb(5),y.Fc("Replicar ",(null==e.articulo?null:e.articulo.descripcion)||"TODOS los art\xedculos"," a las sedes"),y.Cb(7),y.lc("ngModel",e.params.sede),y.Cb(1),y.lc("ngForOf",e.sedes),y.Cb(2),y.lc("disabled",!t.form.valid||e.cargando),y.Cb(2),y.lc("ngIf",e.cargando)}},directives:[d.a,d.h,d.c,c.r,c.l,c.m,l.b,l.e,m.a,c.p,c.k,c.n,i.l,h.a,i.m,U.k,ii.a],styles:[""]}),t})(),ai=(()=>{class t{constructor(t,e){this.dialogRef=t,this.data=e,this.articulo=null}ngOnInit(){this.data.articulo&&(this.articulo=this.data.articulo)}}return t.\u0275fac=function(e){return new(e||t)(y.Nb(M.f),y.Nb(M.a))},t.\u0275cmp=y.Hb({type:t,selectors:[["app-replicar-a-sedes-dialog"]],decls:5,vars:1,consts:[["mat-dialog-content",""],[3,"articulo"],["mat-dialog-actions","","align","end"],["mat-raised-button","","type","button","color","accent",3,"click"]],template:function(t,e){1&t&&(y.Tb(0,"div",0),y.Ob(1,"app-replicar-asedes",1),y.Sb(),y.Tb(2,"div",2),y.Tb(3,"button",3),y.bc("click",function(){return e.dialogRef.close()}),y.Dc(4," Terminar "),y.Sb(),y.Sb()),2&t&&(y.Cb(1),y.lc("articulo",e.articulo))},directives:[M.d,ri,M.c,h.a],styles:[""]}),t})();var si=o("pJXi"),li=o("1wH6"),bi=o("FHMA");function di(t,e){if(1&t){const t=y.Ub();y.Tb(0,"button",5),y.bc("click",function(){return y.wc(t),y.fc().showArticuloForm=!0}),y.Tb(1,"mat-icon",6),y.Dc(2,"expand_more"),y.Sb(),y.Sb()}}function ui(t,e){if(1&t){const t=y.Ub();y.Tb(0,"button",5),y.bc("click",function(){return y.wc(t),y.fc().showArticuloForm=!1}),y.Tb(1,"mat-icon",6),y.Dc(2,"expand_less"),y.Sb(),y.Sb()}}function gi(t,e){if(1&t){const t=y.Ub();y.Tb(0,"mat-form-field",10),y.Tb(1,"input",26),y.bc("ngModelChange",function(e){return y.wc(t),y.fc(2).articulo.descripcion=e}),y.Sb(),y.Sb()}if(2&t){const t=y.fc(2);y.Cb(1),y.lc("ngModel",t.articulo.descripcion)}}function fi(t,e){if(1&t){const t=y.Ub();y.Tb(0,"mat-form-field",10),y.Tb(1,"input",27),y.bc("ngModelChange",function(e){return y.wc(t),y.fc(2).articulo.precio=e}),y.Sb(),y.Sb()}if(2&t){const t=y.fc(2);y.Cb(1),y.lc("ngModel",t.articulo.precio)}}function mi(t,e){if(1&t&&(y.Tb(0,"mat-option",28),y.Dc(1),y.Sb()),2&t){const t=e.$implicit;y.lc("value",t.presentacion),y.Cb(1),y.Fc(" ",t.descripcion," ")}}function pi(t,e){if(1&t&&(y.Tb(0,"mat-option",28),y.Dc(1),y.Sb()),2&t){const t=e.$implicit;y.lc("value",t.presentacion),y.Cb(1),y.Fc(" ",t.descripcion," ")}}function hi(t,e){if(1&t){const t=y.Ub();y.Tb(0,"mat-form-field",10),y.Tb(1,"input",29),y.bc("ngModelChange",function(e){return y.wc(t),y.fc(2).articulo.codigo=e}),y.Sb(),y.Sb()}if(2&t){const t=y.fc(2);y.Cb(1),y.lc("ngModel",t.articulo.codigo)}}function Ci(t,e){if(1&t){const t=y.Ub();y.Tb(0,"mat-form-field",10),y.Tb(1,"input",30),y.bc("ngModelChange",function(e){return y.wc(t),y.fc(2).articulo.shopify_id=e}),y.Sb(),y.Sb()}if(2&t){const t=y.fc(2);y.Cb(1),y.lc("ngModel",t.articulo.shopify_id)}}function Si(t,e){if(1&t&&(y.Tb(0,"mat-option",28),y.Dc(1),y.gc(2,"number"),y.Sb()),2&t){const t=e.$implicit;y.lc("value",t.impuesto_especial),y.Cb(1),y.Gc(" ",t.descripcion," (",y.ic(2,3,t.porcentaje,"1.2-2"),"%) ")}}function vi(t,e){if(1&t){const t=y.Ub();y.Tb(0,"mat-form-field",10),y.Tb(1,"input",31),y.bc("ngModelChange",function(e){return y.wc(t),y.fc(2).articulo.rendimiento=e}),y.Sb(),y.Sb()}if(2&t){const t=y.fc(2);y.Cb(1),y.lc("ngModel",t.articulo.rendimiento)}}function Ti(t,e){if(1&t){const t=y.Ub();y.Tb(0,"mat-form-field",10),y.Tb(1,"input",32),y.bc("ngModelChange",function(e){return y.wc(t),y.fc(2).articulo.cantidad_minima=e}),y.Sb(),y.Sb()}if(2&t){const t=y.fc(2);y.Cb(1),y.lc("ngModel",t.articulo.cantidad_minima)}}function Di(t,e){if(1&t){const t=y.Ub();y.Tb(0,"mat-form-field",10),y.Tb(1,"input",33),y.bc("ngModelChange",function(e){return y.wc(t),y.fc(2).articulo.cantidad_maxima=e}),y.Sb(),y.Sb()}if(2&t){const t=y.fc(2);y.Cb(1),y.lc("ngModel",t.articulo.cantidad_maxima)}}function Mi(t,e){if(1&t){const t=y.Ub();y.Tb(0,"button",34),y.bc("click",function(){return y.wc(t),y.fc(2).replicarASedes()}),y.Dc(1," Replicar a sedes "),y.Sb()}}function Ii(t,e){if(1&t){const t=y.Ub();y.Tb(0,"button",35),y.bc("click",function(){return y.wc(t),y.fc(2).resetArticulo()}),y.Dc(1," Nuevo "),y.Sb()}}function wi(t,e){if(1&t){const t=y.Ub();y.Tb(0,"form",7,8),y.bc("ngSubmit",function(){y.wc(t);const e=y.tc(1),o=y.fc();return e.form.valid&&o.onSubmit()}),y.Cc(2,gi,2,1,"mat-form-field",9),y.Cc(3,fi,2,1,"mat-form-field",9),y.Tb(4,"mat-form-field",10),y.Tb(5,"mat-label"),y.Dc(6,"Presentaci\xf3n Venta"),y.Sb(),y.Tb(7,"mat-select",11),y.bc("ngModelChange",function(e){return y.wc(t),y.fc().articulo.presentacion=e}),y.Cc(8,mi,2,2,"mat-option",12),y.Sb(),y.Sb(),y.Tb(9,"mat-form-field",10),y.Tb(10,"mat-label"),y.Dc(11,"Presentaci\xf3n Reportes"),y.Sb(),y.Tb(12,"mat-select",13),y.bc("ngModelChange",function(e){return y.wc(t),y.fc().articulo.presentacion_reporte=e}),y.Cc(13,pi,2,2,"mat-option",12),y.Sb(),y.Sb(),y.Cc(14,hi,2,1,"mat-form-field",9),y.Cc(15,Ci,2,1,"mat-form-field",9),y.Tb(16,"mat-form-field",10),y.Tb(17,"mat-label"),y.Dc(18,"Impuesto Especial"),y.Sb(),y.Tb(19,"mat-select",14),y.bc("ngModelChange",function(e){return y.wc(t),y.fc().articulo.impuesto_especial=e}),y.Cc(20,Si,3,6,"mat-option",12),y.Sb(),y.Sb(),y.Cc(21,vi,2,1,"mat-form-field",9),y.Cc(22,Ti,2,1,"mat-form-field",9),y.Cc(23,Di,2,1,"mat-form-field",9),y.Tb(24,"div",15),y.Tb(25,"div",16),y.Tb(26,"mat-checkbox",17),y.bc("ngModelChange",function(e){return y.wc(t),+(y.fc().articulo.produccion=e)}),y.Dc(27,"\xbfEs produccion?"),y.Sb(),y.Sb(),y.Tb(28,"div",16),y.Tb(29,"mat-checkbox",18),y.bc("ngModelChange",function(e){return y.wc(t),+(y.fc().articulo.mostrar_pos=e)}),y.Dc(30,"Mostrar en POS"),y.Sb(),y.Sb(),y.Tb(31,"div",16),y.Tb(32,"mat-checkbox",19),y.bc("ngModelChange",function(e){return y.wc(t),+(y.fc().articulo.combo=e)}),y.Dc(33,"Combo"),y.Sb(),y.Sb(),y.Tb(34,"div",16),y.Tb(35,"mat-checkbox",20),y.bc("ngModelChange",function(e){return y.wc(t),+(y.fc().articulo.multiple=e)}),y.Dc(36,"Opcion multiple"),y.Sb(),y.Sb(),y.Sb(),y.Tb(37,"div",15),y.Tb(38,"div",16),y.Tb(39,"mat-checkbox",21),y.bc("ngModelChange",function(e){return y.wc(t),+(y.fc().articulo.mostrar_inventario=e)}),y.Dc(40,"Mostrar en Inventario"),y.Sb(),y.Sb(),y.Sb(),y.Tb(41,"div",22),y.Tb(42,"button",23),y.Dc(43," Guardar "),y.Sb(),y.Cc(44,Mi,2,0,"button",24),y.Cc(45,Ii,2,0,"button",25),y.Sb(),y.Sb()}if(2&t){const t=y.tc(1),e=y.fc();y.Cb(2),y.lc("ngIf",e.esMovil),y.Cb(1),y.lc("ngIf",e.esMovil),y.Cb(4),y.lc("ngModel",e.articulo.presentacion),y.Cb(1),y.lc("ngForOf",e.presentaciones),y.Cb(4),y.lc("ngModel",e.articulo.presentacion_reporte),y.Cb(1),y.lc("ngForOf",e.presentaciones),y.Cb(1),y.lc("ngIf",e.esMovil),y.Cb(1),y.lc("ngIf",e.esMovil),y.Cb(4),y.lc("ngModel",e.articulo.impuesto_especial),y.Cb(1),y.lc("ngForOf",e.impuestosEspeciales),y.Cb(1),y.lc("ngIf",1==+e.articulo.produccion),y.Cb(1),y.lc("ngIf",1==+e.articulo.multiple||+e.articulo.combo),y.Cb(1),y.lc("ngIf",1==+e.articulo.multiple||+e.articulo.combo),y.Cb(3),y.lc("ngModel",+e.articulo.produccion),y.Cb(3),y.lc("ngModel",+e.articulo.mostrar_pos),y.Cb(3),y.lc("ngModel",+e.articulo.combo),y.Cb(3),y.lc("ngModel",+e.articulo.multiple),y.Cb(4),y.lc("ngModel",+e.articulo.mostrar_inventario),y.Cb(3),y.lc("disabled",!t.form.valid||!e.articulo.categoria_grupo),y.Cb(2),y.lc("ngIf",e.articulo.articulo),y.Cb(1),y.lc("ngIf",e.articulo.articulo)}}function _i(t,e){1&t&&y.Ob(0,"hr")}function ki(t,e){if(1&t){const t=y.Ub();y.Tb(0,"button",5),y.bc("click",function(){return y.wc(t),y.fc(2).showDetalleForm=!0}),y.Tb(1,"mat-icon",6),y.Dc(2,"expand_more"),y.Sb(),y.Sb()}}function Oi(t,e){if(1&t){const t=y.Ub();y.Tb(0,"button",5),y.bc("click",function(){return y.wc(t),y.fc(2).showDetalleForm=!1}),y.Tb(1,"mat-icon",6),y.Dc(2,"expand_less"),y.Sb(),y.Sb()}}function Fi(t,e){if(1&t&&(y.Tb(0,"mat-option",28),y.Dc(1),y.Sb()),2&t){const t=e.$implicit;y.lc("value",t),y.Cb(1),y.Fc(" ",t.descripcion," ")}}function xi(t,e){if(1&t){const t=y.Ub();y.Tb(0,"mat-form-field",10),y.Tb(1,"input",45),y.bc("ngModelChange",function(e){return y.wc(t),y.fc(3).receta.cantidad=e}),y.Sb(),y.Sb()}if(2&t){const t=y.fc(3);y.Cb(1),y.lc("ngModel",t.receta.cantidad)}}function yi(t,e){if(1&t){const t=y.Ub();y.Tb(0,"mat-form-field",10),y.Tb(1,"input",46),y.bc("ngModelChange",function(e){return y.wc(t),y.fc(3).receta.precio=e}),y.Sb(),y.Sb()}if(2&t){const t=y.fc(3);y.Cb(1),y.lc("ngModel",t.receta.precio)}}function Ei(t,e){if(1&t&&(y.Tb(0,"mat-option",28),y.Dc(1),y.Sb()),2&t){const t=e.$implicit;y.lc("value",t.medida),y.Cb(1),y.Fc(" ",t.descripcion," ")}}function Ai(t,e){if(1&t){const t=y.Ub();y.Tb(0,"button",35),y.bc("click",function(){return y.wc(t),y.fc(3).resetReceta()}),y.Dc(1," Nuevo "),y.Sb()}}function Pi(t,e){if(1&t){const t=y.Ub();y.Tb(0,"button",35),y.bc("click",function(){return y.wc(t),y.fc(3).imprimirReceta()}),y.Dc(1," Imprimir "),y.Sb()}}const Bi=function(){return{standalone:!0}};function $i(t,e){if(1&t){const t=y.Ub();y.Tb(0,"form",7,38),y.bc("ngSubmit",function(){y.wc(t);const e=y.tc(1),o=y.fc(2);return e.form.valid&&o.onSubmitDetail()}),y.Tb(2,"mat-form-field",10),y.Tb(3,"mat-label"),y.Dc(4,"Art\xedculo"),y.Sb(),y.Tb(5,"input",39),y.bc("ngModelChange",function(e){return y.wc(t),y.fc(2).txtArticuloSelected=e})("keyup",function(){y.wc(t);const e=y.fc(2);return e.filtrarArticulos(e.txtArticuloSelected)}),y.Sb(),y.Tb(6,"mat-autocomplete",40,41),y.Cc(8,Fi,2,2,"mat-option",12),y.Sb(),y.Sb(),y.Cc(9,xi,2,1,"mat-form-field",9),y.Cc(10,yi,2,1,"mat-form-field",9),y.Tb(11,"mat-form-field",10),y.Tb(12,"mat-label"),y.Dc(13,"Unidad de medida"),y.Sb(),y.Tb(14,"mat-select",42),y.bc("ngModelChange",function(e){return y.wc(t),y.fc(2).receta.medida=e}),y.Cc(15,Ei,2,2,"mat-option",12),y.Sb(),y.Sb(),y.Tb(16,"div",15),y.Tb(17,"div",16),y.Tb(18,"mat-checkbox",43),y.bc("ngModelChange",function(e){return y.wc(t),+(y.fc(2).receta.racionable=e)}),y.Dc(19,"\xbfEs racionable?"),y.Sb(),y.Sb(),y.Tb(20,"div",16),y.Tb(21,"mat-checkbox",44),y.bc("ngModelChange",function(e){return y.wc(t),+(y.fc(2).receta.precio_extra=e)}),y.Dc(22," Precio Extra "),y.Sb(),y.Sb(),y.Sb(),y.Tb(23,"div",22),y.Tb(24,"button",23),y.Dc(25," Guardar "),y.Sb(),y.Cc(26,Ai,2,0,"button",25),y.Cc(27,Pi,2,0,"button",25),y.Sb(),y.Sb()}if(2&t){const t=y.tc(1),e=y.tc(7),o=y.fc(2);y.Cb(5),y.lc("ngModel",o.txtArticuloSelected)("ngModelOptions",y.nc(14,Bi))("matAutocomplete",e),y.Cb(1),y.lc("displayWith",o.displayArticulo),y.Cb(2),y.lc("ngForOf",o.filteredArticulos),y.Cb(1),y.lc("ngIf",o.esMovil),y.Cb(1),y.lc("ngIf",o.receta.precio_extra&&o.receta.precio_extra>0),y.Cb(4),y.lc("ngModel",o.receta.medida),y.Cb(1),y.lc("ngForOf",o.medidas),y.Cb(3),y.lc("ngModel",+o.receta.racionable),y.Cb(3),y.lc("ngModel",+o.receta.precio_extra),y.Cb(3),y.lc("disabled",!t.form.valid),y.Cb(2),y.lc("ngIf",o.receta.articulo_detalle),y.Cb(1),y.lc("ngIf",o.recetas.length>0)}}function Ri(t,e){1&t&&y.Ob(0,"hr")}function Ui(t,e){1&t&&(y.Tb(0,"th",58),y.Dc(1,"Art\xedculo"),y.Sb())}function Ni(t,e){if(1&t&&(y.Tb(0,"td",59),y.Dc(1),y.Sb()),2&t){const t=e.$implicit;y.Cb(1),y.Ec(t.articulo.descripcion)}}function Hi(t,e){1&t&&(y.Tb(0,"th",60),y.Dc(1,"Cantidad"),y.Sb())}function ji(t,e){if(1&t&&(y.Tb(0,"td",61),y.Dc(1),y.gc(2,"number"),y.Sb()),2&t){const t=e.$implicit;y.Cb(1),y.Ec(y.ic(2,1,t.cantidad,"1.2-2"))}}function zi(t,e){1&t&&(y.Tb(0,"th",60),y.Dc(1,"Unida de medida"),y.Sb())}function Gi(t,e){if(1&t&&(y.Tb(0,"td",61),y.Dc(1),y.Sb()),2&t){const t=e.$implicit;y.Cb(1),y.Ec(t.medida.descripcion)}}function qi(t,e){1&t&&(y.Tb(0,"th",58),y.Dc(1,"\xa0"),y.Sb())}function Wi(t,e){if(1&t){const t=y.Ub();y.Tb(0,"td",59),y.Tb(1,"button",34),y.bc("click",function(){y.wc(t);const o=e.$implicit;return y.fc(3).getReceta(o.receta,o.articulo_detalle)}),y.Dc(2," Editar "),y.Sb(),y.Tb(3,"button",35),y.bc("click",function(){y.wc(t);const o=e.$implicit;return y.fc(3).eliminaReceta(o)}),y.Dc(4," Eliminar "),y.Sb(),y.Sb()}}function Li(t,e){1&t&&y.Ob(0,"tr",62)}function Vi(t,e){1&t&&y.Ob(0,"tr",63)}function Qi(t,e){if(1&t&&(y.Tb(0,"table",47),y.Rb(1,48),y.Cc(2,Ui,2,0,"th",49),y.Cc(3,Ni,2,1,"td",50),y.Qb(),y.Rb(4,51),y.Cc(5,Hi,2,0,"th",52),y.Cc(6,ji,3,4,"td",53),y.Qb(),y.Rb(7,54),y.Cc(8,zi,2,0,"th",52),y.Cc(9,Gi,2,1,"td",53),y.Qb(),y.Rb(10,55),y.Cc(11,qi,2,0,"th",49),y.Cc(12,Wi,5,0,"td",50),y.Qb(),y.Cc(13,Li,1,0,"tr",56),y.Cc(14,Vi,1,0,"tr",57),y.Sb()),2&t){const t=y.fc(2);y.lc("dataSource",t.dataSource),y.Cb(13),y.lc("matHeaderRowDef",t.displayedColumns),y.Cb(1),y.lc("matRowDefColumns",t.displayedColumns)}}function Xi(t,e){if(1&t){const t=y.Ub();y.Tb(0,"mat-card",0),y.Tb(1,"mat-card-title"),y.Tb(2,"h4"),y.Dc(3),y.Cc(4,ki,3,0,"button",1),y.Cc(5,Oi,3,0,"button",1),y.Sb(),y.Sb(),y.Tb(6,"mat-card-content"),y.Cc(7,$i,28,15,"form",2),y.Cc(8,Ri,1,0,"hr",3),y.Tb(9,"mat-form-field",10),y.Tb(10,"input",36),y.bc("keyup",function(e){return y.wc(t),y.fc().applyFilter(e.target.value)}),y.Sb(),y.Sb(),y.Cc(11,Qi,15,3,"table",37),y.Sb(),y.Sb()}if(2&t){const t=y.fc();y.Cb(3),y.Fc(" Detalle del art\xedculo ",t.articulo.descripcion," "),y.Cb(1),y.lc("ngIf",!t.showDetalleForm),y.Cb(1),y.lc("ngIf",t.showDetalleForm),y.Cb(2),y.lc("ngIf",t.showDetalleForm),y.Cb(1),y.lc("ngIf",t.recetas.length>0),y.Cb(3),y.lc("ngIf",t.recetas.length>0)}}let Ki=(()=>{class t{constructor(t,e,o,i,n,c,r,a){this.dialog=t,this.snackBar=e,this.ls=o,this.articuloSrvc=i,this.medidaSrvc=n,this.presentacionSrvc=c,this.impuestoEspecialSrvc=r,this.rptSrvc=a,this.articuloSvd=new y.o,this.titulo="Receta",this.showArticuloForm=!0,this.medidas=[],this.presentaciones=[],this.articulos=[],this.filteredArticulos=[],this.recetas=[],this.impuestosEspeciales=[],this.showDetalleForm=!0,this.displayedColumns=["articulo","cantidad","medida","editItem"],this.esMovil=!1,this.txtArticuloSelected=void 0,this.resetArticulo=()=>{this.articulo={articulo:null,categoria_grupo:this.articulo.categoria_grupo,presentacion:null,descripcion:null,precio:null,bien_servicio:"B",produccion:0,mostrar_pos:1,presentacion_reporte:null,impuesto_especial:null,shopify_id:null,multiple:0,cantidad_minima:1,cantidad_maxima:1,combo:0,rendimiento:0,mostrar_inventario:0},this.recetas=[],this.resetReceta()},this.setArticuloCategoriaGrupo=t=>this.articulo.categoria_grupo=+t,this.onSubmit=()=>{this.articuloSrvc.saveArticulo(this.articulo).subscribe(t=>{t.exito?(this.articuloSvd.emit(),this.resetArticulo(),this.articulo=t.articulo,this.loadRecetas(this.articulo.articulo),this.loadArticulos(),this.snackBar.open("Articulo guardado con \xe9xito...","Articulo",{duration:3e3})):this.snackBar.open(`ERROR: ${t.mensaje}`,"Articulo",{duration:3e3})})},this.loadMedidas=()=>{this.medidaSrvc.get().subscribe(t=>{t&&(this.medidas=t)})},this.loadPresentaciones=()=>{this.presentacionSrvc.get().subscribe(t=>{t&&(this.presentaciones=t)})},this.loadArticulos=()=>{this.articuloSrvc.getArticulos().subscribe(t=>{t&&(this.articulos=t)})},this.loadImpuestosEspeciales=()=>{this.impuestoEspecialSrvc.get().subscribe(t=>{t&&(this.impuestosEspeciales=t)})},this.displayArticulo=t=>{if(t)return this.receta.articulo=t.articulo,t.descripcion},this.filtrarArticulos=t=>{if(t&&"string"==typeof t){const e=t.toLowerCase();this.filteredArticulos=this.articulos.filter(t=>t.descripcion.toLowerCase().includes(e))}else this.filteredArticulos=this.articulos},this.resetReceta=()=>{this.receta={articulo_detalle:null,receta:this.articulo.articulo||0,racionable:0,articulo:null,cantidad:1,medida:null,anulado:0,precio_extra:0,precio:0},this.txtArticuloSelected=void 0,this.updateTableDataSource()},this.loadRecetas=(t=+this.articulo.articulo)=>{this.articuloSrvc.getArticuloDetalle(+t,{receta:+t}).subscribe(t=>{t&&(this.recetas=t,this.updateTableDataSource())})},this.getReceta=(t=+this.articulo.articulo,e)=>{this.articuloSrvc.getArticuloDetalle(t,{articulo_detalle:e}).subscribe(t=>{t&&(this.receta={articulo_detalle:t[0].articulo_detalle,receta:t[0].receta.articulo,racionable:t[0].articulo.articulo,articulo:t[0].articulo.articulo,cantidad:+t[0].cantidad,medida:t[0].medida.medida,anulado:t[0].anulado||0,precio_extra:t[0].precio_extra||0,precio:+t[0].precio},this.txtArticuloSelected=t[0].articulo,this.showDetalleForm=!0)})},this.eliminaReceta=t=>{this.dialog.open(ei.a,{maxWidth:"400px",data:new ei.b("Eliminar detalle",`\xbfDesea eliminar '${t.cantidad} de ${t.articulo.descripcion}' de la receta?`,"S\xed","No")}).afterClosed().subscribe(e=>{e&&(t.anulado=1,t.articulo=t.articulo.articulo,this.articuloSrvc.saveArticuloDetalle(t).subscribe(t=>{this.loadRecetas(),this.resetReceta()}))})},this.onSubmitDetail=()=>{this.receta.receta=this.articulo.articulo,this.articuloSrvc.saveArticuloDetalle(this.receta).subscribe(t=>{t&&(t.exito?(this.loadRecetas(),this.resetReceta()):this.snackBar.open(`ERROR: ${t.mensaje}`,"Articulo",{duration:3e3}))})},this.imprimirReceta=()=>{this.rptSrvc.imprimirReceta(this.articulo.articulo).subscribe(t=>{if(t){const e=new Blob([t],{type:"application/pdf"});Object(ti.saveAs)(e,`${this.titulo}_${this.articulo.descripcion}.pdf`)}else this.snackBar.open("No se pudo generar el reporte...",this.titulo,{duration:3e3})})},this.updateTableDataSource=()=>{this.dataSource=new f.k(this.recetas),this.dataSource.filterPredicate=(t,e)=>t.articulo.descripcion.toLowerCase().includes(e)},this.replicarASedes=()=>{this.dialog.open(ai,{width:"50%",data:{articulo:this.articulo}}).afterClosed().subscribe(t=>{})},this.applyFilter=t=>{this.dataSource.filter=t.toLocaleLowerCase()}}ngOnInit(){this.esMovil=this.ls.get(F.a.usrTokenVar).enmovil||!1,this.resetArticulo(),this.loadMedidas(),this.loadArticulos(),this.loadPresentaciones(),this.loadImpuestosEspeciales()}}return t.\u0275fac=function(e){return new(e||t)(y.Nb(M.b),y.Nb(C.a),y.Nb(E.a),y.Nb(W.a),y.Nb(si.a),y.Nb(L.a),y.Nb(li.a),y.Nb(bi.a))},t.\u0275cmp=y.Hb({type:t,selectors:[["app-form-producto"]],inputs:{articulo:"articulo"},outputs:{articuloSvd:"articuloSvd"},decls:10,vars:6,consts:[[1,"mat-elevation-z4","fullWidth"],["mat-icon-button","","type","button","color","accent",3,"click",4,"ngIf"],["novalidate","",3,"ngSubmit",4,"ngIf"],[4,"ngIf"],["class","mat-elevation-z4 fullWidth",4,"ngIf"],["mat-icon-button","","type","button","color","accent",3,"click"],[1,"iconFontSize"],["novalidate","",3,"ngSubmit"],["frmArticulo","ngForm"],["class","fullWidth",4,"ngIf"],[1,"fullWidth"],["name","presentacion","required","",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["name","presentacion_reporte","required","",3,"ngModel","ngModelChange"],["name","impuesto_especial",3,"ngModel","ngModelChange"],[1,"row"],[1,"col","m3","s3"],["name","produccion",1,"example-margin",3,"ngModel","ngModelChange"],["name","mostrar_pos",1,"example-margin",3,"ngModel","ngModelChange"],["name","combo",1,"example-margin",3,"ngModel","ngModelChange"],["name","multiple",1,"example-margin",3,"ngModel","ngModelChange"],["name","mostrar_inventario",1,"example-margin",3,"ngModel","ngModelChange"],["align","end"],["mat-raised-button","","type","submit","color","accent",1,"btnAccion",3,"disabled"],["mat-raised-button","","type","button","color","accent","class","btnAccion",3,"click",4,"ngIf"],["mat-raised-button","","type","button","color","accent",3,"click",4,"ngIf"],["matInput","","type","text","placeholder","Descripcion","name","descripcion","required","",3,"ngModel","ngModelChange"],["matInput","","type","number","placeholder","Precio","name","precio","required","",3,"ngModel","ngModelChange"],[3,"value"],["matInput","","type","text","placeholder","C\xf3digo","name","codigo","required","",3,"ngModel","ngModelChange"],["matInput","","type","text","placeholder","Shopify ID","name","shopify_id",3,"ngModel","ngModelChange"],["matInput","","type","number","step","0.05","placeholder","Rendimiento","name","rendimiento","required","",3,"ngModel","ngModelChange"],["matInput","","type","number","step","1","placeholder","Cantidad minima","name","minima","required","",3,"ngModel","ngModelChange"],["matInput","","type","number","step","1","placeholder","Cantidad maxima","name","maxima","required","",3,"ngModel","ngModelChange"],["mat-raised-button","","type","button","color","accent",1,"btnAccion",3,"click"],["mat-raised-button","","type","button","color","accent",3,"click"],["matInput","","placeholder","Buscar",3,"keyup"],["mat-table","","class","mat-elevation-z4 full-width",3,"dataSource",4,"ngIf"],["frmDetalleArticulo","ngForm"],["type","text","placeholder","Art\xedculo","matInput","","required","",3,"ngModel","ngModelOptions","matAutocomplete","ngModelChange","keyup"],[3,"displayWith"],["autoArticulos","matAutocomplete"],["name","medida","required","",3,"ngModel","ngModelChange"],["name","racionable",1,"fullWidth",3,"ngModel","ngModelChange"],["name","extra",1,"fullWidth",3,"ngModel","ngModelChange"],["matInput","","placeholder","Cantidad","name","cantidad","required","",3,"ngModel","ngModelChange"],["matInput","","placeholder","Precio","name","precio","required","",3,"ngModel","ngModelChange"],["mat-table","",1,"mat-elevation-z4","full-width",3,"dataSource"],["matColumnDef","articulo"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","","class","text-wrap",4,"matCellDef"],["matColumnDef","cantidad"],["mat-header-cell","","class","text-right",4,"matHeaderCellDef"],["mat-cell","","class","text-right",4,"matCellDef"],["matColumnDef","medida"],["matColumnDef","editItem"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell","",1,"text-wrap"],["mat-header-cell","",1,"text-right"],["mat-cell","",1,"text-right"],["mat-header-row",""],["mat-row",""]],template:function(t,e){1&t&&(y.Tb(0,"mat-card",0),y.Tb(1,"mat-card-title"),y.Tb(2,"h4"),y.Dc(3),y.Cc(4,di,3,0,"button",1),y.Cc(5,ui,3,0,"button",1),y.Sb(),y.Sb(),y.Tb(6,"mat-card-content"),y.Cc(7,wi,46,21,"form",2),y.Sb(),y.Sb(),y.Cc(8,_i,1,0,"hr",3),y.Cc(9,Xi,12,6,"mat-card",4)),2&t&&(y.Cb(3),y.Fc(" Art\xedculo ",e.articulo.articulo?e.articulo.descripcion:""," "),y.Cb(1),y.lc("ngIf",!e.showArticuloForm),y.Cb(1),y.lc("ngIf",e.showArticuloForm),y.Cb(2),y.lc("ngIf",e.showArticuloForm),y.Cb(1),y.lc("ngIf",e.articulo.articulo),y.Cb(1),y.lc("ngIf",e.articulo.articulo))},directives:[d.a,d.h,i.m,d.c,h.a,s.a,c.r,c.l,c.m,l.b,l.e,m.a,c.p,c.k,c.n,i.l,p.a,b.b,c.c,c.o,U.k,_.c,_.a,f.j,f.c,f.e,f.b,f.g,f.i,f.d,f.a,f.f,f.h],pipes:[i.f],styles:[".full-width[_ngcontent-%COMP%]{width:100%}.iconFontSize[_ngcontent-%COMP%]{font-size:24pt}"]}),t})();const Ji=["lstProducto"],Zi=["frmProducto"];let Yi=(()=>{class t{constructor(t){this.articuloSrvc=t,this.setArticulo=t=>{this.articuloSrvc.getArticulo({articulo:t.id}).subscribe(t=>{if(t&&t.length>0){const e=t[0];this.articulo={articulo:+e.articulo,categoria_grupo:+e.categoria_grupo.categoria_grupo,presentacion:e.presentacion.presentacion,descripcion:e.descripcion,precio:+e.precio,codigo:e.codigo,produccion:e.produccion,presentacion_reporte:e.presentacion_reporte.presentacion,mostrar_pos:e.mostrar_pos,impuesto_especial:e.impuesto_especial,shopify_id:e.shopify_id,multiple:e.multiple,cantidad_minima:e.cantidad_minima,cantidad_maxima:e.cantidad_maxima,combo:e.combo,rendimiento:e.rendimiento,mostrar_inventario:e.mostrar_inventario},this.frmProductoComponent.loadRecetas(+this.articulo.articulo),this.frmProductoComponent.resetReceta()}})},this.setArticuloCategoriaGrupo=t=>{this.articulo.categoria_grupo=+t,this.frmProductoComponent.setArticuloCategoriaGrupo(+t)},this.refreshArticuloList=t=>{this.lstProductoComponent.loadArbolArticulos()},this.articulo={articulo:null,categoria_grupo:null,presentacion:null,descripcion:null,precio:null,bien_servicio:"B",produccion:0,presentacion_reporte:null,mostrar_pos:0,impuesto_especial:null,rendimiento:1,mostrar_inventario:0}}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)(y.Nb(W.a))},t.\u0275cmp=y.Hb({type:t,selectors:[["app-producto"]],viewQuery:function(t,e){if(1&t&&(y.Ic(Ji,1),y.Ic(Zi,1)),2&t){let t;y.sc(t=y.cc())&&(e.lstProductoComponent=t.first),y.sc(t=y.cc())&&(e.frmProductoComponent=t.first)}},decls:8,vars:2,consts:[[1,"row"],[1,"col","m5","s12"],[3,"categoriaGrupoSvd","onChangeSubCategoriaEv"],[3,"treeHeight","productoClickedEv"],["lstProducto",""],[1,"col","m7","s12"],[3,"articulo","articuloSvd"],["frmProducto",""]],template:function(t,e){1&t&&(y.Tb(0,"div",0),y.Tb(1,"div",1),y.Tb(2,"app-categoria-producto",2),y.bc("categoriaGrupoSvd",function(t){return e.refreshArticuloList(t)})("onChangeSubCategoriaEv",function(t){return e.setArticuloCategoriaGrupo(t)}),y.Sb(),y.Tb(3,"app-lista-producto",3,4),y.bc("productoClickedEv",function(t){return e.setArticulo(t)}),y.Sb(),y.Sb(),y.Tb(5,"div",5),y.Tb(6,"app-form-producto",6,7),y.bc("articuloSvd",function(t){return e.refreshArticuloList(t)}),y.Sb(),y.Sb(),y.Sb()),2&t&&(y.Cb(3),y.lc("treeHeight","100%"),y.Cb(3),y.lc("articulo",e.articulo))},directives:[Wo,Yo,Ki],styles:[""]}),t})();const tn=["frmEgreso"],en=["frmIngreso"];let on=(()=>{class t{constructor(t,e,o){this.ls=t,this._snackBar=e,this.transformacionSrvc=o,this.mermaDetalle=[],this.showMerma=!0,this.transformar=()=>{this.egreso=this.frmEgreso.egreso,this.ingreso=this.frmIngreso.ingreso,this.transformacion={egreso:{tipo_movimiento:this.egreso.tipo_movimiento,fecha:this.egreso.fecha,proveedor:this.ingreso.proveedor,bodega:this.egreso.bodega,usuario:this.egreso.usuario,estatus_movimiento:this.egreso.estatus_movimiento,bodega_destino:this.egreso.bodega_destino,tipo_movimiento_destino:this.egreso.tipo_movimiento_destino,detalle:[]},ingreso:{tipo_movimiento:this.ingreso.tipo_movimiento,fecha:this.ingreso.fecha,proveedor:this.ingreso.proveedor,bodega:this.ingreso.bodega,usuario:this.ingreso.usuario,bodega_origen:this.ingreso.bodega_origen,comentario:this.ingreso.comentario,detalle:[]},merma:[]},this.frmEgreso.detallesMerma.forEach(t=>this.transformacion.merma.push({articulo:t.articulo,cantidad:t.cantidad,precio_unitario:t.precio_unitario,precio_total:t.precio_total,presentacion:t.presentacion})),this.frmEgreso.detallesEgreso.forEach(t=>this.transformacion.egreso.detalle.push({articulo:t.articulo,cantidad:t.cantidad,precio_unitario:t.precio_unitario,precio_total:t.precio_total,presentacion:t.presentacion})),this.frmIngreso.detallesIngreso.forEach(t=>this.transformacion.ingreso.detalle.push({articulo:t.articulo,cantidad:t.cantidad,precio_unitario:t.precio_unitario,precio_total:t.precio_total,presentacion:t.presentacion})),this.transformacion.egreso&&this.transformacion.egreso.detalle&&this.transformacion.egreso.detalle.length>0&&this.transformacion.ingreso&&this.transformacion.ingreso.detalle&&this.transformacion.ingreso.detalle.length>0?this.transformacionSrvc.transformar(this.transformacion).subscribe(t=>{t.exito?(this.frmEgreso.resetEgreso(),this.frmEgreso.detallesEgreso=[],this.frmIngreso.resetIngreso(),this.frmIngreso.detallesIngreso=[],this._snackBar.open("Transformaci\xf3n generada con \xe9xito...","Transformaci\xf3n",{duration:5e3})):this._snackBar.open(`ERROR: ${t.mensaje}`,"Transformaci\xf3n",{duration:3e3})}):this._snackBar.open("Faltan datos necesario. Favor complete los datos e intente de nuevo.","Transformaci\xf3n",{duration:3e3})}}ngOnInit(){this.egreso={egreso:null,tipo_movimiento:null,bodega:null,fecha:x().format(F.a.dbDateFormat),usuario:this.ls.get(F.a.usrTokenVar).idusr||0,estatus_movimiento:1,traslado:0},this.ingreso={ingreso:null,tipo_movimiento:null,fecha:x().format(F.a.dbDateFormat),bodega:null,usuario:this.ls.get(F.a.usrTokenVar).idusr||0,comentario:null,proveedor:null}}doSomething(){}}return t.\u0275fac=function(e){return new(e||t)(y.Nb(E.a),y.Nb(C.a),y.Nb(Vt))},t.\u0275cmp=y.Hb({type:t,selectors:[["app-transformacion"]],viewQuery:function(t,e){if(1&t&&(y.Ic(tn,1),y.Ic(en,1)),2&t){let t;y.sc(t=y.cc())&&(e.frmEgreso=t.first),y.sc(t=y.cc())&&(e.frmIngreso=t.first)}},decls:15,vars:4,consts:[[1,"row"],[1,"col","m12","s12",2,"padding-bottom","5px !important"],["align","end"],["mat-raised-button","","type","button","color","accent",3,"click"],[2,"font-size","18pt"],[1,"col","m6","s12"],[3,"egreso","saveToDB","egresoChange","egresoSavedEv"],["frmEgreso",""],[3,"ingreso","saveToDB","ingresoChange","ingresoSavedEv"],["frmIngreso",""]],template:function(t,e){1&t&&(y.Tb(0,"div",0),y.Tb(1,"div",1),y.Tb(2,"div",2),y.Tb(3,"button",3),y.bc("click",function(){return e.transformar()}),y.Tb(4,"mat-icon",4),y.Dc(5,"transform"),y.Sb(),y.Dc(6,"\xa0Transformar "),y.Sb(),y.Sb(),y.Sb(),y.Sb(),y.Tb(7,"div",0),y.Tb(8,"div",5),y.Tb(9,"app-form-egreso",6,7),y.bc("egresoChange",function(t){return e.egreso=t})("egresoSavedEv",function(){return e.doSomething()}),y.Sb(),y.Sb(),y.Tb(11,"div",5),y.Tb(12,"app-form-ingreso",8,9),y.bc("ingresoChange",function(t){return e.ingreso=t})("ingresoSavedEv",function(){return e.doSomething()}),y.Sb(),y.Sb(),y.Sb(),y.Ob(14,"div",0)),2&t&&(y.Cb(9),y.lc("egreso",e.egreso)("saveToDB",!1),y.Cb(3),y.lc("ingreso",e.ingreso)("saveToDB",!1))},directives:[h.a,s.a,po,Nt],styles:[""]}),t})();var nn=o("NU9O");function cn(t,e){if(1&t&&(y.Tb(0,"mat-option",13),y.Dc(1),y.Sb()),2&t){const t=e.$implicit;y.lc("value",t.bodega),y.Cb(1),y.Fc(" ",t.descripcion," ")}}function rn(t,e){if(1&t&&(y.Tb(0,"mat-option",13),y.Dc(1),y.Sb()),2&t){const t=e.$implicit;y.lc("value",t.sede),y.Cb(1),y.Fc(" ",t.nombre," ")}}function an(t,e){1&t&&y.Ob(0,"app-cargando")}const sn=function(){return{standalone:!0}};let ln=(()=>{class t{constructor(t,e,o,i){this.snackBar=t,this.pdfServicio=e,this.sedeSrvc=o,this.bodegaSrvc=i,this.bodegas=[],this.sedes=[],this.params={},this.titulo="Existencias",this.cargando=!1,this.configBotones={showPdf:!0,showHtml:!1,showExcel:!0},this.getSede=(t={})=>{this.sedeSrvc.get(t).subscribe(t=>{this.sedes=t})},this.getBodega=(t={})=>{this.bodegaSrvc.get(t).subscribe(t=>{this.bodegas=t})},this.excelClick=()=>{this.params._excel=1,this.cargando=!0,this.pdfServicio.getReporteExistencia(this.params).subscribe(t=>{if(this.cargando=!1,t){const e=new Blob([t],{type:"application/vnd.ms-excel"});Object(ti.saveAs)(e,`${this.titulo}.xls`)}else this.snackBar.open("No se pudo generar el reporte...",this.titulo,{duration:3e3})})},this.resetParams=()=>{this.params={},this.cargando=!1}}ngOnInit(){this.getSede(),this.getBodega()}onSubmit(){this.params._excel=0,this.cargando=!0,this.pdfServicio.getReporteExistencia(this.params).subscribe(t=>{if(this.cargando=!1,t){const e=new Blob([t],{type:"application/pdf"});Object(ti.saveAs)(e,`${this.titulo}.pdf`)}else this.snackBar.open("No se pudo generar el reporte...",this.titulo,{duration:3e3})})}}return t.\u0275fac=function(e){return new(e||t)(y.Nb(C.a),y.Nb(bi.a),y.Nb(oi.a),y.Nb(q.a))},t.\u0275cmp=y.Hb({type:t,selectors:[["app-existencias"]],decls:24,vars:9,consts:[[1,"row"],[1,"col","m12","s12"],[1,"mat-elevation-z4","fullWidth"],["novalidate",""],["frmRptExistencias","ngForm"],[1,"fullWidth"],["name","bodega",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["name","sede",3,"ngModel","ngModelChange"],["matInput","","type","date","placeholder","Al","required","",3,"ngModel","ngModelOptions","ngModelChange"],["align","end"],[3,"configuracion","excelClick","pdfClick","resetParamsClick"],[4,"ngIf"],[3,"value"]],template:function(t,e){1&t&&(y.Tb(0,"div",0),y.Tb(1,"div",1),y.Tb(2,"mat-card",2),y.Tb(3,"mat-card-title"),y.Tb(4,"h4"),y.Dc(5,"Reporte de existencias"),y.Sb(),y.Sb(),y.Tb(6,"mat-card-content"),y.Tb(7,"form",3,4),y.Tb(9,"mat-form-field",5),y.Tb(10,"mat-label"),y.Dc(11,"Bodega"),y.Sb(),y.Tb(12,"mat-select",6),y.bc("ngModelChange",function(t){return e.params.bodega=t}),y.Cc(13,cn,2,2,"mat-option",7),y.Sb(),y.Sb(),y.Tb(14,"mat-form-field",5),y.Tb(15,"mat-label"),y.Dc(16,"Sede"),y.Sb(),y.Tb(17,"mat-select",8),y.bc("ngModelChange",function(t){return e.params.sede=t}),y.Cc(18,rn,2,2,"mat-option",7),y.Sb(),y.Sb(),y.Tb(19,"mat-form-field",5),y.Tb(20,"input",9),y.bc("ngModelChange",function(t){return e.params.fecha=t}),y.Sb(),y.Sb(),y.Tb(21,"div",10),y.Tb(22,"app-rpt-botones",11),y.bc("excelClick",function(){return e.excelClick()})("pdfClick",function(){return e.onSubmit()})("resetParamsClick",function(){return e.resetParams()}),y.Sb(),y.Sb(),y.Sb(),y.Cc(23,an,1,0,"app-cargando",12),y.Sb(),y.Sb(),y.Sb(),y.Sb()),2&t&&(y.Cb(12),y.lc("ngModel",e.params.bodega),y.Cb(1),y.lc("ngForOf",e.bodegas),y.Cb(4),y.lc("ngModel",e.params.sede),y.Cb(1),y.lc("ngForOf",e.sedes),y.Cb(2),y.lc("ngModel",e.params.fecha)("ngModelOptions",y.nc(8,sn)),y.Cb(2),y.lc("configuracion",e.configBotones),y.Cb(1),y.lc("ngIf",e.cargando))},directives:[d.a,d.h,d.c,c.r,c.l,c.m,l.b,l.e,m.a,c.k,c.n,i.l,b.b,c.c,c.p,nn.a,i.m,U.k,ii.a],styles:[""]}),t})();function bn(t,e){if(1&t&&(y.Tb(0,"mat-option",14),y.Dc(1),y.Sb()),2&t){const t=e.$implicit;y.lc("value",t.articulo),y.Cb(1),y.Fc(" ",t.descripcion," ")}}function dn(t,e){if(1&t&&(y.Tb(0,"mat-option",14),y.Dc(1),y.Sb()),2&t){const t=e.$implicit;y.lc("value",t.bodega),y.Cb(1),y.Fc(" ",t.descripcion," ")}}function un(t,e){if(1&t&&(y.Tb(0,"mat-option",14),y.Dc(1),y.Sb()),2&t){const t=e.$implicit;y.lc("value",t.sede),y.Cb(1),y.Fc(" ",t.nombre," ")}}function gn(t,e){1&t&&y.Ob(0,"app-cargando")}const fn=function(){return{standalone:!0}};let mn=(()=>{class t{constructor(t,e,o,i,n){this.snackBar=t,this.pdfServicio=e,this.sedeSrvc=o,this.bodegaSrvc=i,this.articuloSrvc=n,this.bodegas=[],this.sedes=[],this.articulos=[],this.params={},this.titulo="Kardex",this.cargando=!1,this.configBotones={showPdf:!0,showHtml:!1,showExcel:!0},this.getSede=(t={})=>{this.sedeSrvc.get(t).subscribe(t=>{this.sedes=t})},this.getArticulo=(t={})=>{this.articuloSrvc.getArticulosIngreso(t).subscribe(t=>{this.articulos=t})},this.getBodega=(t={})=>{this.bodegaSrvc.get(t).subscribe(t=>{this.bodegas=t})},this.excelClick=()=>{this.params._excel=1,this.cargando=!0,this.pdfServicio.getReporteKardex(this.params).subscribe(t=>{if(this.cargando=!1,t){const e=new Blob([t],{type:"application/vnd.ms-excel"});Object(ti.saveAs)(e,`${this.titulo}.xls`)}else this.snackBar.open("No se pudo generar el reporte...",this.titulo,{duration:3e3})})},this.resetParams=()=>{this.params={},this.cargando=!1}}ngOnInit(){this.getSede(),this.getBodega(),this.getArticulo()}onSubmit(){this.params._excel=0,this.pdfServicio.getReporteKardex(this.params).subscribe(t=>{if(t){const e=new Blob([t],{type:"application/pdf"});Object(ti.saveAs)(e,`${this.titulo}.pdf`)}else this.snackBar.open("No se pudo generar el reporte...",this.titulo,{duration:3e3})})}}return t.\u0275fac=function(e){return new(e||t)(y.Nb(C.a),y.Nb(bi.a),y.Nb(oi.a),y.Nb(q.a),y.Nb(W.a))},t.\u0275cmp=y.Hb({type:t,selectors:[["app-kardex"]],decls:30,vars:14,consts:[[1,"row"],[1,"col","m12","s12"],[1,"mat-elevation-z4","fullWidth"],["novalidate",""],[1,"fullWidth"],["name","articulo","required","",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["name","bodega",3,"ngModel","ngModelChange"],["name","sede",3,"ngModel","ngModelChange"],["matInput","","type","date","placeholder","Del","required","",3,"ngModel","ngModelOptions","ngModelChange"],["matInput","","type","date","placeholder","Al","required","",3,"ngModel","ngModelOptions","ngModelChange"],["align","end"],[3,"configuracion","excelClick","pdfClick","resetParamsClick"],[4,"ngIf"],[3,"value"]],template:function(t,e){1&t&&(y.Tb(0,"div",0),y.Tb(1,"div",1),y.Tb(2,"mat-card",2),y.Tb(3,"mat-card-title"),y.Tb(4,"h4"),y.Dc(5,"Kardex"),y.Sb(),y.Sb(),y.Tb(6,"mat-card-content"),y.Tb(7,"form",3),y.Tb(8,"mat-form-field",4),y.Tb(9,"mat-label"),y.Dc(10,"Articulo"),y.Sb(),y.Tb(11,"mat-select",5),y.bc("ngModelChange",function(t){return e.params.articulo=t}),y.Cc(12,bn,2,2,"mat-option",6),y.Sb(),y.Sb(),y.Tb(13,"mat-form-field",4),y.Tb(14,"mat-label"),y.Dc(15,"Bodega"),y.Sb(),y.Tb(16,"mat-select",7),y.bc("ngModelChange",function(t){return e.params.bodega=t}),y.Cc(17,dn,2,2,"mat-option",6),y.Sb(),y.Sb(),y.Tb(18,"mat-form-field",4),y.Tb(19,"mat-label"),y.Dc(20,"Sede"),y.Sb(),y.Tb(21,"mat-select",8),y.bc("ngModelChange",function(t){return e.params.sede=t}),y.Cc(22,un,2,2,"mat-option",6),y.Sb(),y.Sb(),y.Tb(23,"mat-form-field",4),y.Tb(24,"input",9),y.bc("ngModelChange",function(t){return e.params.fdel=t}),y.Sb(),y.Sb(),y.Tb(25,"mat-form-field",4),y.Tb(26,"input",10),y.bc("ngModelChange",function(t){return e.params.fal=t}),y.Sb(),y.Sb(),y.Tb(27,"div",11),y.Tb(28,"app-rpt-botones",12),y.bc("excelClick",function(){return e.excelClick()})("pdfClick",function(){return e.onSubmit()})("resetParamsClick",function(){return e.resetParams()}),y.Sb(),y.Sb(),y.Sb(),y.Cc(29,gn,1,0,"app-cargando",13),y.Sb(),y.Sb(),y.Sb(),y.Sb()),2&t&&(y.Cb(11),y.lc("ngModel",e.params.articulo),y.Cb(1),y.lc("ngForOf",e.articulos),y.Cb(4),y.lc("ngModel",e.params.bodega),y.Cb(1),y.lc("ngForOf",e.bodegas),y.Cb(4),y.lc("ngModel",e.params.sede),y.Cb(1),y.lc("ngForOf",e.sedes),y.Cb(2),y.lc("ngModel",e.params.fdel)("ngModelOptions",y.nc(12,fn)),y.Cb(2),y.lc("ngModel",e.params.fal)("ngModelOptions",y.nc(13,fn)),y.Cb(2),y.lc("configuracion",e.configBotones),y.Cb(1),y.lc("ngIf",e.cargando))},directives:[d.a,d.h,d.c,c.r,c.l,c.m,l.b,l.e,m.a,c.p,c.k,c.n,i.l,b.b,c.c,nn.a,i.m,U.k,ii.a],styles:[""]}),t})();const pn=["frmIngreso"];let hn=(()=>{class t{constructor(t,e,o){this.ls=t,this.snackBar=e,this.transformacionSrvc=o,this.transformar=()=>{this.ingreso=this.frmIngreso.ingreso,this.produccion={tipo_movimiento:this.ingreso.tipo_movimiento,fecha:this.ingreso.fecha,proveedor:this.ingreso.proveedor,bodega:this.ingreso.bodega,usuario:this.ingreso.usuario,bodega_origen:this.ingreso.bodega_origen,comentario:this.ingreso.comentario,detalle:[]},this.frmIngreso.detallesIngreso.forEach(t=>this.produccion.detalle.push({articulo:t.articulo,cantidad:t.cantidad,precio_unitario:t.precio_unitario,precio_total:t.precio_total,presentacion:t.presentacion})),this.produccion&&this.produccion.detalle&&this.produccion.detalle.length>0?this.transformacionSrvc.producir(this.produccion).subscribe(t=>{t.exito?(this.frmIngreso.resetIngreso(),this.frmIngreso.detallesIngreso=[],this.snackBar.open("Producto generado con \xe9xito...","Producci\xf3n",{duration:5e3})):this.snackBar.open(`ERROR: ${t.mensaje}`,"Producci\xf3n",{duration:3e3})}):this.snackBar.open("Faltan datos necesario. Favor complete los datos e intente de nuevo.","Transformaci\xf3n",{duration:3e3})},this.doSomething=()=>{}}ngOnInit(){this.ingreso={ingreso:null,tipo_movimiento:null,fecha:x().format(F.a.dbDateFormat),bodega:null,usuario:this.ls.get(F.a.usrTokenVar).idusr||0,comentario:null,proveedor:null}}}return t.\u0275fac=function(e){return new(e||t)(y.Nb(E.a),y.Nb(C.a),y.Nb(Vt))},t.\u0275cmp=y.Hb({type:t,selectors:[["app-produccion"]],viewQuery:function(t,e){if(1&t&&y.Ic(pn,1),2&t){let t;y.sc(t=y.cc())&&(e.frmIngreso=t.first)}},decls:11,vars:2,consts:[[1,"row"],[1,"col","m12","s12",2,"padding-bottom","5px !important"],["align","end"],["mat-raised-button","","type","button","color","accent",3,"click"],[2,"font-size","18pt"],[1,"col","m12","s12"],[3,"ingreso","saveToDB","ingresoChange","ingresoSavedEv"],["frmIngreso",""]],template:function(t,e){1&t&&(y.Tb(0,"div",0),y.Tb(1,"div",1),y.Tb(2,"div",2),y.Tb(3,"button",3),y.bc("click",function(){return e.transformar()}),y.Tb(4,"mat-icon",4),y.Dc(5,"transform"),y.Sb(),y.Dc(6,"\xa0Transformar "),y.Sb(),y.Sb(),y.Sb(),y.Sb(),y.Tb(7,"div",0),y.Tb(8,"div",5),y.Tb(9,"app-form-ingreso",6,7),y.bc("ingresoChange",function(t){return e.ingreso=t})("ingresoSavedEv",function(){return e.doSomething()}),y.Sb(),y.Sb(),y.Sb()),2&t&&(y.Cb(9),y.lc("ingreso",e.ingreso)("saveToDB",!1))},directives:[h.a,s.a,Nt],styles:[""]}),t})();function Cn(t,e){if(1&t&&(y.Tb(0,"mat-option",13),y.Dc(1),y.Sb()),2&t){const t=e.$implicit;y.lc("value",t.bodega),y.Cb(1),y.Fc(" ",t.descripcion," ")}}function Sn(t,e){if(1&t&&(y.Tb(0,"mat-option",13),y.Dc(1),y.Sb()),2&t){const t=e.$implicit;y.lc("value",t.sede),y.Cb(1),y.Fc(" ",t.nombre," ")}}function vn(t,e){1&t&&y.Ob(0,"app-cargando")}const Tn=function(){return{standalone:!0}};let Dn=(()=>{class t{constructor(t,e,o,i){this.snackBar=t,this.pdfServicio=e,this.sedeSrvc=o,this.bodegaSrvc=i,this.bodegas=[],this.sedes=[],this.params={},this.titulo="Valorizado",this.cargando=!1,this.configBotones={showPdf:!0,showHtml:!1,showExcel:!0},this.getSede=(t={})=>{this.sedeSrvc.get(t).subscribe(t=>{this.sedes=t})},this.getBodega=(t={})=>{this.bodegaSrvc.get(t).subscribe(t=>{this.bodegas=t})},this.excelClick=()=>{this.params._excel=1,this.cargando=!0,this.pdfServicio.getReporteValorizado(this.params).subscribe(t=>{if(this.cargando=!1,t){const e=new Blob([t],{type:"application/vnd.ms-excel"});Object(ti.saveAs)(e,`${this.titulo}.xls`)}else this.snackBar.open("No se pudo generar el reporte...",this.titulo,{duration:3e3})})},this.resetParams=()=>{this.params={},this.cargando=!1}}ngOnInit(){this.getSede(),this.getBodega()}onSubmit(){this.params._excel=0,this.cargando=!0,this.pdfServicio.getReporteValorizado(this.params).subscribe(t=>{if(this.cargando=!1,t){const e=new Blob([t],{type:"application/pdf"});Object(ti.saveAs)(e,`${this.titulo}.pdf`)}else this.snackBar.open("No se pudo generar el reporte...",this.titulo,{duration:3e3})})}}return t.\u0275fac=function(e){return new(e||t)(y.Nb(C.a),y.Nb(bi.a),y.Nb(oi.a),y.Nb(q.a))},t.\u0275cmp=y.Hb({type:t,selectors:[["app-valorizado"]],decls:24,vars:9,consts:[[1,"row"],[1,"col","m12","s12"],[1,"mat-elevation-z4","fullWidth"],["novalidate",""],["frmRptValorizado","ngForm"],[1,"fullWidth"],["name","bodega",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["name","sede",3,"ngModel","ngModelChange"],["matInput","","type","date","placeholder","Al","required","",3,"ngModel","ngModelOptions","ngModelChange"],["align","end"],[3,"configuracion","excelClick","pdfClick","resetParamsClick"],[4,"ngIf"],[3,"value"]],template:function(t,e){1&t&&(y.Tb(0,"div",0),y.Tb(1,"div",1),y.Tb(2,"mat-card",2),y.Tb(3,"mat-card-title"),y.Tb(4,"h4"),y.Dc(5,"Inventario Valorizado"),y.Sb(),y.Sb(),y.Tb(6,"mat-card-content"),y.Tb(7,"form",3,4),y.Tb(9,"mat-form-field",5),y.Tb(10,"mat-label"),y.Dc(11,"Bodega"),y.Sb(),y.Tb(12,"mat-select",6),y.bc("ngModelChange",function(t){return e.params.bodega=t}),y.Cc(13,Cn,2,2,"mat-option",7),y.Sb(),y.Sb(),y.Tb(14,"mat-form-field",5),y.Tb(15,"mat-label"),y.Dc(16,"Sede"),y.Sb(),y.Tb(17,"mat-select",8),y.bc("ngModelChange",function(t){return e.params.sede=t}),y.Cc(18,Sn,2,2,"mat-option",7),y.Sb(),y.Sb(),y.Tb(19,"mat-form-field",5),y.Tb(20,"input",9),y.bc("ngModelChange",function(t){return e.params.fecha=t}),y.Sb(),y.Sb(),y.Tb(21,"div",10),y.Tb(22,"app-rpt-botones",11),y.bc("excelClick",function(){return e.excelClick()})("pdfClick",function(){return e.onSubmit()})("resetParamsClick",function(){return e.resetParams()}),y.Sb(),y.Sb(),y.Sb(),y.Cc(23,vn,1,0,"app-cargando",12),y.Sb(),y.Sb(),y.Sb(),y.Sb()),2&t&&(y.Cb(12),y.lc("ngModel",e.params.bodega),y.Cb(1),y.lc("ngForOf",e.bodegas),y.Cb(4),y.lc("ngModel",e.params.sede),y.Cb(1),y.lc("ngForOf",e.sedes),y.Cb(2),y.lc("ngModel",e.params.fecha)("ngModelOptions",y.nc(8,Tn)),y.Cb(2),y.lc("configuracion",e.configBotones),y.Cb(1),y.lc("ngIf",e.cargando))},directives:[d.a,d.h,d.c,c.r,c.l,c.m,l.b,l.e,m.a,c.k,c.n,i.l,b.b,c.c,c.p,nn.a,i.m,U.k,ii.a],styles:[""]}),t})(),Mn=(()=>{class t{constructor(t){this.http=t,this.fisicoUrl="fisico",this.srvcErrHndl=new A.a}generarInventarioFisico(t){return this.http.post(`${F.a.urlWms}/${this.fisicoUrl}/generar`,t).pipe(Object(P.a)(F.a.reintentos),Object(B.a)(this.srvcErrHndl.errorHandler))}confirmar(t){return this.http.post(`${F.a.urlWms}/${this.fisicoUrl}/confirmar/${+t.inventario_fisico>0?"/"+t.inventario_fisico:""}`,{}).pipe(Object(P.a)(F.a.reintentos),Object(B.a)(this.srvcErrHndl.errorHandler))}getDetalle(t,e={}){return this.http.get(`${F.a.urlWms}/${this.fisicoUrl}/buscar_detalle/${t}?${$.stringify(e)}`).pipe(Object(P.a)(F.a.reintentos),Object(B.a)(this.srvcErrHndl.errorHandler))}saveDetalle(t){return this.http.post(`${F.a.urlWms}/${this.fisicoUrl}/actualizar/`,t).pipe(Object(P.a)(F.a.reintentos),Object(B.a)(this.srvcErrHndl.errorHandler))}}return t.\u0275fac=function(e){return new(e||t)(y.Xb(n.b))},t.\u0275prov=y.Jb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function In(t,e){1&t&&(y.Tb(0,"mat-icon",8),y.Dc(1,"expand_more"),y.Sb())}function wn(t,e){1&t&&(y.Tb(0,"mat-icon",8),y.Dc(1,"expand_less"),y.Sb())}function _n(t,e){if(1&t&&(y.Tb(0,"mat-option",20),y.Dc(1),y.Sb()),2&t){const t=e.$implicit;y.lc("value",t.bodega),y.Cb(1),y.Fc(" ",t.descripcion," ")}}function kn(t,e){if(1&t&&(y.Tb(0,"mat-option",20),y.Dc(1),y.Sb()),2&t){const t=e.$implicit;y.lc("value",t.sede),y.Cb(1),y.Fc(" ",t.nombre," ")}}function On(t,e){if(1&t&&(y.Tb(0,"mat-option",20),y.Dc(1),y.Sb()),2&t){const t=e.$implicit;y.lc("value",t),y.Cb(1),y.Fc(" ",t.descripcion," ")}}function Fn(t,e){if(1&t&&(y.Tb(0,"mat-option",20),y.Dc(1),y.Sb()),2&t){const t=e.$implicit;y.lc("value",t.categoria_grupo),y.Cb(1),y.Fc(" ",t.descripcion," ")}}function xn(t,e){1&t&&y.Ob(0,"app-cargando")}const yn=function(){return{standalone:!0}};function En(t,e){if(1&t){const t=y.Ub();y.Tb(0,"mat-card-content"),y.Tb(1,"form",9),y.bc("ngSubmit",function(){return y.wc(t),y.fc().onSubmit()}),y.Tb(2,"mat-form-field",10),y.Tb(3,"mat-label"),y.Dc(4,"Bodega"),y.Sb(),y.Tb(5,"mat-select",11),y.bc("ngModelChange",function(e){return y.wc(t),y.fc().params.bodega=e}),y.Cc(6,_n,2,2,"mat-option",12),y.Sb(),y.Sb(),y.Tb(7,"mat-form-field",10),y.Tb(8,"mat-label"),y.Dc(9,"Sede"),y.Sb(),y.Tb(10,"mat-select",13),y.bc("ngModelChange",function(e){return y.wc(t),y.fc().params.sede=e}),y.Cc(11,kn,2,2,"mat-option",12),y.Sb(),y.Sb(),y.Tb(12,"mat-form-field",10),y.Tb(13,"mat-label"),y.Dc(14,"Categor\xeda"),y.Sb(),y.Tb(15,"mat-select",14),y.bc("selectionChange",function(e){return y.wc(t),y.fc().onCategoriaSelected(e)}),y.Cc(16,On,2,2,"mat-option",12),y.Sb(),y.Sb(),y.Tb(17,"mat-form-field",10),y.Tb(18,"mat-label"),y.Dc(19,"Sub-categor\xeda"),y.Sb(),y.Tb(20,"mat-select",15),y.bc("ngModelChange",function(e){return y.wc(t),y.fc().params.categoria_grupo_grupo=e}),y.Cc(21,Fn,2,2,"mat-option",12),y.Sb(),y.Sb(),y.Tb(22,"mat-form-field",10),y.Tb(23,"input",16),y.bc("ngModelChange",function(e){return y.wc(t),y.fc().params.fecha=e}),y.Sb(),y.Sb(),y.Tb(24,"mat-checkbox",17),y.bc("ngModelChange",function(e){return y.wc(t),+(y.fc().params._excel=e)}),y.Dc(25,"Generar en Excel "),y.Sb(),y.Tb(26,"div",18),y.Tb(27,"button",19),y.Dc(28,"GENERAR"),y.Sb(),y.Sb(),y.Sb(),y.Cc(29,xn,1,0,"app-cargando",7),y.Sb()}if(2&t){const t=y.fc();y.Cb(5),y.lc("ngModel",t.params.bodega),y.Cb(1),y.lc("ngForOf",t.bodegas),y.Cb(4),y.lc("ngModel",t.params.sede),y.Cb(1),y.lc("ngForOf",t.sedes),y.Cb(5),y.lc("ngForOf",t.categorias),y.Cb(4),y.lc("ngModel",t.params.categoria_grupo_grupo),y.Cb(1),y.lc("ngForOf",t.categoriasGruposPadre),y.Cb(2),y.lc("ngModel",t.params.fecha)("ngModelOptions",y.nc(11,yn)),y.Cb(1),y.lc("ngModel",+t.params._excel),y.Cb(5),y.lc("ngIf",t.cargando)}}let An=(()=>{class t{constructor(t,e,o,i,n,c,r){this.snackBar=t,this.pdfServicio=e,this.sedeSrvc=o,this.bodegaSrvc=i,this.articuloSrvc=n,this.fisicoSrvc=c,this.ls=r,this.bodegas=[],this.sedes=[],this.params={},this.categorias=[],this.categoriasGruposPadre=[],this.categoriasGrupos=[],this.titulo="Fisico",this.cargando=!1,this.showReporte=!0,this.getSede=(t={})=>{this.sedeSrvc.get(t).subscribe(t=>{this.sedes=t})},this.getBodega=(t={})=>{this.bodegaSrvc.get(t).subscribe(t=>{this.bodegas=t})},this.loadCategorias=()=>{this.articuloSrvc.getCategorias({sede:+this.ls.get(F.a.usrTokenVar).sede||0}).subscribe(t=>{t&&(this.categorias=t)})},this.onCategoriaSelected=t=>this.loadSubCategorias(+t.value.categoria),this.loadSubCategorias=t=>{this.articuloSrvc.getCategoriasGrupos({categoria:+t}).subscribe(t=>{t&&(this.categoriasGruposPadre=this.articuloSrvc.adaptCategoriaGrupoResponse(t),this.categoriasGrupos=this.categoriasGruposPadre)})},this.onSubCategoriaPadreSelected=t=>this.loadSubCategoriasSubcategorias(+t.value),this.loadSubCategoriasSubcategorias=t=>{this.articuloSrvc.getCategoriasGrupos({categoria_grupo_grupo:t}).subscribe(t=>{t&&(this.categoriasGrupos=this.articuloSrvc.adaptCategoriaGrupoResponse(t))})}}ngOnInit(){this.getSede(),this.getBodega(),this.loadCategorias()}onSubmit(){this.cargando=!0,this.fisicoSrvc.generarInventarioFisico(this.params).subscribe(t=>{this.cargando=!1,console.log(t),t.exito?this.pdfServicio.imprimirInventarioFisico(t.inventario,this.params).subscribe(t=>{if(this.params._excel){const e=new Blob([t],{type:"application/vnd.ms-excel"});Object(ti.saveAs)(e,`${this.titulo}.xls`)}else{const e=new Blob([t],{type:"application/pdf"});Object(ti.saveAs)(e,`${this.titulo}.pdf`)}}):this.snackBar.open("No se pudo generar el reporte... "+t.mensaje,this.titulo,{duration:3e3})})}}return t.\u0275fac=function(e){return new(e||t)(y.Nb(C.a),y.Nb(bi.a),y.Nb(oi.a),y.Nb(q.a),y.Nb(W.a),y.Nb(Mn),y.Nb(E.a))},t.\u0275cmp=y.Hb({type:t,selectors:[["app-reporte"]],decls:13,vars:3,consts:[[1,"row"],[1,"col","m12","s12"],[1,"mat-elevation-z4","fullWidth"],[1,"col"],[1,"col",2,"float","right"],["mat-button","","type","button","color","accent",3,"click"],["class","iconFontSize",4,"ngIf"],[4,"ngIf"],[1,"iconFontSize"],["novalidate","",3,"ngSubmit"],[1,"fullWidth"],["name","bodega",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["name","sede",3,"ngModel","ngModelChange"],["name","categoria",3,"selectionChange"],["name","categoriaGrupoPadre",3,"ngModel","ngModelChange"],["matInput","","type","date","placeholder","Fecha","required","",3,"ngModel","ngModelOptions","ngModelChange"],["name","excel",1,"fullWidth",3,"ngModel","ngModelChange"],["align","end"],["mat-button","","color","accent","type","submit"],[3,"value"]],template:function(t,e){1&t&&(y.Tb(0,"div",0),y.Tb(1,"div",1),y.Tb(2,"mat-card",2),y.Tb(3,"mat-card-title"),y.Tb(4,"div",0),y.Tb(5,"div",3),y.Tb(6,"h4"),y.Dc(7,"Inventario Fisico"),y.Sb(),y.Sb(),y.Tb(8,"div",4),y.Tb(9,"button",5),y.bc("click",function(){return e.showReporte=!e.showReporte}),y.Cc(10,In,2,0,"mat-icon",6),y.Cc(11,wn,2,0,"mat-icon",6),y.Sb(),y.Sb(),y.Sb(),y.Sb(),y.Cc(12,En,30,12,"mat-card-content",7),y.Sb(),y.Sb(),y.Sb()),2&t&&(y.Cb(10),y.lc("ngIf",e.showReporte),y.Cb(1),y.lc("ngIf",!e.showReporte),y.Cb(1),y.lc("ngIf",e.showReporte))},directives:[d.a,d.h,h.a,i.m,s.a,d.c,c.r,c.l,c.m,l.b,l.e,m.a,c.k,c.n,i.l,b.b,c.c,c.p,p.a,U.k,ii.a],styles:[""]}),t})();function Pn(t,e){1&t&&(y.Tb(0,"mat-icon",9),y.Dc(1,"expand_more"),y.Sb())}function Bn(t,e){1&t&&(y.Tb(0,"mat-icon",9),y.Dc(1,"expand_less"),y.Sb())}function $n(t,e){1&t&&y.Ob(0,"app-cargando")}function Rn(t,e){if(1&t){const t=y.Ub();y.Tb(0,"mat-card-content"),y.Tb(1,"form",10),y.bc("ngSubmit",function(){return y.wc(t),y.fc().buscar()}),y.Tb(2,"mat-form-field",11),y.Tb(3,"input",12),y.bc("ngModelChange",function(e){return y.wc(t),y.fc().params.numero=e}),y.Sb(),y.Tb(4,"button",13),y.Dc(5,"Buscar"),y.Sb(),y.Sb(),y.Sb(),y.Cc(6,$n,1,0,"app-cargando",7),y.Sb()}if(2&t){const t=y.fc();y.Cb(3),y.lc("ngModel",t.params.numero),y.Cb(3),y.lc("ngIf",t.cargando)}}const Un=function(){return{standalone:!0}};function Nn(t,e){if(1&t&&(y.Tb(0,"tr"),y.Tb(1,"td",23),y.Dc(2),y.Sb(),y.Tb(3,"td",23),y.Tb(4,"mat-form-field",11),y.Tb(5,"input",24),y.bc("ngModelChange",function(t){return e.$implicit.existencia_fisica=t}),y.Sb(),y.Sb(),y.Sb(),y.Sb()),2&t){const t=e.$implicit;y.Cb(2),y.Fc(" ",t.narticulo," "),y.Cb(3),y.lc("ngModel",t.existencia_fisica)("ngModelOptions",y.nc(3,Un))}}function Hn(t,e){if(1&t&&(y.Rb(0),y.Tb(1,"tr"),y.Tb(2,"th",22),y.Dc(3),y.Sb(),y.Sb(),y.Cc(4,Nn,6,4,"tr",17),y.Qb()),2&t){const t=e.$implicit;y.Cb(3),y.Ec(t.descripcion),y.Cb(1),y.lc("ngForOf",t.datos)}}function jn(t,e){if(1&t&&(y.Rb(0),y.Tb(1,"tr"),y.Tb(2,"th",22),y.Tb(3,"mat-label"),y.Dc(4),y.Sb(),y.Sb(),y.Sb(),y.Cc(5,Hn,5,2,"ng-container",17),y.Qb()),2&t){const t=e.$implicit;y.Cb(4),y.Ec(t.descripcion),y.Cb(1),y.lc("ngForOf",t.datos)}}function zn(t,e){1&t&&(y.Tb(0,"button",25),y.Dc(1,"Guardar"),y.Sb())}function Gn(t,e){if(1&t){const t=y.Ub();y.Tb(0,"button",20),y.bc("click",function(){return y.wc(t),y.fc(2).confirmar()}),y.Dc(1,"Confirmar"),y.Sb()}}function qn(t,e){1&t&&y.Ob(0,"app-cargando")}function Wn(t,e){if(1&t){const t=y.Ub();y.Tb(0,"div",0),y.Tb(1,"div",1),y.Tb(2,"mat-card",2),y.Ob(3,"mat-card-title"),y.Tb(4,"mat-card-content"),y.Tb(5,"form",14,15),y.bc("ngSubmit",function(){y.wc(t);const e=y.tc(6),o=y.fc();return e.form.valid&&o.actualizar()}),y.Tb(7,"table",16),y.Cc(8,jn,6,2,"ng-container",17),y.Sb(),y.Tb(9,"div",18),y.Cc(10,zn,2,0,"button",19),y.Tb(11,"button",20),y.bc("click",function(){return y.wc(t),y.fc().imprimir()}),y.Dc(12,"PDF"),y.Sb(),y.Tb(13,"button",20),y.bc("click",function(){return y.wc(t),y.fc().imprimirXls()}),y.Dc(14,"Excel"),y.Sb(),y.Cc(15,Gn,2,0,"button",21),y.Sb(),y.Sb(),y.Cc(16,qn,1,0,"app-cargando",7),y.Sb(),y.Sb(),y.Sb(),y.Sb()}if(2&t){const t=y.fc();y.Cb(8),y.lc("ngForOf",t.articulos),y.Cb(2),y.lc("ngIf",0==t.inventario.confirmado),y.Cb(5),y.lc("ngIf",0==t.inventario.confirmado),y.Cb(1),y.lc("ngIf",t.cargando)}}let Ln=(()=>{class t{constructor(t,e,o,i){this.snackBar=t,this.pdfServicio=e,this.fisicoSrvc=o,this.dialog=i,this.showForm=!0,this.params={},this.cargando=!1,this.articulos=[],this.inventario={},this.titulo="Inventario_Fisico",this.resetDatos=()=>{this.articulos=[],this.inventario={inventario_fisico:0,sede:null,usuario:null,categoria_grupo:null,fhcreacion:null,fecha:null,notas:null,confirmado:0}},this.buscar=()=>{this.resetDatos(),this.fisicoSrvc.getDetalle(this.params.numero).subscribe(t=>{t&&(this.articulos=t.detalle,this.inventario=t.inventario)})},this.actualizar=()=>{this.fisicoSrvc.saveDetalle(this.articulos).subscribe(t=>{this.snackBar.open(t.exito?"Datos actualizados exitosamente":`ERROR: ${t.mensaje}`,"Inventario",{duration:3e3})})},this.confirmar=()=>{this.dialog.open(ei.a,{maxWidth:"400px",data:new ei.b("Confirmar Inventario Fisico","No podr\xe1 modificar los datos ingresados. \xbfDesea continuar?","S\xed","No")}).afterClosed().subscribe(t=>{t&&this.fisicoSrvc.confirmar(this.inventario).subscribe(t=>{t.exito?(this.inventario=t.inventario,this.snackBar.open("Inventario confirmado exitosamente","Inventario",{duration:3e3})):this.snackBar.open(`ERROR: ${t.mensaje}`,"Inventario",{duration:3e3})})})},this.imprimir=()=>{this.pdfServicio.imprimirInventarioFisico(this.inventario.inventario_fisico,{existencia_fisica:!0}).subscribe(t=>{const e=new Blob([t],{type:"application/pdf"});Object(ti.saveAs)(e,`${this.titulo}.pdf`)})},this.imprimirXls=()=>{this.pdfServicio.imprimirInventarioFisico(this.inventario.inventario_fisico,{existencia_fisica:!0,_excel:!0}).subscribe(t=>{const e=new Blob([t],{type:"application/vnd.ms-excel"});Object(ti.saveAs)(e,`${this.titulo}.xls`)})}}ngOnInit(){this.resetDatos()}}return t.\u0275fac=function(e){return new(e||t)(y.Nb(C.a),y.Nb(bi.a),y.Nb(Mn),y.Nb(M.b))},t.\u0275cmp=y.Hb({type:t,selectors:[["app-form-inventario-fisico"]],decls:14,vars:4,consts:[[1,"row"],[1,"col","m12","s12"],[1,"mat-elevation-z4","fullWidth"],[1,"col"],[1,"col",2,"float","right"],["mat-button","","type","button","color","accent",3,"click"],["class","iconFontSize",4,"ngIf"],[4,"ngIf"],["class","row",4,"ngIf"],[1,"iconFontSize"],["novalidate","",3,"ngSubmit"],[1,"fullWidth"],["matInput","","type","text","placeholder","N\xfamero","name","numero","required","",3,"ngModel","ngModelChange"],["mat-raised-button","","matSuffix","","color","accent","type","submit"],["novalidate","","autocomplete","off",3,"ngSubmit"],["frmConteoFisico","ngForm"],[1,"tbl"],[4,"ngFor","ngForOf"],["align","end"],["mat-button","","color","accent","type","submit",4,"ngIf"],["mat-button","","color","accent","type","button",3,"click"],["mat-button","","color","accent","type","button",3,"click",4,"ngIf"],["colspan","2",1,"brdTSingleBSingle"],[1,"brdTSingleBSingle"],["matInput","","type","number","step","0.01","placeholder","Cantidad","required","",3,"ngModel","ngModelOptions","ngModelChange"],["mat-button","","color","accent","type","submit"]],template:function(t,e){1&t&&(y.Tb(0,"div",0),y.Tb(1,"div",1),y.Tb(2,"mat-card",2),y.Tb(3,"mat-card-title"),y.Tb(4,"div",0),y.Tb(5,"div",3),y.Tb(6,"h4"),y.Dc(7,"Ingreso Inventario Fisico"),y.Sb(),y.Sb(),y.Tb(8,"div",4),y.Tb(9,"button",5),y.bc("click",function(){return e.showForm=!e.showForm}),y.Cc(10,Pn,2,0,"mat-icon",6),y.Cc(11,Bn,2,0,"mat-icon",6),y.Sb(),y.Sb(),y.Sb(),y.Sb(),y.Cc(12,Rn,7,2,"mat-card-content",7),y.Sb(),y.Sb(),y.Sb(),y.Cc(13,Wn,17,4,"div",8)),2&t&&(y.Cb(10),y.lc("ngIf",e.showForm),y.Cb(1),y.lc("ngIf",!e.showForm),y.Cb(1),y.lc("ngIf",e.showForm),y.Cb(1),y.lc("ngIf",e.articulos.length>0))},directives:[d.a,d.h,h.a,i.m,s.a,d.c,c.r,c.l,c.m,l.b,b.b,c.c,c.p,c.k,c.n,l.f,ii.a,i.l,l.e,c.o],styles:[""]}),t})();const Vn=["rptInventario"],Qn=["frmInventario"],Xn=[{path:"ingresos",component:zt,canActivate:[O.a]},{path:"egresos",component:So,canActivate:[O.a]},{path:"articulos",component:Yi,canActivate:[O.a]},{path:"transformaciones",component:on,canActivate:[O.a]},{path:"rptexistencia",component:ln,canActivate:[O.a]},{path:"rptkardex",component:mn,canActivate:[O.a]},{path:"produccion",component:hn,canActivate:[O.a]},{path:"rptvalorizado",component:Dn,canActivate:[O.a]},{path:"fisico",component:(()=>{class t{constructor(){}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=y.Hb({type:t,selectors:[["app-fisico"]],viewQuery:function(t,e){if(1&t&&(y.Ic(Vn,1),y.Ic(Qn,1)),2&t){let t;y.sc(t=y.cc())&&(e.rptInventarioComponent=t.first),y.sc(t=y.cc())&&(e.frmInventarioComponent=t.first)}},decls:6,vars:0,consts:[[1,"row"],[1,"col","s12","m12"]],template:function(t,e){1&t&&(y.Tb(0,"div",0),y.Tb(1,"div",1),y.Ob(2,"app-reporte"),y.Sb(),y.Sb(),y.Tb(3,"div",0),y.Tb(4,"div",1),y.Ob(5,"app-form-inventario-fisico"),y.Sb(),y.Sb())},directives:[An,Ln],styles:[""]}),t})(),canActivate:[O.a]},{path:"replicar_articulos_sedes",component:ri,canActivate:[O.a]},{path:"**",redirectTo:"/admin/dashboard",pathMatch:"full"}];let Kn=(()=>{class t{}return t.\u0275mod=y.Lb({type:t}),t.\u0275inj=y.Kb({factory:function(e){return new(e||t)},imports:[[k.d.forChild(Xn)],k.d]}),t})(),Jn=(()=>{class t{}return t.\u0275mod=y.Lb({type:t}),t.\u0275inj=y.Kb({factory:function(e){return new(e||t)},providers:[],imports:[[i.c,Kn,r.a,n.c,c.e,a.d,s.b,l.d,b.c,d.f,u.b,g.c,f.l,m.b,p.b,h.b,C.b,S.b,v.d,T.b,D.b,M.e,I.d,w.c,_.b]]}),t})()}}]);