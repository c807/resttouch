(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{JbvS:function(t,e,a){"use strict";a.d(e,"a",function(){return m}),a.d(e,"b",function(){return g}),a.d(e,"c",function(){return S}),a.d(e,"d",function(){return F});var i=a("fXoL"),c=a("bTqV"),n=a("ofXK"),r=a("xgIS"),o=a("cp0P"),s=a("IzEk");function l(t,e){1&t&&i.jc(0,0,["*ngIf","miniFabVisible"])}const u=[[["","mat-mini-fab",""]]],d=["[mat-mini-fab]"],f=[[["eco-fab-speed-dial-trigger"]],[["eco-fab-speed-dial-actions"]]],b=["eco-fab-speed-dial-trigger","eco-fab-speed-dial-actions"],h=[[["","mat-fab",""]]],p=["[mat-fab]"];let m=(()=>{class t{constructor(t,e){this.renderer=e,this.miniFabVisible=!1,this._parent=t.get(g)}ngAfterContentInit(){this._buttons.changes.subscribe(()=>{this.initButtonStates(),this._parent.setActionsVisibility()}),this.initButtonStates()}initButtonStates(){this._buttons.forEach((t,e)=>{this.renderer.addClass(t._getHostElement(),"eco-fab-action-item"),this.changeElementStyle(t._getHostElement(),"z-index",""+(23-e))})}show(){this._buttons&&(this.resetAnimationState(),this.miniFabVisible=!0,this.showMiniFabAnimation=setTimeout(()=>{this._buttons.forEach((t,e)=>{let a,i=0;"scale"===this._parent.animationMode?(i=3+65*e,a="scale(1)"):a=this.getTranslateFunction("0");const c=t._getHostElement();this.changeElementStyle(c,"transition-delay",i+"ms"),this.changeElementStyle(c,"opacity","1"),this.changeElementStyle(c,"transform",a)})},50))}resetAnimationState(){clearTimeout(this.showMiniFabAnimation),this.hideMiniFab&&(this.hideMiniFab.unsubscribe(),this.hideMiniFab=null)}hide(){if(!this._buttons)return;this.resetAnimationState();const t=this._buttons.map((t,e)=>{let a,i="1",c=0;"scale"===this._parent.animationMode?(c=3-65*e,a="scale(0)",i="0"):a=this.getTranslateFunction(55*(e+1)-5*e+"px");const n=t._getHostElement();return this.changeElementStyle(n,"transition-delay",c+"ms"),this.changeElementStyle(n,"opacity",i),this.changeElementStyle(n,"transform",a),Object(r.a)(n,"transitionend").pipe(Object(s.a)(1))});this.hideMiniFab=Object(o.a)(t).subscribe(()=>this.miniFabVisible=!1)}getTranslateFunction(t){const e=this._parent.direction;return("up"===e||"down"===e?"translateY":"translateX")+"("+("down"===e||"right"===e?"-":"")+t+")"}changeElementStyle(t,e,a){this.renderer.setStyle(t,e,a)}}return t.\u0275fac=function(e){return new(e||t)(i.Nb(i.t),i.Nb(i.G))},t.\u0275cmp=i.Hb({type:t,selectors:[["eco-fab-speed-dial-actions"]],contentQueries:function(t,e,a){if(1&t&&i.Gb(a,c.a,0),2&t){let t;i.sc(t=i.cc())&&(e._buttons=t)}},ngContentSelectors:d,decls:1,vars:1,consts:[[4,"ngIf"]],template:function(t,e){1&t&&(i.kc(u),i.Dc(0,l,1,0,"ng-content",0)),2&t&&i.lc("ngIf",e.miniFabVisible)},directives:[n.m],encapsulation:2}),t})(),g=(()=>{class t{constructor(t,e,a){this.elementRef=t,this.renderer=e,this.document=a,this.isInitialized=!1,this._direction="up",this._open=!1,this._animationMode="fling",this._fixed=!1,this._documentClickUnlistener=null,this.openChange=new i.o}get fixed(){return this._fixed}set fixed(t){this._fixed=t,this._processOutsideClickState()}get open(){return this._open}set open(t){const e=this._open;this._open=t,e!==this._open&&(this.openChange.emit(this._open),this.isInitialized&&this.setActionsVisibility())}get direction(){return this._direction}set direction(t){const e=this._direction;this._direction=t,e!==this.direction&&(this._setElementClass(e,!1),this._setElementClass(this.direction,!0),this.isInitialized&&this.setActionsVisibility())}get animationMode(){return this._animationMode}set animationMode(t){const e=this._animationMode;this._animationMode=t,e!==this._animationMode&&(this._setElementClass(e,!1),this._setElementClass(this.animationMode,!0),this.isInitialized&&Promise.resolve(null).then(()=>this.open=!1))}ngAfterContentInit(){this.isInitialized=!0,this.setActionsVisibility(),this._setElementClass(this.direction,!0),this._setElementClass(this.animationMode,!0)}ngOnDestroy(){this._unsetDocumentClickListener()}toggle(){this.open=!this.open}_onClick(){!this.fixed&&this.open&&(this.open=!1)}setActionsVisibility(){this._childActions&&(this.open?this._childActions.show():this._childActions.hide(),this._processOutsideClickState())}_setElementClass(t,e){const a=`eco-${t}`;e?this.renderer.addClass(this.elementRef.nativeElement,a):this.renderer.removeClass(this.elementRef.nativeElement,a)}_processOutsideClickState(){!this.fixed&&this.open?this._setDocumentClickListener():this._unsetDocumentClickListener()}_setDocumentClickListener(){this._documentClickUnlistener||(this._documentClickUnlistener=this.renderer.listen(this.document,"click",()=>{this.open=!1}))}_unsetDocumentClickListener(){this._documentClickUnlistener&&(this._documentClickUnlistener(),this._documentClickUnlistener=null)}}return t.\u0275fac=function(e){return new(e||t)(i.Nb(i.l),i.Nb(i.G),i.Nb(n.d))},t.\u0275cmp=i.Hb({type:t,selectors:[["eco-fab-speed-dial"]],contentQueries:function(t,e,a){if(1&t&&i.Gb(a,m,1),2&t){let t;i.sc(t=i.cc())&&(e._childActions=t.first)}},hostVars:2,hostBindings:function(t,e){1&t&&i.bc("click",function(){return e._onClick()}),2&t&&i.Fb("eco-opened",e.open)},inputs:{fixed:"fixed",open:"open",direction:"direction",animationMode:"animationMode"},outputs:{openChange:"openChange"},ngContentSelectors:b,decls:3,vars:0,consts:[[1,"eco-fab-speed-dial-container"]],template:function(t,e){1&t&&(i.kc(f),i.Tb(0,"div",0),i.jc(1),i.jc(2,1),i.Sb())},styles:["eco-fab-speed-dial{display:inline-block}eco-fab-speed-dial.eco-opened .eco-fab-speed-dial-container eco-fab-speed-dial-trigger.eco-spin .spin180{transform:rotate(180deg)}eco-fab-speed-dial.eco-opened .eco-fab-speed-dial-container eco-fab-speed-dial-trigger.eco-spin .spin360{transform:rotate(1turn)}eco-fab-speed-dial .eco-fab-speed-dial-container{align-items:center;display:flex;position:relative;z-index:20}eco-fab-speed-dial .eco-fab-speed-dial-container eco-fab-speed-dial-trigger{pointer-events:auto;z-index:24}eco-fab-speed-dial .eco-fab-speed-dial-container eco-fab-speed-dial-trigger.eco-spin .spin180,eco-fab-speed-dial .eco-fab-speed-dial-container eco-fab-speed-dial-trigger.eco-spin .spin360{transition:all .6s cubic-bezier(.4,0,.2,1)}eco-fab-speed-dial .eco-fab-speed-dial-container eco-fab-speed-dial-actions{display:flex;height:0;position:absolute;width:0}eco-fab-speed-dial.eco-fling .eco-fab-speed-dial-container eco-fab-speed-dial-actions .eco-fab-action-item{display:block;opacity:1;transition:all .3s cubic-bezier(.55,0,.55,.2)}eco-fab-speed-dial.eco-scale .eco-fab-speed-dial-container eco-fab-speed-dial-actions .eco-fab-action-item{transform:scale(0);transition:all .3s cubic-bezier(.55,0,.55,.2);transition-duration:.14286s}eco-fab-speed-dial.eco-down eco-fab-speed-dial-actions{bottom:2px;left:7px}eco-fab-speed-dial.eco-down .eco-fab-speed-dial-container{flex-direction:column}eco-fab-speed-dial.eco-down .eco-fab-speed-dial-container eco-fab-speed-dial-trigger{order:1}eco-fab-speed-dial.eco-down .eco-fab-speed-dial-container eco-fab-speed-dial-actions{flex-direction:column;order:2}eco-fab-speed-dial.eco-down .eco-fab-speed-dial-container eco-fab-speed-dial-actions .eco-fab-action-item{margin-top:10px}eco-fab-speed-dial.eco-up eco-fab-speed-dial-actions{left:7px;top:2px}eco-fab-speed-dial.eco-up .eco-fab-speed-dial-container{flex-direction:column}eco-fab-speed-dial.eco-up .eco-fab-speed-dial-container eco-fab-speed-dial-trigger{order:2}eco-fab-speed-dial.eco-up .eco-fab-speed-dial-container eco-fab-speed-dial-actions{flex-direction:column-reverse;order:1}eco-fab-speed-dial.eco-up .eco-fab-speed-dial-container eco-fab-speed-dial-actions .eco-fab-action-item{margin-bottom:10px}eco-fab-speed-dial.eco-left eco-fab-speed-dial-actions{left:2px;top:7px}eco-fab-speed-dial.eco-left .eco-fab-speed-dial-container{flex-direction:row}eco-fab-speed-dial.eco-left .eco-fab-speed-dial-container eco-fab-speed-dial-trigger{order:2}eco-fab-speed-dial.eco-left .eco-fab-speed-dial-container eco-fab-speed-dial-actions{flex-direction:row-reverse;order:1}eco-fab-speed-dial.eco-left .eco-fab-speed-dial-container eco-fab-speed-dial-actions .eco-fab-action-item{margin-right:10px}eco-fab-speed-dial.eco-right eco-fab-speed-dial-actions{right:2px;top:7px}eco-fab-speed-dial.eco-right .eco-fab-speed-dial-container{flex-direction:row}eco-fab-speed-dial.eco-right .eco-fab-speed-dial-container eco-fab-speed-dial-trigger{order:1}eco-fab-speed-dial.eco-right .eco-fab-speed-dial-container eco-fab-speed-dial-actions{flex-direction:row;order:2}eco-fab-speed-dial.eco-right .eco-fab-speed-dial-container eco-fab-speed-dial-actions .eco-fab-action-item{margin-left:10px}"],encapsulation:2}),t})(),F=(()=>{class t{constructor(t){this.spin=!1,this._parent=t.get(g)}get sp(){return this.spin}_onClick(t){this._parent.fixed||(this._parent.toggle(),t.stopPropagation())}}return t.\u0275fac=function(e){return new(e||t)(i.Nb(i.t))},t.\u0275cmp=i.Hb({type:t,selectors:[["eco-fab-speed-dial-trigger"]],hostVars:2,hostBindings:function(t,e){1&t&&i.bc("click",function(t){return e._onClick(t)}),2&t&&i.Fb("eco-spin",e.sp)},inputs:{spin:"spin"},ngContentSelectors:p,decls:1,vars:0,template:function(t,e){1&t&&(i.kc(h),i.jc(0))},encapsulation:2}),t})(),S=(()=>{class t{}return t.\u0275mod=i.Lb({type:t}),t.\u0275inj=i.Kb({factory:function(e){return new(e||t)},imports:[[n.c]]}),t})()},KFbY:function(t,e,a){"use strict";a.d(e,"a",function(){return u});var i=a("sKxO"),c=a("R5jZ"),n=a("un/a"),r=a("JIr8"),o=a("Qyje"),s=a("fXoL"),l=a("tk/3");let u=(()=>{class t{constructor(t){this.http=t,this.moduleUrl="factura",this.srvcErrHndl=new c.a}facturar(t){return this.http.post(`${i.a.urlAppRestaurante}/${this.moduleUrl}/guardar`,t).pipe(Object(n.a)(i.a.reintentos),Object(r.a)(this.srvcErrHndl.errorHandler))}get(t={}){return this.http.get(`${i.a.urlFacturacion}/${this.moduleUrl}/buscar_factura?${o.stringify(t)}`).pipe(Object(n.a)(i.a.reintentos),Object(r.a)(this.srvcErrHndl.errorHandler))}imprimir(t){return this.http.get(`${i.a.urlFacturacion}/${this.moduleUrl}/imprimir/${t}`).pipe(Object(n.a)(i.a.reintentos),Object(r.a)(this.srvcErrHndl.errorHandler))}save(t){return this.http.post(`${i.a.urlFacturacion}/${this.moduleUrl}/guardar${t.factura?"/"+t.factura:""}`,t).pipe(Object(n.a)(i.a.reintentos),Object(r.a)(this.srvcErrHndl.errorHandler))}refacturar(t){return this.http.post(`${i.a.urlFacturacion}/${this.moduleUrl}/refacturar${t.factura?"/"+t.factura:""}`,t).pipe(Object(n.a)(i.a.reintentos),Object(r.a)(this.srvcErrHndl.errorHandler))}firmar(t){return this.http.post(`${i.a.urlFacturacion}/${this.moduleUrl}/facturar/${t}`,{}).pipe(Object(n.a)(i.a.reintentos),Object(r.a)(this.srvcErrHndl.errorHandler))}anular(t,e={}){return this.http.post(`${i.a.urlFacturacion}/${this.moduleUrl}/anular/${t}`,e).pipe(Object(n.a)(i.a.reintentos),Object(r.a)(this.srvcErrHndl.errorHandler))}getDetalle(t,e={}){return this.http.get(`${i.a.urlFacturacion}/${this.moduleUrl}/buscar_detalle/${t}?${o.stringify(e)}`).pipe(Object(n.a)(i.a.reintentos),Object(r.a)(this.srvcErrHndl.errorHandler))}saveDetalle(t){return this.http.post(`${i.a.urlFacturacion}/${this.moduleUrl}/guardar_detalle/${t.factura}${t.detalle_factura?"/"+t.detalle_factura:""}`,t).pipe(Object(n.a)(i.a.reintentos),Object(r.a)(this.srvcErrHndl.errorHandler))}getGrafo(t){return this.http.get(`${i.a.urlFacturacion}/${this.moduleUrl}/get_grafo_factura/${t}`).pipe(Object(n.a)(i.a.reintentos),Object(r.a)(this.srvcErrHndl.errorHandler))}}return t.\u0275fac=function(e){return new(e||t)(s.Xb(l.b))},t.\u0275prov=s.Jb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},KZK3:function(t,e,a){"use strict";a.d(e,"a",function(){return u});var i=a("sKxO"),c=a("R5jZ"),n=a("un/a"),r=a("JIr8"),o=a("Qyje"),s=a("fXoL"),l=a("tk/3");let u=(()=>{class t{constructor(t){this.http=t,this.moduleUrl="catalogo",this.manteUrl="fpago",this.srvcErrHndl=new c.a}get(t={}){return this.http.get(`${i.a.url}/${this.moduleUrl}/get_forma_pago?${o.stringify(t)}`).pipe(Object(n.a)(i.a.reintentos),Object(r.a)(this.srvcErrHndl.errorHandler))}buscar(t={}){return this.http.get(`${i.a.urlMantenimientos}/${this.manteUrl}/buscar?${o.stringify(t)}`).pipe(Object(n.a)(i.a.reintentos),Object(r.a)(this.srvcErrHndl.errorHandler))}save(t){return this.http.post(`${i.a.urlMantenimientos}/${this.manteUrl}/guardar${t.forma_pago?"/"+t.forma_pago:""}`,t).pipe(Object(n.a)(i.a.reintentos),Object(r.a)(this.srvcErrHndl.errorHandler))}}return t.\u0275fac=function(e){return new(e||t)(s.Xb(l.b))},t.\u0275prov=s.Jb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},qodq:function(t,e,a){"use strict";a.r(e),a.d(e,"PosModule",function(){return Vt});var i=a("ofXK"),c=a("tk/3"),n=a("3Pt+"),r=a("PCNd"),o=a("jkDv"),s=a("MutI"),l=a("NFeN"),u=a("kmnG"),d=a("qFsG"),f=a("Wp6s"),b=a("f0Cb"),h=a("wZkO"),p=a("+0xr"),m=a("d3UM"),g=a("bSwM"),F=a("bTqV"),S=a("dNgK"),_=a("/t3+"),v=a("STbY"),C=a("zkoq"),T=a("M9IT"),x=a("0IaG"),M=a("XhcP"),y=a("/1cH"),k=a("uM5D"),w=a("JbvS"),D=a("tyNb"),O=a("0T/Q"),I=a("fXoL"),P=a("sKxO"),E=a("KZK3"),A=a("FKr1");function $(t,e){if(1&t){const t=I.Ub();I.Tb(0,"mat-list-item",5),I.bc("click",function(){I.xc(t);const a=e.$implicit;return I.fc().getFormaPago(a)}),I.Tb(1,"mat-icon",6),I.Fc(2,"account_balance_wallet"),I.Sb(),I.Tb(3,"h5",7),I.Fc(4),I.Sb(),I.Sb()}if(2&t){const t=e.$implicit;I.Cb(4),I.Gc(t.descripcion)}}const j=function(){return{standalone:!0}};let z=(()=>{class t{constructor(t){this.formaPagoSrvc=t,this.getFormaPagoEv=new I.o,this.length=0,this.pageSize=5,this.pageSizeOptions=[5,10,15],this.pageIndex=0,this.txtFiltro="",this.loadFormasPago=()=>{this.formaPagoSrvc.buscar().subscribe(t=>{t&&t.length>0&&(this.lstFormasPago=t,this.applyFilter())})},this.getFormaPago=t=>{this.getFormaPagoEv.emit(t)},this.pageChange=t=>{this.pageSize=t.pageSize,this.pageIndex=t.pageIndex,this.applyFilter()}}ngOnInit(){this.loadFormasPago()}applyFilter(){if(this.txtFiltro.length>0){const t=Object(P.b)(this.lstFormasPago,this.txtFiltro);this.length=t.length,this.lstFormasPagoPaged=Object(P.c)(t,this.pageSize,this.pageIndex+1)}else this.length=this.lstFormasPago.length,this.lstFormasPagoPaged=Object(P.c)(this.lstFormasPago,this.pageSize,this.pageIndex+1)}}return t.\u0275fac=function(e){return new(e||t)(I.Nb(E.a))},t.\u0275cmp=I.Hb({type:t,selectors:[["app-lista-forma-pago"]],outputs:{getFormaPagoEv:"getFormaPagoEv"},decls:7,vars:7,consts:[[1,"mat-elevation-z4","fullWidth"],[1,"fullWidth"],["matInput","","placeholder","Buscar...",3,"ngModel","ngModelOptions","keyup","ngModelChange"],[3,"click",4,"ngFor","ngForOf"],["showFirstLastButtons","",3,"length","pageSize","pageSizeOptions","page"],[3,"click"],["mat-list-icon",""],["mat-line",""]],template:function(t,e){1&t&&(I.Tb(0,"mat-card",0),I.Tb(1,"mat-card-content"),I.Tb(2,"mat-form-field",1),I.Tb(3,"input",2),I.bc("keyup",function(){return e.applyFilter()})("ngModelChange",function(t){return e.txtFiltro=t}),I.Sb(),I.Sb(),I.Tb(4,"mat-nav-list"),I.Dc(5,$,5,1,"mat-list-item",3),I.Sb(),I.Tb(6,"mat-paginator",4),I.bc("page",function(t){return e.pageChange(t)}),I.Sb(),I.Sb(),I.Sb()),2&t&&(I.Cb(3),I.lc("ngModel",e.txtFiltro)("ngModelOptions",I.nc(6,j)),I.Cb(2),I.lc("ngForOf",e.lstFormasPagoPaged),I.Cb(1),I.lc("length",e.length)("pageSize",e.pageSize)("pageSizeOptions",e.pageSizeOptions))},directives:[f.a,f.c,u.b,d.b,n.c,n.k,n.n,s.e,i.l,T.a,s.c,l.a,s.b,A.j],styles:[".fullWidth[_ngcontent-%COMP%], table[_ngcontent-%COMP%]{width:100%!important}"]}),t})();var H=a("FY0D");function N(t,e){if(1&t){const t=I.Ub();I.Tb(0,"mat-form-field",9),I.Tb(1,"input",10),I.bc("ngModelChange",function(e){return I.xc(t),I.fc().formaPago.descripcion=e}),I.Sb(),I.Sb()}if(2&t){const t=I.fc();I.Cb(1),I.lc("ngModel",t.formaPago.descripcion)}}function U(t,e){if(1&t){const t=I.Ub();I.Tb(0,"button",11),I.bc("click",function(){return I.xc(t),I.fc().resetFormaPago()}),I.Fc(1," Nueva "),I.Sb()}}let R=(()=>{class t{constructor(t,e,a){this._snackBar=t,this.formaPagoSrvc=e,this.ls=a,this.formaPagoSavedEv=new I.o,this.esMovil=!1,this.resetFormaPago=()=>this.formaPago={forma_pago:null,descripcion:null,activo:1},this.onSubmit=()=>{this.formaPagoSrvc.save(this.formaPago).subscribe(t=>{t.exito&&(this.formaPagoSavedEv.emit(),this.resetFormaPago(),this._snackBar.open("Forma de pago agregada...","Forma de pago",{duration:3e3}))})}}ngOnInit(){this.esMovil=this.ls.get(P.a.usrTokenVar).enmovil||!1}}return t.\u0275fac=function(e){return new(e||t)(I.Nb(S.b),I.Nb(E.a),I.Nb(H.a))},t.\u0275cmp=I.Hb({type:t,selectors:[["app-form-forma-pago"]],inputs:{formaPago:"formaPago"},outputs:{formaPagoSavedEv:"formaPagoSavedEv"},decls:16,vars:5,consts:[[1,"mat-elevation-z4","fullWidth"],["novalidate","",3,"ngSubmit"],["frmFormaPago","ngForm"],[1,"form-group"],["class","fullWidth",4,"ngIf"],["name","activo",1,"fullWidth",3,"ngModel","ngModelChange"],["align","end"],["mat-raised-button","","type","submit","color","accent",1,"btnAccion",3,"disabled"],["mat-raised-button","","type","button","color","accent",3,"click",4,"ngIf"],[1,"fullWidth"],["matInput","","type","text","placeholder","Descripci\xf3n","name","descripcion","required","",3,"ngModel","ngModelChange"],["mat-raised-button","","type","button","color","accent",3,"click"]],template:function(t,e){if(1&t){const t=I.Ub();I.Tb(0,"mat-card",0),I.Tb(1,"mat-card-title"),I.Tb(2,"h4"),I.Fc(3),I.Sb(),I.Sb(),I.Tb(4,"mat-card-content"),I.Tb(5,"form",1,2),I.bc("ngSubmit",function(){return I.xc(t),I.tc(6).form.valid&&e.onSubmit()}),I.Tb(7,"div",3),I.Dc(8,N,2,1,"mat-form-field",4),I.Sb(),I.Tb(9,"div",3),I.Tb(10,"mat-checkbox",5),I.bc("ngModelChange",function(t){return+(e.formaPago.activo=t)}),I.Fc(11,"Activo"),I.Sb(),I.Sb(),I.Tb(12,"div",6),I.Tb(13,"button",7),I.Fc(14," Guardar "),I.Sb(),I.Dc(15,U,2,0,"button",8),I.Sb(),I.Sb(),I.Sb(),I.Sb()}if(2&t){const t=I.tc(6);I.Cb(3),I.Hc(" Forma de pago ",e.formaPago.forma_pago?e.formaPago.descripcion:""," "),I.Cb(5),I.lc("ngIf",e.esMovil),I.Cb(2),I.lc("ngModel",+e.formaPago.activo),I.Cb(3),I.lc("disabled",!t.form.valid),I.Cb(2),I.lc("ngIf",e.formaPago.forma_pago)}},directives:[f.a,f.h,f.c,n.r,n.l,n.m,i.m,g.a,n.k,n.n,F.a,u.b,d.b,n.c,n.p],styles:[".full-width[_ngcontent-%COMP%]{width:100%}.iconFontSize[_ngcontent-%COMP%]{font-size:24pt}"]}),t})();const L=["lstFormaPago"];let W=(()=>{class t{constructor(){this.setFormaPago=t=>this.formaPago=t,this.refreshFormaPagoList=()=>this.lstFormaPagoComponent.loadFormasPago(),this.formaPago={forma_pago:null,descripcion:null,activo:1}}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=I.Hb({type:t,selectors:[["app-forma-pago"]],viewQuery:function(t,e){if(1&t&&I.Kc(L,1),2&t){let t;I.sc(t=I.cc())&&(e.lstFormaPagoComponent=t.first)}},decls:7,vars:1,consts:[[1,"row"],[1,"col","m5","s12"],[3,"getFormaPagoEv"],["lstFormaPago",""],[1,"col","m7","s12"],[3,"formaPago","formaPagoSavedEv"],["frmIngreso",""]],template:function(t,e){1&t&&(I.Tb(0,"div",0),I.Tb(1,"div",1),I.Tb(2,"app-lista-forma-pago",2,3),I.bc("getFormaPagoEv",function(t){return e.setFormaPago(t)}),I.Sb(),I.Sb(),I.Tb(4,"div",4),I.Tb(5,"app-form-forma-pago",5,6),I.bc("formaPagoSavedEv",function(){return e.refreshFormaPagoList()}),I.Sb(),I.Sb(),I.Sb()),2&t&&(I.Cb(5),I.lc("formaPago",e.formaPago))},directives:[z,R],styles:[""]}),t})();var B=a("wd/R"),K=a("KFbY");const V=function(){return{standalone:!0}};function G(t,e){if(1&t){const t=I.Ub();I.Tb(0,"mat-form-field",5),I.Tb(1,"input",6),I.bc("keyup",function(){return I.xc(t),I.fc().applyFilter()})("ngModelChange",function(e){return I.xc(t),I.fc().txtFiltro=e}),I.Sb(),I.Sb()}if(2&t){const t=I.fc();I.Cb(1),I.lc("ngModel",t.txtFiltro)("ngModelOptions",I.nc(2,V))}}function q(t,e){if(1&t){const t=I.Ub();I.Tb(0,"mat-list-item",7),I.bc("click",function(){I.xc(t);const a=e.$implicit;return I.fc().getFactura(a)}),I.Tb(1,"mat-icon",8),I.Fc(2,"receipt"),I.Sb(),I.Tb(3,"h5",9),I.Fc(4),I.Sb(),I.Tb(5,"span",9),I.Fc(6),I.gc(7,"date"),I.Sb(),I.Tb(8,"span",9),I.Fc(9),I.Sb(),I.Tb(10,"span",9),I.Fc(11),I.Sb(),I.Sb()}if(2&t){const t=e.$implicit;I.Cb(4),I.Ic("",t.serie_factura,"\xa0",t.numero_factura,""),I.Cb(2),I.Hc("Fecha: ",I.ic(7,5,t.fecha_factura,"dd/MM/yyyy"),""),I.Cb(3),I.Hc("Cliente: ",t.cliente.nombre,""),I.Cb(2),I.Hc("NIT: ",t.cliente.nit,"")}}let J=(()=>{class t{constructor(t,e){this.facturaSrvc=t,this.ls=e,this.esMovil=!1,this.getFacturaEv=new I.o,this.length=0,this.pageSize=5,this.pageSizeOptions=[5,10,15],this.pageIndex=0,this.txtFiltro="",this.verTodas=!1,this.loadFacturas=()=>{const t={};this.verTodas&&(t._todas=!0),this.facturaSrvc.get(t).subscribe(t=>{t&&(this.lstFacturas=t.length>0?t:[],this.applyFilter())})},this.cargarFacturas=t=>this.loadFacturas(),this.getFactura=t=>{this.getFacturaEv.emit(t)},this.pageChange=t=>{this.pageSize=t.pageSize,this.pageIndex=t.pageIndex,this.applyFilter()}}ngOnInit(){this.esMovil=this.ls.get(P.a.usrTokenVar).enmovil||!1,this.loadFacturas()}applyFilter(){if(this.txtFiltro.length>0){const t=Object(P.b)(this.lstFacturas,this.txtFiltro);this.length=t.length,this.lstFacturasPaged=Object(P.c)(t,this.pageSize,this.pageIndex+1)}else this.length=this.lstFacturas.length,this.lstFacturasPaged=Object(P.c)(this.lstFacturas,this.pageSize,this.pageIndex+1)}}return t.\u0275fac=function(e){return new(e||t)(I.Nb(K.a),I.Nb(H.a))},t.\u0275cmp=I.Hb({type:t,selectors:[["app-lista-factura-manual"]],outputs:{getFacturaEv:"getFacturaEv"},decls:8,vars:8,consts:[[1,"mat-elevation-z4","fullWidth"],["class","fullWidth",4,"ngIf"],["name","pedirdocumento",1,"btnAccion",3,"ngModel","ngModelOptions","ngModelChange","change"],[3,"click",4,"ngFor","ngForOf"],["showFirstLastButtons","",3,"length","pageSize","pageSizeOptions","page"],[1,"fullWidth"],["matInput","","placeholder","Buscar...",3,"ngModel","ngModelOptions","keyup","ngModelChange"],[3,"click"],["mat-list-icon",""],["mat-line",""]],template:function(t,e){1&t&&(I.Tb(0,"mat-card",0),I.Tb(1,"mat-card-content"),I.Dc(2,G,2,3,"mat-form-field",1),I.Tb(3,"mat-checkbox",2),I.bc("ngModelChange",function(t){return e.verTodas=t})("change",function(t){return e.cargarFacturas(t)}),I.Fc(4,"Todas"),I.Sb(),I.Tb(5,"mat-nav-list"),I.Dc(6,q,12,8,"mat-list-item",3),I.Sb(),I.Tb(7,"mat-paginator",4),I.bc("page",function(t){return e.pageChange(t)}),I.Sb(),I.Sb(),I.Sb()),2&t&&(I.Cb(2),I.lc("ngIf",e.esMovil),I.Cb(1),I.lc("ngModel",e.verTodas)("ngModelOptions",I.nc(7,V)),I.Cb(3),I.lc("ngForOf",e.lstFacturasPaged),I.Cb(1),I.lc("length",e.length)("pageSize",e.pageSize)("pageSizeOptions",e.pageSizeOptions))},directives:[f.a,f.c,i.m,g.a,n.k,n.n,s.e,i.l,T.a,u.b,d.b,n.c,s.c,l.a,s.b,A.j],pipes:[i.e],styles:[".fullWidth[_ngcontent-%COMP%], table[_ngcontent-%COMP%]{width:100%!important}"]}),t})();var Q=a("IJgu"),X=a("R5jZ"),Y=a("un/a"),Z=a("JIr8"),tt=a("Qyje");let et=(()=>{class t{constructor(t){this.http=t,this.srvcErrHndl=new X.a}get(t={}){return this.http.get(`${P.a.urlCatalogos}/get_factura_serie?${tt.stringify(t)}`).pipe(Object(Y.a)(P.a.reintentos),Object(Z.a)(this.srvcErrHndl.errorHandler))}}return t.\u0275fac=function(e){return new(e||t)(I.Xb(c.b))},t.\u0275prov=I.Jb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var at=a("M8s9");let it=(()=>{class t{constructor(t){this.http=t,this.srvcErrHndl=new X.a}get(t={}){return this.http.get(`${P.a.urlCatalogos}/get_moneda?${tt.stringify(t)}`).pipe(Object(Y.a)(P.a.reintentos),Object(Z.a)(this.srvcErrHndl.errorHandler))}}return t.\u0275fac=function(e){return new(e||t)(I.Xb(c.b))},t.\u0275prov=I.Jb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var ct=a("NGYs"),nt=a("X/K6"),rt=a("7JkF");function ot(t,e){1&t&&(I.Tb(0,"h4",6),I.Fc(1,"*** ANULADA ***"),I.Sb())}function st(t,e){if(1&t){const t=I.Ub();I.Tb(0,"button",7),I.bc("click",function(){return I.xc(t),I.fc().showForm=!0}),I.Tb(1,"mat-icon",8),I.Fc(2,"expand_more"),I.Sb(),I.Sb()}}function lt(t,e){if(1&t){const t=I.Ub();I.Tb(0,"button",7),I.bc("click",function(){return I.xc(t),I.fc().showForm=!1}),I.Tb(1,"mat-icon",8),I.Fc(2,"expand_less"),I.Sb(),I.Sb()}}function ut(t,e){if(1&t&&(I.Tb(0,"mat-option",27),I.Fc(1),I.Sb()),2&t){const t=e.$implicit;I.lc("value",t.factura_serie),I.Cb(1),I.Ic(" ",t.serie," (",t.tipo,") ")}}function dt(t,e){if(1&t&&(I.Tb(0,"mat-option",27),I.Fc(1),I.Sb()),2&t){const t=e.$implicit;I.lc("value",t),I.Cb(1),I.Ic(" ",t.nombre," (",t.nit,") ")}}function ft(t,e){if(1&t&&(I.Tb(0,"mat-option",27),I.Fc(1),I.Sb()),2&t){const t=e.$implicit;I.lc("value",t.moneda),I.Cb(1),I.Ic(" ",t.nombre," (",t.simbolo,") ")}}function bt(t,e){if(1&t){const t=I.Ub();I.Tb(0,"mat-form-field",12),I.Tb(1,"input",28),I.bc("ngModelChange",function(e){return I.xc(t),I.fc(2).factura.notas=e}),I.Sb(),I.Sb()}if(2&t){const t=I.fc(2);I.Cb(1),I.lc("ngModel",t.factura.notas)}}function ht(t,e){if(1&t){const t=I.Ub();I.Tb(0,"button",29),I.bc("click",function(){return I.xc(t),I.fc(2).refacturar()}),I.Fc(1," Refacturar "),I.Sb()}}function pt(t,e){if(1&t){const t=I.Ub();I.Tb(0,"button",30),I.bc("click",function(){return I.xc(t),I.fc(2).resetFactura()}),I.Fc(1," Nueva "),I.Sb()}}const mt=function(){return{standalone:!0}};function gt(t,e){if(1&t){const t=I.Ub();I.Tb(0,"form",9,10),I.bc("ngSubmit",function(){I.xc(t);const e=I.tc(1),a=I.fc();return e.form.valid&&a.onSubmit()}),I.Tb(2,"div",11),I.Tb(3,"mat-form-field",12),I.Tb(4,"mat-label"),I.Fc(5,"Serie"),I.Sb(),I.Tb(6,"mat-select",13),I.bc("ngModelChange",function(e){return I.xc(t),I.fc().factura.factura_serie=e}),I.Dc(7,ut,2,3,"mat-option",14),I.Sb(),I.Sb(),I.Sb(),I.Tb(8,"div",11),I.Tb(9,"mat-form-field",12),I.Tb(10,"mat-label"),I.Fc(11,"Cliente"),I.Sb(),I.Tb(12,"input",15),I.bc("ngModelChange",function(e){return I.xc(t),I.fc().clienteSelected=e})("keyup",function(){I.xc(t);const e=I.fc();return e.filtrar(e.clienteSelected)}),I.Sb(),I.Tb(13,"mat-autocomplete",16,17),I.Dc(15,dt,2,3,"mat-option",14),I.Sb(),I.Sb(),I.Sb(),I.Tb(16,"div",11),I.Tb(17,"mat-form-field",12),I.Tb(18,"input",18),I.bc("ngModelChange",function(e){return I.xc(t),I.fc().factura.fecha_factura=e}),I.Sb(),I.Sb(),I.Sb(),I.Tb(19,"div",11),I.Tb(20,"mat-form-field",12),I.Tb(21,"mat-label"),I.Fc(22,"Moneda"),I.Sb(),I.Tb(23,"mat-select",19),I.bc("ngModelChange",function(e){return I.xc(t),I.fc().factura.moneda=e}),I.Dc(24,ft,2,3,"mat-option",14),I.Sb(),I.Sb(),I.Sb(),I.Tb(25,"div",11),I.Tb(26,"mat-checkbox",20),I.bc("ngModelChange",function(e){return I.xc(t),+(I.fc().factura.exenta=e)}),I.Fc(27,"Exenta"),I.Sb(),I.Sb(),I.Tb(28,"div",11),I.Dc(29,bt,2,1,"mat-form-field",21),I.Sb(),I.Tb(30,"div",22),I.Tb(31,"button",23),I.Fc(32," Guardar "),I.Sb(),I.Tb(33,"button",24),I.bc("click",function(){return I.xc(t),I.fc().firmarFactura()}),I.Fc(34," Firmar "),I.Sb(),I.Tb(35,"button",24),I.bc("click",function(){return I.xc(t),I.fc().imprimirFactura()}),I.Fc(36," Imprimir "),I.Sb(),I.Tb(37,"button",24),I.bc("click",function(){return I.xc(t),I.fc().representacionGrafica()}),I.Fc(38," PDF "),I.Sb(),I.Tb(39,"button",24),I.bc("click",function(){return I.xc(t),I.fc().anularFactura()}),I.Fc(40," Anular "),I.Sb(),I.Dc(41,ht,2,0,"button",25),I.Dc(42,pt,2,0,"button",26),I.Sb(),I.Sb()}if(2&t){const t=I.tc(1),e=I.tc(14),a=I.fc();I.Cb(6),I.lc("ngModel",a.factura.factura_serie),I.Cb(1),I.lc("ngForOf",a.facturaSeries),I.Cb(5),I.lc("ngModel",a.clienteSelected)("ngModelOptions",I.nc(19,mt))("matAutocomplete",e),I.Cb(1),I.lc("displayWith",a.displayCliente),I.Cb(2),I.lc("ngForOf",a.filteredClientes),I.Cb(3),I.lc("ngModel",a.factura.fecha_factura),I.Cb(5),I.lc("ngModel",a.factura.moneda),I.Cb(1),I.lc("ngForOf",a.monedas),I.Cb(2),I.lc("ngModel",+a.factura.exenta),I.Cb(3),I.lc("ngIf",a.esMovil),I.Cb(2),I.lc("disabled",!(t.form.valid&&!a.factura.fel_uuid&&!a.factura.fel_uuid_anulacion&&a.factura.cliente)),I.Cb(2),I.lc("disabled",!t.form.valid||!!a.factura.fel_uuid||!!a.factura.fel_uuid_anulacion||0===a.detallesFactura.length||a.refacturacion),I.Cb(2),I.lc("disabled",!t.form.valid||null==a.factura.fel_uuid||null==a.factura.fel_uuid||!!a.factura.fel_uuid_anulacion||0===a.detallesFactura.length||a.refacturacion),I.Cb(2),I.lc("disabled",!t.form.valid||null==a.factura.fel_uuid||null==a.factura.fel_uuid||0===a.detallesFactura.length||a.refacturacion),I.Cb(2),I.lc("disabled",!t.form.valid||null==a.factura.fel_uuid||null==a.factura.fel_uuid||!!a.factura.fel_uuid_anulacion||0===a.detallesFactura.length),I.Cb(2),I.lc("ngIf",!!a.factura.fel_uuid_anulacion),I.Cb(1),I.lc("ngIf",a.factura.factura)}}function Ft(t,e){1&t&&I.Ob(0,"hr")}function St(t,e){if(1&t){const t=I.Ub();I.Tb(0,"button",7),I.bc("click",function(){return I.xc(t),I.fc(2).showFormDetalle=!0}),I.Tb(1,"mat-icon",8),I.Fc(2,"expand_more"),I.Sb(),I.Sb()}}function _t(t,e){if(1&t){const t=I.Ub();I.Tb(0,"button",7),I.bc("click",function(){return I.xc(t),I.fc(2).showFormDetalle=!1}),I.Tb(1,"mat-icon",8),I.Fc(2,"expand_less"),I.Sb(),I.Sb()}}function vt(t,e){if(1&t&&(I.Tb(0,"mat-option",27),I.Fc(1),I.Sb()),2&t){const t=e.$implicit;I.lc("value",t),I.Cb(1),I.Hc(" ",t.descripcion," ")}}function Ct(t,e){if(1&t){const t=I.Ub();I.Tb(0,"mat-form-field",12),I.Tb(1,"input",36),I.bc("ngModelChange",function(e){return I.xc(t),I.fc(3).detalleFactura.cantidad=e})("change",function(){I.xc(t);const e=I.fc(3);return e.detalleFactura.total=+e.detalleFactura.precio_unitario*+e.detalleFactura.cantidad}),I.Sb(),I.Sb()}if(2&t){const t=I.fc(3);I.Cb(1),I.lc("ngModel",t.detalleFactura.cantidad)}}function Tt(t,e){if(1&t){const t=I.Ub();I.Tb(0,"mat-form-field",12),I.Tb(1,"input",37),I.bc("ngModelChange",function(e){return I.xc(t),I.fc(3).detalleFactura.precio_unitario=e})("change",function(){I.xc(t);const e=I.fc(3);return e.detalleFactura.total=+e.detalleFactura.precio_unitario*+e.detalleFactura.cantidad}),I.Sb(),I.Sb()}if(2&t){const t=I.fc(3);I.Cb(1),I.lc("ngModel",t.detalleFactura.precio_unitario)}}function xt(t,e){if(1&t){const t=I.Ub();I.Tb(0,"button",30),I.bc("click",function(){return I.xc(t),I.fc(3).resetDetalleFactura()}),I.Fc(1," Nuevo "),I.Sb()}}function Mt(t,e){if(1&t){const t=I.Ub();I.Tb(0,"form",9,32),I.bc("ngSubmit",function(){I.xc(t);const e=I.tc(1),a=I.fc(2);return e.form.valid&&a.onSubmitDetail()}),I.Tb(2,"div",11),I.Tb(3,"mat-form-field",12),I.Tb(4,"mat-label"),I.Fc(5,"Art\xedculo"),I.Sb(),I.Tb(6,"input",33),I.bc("ngModelChange",function(e){return I.xc(t),I.fc(2).txtArticuloSelected=e})("keyup",function(){I.xc(t);const e=I.fc(2);return e.filtrarArticulos(e.txtArticuloSelected)}),I.Sb(),I.Tb(7,"mat-autocomplete",34,35),I.bc("optionSelected",function(e){return I.xc(t),I.fc(2).setPrecioUnitario(e)}),I.Dc(9,vt,2,2,"mat-option",14),I.Sb(),I.Sb(),I.Sb(),I.Tb(10,"div",11),I.Dc(11,Ct,2,1,"mat-form-field",21),I.Sb(),I.Tb(12,"div",11),I.Dc(13,Tt,2,1,"mat-form-field",21),I.Sb(),I.Tb(14,"div",22),I.Tb(15,"button",23),I.Fc(16," Guardar "),I.Sb(),I.Dc(17,xt,2,0,"button",26),I.Sb(),I.Sb()}if(2&t){const t=I.tc(1),e=I.tc(8),a=I.fc(2);I.Cb(6),I.lc("ngModel",a.txtArticuloSelected)("ngModelOptions",I.nc(9,mt))("matAutocomplete",e),I.Cb(1),I.lc("displayWith",a.displayArticulo),I.Cb(2),I.lc("ngForOf",a.filteredArticulos),I.Cb(2),I.lc("ngIf",a.esMovil),I.Cb(2),I.lc("ngIf",a.esMovil),I.Cb(2),I.lc("disabled",!t.form.valid||!!a.factura.fel_uuid||!!a.factura.fel_uuid_anulacion),I.Cb(2),I.lc("ngIf",a.detalleFactura.detalle_factura)}}function yt(t,e){1&t&&I.Ob(0,"hr")}function kt(t,e){1&t&&(I.Tb(0,"th",50),I.Fc(1,"Art\xedculo"),I.Sb())}function wt(t,e){if(1&t&&(I.Tb(0,"td",51),I.Fc(1),I.Sb()),2&t){const t=e.$implicit;I.Cb(1),I.Gc(t.articulo.descripcion)}}function Dt(t,e){1&t&&(I.Tb(0,"th",52),I.Fc(1,"Cantidad"),I.Sb())}function Ot(t,e){if(1&t&&(I.Tb(0,"td",53),I.Fc(1),I.gc(2,"number"),I.Sb()),2&t){const t=e.$implicit;I.Cb(1),I.Gc(I.ic(2,1,t.cantidad,"1.2-2"))}}function It(t,e){1&t&&(I.Tb(0,"th",52),I.Fc(1,"Precio Unitario"),I.Sb())}function Pt(t,e){if(1&t&&(I.Tb(0,"td",53),I.Fc(1),I.gc(2,"number"),I.Sb()),2&t){const t=e.$implicit;I.Cb(1),I.Hc("",I.ic(2,1,t.precio_unitario,"1.2-2")," ")}}function Et(t,e){1&t&&(I.Tb(0,"th",52),I.Fc(1,"Total"),I.Sb())}function At(t,e){if(1&t&&(I.Tb(0,"td",53),I.Fc(1),I.gc(2,"number"),I.Sb()),2&t){const t=e.$implicit;I.Cb(1),I.Gc(I.ic(2,1,t.total,"1.2-2"))}}function $t(t,e){1&t&&(I.Tb(0,"th",50),I.Fc(1,"\xa0"),I.Sb())}function jt(t,e){if(1&t){const t=I.Ub();I.Tb(0,"td",51),I.Tb(1,"button",54),I.bc("click",function(){I.xc(t);const a=e.$implicit;return I.fc(3).getDetalleFactura(a.factura,a.detalle_factura)}),I.Fc(2," Editar "),I.Sb(),I.Sb()}if(2&t){const t=I.fc(3);I.Cb(1),I.lc("disabled",!!t.factura.fel_uuid||!!t.factura.fel_uuid_anulacion||t.refacturacion)}}function zt(t,e){1&t&&I.Ob(0,"tr",55)}function Ht(t,e){1&t&&I.Ob(0,"tr",56)}function Nt(t,e){if(1&t&&(I.Tb(0,"table",38),I.Rb(1,39),I.Dc(2,kt,2,0,"th",40),I.Dc(3,wt,2,1,"td",41),I.Qb(),I.Rb(4,42),I.Dc(5,Dt,2,0,"th",43),I.Dc(6,Ot,3,4,"td",44),I.Qb(),I.Rb(7,45),I.Dc(8,It,2,0,"th",43),I.Dc(9,Pt,3,4,"td",44),I.Qb(),I.Rb(10,46),I.Dc(11,Et,2,0,"th",43),I.Dc(12,At,3,4,"td",44),I.Qb(),I.Rb(13,47),I.Dc(14,$t,2,0,"th",40),I.Dc(15,jt,3,1,"td",41),I.Qb(),I.Dc(16,zt,1,0,"tr",48),I.Dc(17,Ht,1,0,"tr",49),I.Sb()),2&t){const t=I.fc(2);I.lc("dataSource",t.dataSource),I.Cb(16),I.lc("matHeaderRowDef",t.displayedColumns),I.Cb(1),I.lc("matRowDefColumns",t.displayedColumns)}}function Ut(t,e){if(1&t&&(I.Tb(0,"mat-card",0),I.Tb(1,"mat-card-title"),I.Tb(2,"h4"),I.Fc(3),I.Dc(4,St,3,0,"button",2),I.Dc(5,_t,3,0,"button",2),I.Sb(),I.Sb(),I.Tb(6,"mat-card-content"),I.Dc(7,Mt,18,10,"form",3),I.Dc(8,yt,1,0,"hr",4),I.Dc(9,Nt,18,3,"table",31),I.Sb(),I.Sb()),2&t){const t=I.fc();I.Cb(3),I.Hc(" Detalle de factura No. ",t.factura.serie_factura?t.factura.serie_factura+" "+t.factura.numero_factura:"Pendiente de firmar."," "),I.Cb(1),I.lc("ngIf",!t.showFormDetalle),I.Cb(1),I.lc("ngIf",t.showFormDetalle),I.Cb(2),I.lc("ngIf",t.showFormDetalle),I.Cb(1),I.lc("ngIf",t.detallesFactura.length>0),I.Cb(1),I.lc("ngIf",t.detallesFactura.length>0)}}let Rt=(()=>{class t{constructor(t,e,a,i,c,n,r,o,s,l){this.snackBar=t,this.dialog=e,this.facturaSrvc=a,this.facturaSerieSrvc=i,this.clienteSrvc=c,this.monedaSrvc=n,this.articuloSrvc=r,this.anulacionSrvc=o,this.socket=s,this.ls=l,this.facturaSavedEv=new I.o,this.showForm=!0,this.showFormDetalle=!0,this.facturaSeries=[],this.clientes=[],this.filteredClientes=[],this.monedas=[],this.detallesFactura=[],this.articulos=[],this.filteredArticulos=[],this.displayedColumns=["articulo","cantidad","precio_unitario","total","editItem"],this.esMovil=!1,this.refacturacion=!1,this.txtArticuloSelected=void 0,this.clienteSelected=void 0,this.razonAnulacion=[],this.getRazonAnulacion=()=>{this.anulacionSrvc.get().subscribe(t=>{this.razonAnulacion=t})},this.filtrar=t=>{if(t&&"string"==typeof t){const e=t.toLowerCase();this.filteredClientes=this.clientes.filter(t=>t.nombre.toLowerCase().includes(e)||t.nit.toLowerCase().includes(e))}else this.filteredClientes=this.clientes},this.loadFacturaSeries=()=>{this.facturaSerieSrvc.get().subscribe(t=>{t&&(this.facturaSeries=t)})},this.loadClientes=()=>{this.clienteSrvc.get().subscribe(t=>{t&&(this.clientes=t,this.filteredClientes=this.clientes)})},this.loadMonedas=()=>{this.monedaSrvc.get().subscribe(t=>{t&&(this.monedas=t)})},this.refacturar=()=>{this.factura={factura:this.factura.factura,factura_serie:null,cliente:null,fecha_factura:B().format(P.a.dbDateFormat),moneda:null,exenta:0,notas:null,fel_uuid:null,fel_uuid_anulacion:null},this.refacturacion=!0},this.resetFactura=()=>{this.factura={factura:null,factura_serie:null,cliente:null,fecha_factura:B().format(P.a.dbDateFormat),moneda:null,exenta:0,notas:null,fel_uuid:null,fel_uuid_anulacion:null},this.clienteSelected=void 0,this.resetDetalleFactura(),this.detallesFactura=[]},this.displayCliente=t=>{if(t)return this.factura.cliente=t.cliente,t.nombre},this.onSubmit=()=>{this.refacturacion?this.facturaSrvc.refacturar(this.factura).subscribe(t=>{t.exito&&(this.facturaSavedEv.emit(),this.resetFactura(),this.refacturacion=!1,this.factura={factura:t.factura.factura,factura_serie:t.factura.factura_serie,cliente:t.factura.cliente,fecha_factura:t.factura.fecha_factura,moneda:t.factura.moneda,exenta:+t.factura.exenta,notas:t.factura.notas,fel_uuid:t.factura.fel_uuid},this.snackBar.open("Factura manual agregada...","Factura",{duration:3e3}))}):this.facturaSrvc.save(this.factura).subscribe(t=>{t.exito&&(this.facturaSavedEv.emit(),this.resetFactura(),this.factura={factura:t.factura.factura,factura_serie:t.factura.factura_serie,cliente:t.factura.cliente,fecha_factura:t.factura.fecha_factura,moneda:t.factura.moneda,exenta:+t.factura.exenta,notas:t.factura.notas,fel_uuid:t.factura.fel_uuid},this.snackBar.open("Factura manual agregada...","Factura",{duration:3e3}))})},this.firmarFactura=()=>{this.dialog.open(Q.a,{maxWidth:"400px",data:new Q.b("Firmar factura","Luego de firmar la factura no podr\xe1 hacer ninguna modificaci\xf3n. \xbfDesea continuar?","S\xed","No")}).afterClosed().subscribe(t=>{t&&this.facturaSrvc.firmar(+this.factura.factura).subscribe(t=>{t.exito?(this.factura.numero_factura=t.factura.numero_factura,this.factura.serie_factura=t.factura.serie_factura,this.factura.certificador_fel=t.factura.certificador_fel,this.factura.fel_uuid=t.factura.fel_uuid,this.facturaSavedEv.emit(),this.snackBar.open("Factura firmada con \xe9xito...","Firmar",{duration:3e3})):this.snackBar.open(`ERROR: ${t.mensaje}`,"Firmar",{duration:3e3})})})},this.procesaDetalleFactura=t=>{const e=[];return t.forEach(t=>e.push({Cantidad:+t.cantidad,Descripcion:t.articulo.descripcion,Total:+t.total})),e},this.getTotalDetalle=t=>{let e=0;return t.forEach(t=>e+=+t.total),e},this.getTotalImpuestosAdicionales=t=>{let e=0;return t.forEach(t=>e+=+t.total),e},this.imprimirFactura=()=>{this.facturaSrvc.imprimir(+this.factura.factura).subscribe(t=>{t.factura?(console.log(t.factura),this.socket.emit("print:factura",`${JSON.stringify({NombreEmpresa:t.factura.empresa.nombre,NitEmpresa:t.factura.empresa.nit,SedeEmpresa:t.factura.sedeFactura.nombre,DireccionEmpresa:t.factura.empresa.direccion,Fecha:B(t.factura.fecha_factura).format(P.a.dateFormat),Nit:t.factura.receptor.nit,Nombre:t.factura.receptor.nombre,Direccion:t.factura.receptor.direccion,Serie:t.factura.serie_factura,Numero:t.factura.numero_factura,Total:this.getTotalDetalle(t.factura.detalle)+this.getTotalImpuestosAdicionales(t.factura.impuestos_adicionales||[]),NoAutorizacion:t.factura.fel_uuid,NombreCertificador:t.factura.certificador_fel.nombre,NitCertificador:t.factura.certificador_fel.nit,FechaDeAutorizacion:t.factura.fecha_autorizacion,NoOrdenEnLinea:"",FormaDePago:"",DetalleFactura:this.procesaDetalleFactura(t.factura.detalle),ImpuestosAdicionales:t.factura.impuestos_adicionales||[]})}`),this.snackBar.open(`Imprimiendo factura ${this.factura.serie_factura}-${this.factura.numero_factura}`,"Impresi\xf3n",{duration:3e3})):this.snackBar.open(`ERROR: ${t.mensaje}`,"Impresi\xf3n",{duration:3e3})})},this.anularFactura=()=>{this.dialog.open(Q.a,{maxWidth:"400px",data:new Q.b("Anular factura","Luego de anular la factura no podr\xe1 hacer ninguna modificaci\xf3n. \xbfDesea continuar?","S\xed","No",{input:[{select:!0,label:"Motivo",datos:this.razonAnulacion,valor:null,id:"razon_anulacion",descripcion:"descripcion",requerido:!0},{select:!1,label:"Comentario",valor:null,id:"comentario_anulacion",requerido:!1}]})}).afterClosed().subscribe(t=>{if(t.resultado){const e={};for(let a=0;a<t.config.input.length;a++){const i=t.config.input[a];e[i.id]=i.valor}this.facturaSrvc.anular(+this.factura.factura,e).subscribe(t=>{t.exito?(this.factura.fel_uuid_anulacion=t.factura.fel_uuid_anulacion,this.facturaSavedEv.emit(),this.snackBar.open("Factura anulada con \xe9xito...","Firmar",{duration:3e3})):this.snackBar.open(`ERROR: ${t.mensaje}`,"Firmar",{duration:1e4})})}})},this.loadArticulos=()=>{this.articuloSrvc.getArticulos().subscribe(t=>{t&&(this.articulos=t,this.filteredArticulos=this.articulos)})},this.displayArticulo=t=>{if(t)return this.detalleFactura.articulo=t.articulo,t.descripcion},this.filtrarArticulos=t=>{if(t&&"string"==typeof t){const e=t.toLowerCase();this.filteredArticulos=this.articulos.filter(t=>t.descripcion.toLowerCase().includes(e))}else this.filteredArticulos=this.articulos},this.setPrecioUnitario=t=>{this.detalleFactura.precio_unitario=+t.option.value.precio,this.detalleFactura.total=+this.detalleFactura.precio_unitario*+this.detalleFactura.cantidad},this.resetDetalleFactura=()=>{this.detalleFactura={detalle_factura:null,factura:this.factura.factura||0,articulo:null,cantidad:1,precio_unitario:null,total:null},this.txtArticuloSelected=void 0},this.loadDetalleFactura=(t=+this.factura.factura)=>{this.facturaSrvc.getDetalle(t,{factura:t}).subscribe(t=>{t&&(this.detallesFactura=t,this.updateTableDataSource())})},this.getDetalleFactura=(t=+this.factura.factura,e)=>{this.facturaSrvc.getDetalle(t,{detalle_factura:e}).subscribe(t=>{t&&(this.detalleFactura={detalle_factura:t[0].detalle_factura,factura:t[0].factura,articulo:t[0].articulo.articulo,cantidad:+t[0].cantidad,precio_unitario:+t[0].precio_unitario,total:+t[0].total},this.txtArticuloSelected=t[0].articulo,this.showFormDetalle=!0)})},this.onSubmitDetail=()=>{this.detalleFactura.factura=this.factura.factura,this.detalleFactura.total=+this.detalleFactura.precio_unitario*+this.detalleFactura.cantidad,this.facturaSrvc.saveDetalle(this.detalleFactura).subscribe(t=>{t&&(this.loadDetalleFactura(),this.resetDetalleFactura())})},this.updateTableDataSource=()=>this.dataSource=new p.k(this.detallesFactura),this.representacionGrafica=()=>{this.facturaSrvc.getGrafo(this.factura.factura).subscribe(t=>{if(t.exito)switch(t.tipo){case"link":this.openLinkWindow(t.documento);break;case"pdf":this.openPdfDocument(t.documento)}})},this.openLinkWindow=t=>window.open(t,"winFactPdf","height=700,width=800,menubar=no,location=no,resizable=no,scrollbars=no,status=no"),this.openPdfDocument=t=>{window.open("","winFactPdf","height=700,width=800,menubar=no,location=no,resizable=no,scrollbars=no,status=no").document.write('<iframe width="100%" style="margin: -8px;border: none;" height="100%" src="data:application/pdf;base64, '+encodeURI(t)+'"></iframe>')}}ngOnInit(){this.esMovil=this.ls.get(P.a.usrTokenVar).enmovil||!1,this.refacturacion=!1,this.resetFactura(),this.loadFacturaSeries(),this.loadClientes(),this.loadMonedas(),this.loadArticulos(),this.getRazonAnulacion(),this.ls.get(P.a.usrTokenVar).sede_uuid&&(this.socket.emit("joinRestaurant",this.ls.get(P.a.usrTokenVar).sede_uuid),this.socket.on("reconnect",()=>this.socket.emit("joinRestaurant",this.ls.get(P.a.usrTokenVar).sede_uuid)))}}return t.\u0275fac=function(e){return new(e||t)(I.Nb(S.b),I.Nb(x.b),I.Nb(K.a),I.Nb(et),I.Nb(at.a),I.Nb(it),I.Nb(ct.a),I.Nb(nt.a),I.Nb(rt.a),I.Nb(H.a))},t.\u0275cmp=I.Hb({type:t,selectors:[["app-form-factura-manual"]],inputs:{factura:"factura"},outputs:{facturaSavedEv:"facturaSavedEv"},decls:11,vars:7,consts:[[1,"mat-elevation-z4","fullWidth"],["style","background-color: lightcoral;",4,"ngIf"],["mat-icon-button","","type","button","color","accent",3,"click",4,"ngIf"],["novalidate","",3,"ngSubmit",4,"ngIf"],[4,"ngIf"],["class","mat-elevation-z4 fullWidth",4,"ngIf"],[2,"background-color","lightcoral"],["mat-icon-button","","type","button","color","accent",3,"click"],[1,"iconFontSize"],["novalidate","",3,"ngSubmit"],["frmFactura","ngForm"],[1,"form-group"],[1,"fullWidth"],["name","factura_serie","required","",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["type","text","placeholder","Cliente","matInput","","required","",3,"ngModel","ngModelOptions","matAutocomplete","ngModelChange","keyup"],[3,"displayWith"],["auto","matAutocomplete"],["matInput","","type","date","placeholder","Fecha","name","fecha_factura","required","",3,"ngModel","ngModelChange"],["name","moneda","required","",3,"ngModel","ngModelChange"],["name","exenta",1,"fullWidth",3,"ngModel","ngModelChange"],["class","fullWidth",4,"ngIf"],["align","end"],["mat-raised-button","","type","submit","color","accent",1,"btnAccion",3,"disabled"],["mat-raised-button","","type","button","color","accent",1,"btnAccion",3,"disabled","click"],["mat-raised-button","","type","button","color","accent","class","btnAccion",3,"click",4,"ngIf"],["mat-raised-button","","type","button","color","accent",3,"click",4,"ngIf"],[3,"value"],["matInput","","type","text","placeholder","Notas","name","notas",3,"ngModel","ngModelChange"],["mat-raised-button","","type","button","color","accent",1,"btnAccion",3,"click"],["mat-raised-button","","type","button","color","accent",3,"click"],["mat-table","","class","mat-elevation-z4 full-width",3,"dataSource",4,"ngIf"],["frmDetalleFactura","ngForm"],["type","text","placeholder","Art\xedculo","matInput","","required","",3,"ngModel","ngModelOptions","matAutocomplete","ngModelChange","keyup"],[3,"displayWith","optionSelected"],["autoArticulos","matAutocomplete"],["matInput","","placeholder","Cantidad","name","cantidad","required","",3,"ngModel","ngModelChange","change"],["matInput","","placeholder","Precio unitario","name","precio_unitario","required","",3,"ngModel","ngModelChange","change"],["mat-table","",1,"mat-elevation-z4","full-width",3,"dataSource"],["matColumnDef","articulo"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","","class","text-wrap",4,"matCellDef"],["matColumnDef","cantidad"],["mat-header-cell","","class","text-right",4,"matHeaderCellDef"],["mat-cell","","class","text-right",4,"matCellDef"],["matColumnDef","precio_unitario"],["matColumnDef","total"],["matColumnDef","editItem"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell","",1,"text-wrap"],["mat-header-cell","",1,"text-right"],["mat-cell","",1,"text-right"],["mat-raised-button","","type","button","color","accent",3,"disabled","click"],["mat-header-row",""],["mat-row",""]],template:function(t,e){1&t&&(I.Tb(0,"mat-card",0),I.Tb(1,"mat-card-title"),I.Dc(2,ot,2,0,"h4",1),I.Tb(3,"h4"),I.Fc(4),I.Dc(5,st,3,0,"button",2),I.Dc(6,lt,3,0,"button",2),I.Sb(),I.Sb(),I.Tb(7,"mat-card-content"),I.Dc(8,gt,43,20,"form",3),I.Sb(),I.Sb(),I.Dc(9,Ft,1,0,"hr",4),I.Dc(10,Ut,10,6,"mat-card",5)),2&t&&(I.Cb(2),I.lc("ngIf",!!e.factura.fel_uuid_anulacion),I.Cb(2),I.Hc(" Factura ",e.factura.factura?e.factura.serie_factura?e.factura.serie_factura+" "+e.factura.numero_factura:"Pendiente de firmar.":""," "),I.Cb(1),I.lc("ngIf",!e.showForm),I.Cb(1),I.lc("ngIf",e.showForm),I.Cb(2),I.lc("ngIf",e.showForm),I.Cb(1),I.lc("ngIf",e.factura.factura),I.Cb(1),I.lc("ngIf",e.factura.factura))},directives:[f.a,f.h,i.m,f.c,F.a,l.a,n.r,n.l,n.m,u.b,u.e,m.a,n.p,n.k,n.n,i.l,d.b,n.c,y.c,y.a,g.a,A.m,p.j,p.c,p.e,p.b,p.g,p.i,p.d,p.a,p.f,p.h],pipes:[i.f],styles:[".full-width[_ngcontent-%COMP%]{width:100%}.iconFontSize[_ngcontent-%COMP%]{font-size:24pt}"]}),t})();const Lt=["lstFacturaManual"],Wt=["frmFacturaManual"],Bt=[{path:"fpago",component:W,canActivate:[O.a]},{path:"factman",component:(()=>{class t{constructor(){this.setFactura=t=>{this.factura={factura:t.factura,factura_serie:t.factura_serie.factura_serie,cliente:t.cliente.cliente,fecha_factura:t.fecha_factura,moneda:t.moneda.moneda,exenta:t.exenta,notas:t.notas,usuario:t.usuario.usuario,numero_factura:t.numero_factura,serie_factura:t.serie_factura,fel_uuid:t.fel_uuid,fel_uuid_anulacion:t.fel_uuid_anulacion,certificador_fel:t.certificador_fel},this.frmFactura.clienteSelected=t.cliente,this.frmFactura.loadDetalleFactura(+this.factura.factura),this.frmFactura.resetDetalleFactura()},this.refreshFacturaList=()=>this.lstFacturaComponent.loadFacturas(),this.factura={factura:null,factura_serie:null,cliente:null,fecha_factura:B().format(P.a.dbDateFormat),moneda:null,exenta:0,notas:null}}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=I.Hb({type:t,selectors:[["app-factura-manual"]],viewQuery:function(t,e){if(1&t&&(I.Kc(Lt,1),I.Kc(Wt,1)),2&t){let t;I.sc(t=I.cc())&&(e.lstFacturaComponent=t.first),I.sc(t=I.cc())&&(e.frmFactura=t.first)}},decls:7,vars:1,consts:[[1,"row"],[1,"col","m5","s12"],[3,"getFacturaEv"],["lstFacturaManual",""],[1,"col","m7","s12"],[3,"factura","facturaSavedEv"],["frmFacturaManual",""]],template:function(t,e){1&t&&(I.Tb(0,"div",0),I.Tb(1,"div",1),I.Tb(2,"app-lista-factura-manual",2,3),I.bc("getFacturaEv",function(t){return e.setFactura(t)}),I.Sb(),I.Sb(),I.Tb(4,"div",4),I.Tb(5,"app-form-factura-manual",5,6),I.bc("facturaSavedEv",function(){return e.refreshFacturaList()}),I.Sb(),I.Sb(),I.Sb()),2&t&&(I.Cb(5),I.lc("factura",e.factura))},directives:[J,Rt],styles:[""]}),t})(),canActivate:[O.a]},{path:"**",redirectTo:"/admin/dashboard",pathMatch:"full"}];let Kt=(()=>{class t{}return t.\u0275mod=I.Lb({type:t}),t.\u0275inj=I.Kb({factory:function(e){return new(e||t)},imports:[[D.d.forChild(Bt)],D.d]}),t})(),Vt=(()=>{class t{}return t.\u0275mod=I.Lb({type:t}),t.\u0275inj=I.Kb({factory:function(e){return new(e||t)},imports:[[i.c,Kt,c.c,n.e,k.b,r.a,o.AdminModule,s.d,l.b,u.d,d.c,f.f,b.b,h.c,p.l,m.b,g.b,F.b,S.c,_.b,v.d,C.b,T.b,x.e,M.d,y.b,w.c]]}),t})()}}]);